var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,o=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),s=(e,i,o,s)=>{if(i&&typeof i==`object`||typeof i==`function`)for(var c=r(i),l=0,u=c.length,d;l<u;l++)d=c[l],!a.call(e,d)&&d!==o&&t(e,d,{get:(e=>i[e]).bind(null,d),enumerable:!(s=n(i,d))||s.enumerable});return e},c=(n,r,a)=>(a=n==null?{}:e(i(n)),s(r||!n||!n.__esModule?t(a,`default`,{value:n,enumerable:!0}):a,n)),l=e=>t=>c(t.default,e),u=class{constructor(e){this.executor=e,this._didRun=!1}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}},d=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?pe.isErrorNoTelemetry(e)?new pe(e.message+`

`+e.stack):Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}};const f=new d;function p(e){f.setUnexpectedErrorHandler(e)}function ee(e){f.onUnexpectedError(e)}function m(e){ae(e)||f.onUnexpectedError(e)}function te(e){ae(e)||f.onUnexpectedExternalError(e)}function ne(e){if(e instanceof Error){let{name:t,message:n,cause:r}=e,i=e.stacktrace||e.stack;return{$isError:!0,name:t,message:n,stack:i,noTelemetry:pe.isErrorNoTelemetry(e),cause:r?ne(r):void 0,code:e.code}}return e}function re(e){let t;return e.noTelemetry?t=new pe:(t=Error(),t.name=e.name),t.message=e.message,t.stack=e.stack,e.code&&(t.code=e.code),e.cause&&(t.cause=re(e.cause)),t}const ie=`Canceled`;function ae(e){return e instanceof oe?!0:e instanceof Error&&e.name===ie&&e.message===ie}var oe=class extends Error{constructor(){super(ie),this.name=this.message}},se=class e extends Error{static{this._name=`PendingMigrationError`}static is(t){return t instanceof e||t instanceof Error&&t.name===e._name}constructor(t){super(t),this.name=e._name}};function ce(){let e=Error(ie);return e.name=e.message,e}function h(e){return e?Error(`Illegal argument: ${e}`):Error(`Illegal argument`)}function le(e){return e?Error(`Illegal state: ${e}`):Error(`Illegal state`)}var ue=class extends TypeError{constructor(e){super(e?`${e} is read-only and cannot be changed`:`Cannot change read-only property`)}},de=class extends Error{constructor(e){super(`NotImplemented`),e&&(this.message=e)}},fe=class extends Error{constructor(e){super(`NotSupported`),e&&(this.message=e)}},pe=class e extends Error{constructor(e){super(e),this.name=`CodeExpectedError`}static fromError(t){if(t instanceof e)return t;let n=new e;return n.message=t.message,n.stack=t.stack,n}static isErrorNoTelemetry(e){return e.name===`CodeExpectedError`}},me=class e extends Error{constructor(t){super(t||`An unexpected bug occurred.`),Object.setPrototypeOf(this,e.prototype)}};function he(e,t,n=0,r=e.length){let i=n,a=r;for(;i<a;){let n=Math.floor((i+a)/2);t(e[n])?i=n+1:a=n}return i-1}(class e{static{this.assertInvariants=!1}constructor(e){this._array=e,this._findLastMonotonousLastIdx=0}findLastMonotonous(t){if(e.assertInvariants){if(this._prevFindLastPredicate){for(let e of this._array)if(this._prevFindLastPredicate(e)&&!t(e))throw Error(`MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.`)}this._prevFindLastPredicate=t}let n=he(this._array,t,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=n+1,n===-1?void 0:this._array[n]}});function ge(e,t,n=(e,t)=>e===t){if(e===t)return!0;if(!e||!t||e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function _e(e,t){let n=[],r;for(let i of e.slice(0).sort(t))!r||t(r[0],i)!==0?(r=[i],n.push(r)):r.push(i);return n}function ve(e,t,n){let r=[];function i(e,t,n){if(t===0&&n.length===0)return;let i=r[r.length-1];i&&i.start+i.deleteCount===e?(i.deleteCount+=t,i.toInsert.push(...n)):r.push({start:e,deleteCount:t,toInsert:n})}let a=0,o=0;for(;;){if(a===e.length){i(a,0,t.slice(o));break}if(o===t.length){i(a,e.length-a,[]);break}let r=e[a],s=t[o],c=n(r,s);c===0?(a+=1,o+=1):c<0?(i(a,1,[]),a+=1):c>0&&(i(a,0,[s]),o+=1)}return r}function ye(e,t,n){let r=ve(e,t,n),i=[],a=[];for(let t of r)i.push(...e.slice(t.start,t.start+t.deleteCount)),a.push(...t.toInsert);return{removed:i,added:a}}function be(e){return e.filter(e=>!!e)}function xe(e){let t=0;for(let n=0;n<e.length;n++)e[n]&&(e[t]=e[n],t+=1);e.length=t}function Se(e){return!Array.isArray(e)||e.length===0}function Ce(e){return Array.isArray(e)&&e.length>0}function we(e,t=e=>e){let n=new Set;return e.filter(e=>{let r=t(e);return n.has(r)?!1:(n.add(r),!0)})}function Te(e,t){let n;if(typeof t==`number`){let e=t;n=()=>{let t=Math.sin(e++)*179426549;return t-Math.floor(t)}}else n=Math.random;for(let t=e.length-1;t>0;--t){let r=Math.floor(n()*(t+1)),i=e[t];e[t]=e[r],e[r]=i}}function Ee(e,t){return Array.isArray(e)?e.map(t):t(e)}function De(e){return Array.isArray(e)?e:[e]}var Oe;(function(e){function t(e){return e<0}e.isLessThan=t;function n(e){return e<=0}e.isLessThanOrEqual=n;function r(e){return e>0}e.isGreaterThan=r;function i(e){return e===0}e.isNeitherLessOrGreaterThan=i,e.greaterThan=1,e.lessThan=-1,e.neitherLessOrGreaterThan=0})(Oe||={});function ke(e,t){return(n,r)=>t(e(n),e(r))}const Ae=(e,t)=>e-t;(class e{static{this.empty=new e(e=>{})}constructor(e){this.iterate=e}forEach(e){this.iterate(t=>(e(t),!0))}toArray(){let e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(t){return new e(e=>this.iterate(n=>t(n)?e(n):!0))}map(t){return new e(e=>this.iterate(n=>e(t(n))))}some(e){let t=!1;return this.iterate(n=>(t=e(n),!t)),t}findFirst(e){let t;return this.iterate(n=>e(n)?(t=n,!1):!0),t}findLast(e){let t;return this.iterate(n=>(e(n)&&(t=n),!0)),t}findLastMaxBy(e){let t,n=!0;return this.iterate(r=>((n||Oe.isGreaterThan(e(r,t)))&&(n=!1,t=r),!0)),t}});var je;function Me(e,t){let n=Object.create(null);for(let r of e){let e=t(r),i=n[e];i||=n[e]=[],i.push(r)}return n}function Ne(e,t){let n=[],r=[];for(let r of e)t.has(r)||n.push(r);for(let n of t)e.has(n)||r.push(n);return{removed:n,added:r}}(class{static{je=Symbol.toStringTag}constructor(e,t){this.toKey=t,this._map=new Map,this[je]=`SetWithKey`;for(let t of e)this.add(t)}get size(){return this._map.size}add(e){let t=this.toKey(e);return this._map.set(t,e),this}delete(e){return this._map.delete(this.toKey(e))}has(e){return this._map.has(this.toKey(e))}*entries(){for(let e of this._map.values())yield[e,e]}keys(){return this.values()}*values(){for(let e of this._map.values())yield e}clear(){this._map.clear()}forEach(e,t){this._map.forEach(n=>e.call(t,n,n,this))}[Symbol.iterator](){return this.values()}});var Pe,Fe,Ie;function g(e,t,n){let r=e.get(t);return r===void 0&&(r=n,e.set(t,r)),r}var Le=class{constructor(e,t){this.uri=e,this.value=t}};function Re(e){return Array.isArray(e)}var ze=class e{static{this.defaultToKey=e=>e.toString()}constructor(t,n){if(this[Pe]=`ResourceMap`,t instanceof e)this.map=new Map(t.map),this.toKey=n??e.defaultToKey;else if(Re(t)){this.map=new Map,this.toKey=n??e.defaultToKey;for(let[e,n]of t)this.set(e,n)}else this.map=new Map,this.toKey=t??e.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new Le(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){t!==void 0&&(e=e.bind(t));for(let[t,n]of this.map)e(n.value,n.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(Pe=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}},Be=class{constructor(e,t){this[Fe]=`ResourceSet`,!e||typeof e==`function`?this._map=new ze(e):(this._map=new ze(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,r)=>e.call(t,r,r,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(Fe=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}},Ve;(function(e){e[e.None=0]=`None`,e[e.AsOld=1]=`AsOld`,e[e.AsNew=2]=`AsNew`})(Ve||={});var He=class{constructor(){this[Ie]=`LinkedMap`,this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=Ve.None){let n=this._map.get(e);if(n)return t!==Ve.None&&this.touch(n,t),n.value}set(e,t,n=Ve.None){let r=this._map.get(e);if(r)r.value=t,n!==Ve.None&&this.touch(r,n);else{switch(r={key:e,value:t,next:void 0,previous:void 0},n){case Ve.None:this.addItemLast(r);break;case Ve.AsOld:this.addItemFirst(r);break;case Ve.AsNew:this.addItemLast(r);break;default:this.addItemLast(r);break}this._map.set(e,r),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw Error(`Invalid list`);let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,r=this._head;for(;r;){if(t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),this._state!==n)throw Error(`LinkedMap got modified during iteration.`);r=r.next}}keys(){let e=this,t=this._state,n=this._head,r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw Error(`LinkedMap got modified during iteration.`);if(n){let e={value:n.key,done:!1};return n=n.next,e}else return{value:void 0,done:!0}}};return r}values(){let e=this,t=this._state,n=this._head,r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw Error(`LinkedMap got modified during iteration.`);if(n){let e={value:n.value,done:!1};return n=n.next,e}else return{value:void 0,done:!0}}};return r}entries(){let e=this,t=this._state,n=this._head,r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw Error(`LinkedMap got modified during iteration.`);if(n){let e={value:[n.key,n.value],done:!1};return n=n.next,e}else return{value:void 0,done:!0}}};return r}[(Ie=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.previous,n--;this._tail=t,this._size=n,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw Error(`Invalid list`);this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw Error(`Invalid list`);this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw Error(`Invalid list`);e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw Error(`Invalid list`);e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw Error(`Invalid list`);t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw Error(`Invalid list`);if(!(t!==Ve.AsOld&&t!==Ve.AsNew)){if(t===Ve.AsOld){if(e===this._head)return;let t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Ve.AsNew){if(e===this._tail)return;let t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}},Ue=class extends He{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Ve.AsNew){return super.get(e,t)}peek(e){return super.get(e,Ve.None)}set(e,t){return super.set(e,t,Ve.AsNew),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},We=class extends Ue{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}},Ge=class{constructor(){this.map=new Map}add(e,t){let n=this.map.get(e);n||(n=new Set,this.map.set(e,n)),n.add(t)}delete(e,t){let n=this.map.get(e);n&&(n.delete(t),n.size===0&&this.map.delete(e))}forEach(e,t){let n=this.map.get(e);n&&n.forEach(t)}get(e){let t=this.map.get(e);return t||new Set}};function Ke(e,t){let n=this,r=!1,i;return function(){if(r)return i;if(r=!0,t)try{i=e.apply(n,arguments)}finally{t()}else i=e.apply(n,arguments);return i}}function qe(e,t){if(!e)throw Error(t?`Assertion failed (${t})`:`Assertion Failed`)}function Je(e,t=`Unreachable`){throw Error(t)}function Ye(e,t=`unexpected state`){if(!e){let e=typeof t==`string`?new me(`Assertion Failed: ${t}`):t;throw e}}function Xe(e){e()||(e(),m(new me(`Assertion Failed`)))}function Ze(e){return typeof e==`string`}function Qe(e){return Array.isArray(e)&&e.every(e=>Ze(e))}function $e(e){return typeof e==`object`&&!!e&&!Array.isArray(e)&&!(e instanceof RegExp)&&!(e instanceof Date)}function et(e){let t=Object.getPrototypeOf(Uint8Array);return typeof e==`object`&&e instanceof t}function tt(e){return typeof e==`number`&&!isNaN(e)}function nt(e){return!!e&&typeof e[Symbol.iterator]==`function`}function rt(e){return e===void 0}function it(e){return!at(e)}function at(e){return rt(e)||e===null}function ot(e,t){if(!e)throw Error(t?`Unexpected type, expected '${t}'`:`Unexpected type`)}function st(e){return Ye(e!=null,"Argument is `undefined` or `null`."),e}const ct=Object.prototype.hasOwnProperty;function lt(e){if(!$e(e))return!1;for(let t in e)if(ct.call(e,t))return!1;return!0}function ut(e){return typeof e==`function`}function dt(e,t){let n=Math.min(e.length,t.length);for(let r=0;r<n;r++)ft(e[r],t[r])}function ft(e,t){if(Ze(t)){if(typeof e!==t)throw Error(`argument does not match constraint: typeof ${t}`)}else if(ut(t)){try{if(e instanceof t)return}catch{}if(!at(e)&&e.constructor===t||t.length===1&&t.call(void 0,e)===!0)return;throw Error(`argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true`)}}var pt;(function(e){function t(e){return!!e&&typeof e==`object`&&typeof e[Symbol.iterator]==`function`}e.is=t;let n=Object.freeze([]);function r(){return n}e.empty=r;function*i(e){yield e}e.single=i;function a(e){return t(e)?e:i(e)}e.wrap=a;function o(e){return e||n}e.from=o;function*s(e){for(let t=e.length-1;t>=0;t--)yield e[t]}e.reverse=s;function c(e){return!e||e[Symbol.iterator]().next().done===!0}e.isEmpty=c;function l(e){return e[Symbol.iterator]().next().value}e.first=l;function u(e,t){let n=0;for(let r of e)if(t(r,n++))return!0;return!1}e.some=u;function d(e,t){let n=0;for(let r of e)if(!t(r,n++))return!1;return!0}e.every=d;function f(e,t){for(let n of e)if(t(n))return n}e.find=f;function*p(e,t){for(let n of e)t(n)&&(yield n)}e.filter=p;function*ee(e,t){let n=0;for(let r of e)yield t(r,n++)}e.map=ee;function*m(e,t){let n=0;for(let r of e)yield*t(r,n++)}e.flatMap=m;function*te(...e){for(let t of e)nt(t)?yield*t:yield t}e.concat=te;function ne(e,t,n){let r=n;for(let n of e)r=t(r,n);return r}e.reduce=ne;function re(e){let t=0;for(let n of e)t++;return t}e.length=re;function*ie(e,t,n=e.length){for(t<-e.length&&(t=0),t<0&&(t+=e.length),n<0?n+=e.length:n>e.length&&(n=e.length);t<n;t++)yield e[t]}e.slice=ie;function ae(t,n=1/0){let r=[];if(n===0)return[r,t];let i=t[Symbol.iterator]();for(let t=0;t<n;t++){let t=i.next();if(t.done)return[r,e.empty()];r.push(t.value)}return[r,{[Symbol.iterator](){return i}}]}e.consume=ae;async function oe(e){let t=[];for await(let n of e)t.push(n);return t}e.asyncToArray=oe;async function se(e){let t=[];for await(let n of e)t=t.concat(n);return t}e.asyncToArrayFlat=se})(pt||={}),class e{constructor(){this.livingDisposables=new Map}static{this.idx=0}getDisposableData(t){let n=this.livingDisposables.get(t);return n||(n={parent:null,source:null,isSingleton:!1,value:t,idx:e.idx++},this.livingDisposables.set(t,n)),n}trackDisposable(e){let t=this.getDisposableData(e);t.source||=Error().stack}setParent(e,t){let n=this.getDisposableData(e);n.parent=t}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=!0}getRootParent(e,t){let n=t.get(e);if(n)return n;let r=e.parent?this.getRootParent(this.getDisposableData(e.parent),t):e;return t.set(e,r),r}getTrackedDisposables(){let e=new Map,t=[...this.livingDisposables.entries()].filter(([,t])=>t.source!==null&&!this.getRootParent(t,e).isSingleton).flatMap(([e])=>e);return t}computeLeakingDisposables(e=10,t){let n;if(t)n=t;else{let e=new Map,t=[...this.livingDisposables.values()].filter(t=>t.source!==null&&!this.getRootParent(t,e).isSingleton);if(t.length===0)return;let r=new Set(t.map(e=>e.value));if(n=t.filter(e=>!(e.parent&&r.has(e.parent))),n.length===0)throw Error(`There are cyclic diposable chains!`)}if(!n)return;function r(e){function t(e,t){for(;e.length>0&&t.some(t=>typeof t==`string`?t===e[0]:e[0].match(t));)e.shift()}let n=e.source.split(`
`).map(e=>e.trim().replace(`at `,``)).filter(e=>e!==``);return t(n,[`Error`,/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),n.reverse()}let i=new Ge;for(let e of n){let t=r(e);for(let n=0;n<=t.length;n++)i.add(t.slice(0,n).join(`
`),e)}n.sort(ke(e=>e.idx,Ae));let a=``,o=0;for(let t of n.slice(0,e)){o++;let e=r(t),s=[];for(let t=0;t<e.length;t++){let a=e[t],o=i.get(e.slice(0,t+1).join(`
`));a=`(shared with ${o.size}/${n.length} leaks) at ${a}`;let c=i.get(e.slice(0,t).join(`
`)),l=Me([...c].map(e=>r(e)[t]),e=>e);delete l[e[t]];for(let[e,t]of Object.entries(l))s.unshift(`    - stacktraces of ${t.length} other leaks continue with ${e}`);s.unshift(a)}a+=`\n\n\n==================== Leaking disposable ${o}/${n.length}: ${t.value.constructor.name} ====================\n${s.join(`
`)}\n============================================================\n\n`}return n.length>e&&(a+=`\n\n\n... and ${n.length-e} more leaking disposables\n\n`),{leaks:n,details:a}}};function mt(e){return null?.trackDisposable(e),e}function ht(e){null?.markAsDisposed(e)}function gt(e,t){null?.setParent(e,t)}function _t(e){return null?.markAsSingleton(e),e}function vt(e){return typeof e==`object`&&!!e&&typeof e.dispose==`function`&&e.dispose.length===0}function yt(e){if(pt.is(e)){let t=[];for(let n of e)if(n)try{n.dispose()}catch(e){t.push(e)}if(t.length===1)throw t[0];if(t.length>1)throw AggregateError(t,`Encountered errors while disposing of store`);return Array.isArray(e)?[]:e}else if(e)return e.dispose(),e}function bt(...e){let t=_(()=>yt(e));return t}function _(e){let t=mt({dispose:Ke(()=>{ht(t),e()})});return t}var v=class e{static{this.DISABLE_DISPOSED_WARNING=!1}constructor(){this._toDispose=new Set,this._isDisposed=!1,mt(this)}dispose(){this._isDisposed||(ht(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{yt(this._toDispose)}finally{this._toDispose.clear()}}add(t){if(!t)return t;if(t===this)throw Error(`Cannot register a disposable on itself!`);return gt(t,this),this._isDisposed?e.DISABLE_DISPOSED_WARNING||console.warn(Error(`Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!`).stack):this._toDispose.add(t),t}delete(e){if(e){if(e===this)throw Error(`Cannot dispose a disposable on itself!`);this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),gt(e,null))}},y=class{static{this.None=Object.freeze({dispose(){}})}constructor(){this._store=new v,mt(this),gt(this._store,this)}dispose(){ht(this),this._store.dispose()}_register(e){if(e===this)throw Error(`Cannot register a disposable on itself!`);return this._store.add(e)}},xt=class{constructor(){this._isDisposed=!1,mt(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&gt(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,ht(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e&&gt(e,null),e}},St=class{constructor(){this._store=new Map,this._isDisposed=!1,mt(this)}dispose(){ht(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{yt(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,n=!1){this._isDisposed&&console.warn(Error(`Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!`).stack),n||this._store.get(e)?.dispose(),this._store.set(e,t),gt(t,this)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let t=this._store.get(e);return t&&gt(t,null),this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};function Ct(e,t){return new wt(e,t)}var wt=class{constructor(e,t){this.reducer=e,this.options=t,this.state={flowing:!1,ended:!1,destroyed:!1},this.buffer={data:[],error:[]},this.listeners={data:[],error:[],end:[]},this.pendingWritePromises=[]}pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(e){if(!this.state.destroyed){if(this.state.flowing)this.emitData(e);else if(this.buffer.data.push(e),typeof this.options?.highWaterMark==`number`&&this.buffer.data.length>this.options.highWaterMark)return new Promise(e=>this.pendingWritePromises.push(e))}}error(e){this.state.destroyed||(this.state.flowing?this.emitError(e):this.buffer.error.push(e))}end(e){this.state.destroyed||(e!==void 0&&this.write(e),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(e){this.listeners.data.slice(0).forEach(t=>t(e))}emitError(e){this.listeners.error.length===0?m(e):this.listeners.error.slice(0).forEach(t=>t(e))}emitEnd(){this.listeners.end.slice(0).forEach(e=>e())}on(e,t){if(!this.state.destroyed)switch(e){case`data`:this.listeners.data.push(t),this.resume();break;case`end`:this.listeners.end.push(t),this.state.flowing&&this.flowEnd()&&this.destroy();break;case`error`:this.listeners.error.push(t),this.state.flowing&&this.flowErrors();break}}removeListener(e,t){if(this.state.destroyed)return;let n;switch(e){case`data`:n=this.listeners.data;break;case`end`:n=this.listeners.end;break;case`error`:n=this.listeners.error;break}if(n){let e=n.indexOf(t);e>=0&&n.splice(e,1)}}flowData(){if(this.buffer.data.length===0)return;if(typeof this.reducer==`function`){let e=this.reducer(this.buffer.data);this.emitData(e)}else for(let e of this.buffer.data)this.emitData(e);this.buffer.data.length=0;let e=[...this.pendingWritePromises];this.pendingWritePromises.length=0,e.forEach(e=>e())}flowErrors(){if(this.listeners.error.length>0){for(let e of this.buffer.error)this.emitError(e);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}};function Tt(e,t){let n=[],r;for(;(r=e.read())!==null;)n.push(r);return t(n)}function Et(e,t){return new Promise((n,r)=>{let i=[];Dt(e,{onData:e=>{t&&i.push(e)},onError:e=>{t?r(e):n(void 0)},onEnd:()=>{n(t?t(i):void 0)}})})}function Dt(e,t,n){e.on(`error`,e=>{n?.isCancellationRequested||t.onError(e)}),e.on(`end`,()=>{n?.isCancellationRequested||t.onEnd()}),e.on(`data`,e=>{n?.isCancellationRequested||t.onData(e)})}function Ot(e,t){let n=Ct(t);return n.end(e),n}const kt=typeof Buffer<`u`,At=new u(()=>new Uint8Array(256));let jt,Mt;var b=class e{static alloc(t){return kt?new e(Buffer.allocUnsafe(t)):new e(new Uint8Array(t))}static wrap(t){return kt&&!Buffer.isBuffer(t)&&(t=Buffer.from(t.buffer,t.byteOffset,t.byteLength)),new e(t)}static fromString(t,n){let r=n?.dontUseNodeBuffer||!1;return!r&&kt?new e(Buffer.from(t)):(jt||=new TextEncoder,new e(jt.encode(t)))}static fromByteArray(t){let n=e.alloc(t.length);for(let e=0,r=t.length;e<r;e++)n.buffer[e]=t[e];return n}static concat(t,n){if(n===void 0){n=0;for(let e=0,r=t.length;e<r;e++)n+=t[e].byteLength}let r=e.alloc(n),i=0;for(let e=0,n=t.length;e<n;e++){let n=t[e];r.set(n,i),i+=n.byteLength}return r}static isNativeBuffer(e){return kt&&Buffer.isBuffer(e)}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){let t=e.alloc(this.byteLength);return t.set(this),t}toString(){return kt?this.buffer.toString():(Mt||=new TextDecoder,Mt.decode(this.buffer))}slice(t,n){return new e(this.buffer.subarray(t,n))}set(t,n){if(t instanceof e)this.buffer.set(t.buffer,n);else if(t instanceof Uint8Array)this.buffer.set(t,n);else if(t instanceof ArrayBuffer)this.buffer.set(new Uint8Array(t),n);else if(ArrayBuffer.isView(t))this.buffer.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n);else throw Error(`Unknown argument 'array'`)}readUInt32BE(e){return It(this.buffer,e)}writeUInt32BE(e,t){Lt(this.buffer,e,t)}readUInt32LE(e){return Rt(this.buffer,e)}writeUInt32LE(e,t){zt(this.buffer,e,t)}readUInt8(e){return Bt(this.buffer,e)}writeUInt8(e,t){Vt(this.buffer,e,t)}indexOf(t,n=0){return Nt(this.buffer,t instanceof e?t.buffer:t,n)}equals(e){return this===e?!0:this.byteLength===e.byteLength?this.buffer.every((t,n)=>t===e.buffer[n]):!1}};function Nt(e,t,n=0){let r=t.byteLength,i=e.byteLength;if(r===0)return 0;if(r===1)return e.indexOf(t[0]);if(r>i-n)return-1;let a=At.value;a.fill(t.length);for(let e=0;e<t.length;e++)a[t[e]]=t.length-e-1;let o=n+t.length-1,s=o,c=-1;for(;o<i;)if(e[o]===t[s]){if(s===0){c=o;break}o--,s--}else o+=Math.max(t.length-s,a[e[o]]),s=t.length-1;return c}function Pt(e,t){return e[t+0]<<0>>>0|e[t+1]<<8>>>0}function Ft(e,t,n){e[n+0]=t&255,t>>>=8,e[n+1]=t&255}function It(e,t){return e[t]*2**24+e[t+1]*2**16+e[t+2]*2**8+e[t+3]}function Lt(e,t,n){e[n+3]=t,t>>>=8,e[n+2]=t,t>>>=8,e[n+1]=t,t>>>=8,e[n]=t}function Rt(e,t){return e[t+0]<<0>>>0|e[t+1]<<8>>>0|e[t+2]<<16>>>0|e[t+3]<<24>>>0}function zt(e,t,n){e[n+0]=t&255,t>>>=8,e[n+1]=t&255,t>>>=8,e[n+2]=t&255,t>>>=8,e[n+3]=t&255}function Bt(e,t){return e[t]}function Vt(e,t,n){e[n]=t}function Ht(e){return Tt(e,e=>b.concat(e))}function Ut(e){return Ot(e,e=>b.concat(e))}function Wt(e){let t=0,n=0,r=0,i=new Uint8Array(Math.floor(e.length/4*3)),a=e=>{switch(n){case 3:i[r++]=t|e,n=0;break;case 2:i[r++]=t|e>>>2,t=e<<6,n=3;break;case 1:i[r++]=t|e>>>4,t=e<<4,n=2;break;default:t=e<<2,n=1}};for(let t=0;t<e.length;t++){let n=e.charCodeAt(t);if(n>=65&&n<=90)a(n-65);else if(n>=97&&n<=122)a(n-97+26);else if(n>=48&&n<=57)a(n-48+52);else if(n===43||n===45)a(62);else if(n===47||n===95)a(63);else if(n===61)break;else throw SyntaxError(`Unexpected base64 character ${e[t]}`)}let o=r;for(;n>0;)a(0);return b.wrap(i).slice(0,o)}function Gt({buffer:e},t=!0,n=!1){let r=n?`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_`:`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/`,i=``,a=e.byteLength%3,o=0;for(;o<e.byteLength-a;o+=3){let t=e[o+0],n=e[o+1],a=e[o+2];i+=r[t>>>2],i+=r[(t<<4|n>>>4)&63],i+=r[(n<<2|a>>>6)&63],i+=r[a&63]}if(a===1){let n=e[o+0];i+=r[n>>>2],i+=r[n<<4&63],t&&(i+=`==`)}else if(a===2){let n=e[o+0],a=e[o+1];i+=r[n>>>2],i+=r[(n<<4|a>>>4)&63],i+=r[a<<2&63],t&&(i+=`=`)}return i}const Kt=`0123456789abcdef`;function qt({buffer:e}){let t=``;for(let n=0;n<e.length;n++){let r=e[n];t+=Kt[r>>>4],t+=Kt[r&15]}return t}function Jt(e){if(e.length%2!=0)throw SyntaxError(`Hex string must have an even length`);let t=new Uint8Array(e.length>>1);for(let n=0;n<e.length;)t[n>>1]=Yt(e,n++)<<4|Yt(e,n++);return b.wrap(t)}function Yt(e,t){let n=e.charCodeAt(t);if(n>=48&&n<=57)return n-48;if(n>=97&&n<=102)return n-87;if(n>=65&&n<=70)return n-55;throw SyntaxError(`Invalid hex character at position ${t}`)}var Xt=class e{static{this.Undefined=new e(void 0)}constructor(t){this.element=t,this.next=e.Undefined,this.prev=e.Undefined}},Zt=class{constructor(){this._first=Xt.Undefined,this._last=Xt.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Xt.Undefined}clear(){let e=this._first;for(;e!==Xt.Undefined;){let t=e.next;e.prev=Xt.Undefined,e.next=Xt.Undefined,e=t}this._first=Xt.Undefined,this._last=Xt.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){let n=new Xt(e);if(this._first===Xt.Undefined)this._first=n,this._last=n;else if(t){let e=this._last;this._last=n,n.prev=e,e.next=n}else{let e=this._first;this._first=n,n.next=e,e.prev=n}this._size+=1;let r=!1;return()=>{r||(r=!0,this._remove(n))}}shift(){if(this._first!==Xt.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==Xt.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==Xt.Undefined&&e.next!==Xt.Undefined){let t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Xt.Undefined&&e.next===Xt.Undefined?(this._first=Xt.Undefined,this._last=Xt.Undefined):e.next===Xt.Undefined?(this._last=this._last.prev,this._last.next=Xt.Undefined):e.prev===Xt.Undefined&&(this._first=this._first.next,this._first.prev=Xt.Undefined);--this._size}*[Symbol.iterator](){let e=this._first;for(;e!==Xt.Undefined;)yield e.element,e=e.next}};const Qt=globalThis.performance.now.bind(globalThis.performance);var $t=class e{static create(t){return new e(t)}constructor(e){this._now=e===!1?Date.now:Qt,this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime===-1?this._now()-this._startTime:this._stopTime-this._startTime}},en;(function(e){e.None=()=>y.None;function t(e,t){return f(e,()=>void 0,0,void 0,!0,void 0,t)}e.defer=t;function n(e){return(t,n=null,r)=>{let i=!1,a;return a=e(e=>{if(!i)return a?a.dispose():i=!0,t.call(n,e)},null,r),i&&a.dispose(),a}}e.once=n;function r(t,n){return e.once(e.filter(t,n))}e.onceIf=r;function i(e,t,n){return u((n,r=null,i)=>e(e=>n.call(r,t(e)),null,i),n)}e.map=i;function a(e,t,n){return u((n,r=null,i)=>e(e=>{t(e),n.call(r,e)},null,i),n)}e.forEach=a;function o(e,t,n){return u((n,r=null,i)=>e(e=>t(e)&&n.call(r,e),null,i),n)}e.filter=o;function s(e){return e}e.signal=s;function c(...e){return(t,n=null,r)=>{let i=bt(...e.map(e=>e(e=>t.call(n,e))));return d(i,r)}}e.any=c;function l(e,t,n,r){let a=n;return i(e,e=>(a=t(a,e),a),r)}e.reduce=l;function u(e,t){let n,r={onWillAddFirstListener(){n=e(i.fire,i)},onDidRemoveLastListener(){n?.dispose()}},i=new x(r);return t?.add(i),i.event}function d(e,t){return t instanceof Array?t.push(e):t&&t.add(e),e}function f(e,t,n=100,r=!1,i=!1,a,o){let s,c,l,u=0,d,f={leakWarningThreshold:a,onWillAddFirstListener(){s=e(e=>{u++,c=t(c,e),r&&!l&&(p.fire(c),c=void 0),d=()=>{let e=c;c=void 0,l=void 0,(!r||u>1)&&p.fire(e),u=0},typeof n==`number`?(l&&clearTimeout(l),l=setTimeout(d,n)):l===void 0&&(l=null,queueMicrotask(d))})},onWillRemoveListener(){i&&u>0&&d?.()},onDidRemoveLastListener(){d=void 0,s.dispose()}},p=new x(f);return o?.add(p),p.event}e.debounce=f;function p(t,n=0,r){return e.debounce(t,(e,t)=>e?(e.push(t),e):[t],n,void 0,!0,void 0,r)}e.accumulate=p;function ee(e,t=(e,t)=>e===t,n){let r=!0,i;return o(e,e=>{let n=r||!t(e,i);return r=!1,i=e,n},n)}e.latch=ee;function m(t,n,r){return[e.filter(t,n,r),e.filter(t,e=>!n(e),r)]}e.split=m;function te(e,t=!1,n=[],r){let i=n.slice(),a=e(e=>{i?i.push(e):s.fire(e)});r&&r.add(a);let o=()=>{i?.forEach(e=>s.fire(e)),i=null},s=new x({onWillAddFirstListener(){a||(a=e(e=>s.fire(e)),r&&r.add(a))},onDidAddFirstListener(){i&&(t?setTimeout(o):o())},onDidRemoveLastListener(){a&&a.dispose(),a=null}});return r&&r.add(s),s.event}e.buffer=te;function ne(e,t){let n=(n,r,i)=>{let a=t(new ie);return e(function(e){let t=a.evaluate(e);t!==re&&n.call(r,t)},void 0,i)};return n}e.chain=ne;let re=Symbol(`HaltChainable`);class ie{constructor(){this.steps=[]}map(e){return this.steps.push(e),this}forEach(e){return this.steps.push(t=>(e(t),t)),this}filter(e){return this.steps.push(t=>e(t)?t:re),this}reduce(e,t){let n=t;return this.steps.push(t=>(n=e(n,t),n)),this}latch(e=(e,t)=>e===t){let t=!0,n;return this.steps.push(r=>{let i=t||!e(r,n);return t=!1,n=r,i?r:re}),this}evaluate(e){for(let t of this.steps)if(e=t(e),e===re)break;return e}}function ae(e,t,n=e=>e){let r=(...e)=>o.fire(n(...e)),i=()=>e.on(t,r),a=()=>e.removeListener(t,r),o=new x({onWillAddFirstListener:i,onDidRemoveLastListener:a});return o.event}e.fromNodeEventEmitter=ae;function oe(e,t,n=e=>e){let r=(...e)=>o.fire(n(...e)),i=()=>e.addEventListener(t,r),a=()=>e.removeEventListener(t,r),o=new x({onWillAddFirstListener:i,onDidRemoveLastListener:a});return o.event}e.fromDOMEventEmitter=oe;function se(e,t){let r,i=new Promise((i,a)=>{let o=n(e)(i,null,t);r=()=>o.dispose()});return i.cancel=r,i}e.toPromise=se;function ce(e){let t=new x;return e.then(e=>{t.fire(e)},()=>{t.fire(void 0)}).finally(()=>{t.dispose()}),t.event}e.fromPromise=ce;function h(e,t){return e(e=>t.fire(e))}e.forward=h;function le(e,t,n){return t(n),e(e=>t(e))}e.runAndSubscribe=le;class ue{constructor(e,t){this._observable=e,this._counter=0,this._hasChanged=!1;let n={onWillAddFirstListener:()=>{e.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{e.removeObserver(this)}};this.emitter=new x(n),t&&t.add(this.emitter)}beginUpdate(e){this._counter++}handlePossibleChange(e){}handleChange(e,t){this._hasChanged=!0}endUpdate(e){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function de(e,t){let n=new ue(e,t);return n.emitter.event}e.fromObservable=de;function fe(e){return(t,n,r)=>{let i=0,a=!1,o={beginUpdate(){i++},endUpdate(){i--,i===0&&(e.reportChanges(),a&&(a=!1,t.call(n)))},handlePossibleChange(){},handleChange(){a=!0}};e.addObserver(o),e.reportChanges();let s={dispose(){e.removeObserver(o)}};return r instanceof v?r.add(s):Array.isArray(r)&&r.push(s),s}}e.fromObservableLight=fe})(en||={});var tn=class e{static{this.all=new Set}static{this._idPool=0}constructor(t){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${t}_${e._idPool++}`,e.all.add(this)}start(e){this._stopWatch=new $t,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},nn=class e{static{this._idPool=1}constructor(t,n,r=(e._idPool++).toString(16).padStart(3,`0`)){this._errorHandler=t,this.threshold=n,this.name=r,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(e,t){let n=this.threshold;if(n<=0||t<n)return;this._stacks||=new Map;let r=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,r+1),--this._warnCountdown,this._warnCountdown<=0){this._warnCountdown=n*.5;let[e,r]=this.getMostFrequentStack(),i=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${r}):`;console.warn(i),console.warn(e);let a=new an(i,e);this._errorHandler(a)}return()=>{let t=this._stacks.get(e.value)||0;this._stacks.set(e.value,t-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(let[n,r]of this._stacks)(!e||t<r)&&(e=[n,r],t=r);return e}},rn=class e{static create(){let t=Error();return new e(t.stack??``)}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},an=class extends Error{constructor(e,t){super(e),this.name=`ListenerLeakError`,this.stack=t}},on=class extends Error{constructor(e,t){super(e),this.name=`ListenerRefusalError`,this.stack=t}};let sn=0;var cn=class{constructor(e){this.value=e,this.id=sn++}};const ln=(e,t)=>{if(e instanceof cn)t(e);else for(let n=0;n<e.length;n++){let r=e[n];r&&t(r)}};var x=class{constructor(e){this._size=0,this._options=e,this._leakageMon=this._options?.leakWarningThreshold?new nn(e?.onListenerError??m,this._options?.leakWarningThreshold??-1):void 0,this._perfMon=this._options?._profName?new tn(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){this._disposed||(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose())}get event(){return this._event??=(e,t,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let e=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(e);let t=this._leakageMon.getMostFrequentStack()??[`UNKNOWN stack`,-1],n=new on(`${e}. HINT: Stack shows most frequent listener (${t[1]}-times)`,t[0]),r=this._options?.onListenerError||m;return r(n),y.None}if(this._disposed)return y.None;t&&(e=e.bind(t));let r=new cn(e),i;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(r.stack=rn.create(),i=this._leakageMon.check(r.stack,this._size+1)),this._listeners?this._listeners instanceof cn?(this._deliveryQueue??=new un,this._listeners=[this._listeners,r]):this._listeners.push(r):(this._options?.onWillAddFirstListener?.(this),this._listeners=r,this._options?.onDidAddFirstListener?.(this)),this._options?.onDidAddListener?.(this),this._size++;let a=_(()=>{i?.(),this._removeListener(r)});return n instanceof v?n.add(a):Array.isArray(n)&&n.push(a),a},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let t=this._listeners,n=t.indexOf(e);if(n===-1)throw console.log(`disposed?`,this._disposed),console.log(`size?`,this._size),console.log(`arr?`,JSON.stringify(this._listeners)),Error(`Attempted to dispose unknown listener`);this._size--,t[n]=void 0;let r=this._deliveryQueue.current===this;if(this._size*2<=t.length){let e=0;for(let n=0;n<t.length;n++)t[n]?t[e++]=t[n]:r&&e<this._deliveryQueue.end&&(this._deliveryQueue.end--,e<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=e}}_deliver(e,t){if(!e)return;let n=this._options?.onListenerError||m;if(!n){e.value(t);return}try{e.value(t)}catch(e){n(e)}}_deliverQueue(e){let t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof cn)this._deliver(this._listeners,e);else{let t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}},un=class{constructor(){this.i=-1,this.end=0}enqueue(e,t,n){this.i=0,this.end=n,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},dn=class extends x{async fireAsync(e,t,n){if(this._listeners)for(this._asyncDeliveryQueue||=new Zt,ln(this._listeners,t=>this._asyncDeliveryQueue.push([t.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){let[e,r]=this._asyncDeliveryQueue.shift(),i=[],a={...r,token:t,waitUntil:t=>{if(Object.isFrozen(i))throw Error(`waitUntil can NOT be called asynchronous`);n&&(t=n(t,e)),i.push(t)}};try{e(a)}catch(e){m(e);continue}await Promise.allSettled(i).then(e=>{for(let t of e)t.status===`rejected`&&m(t.reason)})}}},fn=class extends x{get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._isPaused=0,this._eventQueue=new Zt,this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){let e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused===0?super.fire(e):this._eventQueue.push(e))}},pn=class extends fn{constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||=(this.pause(),setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}},mn=class extends x{constructor(e){super(e),this._queuedEvents=[],this._mergeFn=e?.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(e=>super.fire(e)),this._queuedEvents=[]}))}},hn;(function(e){e[e.Desktop=1]=`Desktop`,e[e.Web=2]=`Web`})(hn||={});var gn;(function(e){e[e.VersionMismatch=55]=`VersionMismatch`,e[e.UnexpectedError=81]=`UnexpectedError`})(gn||={});var _n;(function(e){e[e.Initialized=0]=`Initialized`,e[e.Ready=1]=`Ready`,e[e.Terminate=2]=`Terminate`})(_n||={});function vn(e){let t=b.alloc(1);switch(e){case _n.Initialized:t.writeUInt8(1,0);break;case _n.Ready:t.writeUInt8(2,0);break;case _n.Terminate:t.writeUInt8(3,0);break}return t}function yn(e,t){if(e.byteLength!==1)return!1;switch(e.readUInt8(0)){case 1:return t===_n.Initialized;case 2:return t===_n.Ready;case 3:return t===_n.Terminate;default:return!1}}var bn;(function(e){e.Start=`START_NATIVE_LOG`,e.End=`END_NATIVE_LOG`})(bn||={});function xn(e){let t=[];typeof e==`number`&&t.push(`code/timeOrigin`,e);function n(e,n){t.push(e,n?.startTime??Date.now())}function r(){let e=[];for(let n=0;n<t.length;n+=2)e.push({name:t[n],startTime:t[n+1]});return e}return{mark:n,getMarks:r}}function Sn(){if(typeof performance==`object`&&typeof performance.mark==`function`&&!performance.nodeTiming)return typeof performance.timeOrigin!=`number`&&!performance.timing?xn():{mark(e,t){performance.mark(e,t)},getMarks(){let e=performance.timeOrigin;typeof e!=`number`&&(e=(performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart)??0);let t=[{name:`code/timeOrigin`,startTime:Math.round(e)}];for(let n of performance.getEntriesByType(`mark`))t.push({name:n.name,startTime:Math.round(e+n.startTime)});return t}};if(typeof process==`object`){let e=performance?.timeOrigin;return xn(e)}else return console.trace(`perf-util loaded in UNKNOWN environment`),xn()}function Cn(e){return e.MonacoPerformanceMarks||=Sn(),e.MonacoPerformanceMarks}const wn=Cn(globalThis),Tn=wn.mark,En=wn.getMarks;var S;(function(e){e[e.Null=0]=`Null`,e[e.Backspace=8]=`Backspace`,e[e.Tab=9]=`Tab`,e[e.LineFeed=10]=`LineFeed`,e[e.CarriageReturn=13]=`CarriageReturn`,e[e.Space=32]=`Space`,e[e.ExclamationMark=33]=`ExclamationMark`,e[e.DoubleQuote=34]=`DoubleQuote`,e[e.Hash=35]=`Hash`,e[e.DollarSign=36]=`DollarSign`,e[e.PercentSign=37]=`PercentSign`,e[e.Ampersand=38]=`Ampersand`,e[e.SingleQuote=39]=`SingleQuote`,e[e.OpenParen=40]=`OpenParen`,e[e.CloseParen=41]=`CloseParen`,e[e.Asterisk=42]=`Asterisk`,e[e.Plus=43]=`Plus`,e[e.Comma=44]=`Comma`,e[e.Dash=45]=`Dash`,e[e.Period=46]=`Period`,e[e.Slash=47]=`Slash`,e[e.Digit0=48]=`Digit0`,e[e.Digit1=49]=`Digit1`,e[e.Digit2=50]=`Digit2`,e[e.Digit3=51]=`Digit3`,e[e.Digit4=52]=`Digit4`,e[e.Digit5=53]=`Digit5`,e[e.Digit6=54]=`Digit6`,e[e.Digit7=55]=`Digit7`,e[e.Digit8=56]=`Digit8`,e[e.Digit9=57]=`Digit9`,e[e.Colon=58]=`Colon`,e[e.Semicolon=59]=`Semicolon`,e[e.LessThan=60]=`LessThan`,e[e.Equals=61]=`Equals`,e[e.GreaterThan=62]=`GreaterThan`,e[e.QuestionMark=63]=`QuestionMark`,e[e.AtSign=64]=`AtSign`,e[e.A=65]=`A`,e[e.B=66]=`B`,e[e.C=67]=`C`,e[e.D=68]=`D`,e[e.E=69]=`E`,e[e.F=70]=`F`,e[e.G=71]=`G`,e[e.H=72]=`H`,e[e.I=73]=`I`,e[e.J=74]=`J`,e[e.K=75]=`K`,e[e.L=76]=`L`,e[e.M=77]=`M`,e[e.N=78]=`N`,e[e.O=79]=`O`,e[e.P=80]=`P`,e[e.Q=81]=`Q`,e[e.R=82]=`R`,e[e.S=83]=`S`,e[e.T=84]=`T`,e[e.U=85]=`U`,e[e.V=86]=`V`,e[e.W=87]=`W`,e[e.X=88]=`X`,e[e.Y=89]=`Y`,e[e.Z=90]=`Z`,e[e.OpenSquareBracket=91]=`OpenSquareBracket`,e[e.Backslash=92]=`Backslash`,e[e.CloseSquareBracket=93]=`CloseSquareBracket`,e[e.Caret=94]=`Caret`,e[e.Underline=95]=`Underline`,e[e.BackTick=96]=`BackTick`,e[e.a=97]=`a`,e[e.b=98]=`b`,e[e.c=99]=`c`,e[e.d=100]=`d`,e[e.e=101]=`e`,e[e.f=102]=`f`,e[e.g=103]=`g`,e[e.h=104]=`h`,e[e.i=105]=`i`,e[e.j=106]=`j`,e[e.k=107]=`k`,e[e.l=108]=`l`,e[e.m=109]=`m`,e[e.n=110]=`n`,e[e.o=111]=`o`,e[e.p=112]=`p`,e[e.q=113]=`q`,e[e.r=114]=`r`,e[e.s=115]=`s`,e[e.t=116]=`t`,e[e.u=117]=`u`,e[e.v=118]=`v`,e[e.w=119]=`w`,e[e.x=120]=`x`,e[e.y=121]=`y`,e[e.z=122]=`z`,e[e.OpenCurlyBrace=123]=`OpenCurlyBrace`,e[e.Pipe=124]=`Pipe`,e[e.CloseCurlyBrace=125]=`CloseCurlyBrace`,e[e.Tilde=126]=`Tilde`,e[e.NoBreakSpace=160]=`NoBreakSpace`,e[e.U_Combining_Grave_Accent=768]=`U_Combining_Grave_Accent`,e[e.U_Combining_Acute_Accent=769]=`U_Combining_Acute_Accent`,e[e.U_Combining_Circumflex_Accent=770]=`U_Combining_Circumflex_Accent`,e[e.U_Combining_Tilde=771]=`U_Combining_Tilde`,e[e.U_Combining_Macron=772]=`U_Combining_Macron`,e[e.U_Combining_Overline=773]=`U_Combining_Overline`,e[e.U_Combining_Breve=774]=`U_Combining_Breve`,e[e.U_Combining_Dot_Above=775]=`U_Combining_Dot_Above`,e[e.U_Combining_Diaeresis=776]=`U_Combining_Diaeresis`,e[e.U_Combining_Hook_Above=777]=`U_Combining_Hook_Above`,e[e.U_Combining_Ring_Above=778]=`U_Combining_Ring_Above`,e[e.U_Combining_Double_Acute_Accent=779]=`U_Combining_Double_Acute_Accent`,e[e.U_Combining_Caron=780]=`U_Combining_Caron`,e[e.U_Combining_Vertical_Line_Above=781]=`U_Combining_Vertical_Line_Above`,e[e.U_Combining_Double_Vertical_Line_Above=782]=`U_Combining_Double_Vertical_Line_Above`,e[e.U_Combining_Double_Grave_Accent=783]=`U_Combining_Double_Grave_Accent`,e[e.U_Combining_Candrabindu=784]=`U_Combining_Candrabindu`,e[e.U_Combining_Inverted_Breve=785]=`U_Combining_Inverted_Breve`,e[e.U_Combining_Turned_Comma_Above=786]=`U_Combining_Turned_Comma_Above`,e[e.U_Combining_Comma_Above=787]=`U_Combining_Comma_Above`,e[e.U_Combining_Reversed_Comma_Above=788]=`U_Combining_Reversed_Comma_Above`,e[e.U_Combining_Comma_Above_Right=789]=`U_Combining_Comma_Above_Right`,e[e.U_Combining_Grave_Accent_Below=790]=`U_Combining_Grave_Accent_Below`,e[e.U_Combining_Acute_Accent_Below=791]=`U_Combining_Acute_Accent_Below`,e[e.U_Combining_Left_Tack_Below=792]=`U_Combining_Left_Tack_Below`,e[e.U_Combining_Right_Tack_Below=793]=`U_Combining_Right_Tack_Below`,e[e.U_Combining_Left_Angle_Above=794]=`U_Combining_Left_Angle_Above`,e[e.U_Combining_Horn=795]=`U_Combining_Horn`,e[e.U_Combining_Left_Half_Ring_Below=796]=`U_Combining_Left_Half_Ring_Below`,e[e.U_Combining_Up_Tack_Below=797]=`U_Combining_Up_Tack_Below`,e[e.U_Combining_Down_Tack_Below=798]=`U_Combining_Down_Tack_Below`,e[e.U_Combining_Plus_Sign_Below=799]=`U_Combining_Plus_Sign_Below`,e[e.U_Combining_Minus_Sign_Below=800]=`U_Combining_Minus_Sign_Below`,e[e.U_Combining_Palatalized_Hook_Below=801]=`U_Combining_Palatalized_Hook_Below`,e[e.U_Combining_Retroflex_Hook_Below=802]=`U_Combining_Retroflex_Hook_Below`,e[e.U_Combining_Dot_Below=803]=`U_Combining_Dot_Below`,e[e.U_Combining_Diaeresis_Below=804]=`U_Combining_Diaeresis_Below`,e[e.U_Combining_Ring_Below=805]=`U_Combining_Ring_Below`,e[e.U_Combining_Comma_Below=806]=`U_Combining_Comma_Below`,e[e.U_Combining_Cedilla=807]=`U_Combining_Cedilla`,e[e.U_Combining_Ogonek=808]=`U_Combining_Ogonek`,e[e.U_Combining_Vertical_Line_Below=809]=`U_Combining_Vertical_Line_Below`,e[e.U_Combining_Bridge_Below=810]=`U_Combining_Bridge_Below`,e[e.U_Combining_Inverted_Double_Arch_Below=811]=`U_Combining_Inverted_Double_Arch_Below`,e[e.U_Combining_Caron_Below=812]=`U_Combining_Caron_Below`,e[e.U_Combining_Circumflex_Accent_Below=813]=`U_Combining_Circumflex_Accent_Below`,e[e.U_Combining_Breve_Below=814]=`U_Combining_Breve_Below`,e[e.U_Combining_Inverted_Breve_Below=815]=`U_Combining_Inverted_Breve_Below`,e[e.U_Combining_Tilde_Below=816]=`U_Combining_Tilde_Below`,e[e.U_Combining_Macron_Below=817]=`U_Combining_Macron_Below`,e[e.U_Combining_Low_Line=818]=`U_Combining_Low_Line`,e[e.U_Combining_Double_Low_Line=819]=`U_Combining_Double_Low_Line`,e[e.U_Combining_Tilde_Overlay=820]=`U_Combining_Tilde_Overlay`,e[e.U_Combining_Short_Stroke_Overlay=821]=`U_Combining_Short_Stroke_Overlay`,e[e.U_Combining_Long_Stroke_Overlay=822]=`U_Combining_Long_Stroke_Overlay`,e[e.U_Combining_Short_Solidus_Overlay=823]=`U_Combining_Short_Solidus_Overlay`,e[e.U_Combining_Long_Solidus_Overlay=824]=`U_Combining_Long_Solidus_Overlay`,e[e.U_Combining_Right_Half_Ring_Below=825]=`U_Combining_Right_Half_Ring_Below`,e[e.U_Combining_Inverted_Bridge_Below=826]=`U_Combining_Inverted_Bridge_Below`,e[e.U_Combining_Square_Below=827]=`U_Combining_Square_Below`,e[e.U_Combining_Seagull_Below=828]=`U_Combining_Seagull_Below`,e[e.U_Combining_X_Above=829]=`U_Combining_X_Above`,e[e.U_Combining_Vertical_Tilde=830]=`U_Combining_Vertical_Tilde`,e[e.U_Combining_Double_Overline=831]=`U_Combining_Double_Overline`,e[e.U_Combining_Grave_Tone_Mark=832]=`U_Combining_Grave_Tone_Mark`,e[e.U_Combining_Acute_Tone_Mark=833]=`U_Combining_Acute_Tone_Mark`,e[e.U_Combining_Greek_Perispomeni=834]=`U_Combining_Greek_Perispomeni`,e[e.U_Combining_Greek_Koronis=835]=`U_Combining_Greek_Koronis`,e[e.U_Combining_Greek_Dialytika_Tonos=836]=`U_Combining_Greek_Dialytika_Tonos`,e[e.U_Combining_Greek_Ypogegrammeni=837]=`U_Combining_Greek_Ypogegrammeni`,e[e.U_Combining_Bridge_Above=838]=`U_Combining_Bridge_Above`,e[e.U_Combining_Equals_Sign_Below=839]=`U_Combining_Equals_Sign_Below`,e[e.U_Combining_Double_Vertical_Line_Below=840]=`U_Combining_Double_Vertical_Line_Below`,e[e.U_Combining_Left_Angle_Below=841]=`U_Combining_Left_Angle_Below`,e[e.U_Combining_Not_Tilde_Above=842]=`U_Combining_Not_Tilde_Above`,e[e.U_Combining_Homothetic_Above=843]=`U_Combining_Homothetic_Above`,e[e.U_Combining_Almost_Equal_To_Above=844]=`U_Combining_Almost_Equal_To_Above`,e[e.U_Combining_Left_Right_Arrow_Below=845]=`U_Combining_Left_Right_Arrow_Below`,e[e.U_Combining_Upwards_Arrow_Below=846]=`U_Combining_Upwards_Arrow_Below`,e[e.U_Combining_Grapheme_Joiner=847]=`U_Combining_Grapheme_Joiner`,e[e.U_Combining_Right_Arrowhead_Above=848]=`U_Combining_Right_Arrowhead_Above`,e[e.U_Combining_Left_Half_Ring_Above=849]=`U_Combining_Left_Half_Ring_Above`,e[e.U_Combining_Fermata=850]=`U_Combining_Fermata`,e[e.U_Combining_X_Below=851]=`U_Combining_X_Below`,e[e.U_Combining_Left_Arrowhead_Below=852]=`U_Combining_Left_Arrowhead_Below`,e[e.U_Combining_Right_Arrowhead_Below=853]=`U_Combining_Right_Arrowhead_Below`,e[e.U_Combining_Right_Arrowhead_And_Up_Arrowhead_Below=854]=`U_Combining_Right_Arrowhead_And_Up_Arrowhead_Below`,e[e.U_Combining_Right_Half_Ring_Above=855]=`U_Combining_Right_Half_Ring_Above`,e[e.U_Combining_Dot_Above_Right=856]=`U_Combining_Dot_Above_Right`,e[e.U_Combining_Asterisk_Below=857]=`U_Combining_Asterisk_Below`,e[e.U_Combining_Double_Ring_Below=858]=`U_Combining_Double_Ring_Below`,e[e.U_Combining_Zigzag_Above=859]=`U_Combining_Zigzag_Above`,e[e.U_Combining_Double_Breve_Below=860]=`U_Combining_Double_Breve_Below`,e[e.U_Combining_Double_Breve=861]=`U_Combining_Double_Breve`,e[e.U_Combining_Double_Macron=862]=`U_Combining_Double_Macron`,e[e.U_Combining_Double_Macron_Below=863]=`U_Combining_Double_Macron_Below`,e[e.U_Combining_Double_Tilde=864]=`U_Combining_Double_Tilde`,e[e.U_Combining_Double_Inverted_Breve=865]=`U_Combining_Double_Inverted_Breve`,e[e.U_Combining_Double_Rightwards_Arrow_Below=866]=`U_Combining_Double_Rightwards_Arrow_Below`,e[e.U_Combining_Latin_Small_Letter_A=867]=`U_Combining_Latin_Small_Letter_A`,e[e.U_Combining_Latin_Small_Letter_E=868]=`U_Combining_Latin_Small_Letter_E`,e[e.U_Combining_Latin_Small_Letter_I=869]=`U_Combining_Latin_Small_Letter_I`,e[e.U_Combining_Latin_Small_Letter_O=870]=`U_Combining_Latin_Small_Letter_O`,e[e.U_Combining_Latin_Small_Letter_U=871]=`U_Combining_Latin_Small_Letter_U`,e[e.U_Combining_Latin_Small_Letter_C=872]=`U_Combining_Latin_Small_Letter_C`,e[e.U_Combining_Latin_Small_Letter_D=873]=`U_Combining_Latin_Small_Letter_D`,e[e.U_Combining_Latin_Small_Letter_H=874]=`U_Combining_Latin_Small_Letter_H`,e[e.U_Combining_Latin_Small_Letter_M=875]=`U_Combining_Latin_Small_Letter_M`,e[e.U_Combining_Latin_Small_Letter_R=876]=`U_Combining_Latin_Small_Letter_R`,e[e.U_Combining_Latin_Small_Letter_T=877]=`U_Combining_Latin_Small_Letter_T`,e[e.U_Combining_Latin_Small_Letter_V=878]=`U_Combining_Latin_Small_Letter_V`,e[e.U_Combining_Latin_Small_Letter_X=879]=`U_Combining_Latin_Small_Letter_X`,e[e.LINE_SEPARATOR=8232]=`LINE_SEPARATOR`,e[e.PARAGRAPH_SEPARATOR=8233]=`PARAGRAPH_SEPARATOR`,e[e.NEXT_LINE=133]=`NEXT_LINE`,e[e.U_CIRCUMFLEX=94]=`U_CIRCUMFLEX`,e[e.U_GRAVE_ACCENT=96]=`U_GRAVE_ACCENT`,e[e.U_DIAERESIS=168]=`U_DIAERESIS`,e[e.U_MACRON=175]=`U_MACRON`,e[e.U_ACUTE_ACCENT=180]=`U_ACUTE_ACCENT`,e[e.U_CEDILLA=184]=`U_CEDILLA`,e[e.U_MODIFIER_LETTER_LEFT_ARROWHEAD=706]=`U_MODIFIER_LETTER_LEFT_ARROWHEAD`,e[e.U_MODIFIER_LETTER_RIGHT_ARROWHEAD=707]=`U_MODIFIER_LETTER_RIGHT_ARROWHEAD`,e[e.U_MODIFIER_LETTER_UP_ARROWHEAD=708]=`U_MODIFIER_LETTER_UP_ARROWHEAD`,e[e.U_MODIFIER_LETTER_DOWN_ARROWHEAD=709]=`U_MODIFIER_LETTER_DOWN_ARROWHEAD`,e[e.U_MODIFIER_LETTER_CENTRED_RIGHT_HALF_RING=722]=`U_MODIFIER_LETTER_CENTRED_RIGHT_HALF_RING`,e[e.U_MODIFIER_LETTER_CENTRED_LEFT_HALF_RING=723]=`U_MODIFIER_LETTER_CENTRED_LEFT_HALF_RING`,e[e.U_MODIFIER_LETTER_UP_TACK=724]=`U_MODIFIER_LETTER_UP_TACK`,e[e.U_MODIFIER_LETTER_DOWN_TACK=725]=`U_MODIFIER_LETTER_DOWN_TACK`,e[e.U_MODIFIER_LETTER_PLUS_SIGN=726]=`U_MODIFIER_LETTER_PLUS_SIGN`,e[e.U_MODIFIER_LETTER_MINUS_SIGN=727]=`U_MODIFIER_LETTER_MINUS_SIGN`,e[e.U_BREVE=728]=`U_BREVE`,e[e.U_DOT_ABOVE=729]=`U_DOT_ABOVE`,e[e.U_RING_ABOVE=730]=`U_RING_ABOVE`,e[e.U_OGONEK=731]=`U_OGONEK`,e[e.U_SMALL_TILDE=732]=`U_SMALL_TILDE`,e[e.U_DOUBLE_ACUTE_ACCENT=733]=`U_DOUBLE_ACUTE_ACCENT`,e[e.U_MODIFIER_LETTER_RHOTIC_HOOK=734]=`U_MODIFIER_LETTER_RHOTIC_HOOK`,e[e.U_MODIFIER_LETTER_CROSS_ACCENT=735]=`U_MODIFIER_LETTER_CROSS_ACCENT`,e[e.U_MODIFIER_LETTER_EXTRA_HIGH_TONE_BAR=741]=`U_MODIFIER_LETTER_EXTRA_HIGH_TONE_BAR`,e[e.U_MODIFIER_LETTER_HIGH_TONE_BAR=742]=`U_MODIFIER_LETTER_HIGH_TONE_BAR`,e[e.U_MODIFIER_LETTER_MID_TONE_BAR=743]=`U_MODIFIER_LETTER_MID_TONE_BAR`,e[e.U_MODIFIER_LETTER_LOW_TONE_BAR=744]=`U_MODIFIER_LETTER_LOW_TONE_BAR`,e[e.U_MODIFIER_LETTER_EXTRA_LOW_TONE_BAR=745]=`U_MODIFIER_LETTER_EXTRA_LOW_TONE_BAR`,e[e.U_MODIFIER_LETTER_YIN_DEPARTING_TONE_MARK=746]=`U_MODIFIER_LETTER_YIN_DEPARTING_TONE_MARK`,e[e.U_MODIFIER_LETTER_YANG_DEPARTING_TONE_MARK=747]=`U_MODIFIER_LETTER_YANG_DEPARTING_TONE_MARK`,e[e.U_MODIFIER_LETTER_UNASPIRATED=749]=`U_MODIFIER_LETTER_UNASPIRATED`,e[e.U_MODIFIER_LETTER_LOW_DOWN_ARROWHEAD=751]=`U_MODIFIER_LETTER_LOW_DOWN_ARROWHEAD`,e[e.U_MODIFIER_LETTER_LOW_UP_ARROWHEAD=752]=`U_MODIFIER_LETTER_LOW_UP_ARROWHEAD`,e[e.U_MODIFIER_LETTER_LOW_LEFT_ARROWHEAD=753]=`U_MODIFIER_LETTER_LOW_LEFT_ARROWHEAD`,e[e.U_MODIFIER_LETTER_LOW_RIGHT_ARROWHEAD=754]=`U_MODIFIER_LETTER_LOW_RIGHT_ARROWHEAD`,e[e.U_MODIFIER_LETTER_LOW_RING=755]=`U_MODIFIER_LETTER_LOW_RING`,e[e.U_MODIFIER_LETTER_MIDDLE_GRAVE_ACCENT=756]=`U_MODIFIER_LETTER_MIDDLE_GRAVE_ACCENT`,e[e.U_MODIFIER_LETTER_MIDDLE_DOUBLE_GRAVE_ACCENT=757]=`U_MODIFIER_LETTER_MIDDLE_DOUBLE_GRAVE_ACCENT`,e[e.U_MODIFIER_LETTER_MIDDLE_DOUBLE_ACUTE_ACCENT=758]=`U_MODIFIER_LETTER_MIDDLE_DOUBLE_ACUTE_ACCENT`,e[e.U_MODIFIER_LETTER_LOW_TILDE=759]=`U_MODIFIER_LETTER_LOW_TILDE`,e[e.U_MODIFIER_LETTER_RAISED_COLON=760]=`U_MODIFIER_LETTER_RAISED_COLON`,e[e.U_MODIFIER_LETTER_BEGIN_HIGH_TONE=761]=`U_MODIFIER_LETTER_BEGIN_HIGH_TONE`,e[e.U_MODIFIER_LETTER_END_HIGH_TONE=762]=`U_MODIFIER_LETTER_END_HIGH_TONE`,e[e.U_MODIFIER_LETTER_BEGIN_LOW_TONE=763]=`U_MODIFIER_LETTER_BEGIN_LOW_TONE`,e[e.U_MODIFIER_LETTER_END_LOW_TONE=764]=`U_MODIFIER_LETTER_END_LOW_TONE`,e[e.U_MODIFIER_LETTER_SHELF=765]=`U_MODIFIER_LETTER_SHELF`,e[e.U_MODIFIER_LETTER_OPEN_SHELF=766]=`U_MODIFIER_LETTER_OPEN_SHELF`,e[e.U_MODIFIER_LETTER_LOW_LEFT_ARROW=767]=`U_MODIFIER_LETTER_LOW_LEFT_ARROW`,e[e.U_GREEK_LOWER_NUMERAL_SIGN=885]=`U_GREEK_LOWER_NUMERAL_SIGN`,e[e.U_GREEK_TONOS=900]=`U_GREEK_TONOS`,e[e.U_GREEK_DIALYTIKA_TONOS=901]=`U_GREEK_DIALYTIKA_TONOS`,e[e.U_GREEK_KORONIS=8125]=`U_GREEK_KORONIS`,e[e.U_GREEK_PSILI=8127]=`U_GREEK_PSILI`,e[e.U_GREEK_PERISPOMENI=8128]=`U_GREEK_PERISPOMENI`,e[e.U_GREEK_DIALYTIKA_AND_PERISPOMENI=8129]=`U_GREEK_DIALYTIKA_AND_PERISPOMENI`,e[e.U_GREEK_PSILI_AND_VARIA=8141]=`U_GREEK_PSILI_AND_VARIA`,e[e.U_GREEK_PSILI_AND_OXIA=8142]=`U_GREEK_PSILI_AND_OXIA`,e[e.U_GREEK_PSILI_AND_PERISPOMENI=8143]=`U_GREEK_PSILI_AND_PERISPOMENI`,e[e.U_GREEK_DASIA_AND_VARIA=8157]=`U_GREEK_DASIA_AND_VARIA`,e[e.U_GREEK_DASIA_AND_OXIA=8158]=`U_GREEK_DASIA_AND_OXIA`,e[e.U_GREEK_DASIA_AND_PERISPOMENI=8159]=`U_GREEK_DASIA_AND_PERISPOMENI`,e[e.U_GREEK_DIALYTIKA_AND_VARIA=8173]=`U_GREEK_DIALYTIKA_AND_VARIA`,e[e.U_GREEK_DIALYTIKA_AND_OXIA=8174]=`U_GREEK_DIALYTIKA_AND_OXIA`,e[e.U_GREEK_VARIA=8175]=`U_GREEK_VARIA`,e[e.U_GREEK_OXIA=8189]=`U_GREEK_OXIA`,e[e.U_GREEK_DASIA=8190]=`U_GREEK_DASIA`,e[e.U_IDEOGRAPHIC_FULL_STOP=12290]=`U_IDEOGRAPHIC_FULL_STOP`,e[e.U_LEFT_CORNER_BRACKET=12300]=`U_LEFT_CORNER_BRACKET`,e[e.U_RIGHT_CORNER_BRACKET=12301]=`U_RIGHT_CORNER_BRACKET`,e[e.U_LEFT_BLACK_LENTICULAR_BRACKET=12304]=`U_LEFT_BLACK_LENTICULAR_BRACKET`,e[e.U_RIGHT_BLACK_LENTICULAR_BRACKET=12305]=`U_RIGHT_BLACK_LENTICULAR_BRACKET`,e[e.U_OVERLINE=8254]=`U_OVERLINE`,e[e.UTF8_BOM=65279]=`UTF8_BOM`,e[e.U_FULLWIDTH_SEMICOLON=65307]=`U_FULLWIDTH_SEMICOLON`,e[e.U_FULLWIDTH_COMMA=65292]=`U_FULLWIDTH_COMMA`})(S||={});var Dn;(function(e){e[e.Uri=1]=`Uri`,e[e.Regexp=2]=`Regexp`,e[e.ScmResource=3]=`ScmResource`,e[e.ScmResourceGroup=4]=`ScmResourceGroup`,e[e.ScmProvider=5]=`ScmProvider`,e[e.CommentController=6]=`CommentController`,e[e.CommentThread=7]=`CommentThread`,e[e.CommentThreadInstance=8]=`CommentThreadInstance`,e[e.CommentThreadReply=9]=`CommentThreadReply`,e[e.CommentNode=10]=`CommentNode`,e[e.CommentThreadNode=11]=`CommentThreadNode`,e[e.TimelineActionContext=12]=`TimelineActionContext`,e[e.NotebookCellActionContext=13]=`NotebookCellActionContext`,e[e.NotebookActionContext=14]=`NotebookActionContext`,e[e.TerminalContext=15]=`TerminalContext`,e[e.TestItemContext=16]=`TestItemContext`,e[e.Date=17]=`Date`,e[e.TestMessageMenuArgs=18]=`TestMessageMenuArgs`,e[e.ChatViewContext=19]=`ChatViewContext`,e[e.LanguageModelToolResult=20]=`LanguageModelToolResult`,e[e.LanguageModelTextPart=21]=`LanguageModelTextPart`,e[e.LanguageModelPromptTsxPart=22]=`LanguageModelPromptTsxPart`,e[e.LanguageModelDataPart=23]=`LanguageModelDataPart`,e[e.ChatSessionContext=24]=`ChatSessionContext`,e[e.ChatResponsePullRequestPart=25]=`ChatResponsePullRequestPart`})(Dn||={});function On(){return globalThis._VSCODE_NLS_MESSAGES}function kn(){return globalThis._VSCODE_NLS_LANGUAGE}const An=kn()===`pseudo`||typeof document<`u`&&document.location&&typeof document.location.hash==`string`&&document.location.hash.indexOf(`pseudo=true`)>=0;function jn(e,t){let n;return n=t.length===0?e:e.replace(/\{(\d+)\}/g,(e,n)=>{let r=n[0],i=t[r],a=e;return typeof i==`string`?a=i:(typeof i==`number`||typeof i==`boolean`||i==null)&&(a=String(i)),a}),An&&(n=`［`+n.replace(/[aouei]/g,`$&$&`)+`］`),n}function C(e,t,...n){return jn(typeof e==`number`?Mn(e,t):t,n)}function Mn(e,t){let n=On()?.[e];if(typeof n!=`string`){if(typeof t==`string`)return t;throw Error(`!!! NLS MISSING: ${e} !!!`)}return n}function Nn(e,t,...n){let r;r=typeof e==`number`?Mn(e,t):t;let i=jn(r,n);return{value:i,original:t===r?i:jn(t,n)}}let Pn=!1,Fn=!1,In=!1,Ln=!1,Rn=!1,zn=!1,Bn=!1,Vn=!1,Hn=`en`,Un;const Wn=globalThis;let Gn;Wn.vscode!==void 0&&Wn.vscode.process!==void 0?Gn=Wn.vscode.process:typeof process<`u`&&typeof process?.versions?.node==`string`&&(Gn=process);const Kn=typeof Gn?.versions?.electron==`string`,qn=Kn&&Gn?.type===`renderer`;if(typeof Gn==`object`){Pn=Gn.platform===`win32`,Fn=Gn.platform===`darwin`,In=Gn.platform===`linux`,In&&Gn.env.SNAP&&Gn.env.SNAP_REVISION,Bn=!!Gn.env.CI||!!Gn.env.BUILD_ARTIFACTSTAGINGDIRECTORY||!!Gn.env.GITHUB_WORKSPACE,Hn=`en`;let e=Gn.env.VSCODE_NLS_CONFIG;if(e)try{let t=JSON.parse(e);t.userLocale,t.osLocale,Hn=t.resolvedLanguage||`en`,t.languagePack?.translationsConfigFile}catch{}Ln=!0}else typeof navigator==`object`&&!qn?(Un=navigator.userAgent,Pn=Un.indexOf(`Windows`)>=0,Fn=Un.indexOf(`Macintosh`)>=0,zn=(Un.indexOf(`Macintosh`)>=0||Un.indexOf(`iPad`)>=0||Un.indexOf(`iPhone`)>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,In=Un.indexOf(`Linux`)>=0,Vn=Un?.indexOf(`Mobi`)>=0,Rn=!0,Hn=kn()||`en`,navigator.language.toLowerCase()):console.error(`Unable to resolve platform.`);var Jn;(function(e){e[e.Web=0]=`Web`,e[e.Mac=1]=`Mac`,e[e.Linux=2]=`Linux`,e[e.Windows=3]=`Windows`})(Jn||={});function Yn(e){switch(e){case Jn.Web:return`Web`;case Jn.Mac:return`Mac`;case Jn.Linux:return`Linux`;case Jn.Windows:return`Windows`}}Jn.Web,Fn?Jn.Mac:Pn?Jn.Windows:In&&Jn.Linux;const Xn=Pn,Zn=Fn,Qn=In,$n=Ln,er=Rn,tr=Rn&&typeof Wn.importScripts==`function`,nr=tr?Wn.origin:void 0,rr=zn,ir=Vn,ar=Bn,or=Un,sr=Hn;var cr;(function(e){function t(){return sr}e.value=t;function n(){return sr.length===2?sr===`en`:sr.length>=3?sr[0]===`e`&&sr[1]===`n`&&sr[2]===`-`:!1}e.isDefaultVariant=n;function r(){return sr===`en`}e.isDefault=r})(cr||={});const lr=typeof Wn.postMessage==`function`&&!Wn.importScripts,ur=(()=>{if(lr){let e=[];Wn.addEventListener(`message`,t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,r=e.length;n<r;n++){let r=e[n];if(r.id===t.data.vscodeScheduleAsyncWork){e.splice(n,1),r.callback();return}}});let t=0;return n=>{let r=++t;e.push({id:r,callback:n}),Wn.postMessage({vscodeScheduleAsyncWork:r},`*`)}}return e=>setTimeout(e)})();var dr;(function(e){e[e.Windows=1]=`Windows`,e[e.Macintosh=2]=`Macintosh`,e[e.Linux=3]=`Linux`})(dr||={});const fr=Fn||zn?dr.Macintosh:Pn?dr.Windows:dr.Linux;let pr=!0,mr=!1;function hr(){if(!mr){mr=!0;let e=new Uint8Array(2);e[0]=1,e[1]=2;let t=new Uint16Array(e.buffer);pr=t[0]===513}return pr}const gr=!!(or&&or.indexOf(`Chrome`)>=0),_r=!!(or&&or.indexOf(`Firefox`)>=0),vr=!!(!gr&&or&&or.indexOf(`Safari`)>=0),yr=!!(or&&or.indexOf(`Edg/`)>=0);or&&or.indexOf(`Android`);let br;const xr=globalThis.vscode;if(xr!==void 0&&xr.process!==void 0){let e=xr.process;br={get platform(){return e.platform},get arch(){return e.arch},get env(){return e.env},cwd(){return e.cwd()}}}else br=typeof process<`u`&&typeof process?.versions?.node==`string`?{get platform(){return process.platform},get arch(){return process.arch},get env(){return{}},cwd(){return{}.VSCODE_CWD||process.cwd()}}:{get platform(){return Xn?`win32`:Zn?`darwin`:`linux`},get arch(){},get env(){return{}},cwd(){return`/`}};const Sr=br.cwd,Cr=br.env,wr=br.platform;br.arch;var Tr=class extends Error{constructor(e,t,n){let r;typeof t==`string`&&t.indexOf(`not `)===0?(r=`must not be`,t=t.replace(/^not /,``)):r=`must be`;let i=e.indexOf(`.`)===-1?`argument`:`property`,a=`The "${e}" ${i} ${r} of type ${t}`;a+=`. Received type ${typeof n}`,super(a),this.code=`ERR_INVALID_ARG_TYPE`}};function Er(e,t){if(typeof e!=`object`||!e)throw new Tr(t,`Object`,e)}function Dr(e,t){if(typeof e!=`string`)throw new Tr(t,`string`,e)}const Or=wr===`win32`;function kr(e){return e===47||e===92}function Ar(e){return e===47}function jr(e){return e>=65&&e<=90||e>=97&&e<=122}function Mr(e,t,n,r){let i=``,a=0,o=-1,s=0,c=0;for(let l=0;l<=e.length;++l){if(l<e.length)c=e.charCodeAt(l);else if(r(c))break;else c=47;if(r(c)){if(!(o===l-1||s===1))if(s===2){if(i.length<2||a!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){let e=i.lastIndexOf(n);e===-1?(i=``,a=0):(i=i.slice(0,e),a=i.length-1-i.lastIndexOf(n)),o=l,s=0;continue}else if(i.length!==0){i=``,a=0,o=l,s=0;continue}}t&&(i+=i.length>0?`${n}..`:`..`,a=2)}else i.length>0?i+=`${n}${e.slice(o+1,l)}`:i=e.slice(o+1,l),a=l-o-1;o=l,s=0}else c===46&&s!==-1?++s:s=-1}return i}function Nr(e){return e?`${e[0]===`.`?``:`.`}${e}`:``}function Pr(e,t){Er(t,`pathObject`);let n=t.dir||t.root,r=t.base||`${t.name||``}${Nr(t.ext)}`;return n?n===t.root?`${n}${r}`:`${n}${e}${r}`:r}const Fr={resolve(...e){let t=``,n=``,r=!1;for(let i=e.length-1;i>=-1;i--){let a;if(i>=0){if(a=e[i],Dr(a,`paths[${i}]`),a.length===0)continue}else t.length===0?a=Sr():(a=Cr[`=${t}`]||Sr(),(a===void 0||a.slice(0,2).toLowerCase()!==t.toLowerCase()&&a.charCodeAt(2)===92)&&(a=`${t}\\`));let o=a.length,s=0,c=``,l=!1,u=a.charCodeAt(0);if(o===1)kr(u)&&(s=1,l=!0);else if(kr(u))if(l=!0,kr(a.charCodeAt(1))){let e=2,t=e;for(;e<o&&!kr(a.charCodeAt(e));)e++;if(e<o&&e!==t){let n=a.slice(t,e);for(t=e;e<o&&kr(a.charCodeAt(e));)e++;if(e<o&&e!==t){for(t=e;e<o&&!kr(a.charCodeAt(e));)e++;(e===o||e!==t)&&(c=`\\\\${n}\\${a.slice(t,e)}`,s=e)}}}else s=1;else jr(u)&&a.charCodeAt(1)===58&&(c=a.slice(0,2),s=2,o>2&&kr(a.charCodeAt(2))&&(l=!0,s=3));if(c.length>0)if(t.length>0){if(c.toLowerCase()!==t.toLowerCase())continue}else t=c;if(r){if(t.length>0)break}else if(n=`${a.slice(s)}\\${n}`,r=l,l&&t.length>0)break}return n=Mr(n,!r,`\\`,kr),r?`${t}\\${n}`:`${t}${n}`||`.`},normalize(e){Dr(e,`path`);let t=e.length;if(t===0)return`.`;let n=0,r,i=!1,a=e.charCodeAt(0);if(t===1)return Ar(a)?`\\`:e;if(kr(a))if(i=!0,kr(e.charCodeAt(1))){let i=2,a=i;for(;i<t&&!kr(e.charCodeAt(i));)i++;if(i<t&&i!==a){let o=e.slice(a,i);for(a=i;i<t&&kr(e.charCodeAt(i));)i++;if(i<t&&i!==a){for(a=i;i<t&&!kr(e.charCodeAt(i));)i++;if(i===t)return`\\\\${o}\\${e.slice(a)}\\`;i!==a&&(r=`\\\\${o}\\${e.slice(a,i)}`,n=i)}}}else n=1;else jr(a)&&e.charCodeAt(1)===58&&(r=e.slice(0,2),n=2,t>2&&kr(e.charCodeAt(2))&&(i=!0,n=3));let o=n<t?Mr(e.slice(n),!i,`\\`,kr):``;if(o.length===0&&!i&&(o=`.`),o.length>0&&kr(e.charCodeAt(t-1))&&(o+=`\\`),!i&&r===void 0&&e.includes(`:`)){if(o.length>=2&&jr(o.charCodeAt(0))&&o.charCodeAt(1)===58)return`.\\${o}`;let n=e.indexOf(`:`);do if(n===t-1||kr(e.charCodeAt(n+1)))return`.\\${o}`;while((n=e.indexOf(`:`,n+1))!==-1)}return r===void 0?i?`\\${o}`:o:i?`${r}\\${o}`:`${r}${o}`},isAbsolute(e){Dr(e,`path`);let t=e.length;if(t===0)return!1;let n=e.charCodeAt(0);return kr(n)||t>2&&jr(n)&&e.charCodeAt(1)===58&&kr(e.charCodeAt(2))},join(...e){if(e.length===0)return`.`;let t,n;for(let r=0;r<e.length;++r){let i=e[r];Dr(i,`path`),i.length>0&&(t===void 0?t=n=i:t+=`\\${i}`)}if(t===void 0)return`.`;let r=!0,i=0;if(typeof n==`string`&&kr(n.charCodeAt(0))){++i;let e=n.length;e>1&&kr(n.charCodeAt(1))&&(++i,e>2&&(kr(n.charCodeAt(2))?++i:r=!1))}if(r){for(;i<t.length&&kr(t.charCodeAt(i));)i++;i>=2&&(t=`\\${t.slice(i)}`)}return Fr.normalize(t)},relative(e,t){if(Dr(e,`from`),Dr(t,`to`),e===t)return``;let n=Fr.resolve(e),r=Fr.resolve(t);if(n===r||(e=n.toLowerCase(),t=r.toLowerCase(),e===t))return``;if(n.length!==e.length||r.length!==t.length){let e=n.split(`\\`),t=r.split(`\\`);e[e.length-1]===``&&e.pop(),t[t.length-1]===``&&t.pop();let i=e.length,a=t.length,o=i<a?i:a,s;for(s=0;s<o&&e[s].toLowerCase()===t[s].toLowerCase();s++);return s===0?r:s===o?a>o?t.slice(s).join(`\\`):i>o?`..\\`.repeat(i-1-s)+`..`:``:`..\\`.repeat(i-s)+t.slice(s).join(`\\`)}let i=0;for(;i<e.length&&e.charCodeAt(i)===92;)i++;let a=e.length;for(;a-1>i&&e.charCodeAt(a-1)===92;)a--;let o=a-i,s=0;for(;s<t.length&&t.charCodeAt(s)===92;)s++;let c=t.length;for(;c-1>s&&t.charCodeAt(c-1)===92;)c--;let l=c-s,u=o<l?o:l,d=-1,f=0;for(;f<u;f++){let n=e.charCodeAt(i+f);if(n!==t.charCodeAt(s+f))break;n===92&&(d=f)}if(f!==u){if(d===-1)return r}else{if(l>u){if(t.charCodeAt(s+f)===92)return r.slice(s+f+1);if(f===2)return r.slice(s+f)}o>u&&(e.charCodeAt(i+f)===92?d=f:f===2&&(d=3)),d===-1&&(d=0)}let p=``;for(f=i+d+1;f<=a;++f)(f===a||e.charCodeAt(f)===92)&&(p+=p.length===0?`..`:`\\..`);return s+=d,p.length>0?`${p}${r.slice(s,c)}`:(r.charCodeAt(s)===92&&++s,r.slice(s,c))},toNamespacedPath(e){if(typeof e!=`string`||e.length===0)return e;let t=Fr.resolve(e);if(t.length<=2)return e;if(t.charCodeAt(0)===92){if(t.charCodeAt(1)===92){let e=t.charCodeAt(2);if(e!==63&&e!==46)return`\\\\?\\UNC\\${t.slice(2)}`}}else if(jr(t.charCodeAt(0))&&t.charCodeAt(1)===58&&t.charCodeAt(2)===92)return`\\\\?\\${t}`;return t},dirname(e){Dr(e,`path`);let t=e.length;if(t===0)return`.`;let n=-1,r=0,i=e.charCodeAt(0);if(t===1)return kr(i)?e:`.`;if(kr(i)){if(n=r=1,kr(e.charCodeAt(1))){let i=2,a=i;for(;i<t&&!kr(e.charCodeAt(i));)i++;if(i<t&&i!==a){for(a=i;i<t&&kr(e.charCodeAt(i));)i++;if(i<t&&i!==a){for(a=i;i<t&&!kr(e.charCodeAt(i));)i++;if(i===t)return e;i!==a&&(n=r=i+1)}}}}else jr(i)&&e.charCodeAt(1)===58&&(n=t>2&&kr(e.charCodeAt(2))?3:2,r=n);let a=-1,o=!0;for(let n=t-1;n>=r;--n)if(kr(e.charCodeAt(n))){if(!o){a=n;break}}else o=!1;if(a===-1){if(n===-1)return`.`;a=n}return e.slice(0,a)},basename(e,t){t!==void 0&&Dr(t,`suffix`),Dr(e,`path`);let n=0,r=-1,i=!0,a;if(e.length>=2&&jr(e.charCodeAt(0))&&e.charCodeAt(1)===58&&(n=2),t!==void 0&&t.length>0&&t.length<=e.length){if(t===e)return``;let o=t.length-1,s=-1;for(a=e.length-1;a>=n;--a){let c=e.charCodeAt(a);if(kr(c)){if(!i){n=a+1;break}}else s===-1&&(i=!1,s=a+1),o>=0&&(c===t.charCodeAt(o)?--o===-1&&(r=a):(o=-1,r=s))}return n===r?r=s:r===-1&&(r=e.length),e.slice(n,r)}for(a=e.length-1;a>=n;--a)if(kr(e.charCodeAt(a))){if(!i){n=a+1;break}}else r===-1&&(i=!1,r=a+1);return r===-1?``:e.slice(n,r)},extname(e){Dr(e,`path`);let t=0,n=-1,r=0,i=-1,a=!0,o=0;e.length>=2&&e.charCodeAt(1)===58&&jr(e.charCodeAt(0))&&(t=r=2);for(let s=e.length-1;s>=t;--s){let t=e.charCodeAt(s);if(kr(t)){if(!a){r=s+1;break}continue}i===-1&&(a=!1,i=s+1),t===46?n===-1?n=s:o!==1&&(o=1):n!==-1&&(o=-1)}return n===-1||i===-1||o===0||o===1&&n===i-1&&n===r+1?``:e.slice(n,i)},format:Pr.bind(null,`\\`),parse(e){Dr(e,`path`);let t={root:``,dir:``,base:``,ext:``,name:``};if(e.length===0)return t;let n=e.length,r=0,i=e.charCodeAt(0);if(n===1)return kr(i)?(t.root=t.dir=e,t):(t.base=t.name=e,t);if(kr(i)){if(r=1,kr(e.charCodeAt(1))){let t=2,i=t;for(;t<n&&!kr(e.charCodeAt(t));)t++;if(t<n&&t!==i){for(i=t;t<n&&kr(e.charCodeAt(t));)t++;if(t<n&&t!==i){for(i=t;t<n&&!kr(e.charCodeAt(t));)t++;t===n?r=t:t!==i&&(r=t+1)}}}}else if(jr(i)&&e.charCodeAt(1)===58){if(n<=2)return t.root=t.dir=e,t;if(r=2,kr(e.charCodeAt(2))){if(n===3)return t.root=t.dir=e,t;r=3}}r>0&&(t.root=e.slice(0,r));let a=-1,o=r,s=-1,c=!0,l=e.length-1,u=0;for(;l>=r;--l){if(i=e.charCodeAt(l),kr(i)){if(!c){o=l+1;break}continue}s===-1&&(c=!1,s=l+1),i===46?a===-1?a=l:u!==1&&(u=1):a!==-1&&(u=-1)}return s!==-1&&(a===-1||u===0||u===1&&a===s-1&&a===o+1?t.base=t.name=e.slice(o,s):(t.name=e.slice(o,a),t.base=e.slice(o,s),t.ext=e.slice(a,s))),o>0&&o!==r?t.dir=e.slice(0,o-1):t.dir=t.root,t},sep:`\\`,delimiter:`;`,win32:null,posix:null},Ir=(()=>{if(Or){let e=/\\/g;return()=>{let t=Sr().replace(e,`/`);return t.slice(t.indexOf(`/`))}}return()=>Sr()})(),Lr={resolve(...e){let t=``,n=!1;for(let r=e.length-1;r>=0&&!n;r--){let i=e[r];Dr(i,`paths[${r}]`),i.length!==0&&(t=`${i}/${t}`,n=i.charCodeAt(0)===47)}if(!n){let e=Ir();t=`${e}/${t}`,n=e.charCodeAt(0)===47}return t=Mr(t,!n,`/`,Ar),n?`/${t}`:t.length>0?t:`.`},normalize(e){if(Dr(e,`path`),e.length===0)return`.`;let t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=Mr(e,!t,`/`,Ar),e.length===0?t?`/`:n?`./`:`.`:(n&&(e+=`/`),t?`/${e}`:e)},isAbsolute(e){return Dr(e,`path`),e.length>0&&e.charCodeAt(0)===47},join(...e){if(e.length===0)return`.`;let t=[];for(let n=0;n<e.length;++n){let r=e[n];Dr(r,`path`),r.length>0&&t.push(r)}return t.length===0?`.`:Lr.normalize(t.join(`/`))},relative(e,t){if(Dr(e,`from`),Dr(t,`to`),e===t||(e=Lr.resolve(e),t=Lr.resolve(t),e===t))return``;let n=e.length,r=n-1,i=t.length-1,a=r<i?r:i,o=-1,s=0;for(;s<a;s++){let n=e.charCodeAt(1+s);if(n!==t.charCodeAt(1+s))break;n===47&&(o=s)}if(s===a)if(i>a){if(t.charCodeAt(1+s)===47)return t.slice(1+s+1);if(s===0)return t.slice(1+s)}else r>a&&(e.charCodeAt(1+s)===47?o=s:s===0&&(o=0));let c=``;for(s=1+o+1;s<=n;++s)(s===n||e.charCodeAt(s)===47)&&(c+=c.length===0?`..`:`/..`);return`${c}${t.slice(1+o)}`},toNamespacedPath(e){return e},dirname(e){if(Dr(e,`path`),e.length===0)return`.`;let t=e.charCodeAt(0)===47,n=-1,r=!0;for(let t=e.length-1;t>=1;--t)if(e.charCodeAt(t)===47){if(!r){n=t;break}}else r=!1;return n===-1?t?`/`:`.`:t&&n===1?`//`:e.slice(0,n)},basename(e,t){t!==void 0&&Dr(t,`suffix`),Dr(e,`path`);let n=0,r=-1,i=!0,a;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t===e)return``;let o=t.length-1,s=-1;for(a=e.length-1;a>=0;--a){let c=e.charCodeAt(a);if(c===47){if(!i){n=a+1;break}}else s===-1&&(i=!1,s=a+1),o>=0&&(c===t.charCodeAt(o)?--o===-1&&(r=a):(o=-1,r=s))}return n===r?r=s:r===-1&&(r=e.length),e.slice(n,r)}for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!i){n=a+1;break}}else r===-1&&(i=!1,r=a+1);return r===-1?``:e.slice(n,r)},extname(e){Dr(e,`path`);let t=-1,n=0,r=-1,i=!0,a=0;for(let o=e.length-1;o>=0;--o){let s=e[o];if(s===`/`){if(!i){n=o+1;break}continue}r===-1&&(i=!1,r=o+1),s===`.`?t===-1?t=o:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||r===-1||a===0||a===1&&t===r-1&&t===n+1?``:e.slice(t,r)},format:Pr.bind(null,`/`),parse(e){Dr(e,`path`);let t={root:``,dir:``,base:``,ext:``,name:``};if(e.length===0)return t;let n=e.charCodeAt(0)===47,r;n?(t.root=`/`,r=1):r=0;let i=-1,a=0,o=-1,s=!0,c=e.length-1,l=0;for(;c>=r;--c){let t=e.charCodeAt(c);if(t===47){if(!s){a=c+1;break}continue}o===-1&&(s=!1,o=c+1),t===46?i===-1?i=c:l!==1&&(l=1):i!==-1&&(l=-1)}if(o!==-1){let r=a===0&&n?1:a;i===-1||l===0||l===1&&i===o-1&&i===a+1?t.base=t.name=e.slice(r,o):(t.name=e.slice(r,i),t.base=e.slice(r,o),t.ext=e.slice(i,o))}return a>0?t.dir=e.slice(0,a-1):n&&(t.dir=`/`),t},sep:`/`,delimiter:`:`,win32:null,posix:null};Lr.win32=Fr.win32=Fr,Lr.posix=Fr.posix=Lr;const Rr=Or?Fr.normalize:Lr.normalize,zr=Or?Fr.isAbsolute:Lr.isAbsolute,Br=Or?Fr.join:Lr.join,Vr=Or?Fr.resolve:Lr.resolve,Hr=Or?Fr.relative:Lr.relative,Ur=Or?Fr.dirname:Lr.dirname,Wr=Or?Fr.basename:Lr.basename,Gr=Or?Fr.extname:Lr.extname;Or?Fr.parse:Lr.parse;const Kr=Or?Fr.sep:Lr.sep,qr=/^\w[\w\d+.-]*$/,Jr=/^\//,Yr=/^\/\//;function Xr(e,t){if(!e.scheme&&t)throw Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${e.authority}", path: "${e.path}", query: "${e.query}", fragment: "${e.fragment}"}`);if(e.scheme&&!qr.test(e.scheme))throw Error(`[UriError]: Scheme contains illegal characters.`);if(e.path){if(e.authority){if(!Jr.test(e.path))throw Error(`[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character`)}else if(Yr.test(e.path))throw Error(`[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")`)}}function Zr(e,t){return!e&&!t?`file`:e}function Qr(e,t){switch(e){case`https`:case`http`:case`file`:t?t[0]!==$r&&(t=$r+t):t=$r;break}return t}const $r=`/`,ei=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;var w=class e{static isUri(t){return t instanceof e?!0:!t||typeof t!=`object`?!1:typeof t.authority==`string`&&typeof t.fragment==`string`&&typeof t.path==`string`&&typeof t.query==`string`&&typeof t.scheme==`string`&&typeof t.fsPath==`string`&&typeof t.with==`function`&&typeof t.toString==`function`}constructor(e,t,n,r,i,a=!1){typeof e==`object`?(this.scheme=e.scheme||``,this.authority=e.authority||``,this.path=e.path||``,this.query=e.query||``,this.fragment=e.fragment||``):(this.scheme=Zr(e,a),this.authority=t||``,this.path=Qr(this.scheme,n||``),this.query=r||``,this.fragment=i||``,Xr(this,a))}get fsPath(){return si(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:n,path:r,query:i,fragment:a}=e;return t===void 0?t=this.scheme:t===null&&(t=``),n===void 0?n=this.authority:n===null&&(n=``),r===void 0?r=this.path:r===null&&(r=``),i===void 0?i=this.query:i===null&&(i=``),a===void 0?a=this.fragment:a===null&&(a=``),t===this.scheme&&n===this.authority&&r===this.path&&i===this.query&&a===this.fragment?this:new ri(t,n,r,i,a)}static parse(e,t=!1){let n=ei.exec(e);return n?new ri(n[2]||``,di(n[4]||``),di(n[5]||``),di(n[7]||``),di(n[9]||``),t):new ri(``,``,``,``,``)}static file(e){let t=``;if(Xn&&(e=e.replace(/\\/g,`/`)),e[0]===`/`&&e[1]===`/`){let n=e.indexOf(`/`,2);n===-1?(t=e.substring(2),e=`/`):(t=e.substring(2,n),e=e.substring(n)||`/`)}return new ri(`file`,t,e,``,``)}static from(e,t){let n=new ri(e.scheme,e.authority,e.path,e.query,e.fragment,t);return n}static joinPath(t,...n){if(!t.path)throw Error(`[UriError]: cannot call joinPath on URI without path`);let r;return r=Xn&&t.scheme===`file`?e.file(Fr.join(si(t,!0),...n)).path:Lr.join(t.path,...n),t.with({path:r})}toString(e=!1){return ci(this,e)}toJSON(){return this}static revive(t){if(t){if(t instanceof e)return t;{let e=new ri(t);return e._formatted=t.external??null,e._fsPath=t._sep===ni?t.fsPath??null:null,e}}else return t}[Symbol.for(`debug.description`)](){return`URI(${this.toString()})`}};function ti(e){return!e||typeof e!=`object`?!1:typeof e.scheme==`string`&&(typeof e.authority==`string`||e.authority===void 0)&&(typeof e.path==`string`||e.path===void 0)&&(typeof e.query==`string`||e.query===void 0)&&(typeof e.fragment==`string`||e.fragment===void 0)}const ni=Xn?1:void 0;var ri=class extends w{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||=si(this,!1),this._fsPath}toString(e=!1){return e?ci(this,!0):(this._formatted||=ci(this,!1),this._formatted)}toJSON(){let e={$mid:Dn.Uri};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=ni),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}};const ii={[S.Colon]:`%3A`,[S.Slash]:`%2F`,[S.QuestionMark]:`%3F`,[S.Hash]:`%23`,[S.OpenSquareBracket]:`%5B`,[S.CloseSquareBracket]:`%5D`,[S.AtSign]:`%40`,[S.ExclamationMark]:`%21`,[S.DollarSign]:`%24`,[S.Ampersand]:`%26`,[S.SingleQuote]:`%27`,[S.OpenParen]:`%28`,[S.CloseParen]:`%29`,[S.Asterisk]:`%2A`,[S.Plus]:`%2B`,[S.Comma]:`%2C`,[S.Semicolon]:`%3B`,[S.Equals]:`%3D`,[S.Space]:`%20`};function ai(e,t,n){let r,i=-1;for(let a=0;a<e.length;a++){let o=e.charCodeAt(a);if(o>=S.a&&o<=S.z||o>=S.A&&o<=S.Z||o>=S.Digit0&&o<=S.Digit9||o===S.Dash||o===S.Period||o===S.Underline||o===S.Tilde||t&&o===S.Slash||n&&o===S.OpenSquareBracket||n&&o===S.CloseSquareBracket||n&&o===S.Colon)i!==-1&&(r+=encodeURIComponent(e.substring(i,a)),i=-1),r!==void 0&&(r+=e.charAt(a));else{r===void 0&&(r=e.substr(0,a));let t=ii[o];t===void 0?i===-1&&(i=a):(i!==-1&&(r+=encodeURIComponent(e.substring(i,a)),i=-1),r+=t)}}return i!==-1&&(r+=encodeURIComponent(e.substring(i))),r===void 0?e:r}function oi(e){let t;for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);r===S.Hash||r===S.QuestionMark?(t===void 0&&(t=e.substr(0,n)),t+=ii[r]):t!==void 0&&(t+=e[n])}return t===void 0?e:t}function si(e,t){let n;return n=e.authority&&e.path.length>1&&e.scheme===`file`?`//${e.authority}${e.path}`:e.path.charCodeAt(0)===S.Slash&&(e.path.charCodeAt(1)>=S.A&&e.path.charCodeAt(1)<=S.Z||e.path.charCodeAt(1)>=S.a&&e.path.charCodeAt(1)<=S.z)&&e.path.charCodeAt(2)===S.Colon?t?e.path.substr(1):e.path[1].toLowerCase()+e.path.substr(2):e.path,Xn&&(n=n.replace(/\//g,`\\`)),n}function ci(e,t){let n=t?oi:ai,r=``,{scheme:i,authority:a,path:o,query:s,fragment:c}=e;if(i&&(r+=i,r+=`:`),(a||i===`file`)&&(r+=`/`,r+=`/`),a){let e=a.indexOf(`@`);if(e!==-1){let t=a.substr(0,e);a=a.substr(e+1),e=t.lastIndexOf(`:`),e===-1?r+=n(t,!1,!1):(r+=n(t.substr(0,e),!1,!1),r+=`:`,r+=n(t.substr(e+1),!1,!0)),r+=`@`}a=a.toLowerCase(),e=a.lastIndexOf(`:`),e===-1?r+=n(a,!1,!0):(r+=n(a.substr(0,e),!1,!0),r+=a.substr(e))}if(o){if(o.length>=3&&o.charCodeAt(0)===S.Slash&&o.charCodeAt(2)===S.Colon){let e=o.charCodeAt(1);e>=S.A&&e<=S.Z&&(o=`/${String.fromCharCode(e+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===S.Colon){let e=o.charCodeAt(0);e>=S.A&&e<=S.Z&&(o=`${String.fromCharCode(e+32)}:${o.substr(2)}`)}r+=n(o,!0,!1)}return s&&(r+=`?`,r+=n(s,!1,!1)),c&&(r+=`#`,r+=t?c:ai(c,!1,!1)),r}function li(e){try{return decodeURIComponent(e)}catch{return e.length>3?e.substr(0,3)+li(e.substr(3)):e}}const ui=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function di(e){return e.match(ui)?e.replace(ui,e=>li(e)):e}var fi=class e{static{this.count=0}constructor(t){this._proxyIdentifierBrand=void 0,this.sid=t,this.nid=++e.count}};const pi=[];function T(e){let t=new fi(e);return pi[t.nid]=t,t}function mi(e){return pi[e].sid}var hi=class{constructor(e){this.value=e}},gi;(function(e){e[e.Default=0]=`Default`,e[e.InCenter=1]=`InCenter`,e[e.InCenterIfOutsideViewport=2]=`InCenterIfOutsideViewport`,e[e.AtTop=3]=`AtTop`})(gi||={});var _i;(function(e){e[e.UnknownInput=0]=`UnknownInput`,e[e.TextInput=1]=`TextInput`,e[e.TextDiffInput=2]=`TextDiffInput`,e[e.TextMergeInput=3]=`TextMergeInput`,e[e.NotebookInput=4]=`NotebookInput`,e[e.NotebookDiffInput=5]=`NotebookDiffInput`,e[e.CustomEditorInput=6]=`CustomEditorInput`,e[e.WebviewEditorInput=7]=`WebviewEditorInput`,e[e.TerminalEditorInput=8]=`TerminalEditorInput`,e[e.InteractiveEditorInput=9]=`InteractiveEditorInput`,e[e.ChatEditorInput=10]=`ChatEditorInput`,e[e.MultiDiffEditorInput=11]=`MultiDiffEditorInput`})(_i||={});var vi;(function(e){e[e.TAB_OPEN=0]=`TAB_OPEN`,e[e.TAB_CLOSE=1]=`TAB_CLOSE`,e[e.TAB_UPDATE=2]=`TAB_UPDATE`,e[e.TAB_MOVE=3]=`TAB_MOVE`})(vi||={});var yi;(function(e){e[e.Editable=0]=`Editable`,e[e.SupportsHotExit=1]=`SupportsHotExit`})(yi||={});var bi;(function(e){e[e.Int8Array=1]=`Int8Array`,e[e.Uint8Array=2]=`Uint8Array`,e[e.Uint8ClampedArray=3]=`Uint8ClampedArray`,e[e.Int16Array=4]=`Int16Array`,e[e.Uint16Array=5]=`Uint16Array`,e[e.Int32Array=6]=`Int32Array`,e[e.Uint32Array=7]=`Uint32Array`,e[e.Float32Array=8]=`Float32Array`,e[e.Float64Array=9]=`Float64Array`,e[e.BigInt64Array=10]=`BigInt64Array`,e[e.BigUint64Array=11]=`BigUint64Array`})(bi||={});var xi;(function(e){e[e.Text=1]=`Text`,e[e.Error=2]=`Error`,e[e.Rich=3]=`Rich`})(xi||={});var Si;(function(e){e[e.Default=0]=`Default`,e[e.InCenter=1]=`InCenter`,e[e.InCenterIfOutsideViewport=2]=`InCenterIfOutsideViewport`,e[e.AtTop=3]=`AtTop`})(Si||={});var Ci;(function(e){e[e.None=0]=`None`,e[e.Process=1]=`Process`,e[e.Output=2]=`Output`,e[e.Hybrid=3]=`Hybrid`})(Ci||={});var wi;(function(e){e.label=`a`,e.kind=`b`,e.detail=`c`,e.documentation=`d`,e.sortText=`e`,e.filterText=`f`,e.preselect=`g`,e.insertText=`h`,e.insertTextRules=`i`,e.range=`j`,e.commitCharacters=`k`,e.additionalTextEdits=`l`,e.kindModifier=`m`,e.commandIdent=`n`,e.commandId=`o`,e.commandArguments=`p`})(wi||={});var Ti;(function(e){e.defaultRanges=`a`,e.completions=`b`,e.isIncomplete=`c`,e.duration=`d`})(Ti||={});var Ei;(function(e){e[e.Workspace=0]=`Workspace`,e[e.TextDocument=1]=`TextDocument`})(Ei||={});const E={MainThreadAuthentication:T(`MainThreadAuthentication`),MainThreadBulkEdits:T(`MainThreadBulkEdits`),MainThreadLanguageModels:T(`MainThreadLanguageModels`),MainThreadEmbeddings:T(`MainThreadEmbeddings`),MainThreadChatAgents2:T(`MainThreadChatAgents2`),MainThreadCodeMapper:T(`MainThreadCodeMapper`),MainThreadLanguageModelTools:T(`MainThreadChatSkills`),MainThreadClipboard:T(`MainThreadClipboard`),MainThreadCommands:T(`MainThreadCommands`),MainThreadComments:T(`MainThreadComments`),MainThreadConfiguration:T(`MainThreadConfiguration`),MainThreadConsole:T(`MainThreadConsole`),MainThreadDebugService:T(`MainThreadDebugService`),MainThreadDecorations:T(`MainThreadDecorations`),MainThreadDiagnostics:T(`MainThreadDiagnostics`),MainThreadDialogs:T(`MainThreadDiaglogs`),MainThreadDocuments:T(`MainThreadDocuments`),MainThreadDocumentContentProviders:T(`MainThreadDocumentContentProviders`),MainThreadTextEditors:T(`MainThreadTextEditors`),MainThreadEditorInsets:T(`MainThreadEditorInsets`),MainThreadEditorTabs:T(`MainThreadEditorTabs`),MainThreadErrors:T(`MainThreadErrors`),MainThreadTreeViews:T(`MainThreadTreeViews`),MainThreadDownloadService:T(`MainThreadDownloadService`),MainThreadLanguageFeatures:T(`MainThreadLanguageFeatures`),MainThreadLanguages:T(`MainThreadLanguages`),MainThreadLogger:T(`MainThreadLogger`),MainThreadMessageService:T(`MainThreadMessageService`),MainThreadOutputService:T(`MainThreadOutputService`),MainThreadProgress:T(`MainThreadProgress`),MainThreadQuickDiff:T(`MainThreadQuickDiff`),MainThreadQuickOpen:T(`MainThreadQuickOpen`),MainThreadStatusBar:T(`MainThreadStatusBar`),MainThreadSecretState:T(`MainThreadSecretState`),MainThreadStorage:T(`MainThreadStorage`),MainThreadSpeech:T(`MainThreadSpeechProvider`),MainThreadTelemetry:T(`MainThreadTelemetry`),MainThreadTerminalService:T(`MainThreadTerminalService`),MainThreadTerminalShellIntegration:T(`MainThreadTerminalShellIntegration`),MainThreadWebviews:T(`MainThreadWebviews`),MainThreadWebviewPanels:T(`MainThreadWebviewPanels`),MainThreadWebviewViews:T(`MainThreadWebviewViews`),MainThreadCustomEditors:T(`MainThreadCustomEditors`),MainThreadUrls:T(`MainThreadUrls`),MainThreadUriOpeners:T(`MainThreadUriOpeners`),MainThreadProfileContentHandlers:T(`MainThreadProfileContentHandlers`),MainThreadWorkspace:T(`MainThreadWorkspace`),MainThreadFileSystem:T(`MainThreadFileSystem`),MainThreadFileSystemEventService:T(`MainThreadFileSystemEventService`),MainThreadExtensionService:T(`MainThreadExtensionService`),MainThreadSCM:T(`MainThreadSCM`),MainThreadSearch:T(`MainThreadSearch`),MainThreadShare:T(`MainThreadShare`),MainThreadTask:T(`MainThreadTask`),MainThreadWindow:T(`MainThreadWindow`),MainThreadLabelService:T(`MainThreadLabelService`),MainThreadNotebook:T(`MainThreadNotebook`),MainThreadNotebookDocuments:T(`MainThreadNotebookDocumentsShape`),MainThreadNotebookEditors:T(`MainThreadNotebookEditorsShape`),MainThreadNotebookKernels:T(`MainThreadNotebookKernels`),MainThreadNotebookRenderers:T(`MainThreadNotebookRenderers`),MainThreadInteractive:T(`MainThreadInteractive`),MainThreadTheming:T(`MainThreadTheming`),MainThreadTunnelService:T(`MainThreadTunnelService`),MainThreadManagedSockets:T(`MainThreadManagedSockets`),MainThreadTimeline:T(`MainThreadTimeline`),MainThreadTesting:T(`MainThreadTesting`),MainThreadLocalization:T(`MainThreadLocalizationShape`),MainThreadMcp:T(`MainThreadMcpShape`),MainThreadAiRelatedInformation:T(`MainThreadAiRelatedInformation`),MainThreadAiEmbeddingVector:T(`MainThreadAiEmbeddingVector`),MainThreadChatStatus:T(`MainThreadChatStatus`),MainThreadAiSettingsSearch:T(`MainThreadAiSettingsSearch`),MainThreadDataChannels:T(`MainThreadDataChannels`),MainThreadChatSessions:T(`MainThreadChatSessions`),MainThreadChatOutputRenderer:T(`MainThreadChatOutputRenderer`)},D={ExtHostCodeMapper:T(`ExtHostCodeMapper`),ExtHostCommands:T(`ExtHostCommands`),ExtHostConfiguration:T(`ExtHostConfiguration`),ExtHostDiagnostics:T(`ExtHostDiagnostics`),ExtHostDebugService:T(`ExtHostDebugService`),ExtHostDecorations:T(`ExtHostDecorations`),ExtHostDocumentsAndEditors:T(`ExtHostDocumentsAndEditors`),ExtHostDocuments:T(`ExtHostDocuments`),ExtHostDocumentContentProviders:T(`ExtHostDocumentContentProviders`),ExtHostDocumentSaveParticipant:T(`ExtHostDocumentSaveParticipant`),ExtHostEditors:T(`ExtHostEditors`),ExtHostTreeViews:T(`ExtHostTreeViews`),ExtHostFileSystem:T(`ExtHostFileSystem`),ExtHostFileSystemInfo:T(`ExtHostFileSystemInfo`),ExtHostFileSystemEventService:T(`ExtHostFileSystemEventService`),ExtHostLanguages:T(`ExtHostLanguages`),ExtHostLanguageFeatures:T(`ExtHostLanguageFeatures`),ExtHostQuickOpen:T(`ExtHostQuickOpen`),ExtHostQuickDiff:T(`ExtHostQuickDiff`),ExtHostStatusBar:T(`ExtHostStatusBar`),ExtHostShare:T(`ExtHostShare`),ExtHostExtensionService:T(`ExtHostExtensionService`),ExtHostLogLevelServiceShape:T(`ExtHostLogLevelServiceShape`),ExtHostTerminalService:T(`ExtHostTerminalService`),ExtHostTerminalShellIntegration:T(`ExtHostTerminalShellIntegration`),ExtHostSCM:T(`ExtHostSCM`),ExtHostSearch:T(`ExtHostSearch`),ExtHostTask:T(`ExtHostTask`),ExtHostWorkspace:T(`ExtHostWorkspace`),ExtHostWindow:T(`ExtHostWindow`),ExtHostWebviews:T(`ExtHostWebviews`),ExtHostWebviewPanels:T(`ExtHostWebviewPanels`),ExtHostCustomEditors:T(`ExtHostCustomEditors`),ExtHostWebviewViews:T(`ExtHostWebviewViews`),ExtHostEditorInsets:T(`ExtHostEditorInsets`),ExtHostEditorTabs:T(`ExtHostEditorTabs`),ExtHostProgress:T(`ExtHostProgress`),ExtHostComments:T(`ExtHostComments`),ExtHostSecretState:T(`ExtHostSecretState`),ExtHostStorage:T(`ExtHostStorage`),ExtHostUrls:T(`ExtHostUrls`),ExtHostUriOpeners:T(`ExtHostUriOpeners`),ExtHostChatOutputRenderer:T(`ExtHostChatOutputRenderer`),ExtHostProfileContentHandlers:T(`ExtHostProfileContentHandlers`),ExtHostOutputService:T(`ExtHostOutputService`),ExtHostLabelService:T(`ExtHostLabelService`),ExtHostNotebook:T(`ExtHostNotebook`),ExtHostNotebookDocuments:T(`ExtHostNotebookDocuments`),ExtHostNotebookEditors:T(`ExtHostNotebookEditors`),ExtHostNotebookKernels:T(`ExtHostNotebookKernels`),ExtHostNotebookRenderers:T(`ExtHostNotebookRenderers`),ExtHostNotebookDocumentSaveParticipant:T(`ExtHostNotebookDocumentSaveParticipant`),ExtHostInteractive:T(`ExtHostInteractive`),ExtHostChatAgents2:T(`ExtHostChatAgents`),ExtHostLanguageModelTools:T(`ExtHostChatSkills`),ExtHostChatProvider:T(`ExtHostChatProvider`),ExtHostSpeech:T(`ExtHostSpeech`),ExtHostEmbeddings:T(`ExtHostEmbeddings`),ExtHostAiRelatedInformation:T(`ExtHostAiRelatedInformation`),ExtHostAiEmbeddingVector:T(`ExtHostAiEmbeddingVector`),ExtHostAiSettingsSearch:T(`ExtHostAiSettingsSearch`),ExtHostTheming:T(`ExtHostTheming`),ExtHostTunnelService:T(`ExtHostTunnelService`),ExtHostManagedSockets:T(`ExtHostManagedSockets`),ExtHostAuthentication:T(`ExtHostAuthentication`),ExtHostTimeline:T(`ExtHostTimeline`),ExtHostTesting:T(`ExtHostTesting`),ExtHostTelemetry:T(`ExtHostTelemetry`),ExtHostLocalization:T(`ExtHostLocalization`),ExtHostMcp:T(`ExtHostMcp`),ExtHostDataChannels:T(`ExtHostDataChannels`),ExtHostChatSessions:T(`ExtHostChatSessions`)},Di=Object.freeze(function(e,t){let n=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(n)}}});var Oi;(function(e){function t(t){return t===e.None||t===e.Cancelled||t instanceof ki?!0:!t||typeof t!=`object`?!1:typeof t.isCancellationRequested==`boolean`&&typeof t.onCancellationRequested==`function`}e.isCancellationToken=t,e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:en.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Di})})(Oi||={});var ki=class{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Di:(this._emitter||=new x,this._emitter.event)}dispose(){this._emitter&&=(this._emitter.dispose(),null)}},Ai=class{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||=new ki,this._token}cancel(){this._token?this._token instanceof ki&&this._token.cancel():this._token=Oi.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof ki&&this._token.dispose():this._token=Oi.None}};function ji(e){return e}var Mi=class{constructor(e,t){this.lastCache=void 0,this.lastArgKey=void 0,typeof e==`function`?(this._fn=e,this._computeKey=ji):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}},Ni;(function(e){e[e.MAX_SAFE_SMALL_INTEGER=1073741824]=`MAX_SAFE_SMALL_INTEGER`,e[e.MIN_SAFE_SMALL_INTEGER=-1073741824]=`MIN_SAFE_SMALL_INTEGER`,e[e.MAX_UINT_8=255]=`MAX_UINT_8`,e[e.MAX_UINT_16=65535]=`MAX_UINT_16`,e[e.MAX_UINT_32=4294967295]=`MAX_UINT_32`,e[e.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]=`UNICODE_SUPPLEMENTARY_PLANE_BEGIN`})(Ni||={});function Pi(e){return e<0?0:e>Ni.MAX_UINT_8?Ni.MAX_UINT_8:e|0}function Fi(e){return e<0?0:e>Ni.MAX_UINT_32?Ni.MAX_UINT_32:e|0}function Ii(e){return!e||typeof e!=`string`?!0:e.trim().length===0}const Li=/{([^}]+)}/g;function Ri(e,t){return Object.keys(t).length===0?e:e.replace(Li,(e,n)=>t[n]??e)}function zi(e){return e.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,`\\$&`)}function Bi(e,t){let n=0,r=e.indexOf(t);for(;r!==-1;)n++,r=e.indexOf(t,r+t.length);return n}function Vi(e,t){if(!e||!t)return e;let n=t.length;if(n===0||e.length===0)return e;let r=0;for(;e.indexOf(t,r)===r;)r+=n;return e.substring(r)}function Hi(e,t){if(!e||!t)return e;let n=t.length,r=e.length;if(n===0||r===0)return e;let i=r,a=-1;for(;a=e.lastIndexOf(t,i-1),!(a===-1||a+n!==i);){if(a===0)return``;i=a}return e.substring(0,i)}function Ui(e,t,n={}){if(!e)throw Error(`Cannot create regex from empty string`);t||(e=zi(e)),n.wholeWord&&(/\B/.test(e.charAt(0))||(e=`\\b`+e),/\B/.test(e.charAt(e.length-1))||(e+=`\\b`));let r=``;return n.global&&(r+=`g`),n.matchCase||(r+=`i`),n.multiline&&(r+=`m`),n.unicode&&(r+=`u`),new RegExp(e,r)}function Wi(e){if(e.source===`^`||e.source===`^$`||e.source===`$`||e.source===`^\\s*$`)return!1;let t=e.exec(``);return!!(t&&e.lastIndex===0)}function Gi(e){return e.split(/\r\n|\r|\n/)}function Ki(e){for(let t=0,n=e.length;t<n;t++){let n=e.charCodeAt(t);if(n!==S.Space&&n!==S.Tab)return t}return-1}function qi(e,t=e.length-1){for(let n=t;n>=0;n--){let t=e.charCodeAt(n);if(t!==S.Space&&t!==S.Tab)return n}return-1}function Ji(e,t){return e<t?-1:e>t?1:0}function Yi(e,t,n=0,r=e.length,i=0,a=t.length){for(;n<r&&i<a;n++,i++){let r=e.charCodeAt(n),a=t.charCodeAt(i);if(r<a)return-1;if(r>a)return 1}let o=r-n,s=a-i;return o<s?-1:o>s?1:0}function Xi(e,t){return Zi(e,t,0,e.length,0,t.length)}function Zi(e,t,n=0,r=e.length,i=0,a=t.length){for(;n<r&&i<a;n++,i++){let o=e.charCodeAt(n),s=t.charCodeAt(i);if(o===s)continue;if(o>=128||s>=128)return Yi(e.toLowerCase(),t.toLowerCase(),n,r,i,a);Qi(o)&&(o-=32),Qi(s)&&(s-=32);let c=o-s;if(c!==0)return c}let o=r-n,s=a-i;return o<s?-1:o>s?1:0}function Qi(e){return e>=S.a&&e<=S.z}function $i(e,t){return e.length===t.length&&Zi(e,t)===0}function ea(e,t){let n=t.length;return t.length>e.length?!1:Zi(e,t,0,n)===0}function ta(e,t){let n=Math.min(e.length,t.length),r;for(r=0;r<n;r++)if(e.charCodeAt(r)!==t.charCodeAt(r))return r;return n}function na(e){return 55296<=e&&e<=56319}function ra(e){return 56320<=e&&e<=57343}function ia(e,t){return(e-55296<<10)+(t-56320)+65536}function aa(e,t,n){let r=e.charCodeAt(n);if(na(r)&&n+1<t){let t=e.charCodeAt(n+1);if(ra(t))return ia(r,t)}return r}function oa(e,t){let n=e.charCodeAt(t-1);if(ra(n)&&t>1){let r=e.charCodeAt(t-2);if(na(r))return ia(r,n)}return n}var sa=class{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){let e=oa(this._str,this._offset);return this._offset-=e>=Ni.UNICODE_SUPPLEMENTARY_PLANE_BEGIN?2:1,e}nextCodePoint(){let e=aa(this._str,this._len,this._offset);return this._offset+=e>=Ni.UNICODE_SUPPLEMENTARY_PLANE_BEGIN?2:1,e}eol(){return this._offset>=this._len}},ca=class{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new sa(e,t)}nextGraphemeLength(){let e=Ea.getInstance(),t=this._iterator,n=t.offset,r=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){let n=t.offset,i=e.getGraphemeBreakType(t.nextCodePoint());if(wa(r,i)){t.setOffset(n);break}r=i}return t.offset-n}prevGraphemeLength(){let e=Ea.getInstance(),t=this._iterator,n=t.offset,r=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){let n=t.offset,i=e.getGraphemeBreakType(t.prevCodePoint());if(wa(i,r)){t.setOffset(n);break}r=i}return n-t.offset}eol(){return this._iterator.eol()}};function la(e,t){let n=new ca(e,t);return n.nextGraphemeLength()}let ua;function da(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function fa(e){return ua||=da(),ua.test(e)}const pa=/^[\t\n\r\x20-\x7E]*$/;function ma(e){return pa.test(e)}const ha=/[\u2028\u2029]/;function ga(e){return ha.test(e)}const _a=/(?:\x1b\[|\x9b)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/,va=/(?:\x1b\]|\x9d).*?(?:\x1b\\|\x07|\x9c)/,ya=/\x1b(?:[ #%\(\)\*\+\-\.\/]?[a-zA-Z0-9\|}~@])/;RegExp(`(?:`+[_a.source,va.source,ya.source].join(`|`)+`)`,`g`);const ba=String.fromCharCode(S.UTF8_BOM);function xa(e){return!!(e&&e.length>0&&e.charCodeAt(0)===S.UTF8_BOM)}function Sa(e,t=!1){return e?(t&&(e=e.replace(/\\./g,``)),e.toLowerCase()!==e):!1}function Ca(e,t=1){if(t===0)return``;let n=-1;do n=e.indexOf(`
`,n+1),t--;while(t>0&&n>=0);return n===-1?e:(e[n-1]===`\r`&&n--,e.substr(0,n))}function wa(e,t){return e===Ta.Other?t!==Ta.Extend&&t!==Ta.SpacingMark:e===Ta.CR&&t===Ta.LF?!1:e===Ta.Control||e===Ta.CR||e===Ta.LF||t===Ta.Control||t===Ta.CR||t===Ta.LF?!0:!(e===Ta.L&&(t===Ta.L||t===Ta.V||t===Ta.LV||t===Ta.LVT)||(e===Ta.LV||e===Ta.V)&&(t===Ta.V||t===Ta.T)||(e===Ta.LVT||e===Ta.T)&&t===Ta.T||t===Ta.Extend||t===Ta.ZWJ||t===Ta.SpacingMark||e===Ta.Prepend||e===Ta.ZWJ&&t===Ta.Extended_Pictographic||e===Ta.Regional_Indicator&&t===Ta.Regional_Indicator)}var Ta;(function(e){e[e.Other=0]=`Other`,e[e.Prepend=1]=`Prepend`,e[e.CR=2]=`CR`,e[e.LF=3]=`LF`,e[e.Control=4]=`Control`,e[e.Extend=5]=`Extend`,e[e.Regional_Indicator=6]=`Regional_Indicator`,e[e.SpacingMark=7]=`SpacingMark`,e[e.L=8]=`L`,e[e.V=9]=`V`,e[e.T=10]=`T`,e[e.LV=11]=`LV`,e[e.LVT=12]=`LVT`,e[e.ZWJ=13]=`ZWJ`,e[e.Extended_Pictographic=14]=`Extended_Pictographic`})(Ta||={});var Ea=class e{static{this._INSTANCE=null}static getInstance(){return e._INSTANCE||=new e,e._INSTANCE}constructor(){this._data=Da()}getGraphemeBreakType(e){if(e<32)return e===S.LineFeed?Ta.LF:e===S.CarriageReturn?Ta.CR:Ta.Control;if(e<127)return Ta.Other;let t=this._data,n=t.length/3,r=1;for(;r<=n;)if(e<t[3*r])r=2*r;else if(e>t[3*r+1])r=2*r+1;else return t[3*r+2];return Ta.Other}};function Da(){return JSON.parse(`[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]`)}var Oa;(function(e){e[e.zwj=8205]=`zwj`,e[e.emojiVariantSelector=65039]=`emojiVariantSelector`,e[e.enclosingKeyCap=8419]=`enclosingKeyCap`,e[e.space=32]=`space`})(Oa||={}),class e{static{this.ambiguousCharacterData=new u(()=>JSON.parse(`{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,1523,96,8242,96,1370,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,118002,50,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,118003,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,118004,52,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,118005,53,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,118006,54,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,118007,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,118008,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,118009,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,117974,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,117975,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71913,67,71922,67,65315,67,8557,67,8450,67,8493,67,117976,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,117977,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,117978,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,117979,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,117980,71,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,117981,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,117983,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,117984,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,118001,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,117982,108,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,117985,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,117986,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,117987,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,118000,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,117988,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,117989,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,117990,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,117991,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,117992,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,117993,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,117994,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,117995,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71910,87,71919,87,117996,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,117997,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,117998,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,71909,90,66293,90,65338,90,8484,90,8488,90,117999,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65283,35,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"cs":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"es":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"fr":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"it":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ja":[8211,45,8218,44,65281,33,8216,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65292,44,65297,49,65307,59],"ko":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pt-BR":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ru":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"zh-hans":[160,32,65374,126,8218,44,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65297,49],"zh-hant":[8211,45,65374,126,8218,44,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89]}`))}static{this.cache=new Mi({getCacheKey:JSON.stringify},t=>{function n(e){let t=new Map;for(let n=0;n<e.length;n+=2)t.set(e[n],e[n+1]);return t}function r(e,t){let n=new Map(e);for(let[e,r]of t)n.set(e,r);return n}function i(e,t){if(!e)return t;let n=new Map;for(let[r,i]of e)t.has(r)&&n.set(r,i);return n}let a=this.ambiguousCharacterData.value,o=t.filter(e=>!e.startsWith(`_`)&&e in a);o.length===0&&(o=[`_default`]);let s;for(let e of o){let t=n(a[e]);s=i(s,t)}let c=n(a._common),l=r(c,s);return new e(l)})}static getInstance(t){return e.cache.get(Array.from(t))}static{this._locales=new u(()=>Object.keys(e.ambiguousCharacterData.value).filter(e=>!e.startsWith(`_`)))}static getLocales(){return e._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){let n=e.codePointAt(t);if(typeof n==`number`&&this.isAmbiguous(n))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}},class e{static getRawData(){return JSON.parse(`{"_common":[11,12,13,127,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999],"cs":[173,8203,12288],"de":[173,8203,12288],"es":[8203,12288],"fr":[173,8203,12288],"it":[160,173,12288],"ja":[173],"ko":[173,12288],"pl":[173,8203,12288],"pt-BR":[173,8203,12288],"qps-ploc":[160,173,8203,12288],"ru":[173,12288],"tr":[160,173,8203,12288],"zh-hans":[160,173,8203,12288],"zh-hant":[173,12288]}`)}static{this._data=void 0}static getData(){return this._data||=new Set([...Object.values(e.getRawData())].flat()),this._data}static isInvisibleCharacter(t){return e.getData().has(t)}static containsInvisibleCharacter(t){for(let n=0;n<t.length;n++){let r=t.codePointAt(n);if(typeof r==`number`&&(e.isInvisibleCharacter(r)||r===Oa.space))return!0}return!1}static get codePoints(){return e.getData()}};function ka(e){return e===S.Slash||e===S.Backslash}function Aa(e){return e.replace(/[\\/]/g,Lr.sep)}function ja(e){return e.indexOf(`/`)===-1&&(e=Aa(e)),/^[a-zA-Z]:(\/|$)/.test(e)&&(e=`/`+e),e}function Ma(e,t=Lr.sep){if(!e)return``;let n=e.length,r=e.charCodeAt(0);if(ka(r)){if(ka(e.charCodeAt(1))&&!ka(e.charCodeAt(2))){let r=3,i=r;for(;r<n&&!ka(e.charCodeAt(r));r++);if(i!==r&&!ka(e.charCodeAt(r+1))){for(r+=1;r<n;r++)if(ka(e.charCodeAt(r)))return e.slice(0,r+1).replace(/[\\/]/g,t)}}return t}else if(Pa(r)&&e.charCodeAt(1)===S.Colon)return ka(e.charCodeAt(2))?e.slice(0,2)+t:e.slice(0,2);let i=e.indexOf(`://`);if(i!==-1){for(i+=3;i<n;i++)if(ka(e.charCodeAt(i)))return e.slice(0,i+1)}return``}function Na(e,t,n,r=Kr){if(e===t)return!0;if(!e||!t||t.length>e.length)return!1;if(n){let n=ea(e,t);if(!n)return!1;if(t.length===e.length)return!0;let i=t.length;return t.charAt(t.length-1)===r&&i--,e.charAt(i)===r}return t.charAt(t.length-1)!==r&&(t+=r),e.indexOf(t)===0}function Pa(e){return e>=S.A&&e<=S.Z||e>=S.a&&e<=S.z}function Fa(e,t=Xn){return t?Pa(e.charCodeAt(0))&&e.charCodeAt(1)===S.Colon:!1}var O;(function(e){e.inMemory=`inmemory`,e.vscode=`vscode`,e.internal=`private`,e.walkThrough=`walkThrough`,e.walkThroughSnippet=`walkThroughSnippet`,e.http=`http`,e.https=`https`,e.file=`file`,e.mailto=`mailto`,e.untitled=`untitled`,e.data=`data`,e.command=`command`,e.vscodeRemote=`vscode-remote`,e.vscodeRemoteResource=`vscode-remote-resource`,e.vscodeManagedRemoteResource=`vscode-managed-remote-resource`,e.vscodeUserData=`vscode-userdata`,e.vscodeCustomEditor=`vscode-custom-editor`,e.vscodeNotebookCell=`vscode-notebook-cell`,e.vscodeNotebookCellMetadata=`vscode-notebook-cell-metadata`,e.vscodeNotebookCellMetadataDiff=`vscode-notebook-cell-metadata-diff`,e.vscodeNotebookCellOutput=`vscode-notebook-cell-output`,e.vscodeNotebookCellOutputDiff=`vscode-notebook-cell-output-diff`,e.vscodeNotebookMetadata=`vscode-notebook-metadata`,e.vscodeInteractiveInput=`vscode-interactive-input`,e.vscodeSettings=`vscode-settings`,e.vscodeWorkspaceTrust=`vscode-workspace-trust`,e.vscodeTerminal=`vscode-terminal`,e.vscodeChatCodeBlock=`vscode-chat-code-block`,e.vscodeChatCodeCompareBlock=`vscode-chat-code-compare-block`,e.vscodeChatEditor=`vscode-chat-editor`,e.vscodeChatInput=`chatSessionInput`,e.vscodeChatSession=`vscode-chat-session`,e.webviewPanel=`webview-panel`,e.vscodeWebview=`vscode-webview`,e.extension=`extension`,e.vscodeFileResource=`vscode-file`,e.tmp=`tmp`,e.vsls=`vsls`,e.vscodeSourceControl=`vscode-scm`,e.commentsInput=`comment`,e.codeSetting=`code-setting`,e.outputChannel=`output`,e.accessibleView=`accessible-view`})(O||={});function Ia(e,t){return w.isUri(e)?$i(e.scheme,t):ea(e,t+`:`)}function La(e,...t){return t.some(t=>Ia(e,t))}var Ra=class{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema=`http`,this._delegate=null,this._serverRootPath=`/`}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=Lr.join(t??`/`,Ba(e))}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return Lr.join(this._serverRootPath,O.vscodeRemoteResource)}set(e,t,n){this._hosts[e]=t,this._ports[e]=n}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(t){return m(t),e}let t=e.authority,n=this._hosts[t];n&&n.indexOf(`:`)!==-1&&n.indexOf(`[`)===-1&&(n=`[${n}]`);let r=this._ports[t],i=this._connectionTokens[t],a=`path=${encodeURIComponent(e.path)}`;return typeof i==`string`&&(a+=`&tkn=${encodeURIComponent(i)}`),w.from({scheme:er?this._preferredWebSchema:O.vscodeRemoteResource,authority:`${n}:${r}`,path:this._remoteResourcesPath,query:a})}};const za=new Ra;function Ba(e){return`${e.quality??`oss`}-${e.commit??`dev`}`}var Va=class e{constructor(){this.staticBrowserUris=new ze,this.appResourcePathUrls=new Map}static{this.FALLBACK_AUTHORITY=`vscode-app`}registerAppResourcePathUrl(e,t){this.appResourcePathUrls.set(e,t)}toUrl(e){let t=this.appResourcePathUrls.get(e);return typeof t==`function`&&(t=t()),new URL(t??e,globalThis.location?.href??import.meta.url).toString()}asBrowserUri(e){let t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(t){return t.scheme===O.vscodeRemote?za.rewrite(t):t.scheme===O.file&&($n||nr===`${O.vscodeFileResource}://${e.FALLBACK_AUTHORITY}`)?t.with({scheme:O.vscodeFileResource,authority:t.authority||e.FALLBACK_AUTHORITY,query:null,fragment:null}):this.staticBrowserUris.get(t)??t}asFileUri(e){let t=this.toUri(e);return this.uriToFileUri(t)}uriToFileUri(t){return t.scheme===O.vscodeFileResource?t.with({scheme:O.file,authority:t.authority===e.FALLBACK_AUTHORITY?null:t.authority,query:null,fragment:null}):t}toUri(e){if(w.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){let t=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(t))return w.joinPath(w.parse(t,!0),e);let n=Br(t,e);return w.file(n)}return w.parse(this.toUrl(e))}registerStaticBrowserUri(e,t){return this.staticBrowserUris.set(e,t),_(()=>{this.staticBrowserUris.get(e)===t&&this.staticBrowserUris.delete(e)})}getRegisteredBrowserUris(){return this.staticBrowserUris.keys()}};new Va;var Ha;(function(e){let t=new Map([[`1`,{"Cross-Origin-Opener-Policy":`same-origin`}],[`2`,{"Cross-Origin-Embedder-Policy":`require-corp`}],[`3`,{"Cross-Origin-Opener-Policy":`same-origin`,"Cross-Origin-Embedder-Policy":`require-corp`}]]);e.CoopAndCoep=Object.freeze(t.get(`3`));let n=`vscode-coi`;function r(e){let r;typeof e==`string`?r=new URL(e).searchParams:e instanceof URL?r=e.searchParams:w.isUri(e)&&(r=new URL(e.toString(!0)).searchParams);let i=r?.get(n);if(i)return t.get(i)}e.getHeadersFromQuery=r;function i(e,t,r){if(!globalThis.crossOriginIsolated)return;let i=t&&r?`3`:r?`2`:`1`;e instanceof URLSearchParams?e.set(n,i):e[n]=i}e.addSearchParam=i})(Ha||={});function Ua(e){return si(e,!0)}var Wa=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:Ji(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1){if(e.scheme===t.scheme){if(e.scheme===O.file)return Na(Ua(e),Ua(t),this._ignorePathCasing(e))&&e.query===t.query&&(n||e.fragment===t.fragment);if(no(e.authority,t.authority))return Na(e.path,t.path,this._ignorePathCasing(e),`/`)&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return w.joinPath(e,...t)}basenameOrAuthority(e){return Xa(e)||e.authority}basename(e){return Lr.basename(e.path)}extname(e){return Lr.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===O.file?t=w.file(Ur(Ua(e))).path:(t=Lr.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==S.Slash&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t=`/`)),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return t=e.scheme===O.file?w.file(Rr(Ua(e))).path:Lr.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!no(e.authority,t.authority))return;if(e.scheme===O.file){let n=Hr(Ua(e),Ua(t));return Xn?Aa(n):n}let n=e.path||`/`,r=t.path||`/`;if(this._ignorePathCasing(e)){let e=0;for(let t=Math.min(n.length,r.length);e<t&&!(n.charCodeAt(e)!==r.charCodeAt(e)&&n.charAt(e).toLowerCase()!==r.charAt(e).toLowerCase());e++);n=r.substr(0,e)+n.substr(e)}return Lr.relative(n,r)}resolvePath(e,t){if(e.scheme===O.file){let n=w.file(Vr(Ua(e),t));return e.with({authority:n.authority,path:n.path})}return t=ja(t),e.with({path:Lr.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]===`/`}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&$i(e,t)}hasTrailingPathSeparator(e,t=Kr){if(e.scheme===O.file){let n=Ua(e);return n.length>Ma(n).length&&n[n.length-1]===t}else{let t=e.path;return t.length>1&&t.charCodeAt(t.length-1)===S.Slash&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Kr){return ro(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Kr){let n=!1;if(e.scheme===O.file){let r=Ua(e);n=r!==void 0&&r.length===Ma(r).length&&r[r.length-1]===t}else{t=`/`;let r=e.path;n=r.length===1&&r.charCodeAt(r.length-1)===S.Slash}return!n&&!ro(e,t)?e.with({path:e.path+`/`}):e}};const Ga=new Wa(()=>!1),Ka=new Wa(e=>e.scheme===O.file?!Qn:!0),qa=new Wa(e=>!0),Ja=Ga.isEqual.bind(Ga);Ga.isEqualOrParent.bind(Ga),Ga.getComparisonKey.bind(Ga);const Ya=Ga.basenameOrAuthority.bind(Ga),Xa=Ga.basename.bind(Ga),Za=Ga.extname.bind(Ga),Qa=Ga.dirname.bind(Ga),$a=Ga.joinPath.bind(Ga);Ga.normalizePath.bind(Ga);const eo=Ga.relativePath.bind(Ga);Ga.resolvePath.bind(Ga);const to=Ga.isAbsolutePath.bind(Ga),no=Ga.isEqualAuthority.bind(Ga),ro=Ga.hasTrailingPathSeparator.bind(Ga);Ga.removeTrailingPathSeparator.bind(Ga),Ga.addTrailingPathSeparator.bind(Ga);var io;(function(e){e.META_DATA_LABEL=`label`,e.META_DATA_DESCRIPTION=`description`,e.META_DATA_SIZE=`size`,e.META_DATA_MIME=`mime`;function t(t){let n=new Map,r=t.path.substring(t.path.indexOf(`;`)+1,t.path.lastIndexOf(`;`));r.split(`;`).forEach(e=>{let[t,r]=e.split(`:`);t&&r&&n.set(t,r)});let i=t.path.substring(0,t.path.indexOf(`;`));return i&&n.set(e.META_DATA_MIME,i),n}e.parseMetaData=t})(io||={});const ao=Symbol(`MicrotaskDelay`);function oo(e){return!!e&&typeof e.then==`function`}function so(e){let t=new Ai,n=e(t.token),r=!1,i=new Promise((e,i)=>{let a=t.token.onCancellationRequested(()=>{r=!0,a.dispose(),i(new oe)});Promise.resolve(n).then(n=>{a.dispose(),t.dispose(),r?vt(n)&&n.dispose():e(n)},e=>{a.dispose(),t.dispose(),i(e)})});return new class{cancel(){t.cancel(),t.dispose()}then(e,t){return i.then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return i.finally(e)}}}function co(e,t,n){return new Promise((r,i)=>{let a=t.onCancellationRequested(()=>{a.dispose(),r(n)});e.then(r,i).finally(()=>a.dispose())})}function lo(e,t){return new Promise((n,r)=>{let i=t.onCancellationRequested(()=>{i.dispose(),r(new oe)});e.then(n,r).finally(()=>i.dispose())})}function uo(e){return new Promise((t,n)=>{let r=e();oo(r)?r.then(t,n):t(r)})}function fo(){let e,t,n=new Promise((n,r)=>{e=n,t=r});return{promise:n,resolve:e,reject:t}}var po=class{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(Error(`Throttler is disposed`));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){let e=()=>{if(this.queuedPromise=null,this.isDisposed)return;let e=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,e};this.queuedPromise=new Promise(t=>{this.activePromise.then(e,e).then(t)})}return new Promise((e,t)=>{this.queuedPromise.then(e,t)})}return this.activePromise=e(),new Promise((e,t)=>{this.activePromise.then(t=>{this.activePromise=null,e(t)},e=>{this.activePromise=null,t(e)})})}dispose(){this.isDisposed=!0}},mo=class{constructor(){this.current=Promise.resolve(null)}queue(e){return this.current=this.current.then(()=>e(),()=>e())}},ho=class{constructor(){this.promiseMap=new Map}queue(e,t){let n=this.promiseMap.get(e)??Promise.resolve(),r=n.catch(()=>{}).then(t).finally(()=>{this.promiseMap.get(e)===r&&this.promiseMap.delete(e)});return this.promiseMap.set(e,r),r}keys(){return this.promiseMap.keys()}};const go=(e,t)=>{let n=!0,r=setTimeout(()=>{n=!1,t()},e);return{isTriggered:()=>n,dispose:()=>{clearTimeout(r),n=!1}}},_o=e=>{let t=!0;return queueMicrotask(()=>{t&&(t=!1,e())}),{isTriggered:()=>t,dispose:()=>{t=!1}}};var vo=class{constructor(e){this.defaultDelay=e,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||=new Promise((e,t)=>{this.doResolve=e,this.doReject=t}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let e=this.task;return this.task=null,e()}});let n=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=t===ao?_o(n):go(t,n),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&=(this.doReject?.(new oe),null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},yo=class{constructor(e){this.delayer=new vo(e),this.throttler=new po}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}},bo=class{constructor(){this._isOpen=!1,this._promise=new Promise((e,t)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}};function xo(e,t){return t?new Promise((n,r)=>{let i=setTimeout(()=>{a.dispose(),n()},e),a=t.onCancellationRequested(()=>{clearTimeout(i),a.dispose(),r(new oe)})}):so(t=>xo(e,t))}function So(e,t=0,n){let r=setTimeout(()=>{e(),n&&i.dispose()},t),i=_(()=>{clearTimeout(r),n?.delete(i)});return n?.add(i),i}var Co=class{constructor(e){this._size=0,this._isDisposed=!1,this.maxDegreeOfParalellism=e,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new x}whenIdle(){return this.size>0?en.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed)throw Error(`Object has been disposed`);return this._size++,new Promise((t,n)=>{this.outstandingPromises.push({factory:e,c:t,e:n}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){let e=this.outstandingPromises.shift();this.runningPromises++;let t=e.factory();t.then(e.c,e.e),t.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw Error(`Object has been disposed`);this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}},wo=class extends Co{constructor(){super(1)}},To=class{constructor(){this.queues=new Map,this.drainers=new Set,this.drainListeners=void 0,this.drainListenerCount=0}async whenDrained(){if(this.isDrained())return;let e=new No;return this.drainers.add(e),e.p}isDrained(){for(let[,e]of this.queues)if(e.size>0)return!1;return!0}queueSize(e,t=Ga){let n=t.getComparisonKey(e);return this.queues.get(n)?.size??0}queueFor(e,t,n=Ga){let r=n.getComparisonKey(e),i=this.queues.get(r);if(!i){i=new wo;let e=this.drainListenerCount++,t=en.once(i.onDrained)(()=>{i?.dispose(),this.queues.delete(r),this.onDidQueueDrain(),this.drainListeners?.deleteAndDispose(e),this.drainListeners?.size===0&&(this.drainListeners.dispose(),this.drainListeners=void 0)});this.drainListeners||=new St,this.drainListeners.set(e,t),this.queues.set(r,i)}return i.queue(t)}onDidQueueDrain(){this.isDrained()&&this.releaseDrainers()}releaseDrainers(){for(let e of this.drainers)e.complete();this.drainers.clear()}dispose(){for(let[,e]of this.queues)e.dispose();this.queues.clear(),this.releaseDrainers(),this.drainListeners?.dispose()}},Eo=class{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,n=globalThis){if(this.isDisposed)throw new me(`Calling 'cancelAndSet' on a disposed IntervalTimer`);this.cancel();let r=n.setInterval(()=>{e()},t);this.disposable=_(()=>{n.clearInterval(r),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},Do=class{constructor(e,t){this.timeoutToken=void 0,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=void 0)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==void 0}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=void 0,this.runner&&this.doRun()}doRun(){this.runner?.()}};let Oo,ko;(function(){let e=globalThis;ko=typeof e.requestIdleCallback!=`function`||typeof e.cancelIdleCallback!=`function`?(e,t,n)=>{ur(()=>{if(r)return;let e=Date.now()+15,n={didTimeout:!0,timeRemaining(){return Math.max(0,e-Date.now())}};t(Object.freeze(n))});let r=!1;return{dispose(){r||=!0}}}:(e,t,n)=>{let r=e.requestIdleCallback(t,typeof n==`number`?{timeout:n}:void 0),i=!1;return{dispose(){i||(i=!0,e.cancelIdleCallback(r))}}},Oo=(e,t)=>ko(globalThis,e,t)})();var Ao=class{constructor(e,t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(e){this._error=e}finally{this._didRun=!0}},this._handle=ko(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},jo=class extends Ao{constructor(e){super(globalThis,e)}},Mo;(function(e){e[e.Resolved=0]=`Resolved`,e[e.Rejected=1]=`Rejected`})(Mo||={});var No=class{get isRejected(){return this.outcome?.outcome===Mo.Rejected}get isResolved(){return this.outcome?.outcome===Mo.Resolved}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===Mo.Resolved?this.outcome?.value:void 0}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:Mo.Resolved,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:Mo.Rejected,value:e},t()})}settleWith(e){return e.then(e=>this.complete(e),e=>this.error(e))}cancel(){return this.error(new oe)}},Po;(function(e){async function t(e){let t,n=await Promise.all(e.map(e=>e.then(e=>e,e=>{t||=e})));if(t!==void 0)throw t;return n}e.settled=t;function n(e){return new Promise(async(t,n)=>{try{await e(t,n)}catch(e){n(e)}})}e.withAsyncBody=n})(Po||={});var Fo;(function(e){e[e.Initial=0]=`Initial`,e[e.DoneOK=1]=`DoneOK`,e[e.DoneError=2]=`DoneError`})(Fo||={});var Io=class e{static fromArray(t){return new e(e=>{e.emitMany(t)})}static fromPromise(t){return new e(async e=>{e.emitMany(await t)})}static fromPromisesResolveOrder(t){return new e(async e=>{await Promise.all(t.map(async t=>e.emitOne(await t)))})}static merge(t){return new e(async e=>{await Promise.all(t.map(async t=>{for await(let n of t)e.emitOne(n)}))})}static{this.EMPTY=e.fromArray([])}constructor(e,t){this._state=Fo.Initial,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new x,queueMicrotask(async()=>{let t={emitOne:e=>this.emitOne(e),emitMany:e=>this.emitMany(e),reject:e=>this.reject(e)};try{await Promise.resolve(e(t)),this.resolve()}catch(e){this.reject(e)}finally{t.emitOne=void 0,t.emitMany=void 0,t.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===Fo.DoneError)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===Fo.DoneOK)return{done:!0,value:void 0};await en.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(t,n){return new e(async e=>{for await(let r of t)e.emitOne(n(r))})}map(t){return e.map(this,t)}static filter(t,n){return new e(async e=>{for await(let r of t)n(r)&&e.emitOne(r)})}filter(t){return e.filter(this,t)}static coalesce(t){return e.filter(t,e=>!!e)}coalesce(){return e.coalesce(this)}static async toPromise(e){let t=[];for await(let n of e)t.push(n);return t}toPromise(){return e.toPromise(this)}emitOne(e){this._state===Fo.Initial&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===Fo.Initial&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===Fo.Initial&&(this._state=Fo.DoneOK,this._onStateChanged.fire())}reject(e){this._state===Fo.Initial&&(this._state=Fo.DoneError,this._error=e,this._onStateChanged.fire())}},Lo=class{constructor(e){this._deferred=new No,this._asyncIterable=new Io(e=>{if(t){e.reject(t);return}return n&&e.emitMany(n),this._errorFn=t=>e.reject(t),this._emitOneFn=t=>e.emitOne(t),this._emitManyFn=t=>e.emitMany(t),this._deferred.p},e);let t,n;this._errorFn=e=>{t||=e},this._emitOneFn=e=>{n||=[],n.push(e)},this._emitManyFn=e=>{n?e.forEach(e=>n.push(e)):n=e.slice()}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e),this._deferred.complete()}emitOne(e){this._emitOneFn(e)}emitMany(e){this._emitManyFn(e)}};Symbol.asyncIterator,new class{transformIncoming(e){return e}transformOutgoing(e){return e}transformOutgoingURI(e){return e}transformOutgoingScheme(e){return e}};function Ro(e,t,n,r){if(!e||r>200)return null;if(typeof e==`object`){if(e.$mid===Dn.Uri)return n?w.revive(t.transformIncoming(e)):t.transformIncoming(e);if(e instanceof b)return null;for(let i in e)if(Object.hasOwnProperty.call(e,i)){let a=Ro(e[i],t,n,r+1);a!==null&&(e[i]=a)}}return null}function zo(e,t){let n=Ro(e,t,!1,0);return n===null?e:n}var Bo=class{constructor(){this._actual=null,this._actualOk=null,this._actualErr=null,this._hasValue=!1,this._value=null,this._hasErr=!1,this._err=null}get[Symbol.toStringTag](){return this.toString()}_ensureActual(){return this._actual||=new Promise((e,t)=>{this._actualOk=e,this._actualErr=t,this._hasValue&&this._actualOk(this._value),this._hasErr&&this._actualErr(this._err)}),this._actual}resolveOk(e){this._hasValue||this._hasErr||(this._hasValue=!0,this._value=e,this._actual&&this._actualOk(e))}resolveErr(e){this._hasValue||this._hasErr||(this._hasErr=!0,this._err=e,this._actual?this._actualErr(e):m(e))}then(e,t){return this._ensureActual().then(e,t)}catch(e){return this._ensureActual().then(void 0,e)}finally(e){return this._ensureActual().finally(e)}},Vo=class extends Bo{constructor(){super(),this._hasErr=!0,this._err=new oe}},Ho;function Uo(e,t){try{return JSON.stringify(e,t)}catch{return`null`}}const Wo=`$$ref$$`,Go={[Wo]:-1};function Ko(e,t=null,n=!1){let r=[],i=(n?Uo:JSON.stringify)(e,(e,n)=>{if(n===void 0)return Go;if(typeof n==`object`){if(n instanceof b){let e=r.push(n)-1;return{[Wo]:e}}if(t)return t(e,n)}return n});return{jsonString:i,referencedBuffers:r}}function qo(e,t,n){return JSON.parse(e,(e,r)=>{if(r){let e=r[Wo];if(typeof e==`number`)return t[e];if(n&&r.$mid===Dn.Uri)return n.transformIncoming(r)}return r})}function Jo(e,t){return JSON.stringify(e,t)}function Yo(e){return e?(t,n)=>n&&n.$mid===Dn.Uri?e.transformOutgoing(n):n:null}var Xo;(function(e){e[e.LocalSide=0]=`LocalSide`,e[e.OtherSide=1]=`OtherSide`})(Xo||={});var Zo;(function(e){e[e.Responsive=0]=`Responsive`,e[e.Unresponsive=1]=`Unresponsive`})(Zo||={});const Qo=()=>{},$o=Symbol.for(`rpcProtocol`),es=Symbol.for(`rpcProxy`);var ts=class e extends y{static{Ho=$o}static{this.UNRESPONSIVE_TIME=3*1e3}constructor(e,t=null,n=null){super(),this[Ho]=!0,this._onDidChangeResponsiveState=this._register(new x),this.onDidChangeResponsiveState=this._onDidChangeResponsiveState.event,this._protocol=e,this._logger=t,this._uriTransformer=n,this._uriReplacer=Yo(this._uriTransformer),this._isDisposed=!1,this._locals=[],this._proxies=[];for(let e=0,t=fi.count;e<t;e++)this._locals[e]=null,this._proxies[e]=null;this._lastMessageId=0,this._cancelInvokedHandlers=Object.create(null),this._pendingRPCReplies={},this._responsiveState=Zo.Responsive,this._unacknowledgedCount=0,this._unresponsiveTime=0,this._asyncCheckUresponsive=this._register(new Do(()=>this._checkUnresponsive(),1e3)),this._register(this._protocol.onMessage(e=>this._receiveOneMessage(e)))}dispose(){this._isDisposed=!0,Object.keys(this._pendingRPCReplies).forEach(e=>{let t=this._pendingRPCReplies[e];delete this._pendingRPCReplies[e],t.resolveErr(ce())}),super.dispose()}drain(){return typeof this._protocol.drain==`function`?this._protocol.drain():Promise.resolve()}_onWillSendRequest(t){this._unacknowledgedCount===0&&(this._unresponsiveTime=Date.now()+e.UNRESPONSIVE_TIME),this._unacknowledgedCount++,this._asyncCheckUresponsive.isScheduled()||this._asyncCheckUresponsive.schedule()}_onDidReceiveAcknowledge(t){this._unresponsiveTime=Date.now()+e.UNRESPONSIVE_TIME,this._unacknowledgedCount--,this._unacknowledgedCount===0&&this._asyncCheckUresponsive.cancel(),this._setResponsiveState(Zo.Responsive)}_checkUnresponsive(){this._unacknowledgedCount!==0&&(Date.now()>this._unresponsiveTime?this._setResponsiveState(Zo.Unresponsive):this._asyncCheckUresponsive.schedule())}_setResponsiveState(e){this._responsiveState!==e&&(this._responsiveState=e,this._onDidChangeResponsiveState.fire(this._responsiveState))}get responsiveState(){return this._responsiveState}transformIncomingURIs(e){return this._uriTransformer?zo(e,this._uriTransformer):e}getProxy(e){let{nid:t,sid:n}=e;return this._proxies[t]||(this._proxies[t]=this._createProxy(t,n)),this._proxies[t]}_createProxy(e,t){let n={get:(n,r)=>(typeof r==`string`&&!n[r]&&r.charCodeAt(0)===S.DollarSign&&(n[r]=(...t)=>this._remoteCall(e,r,t)),r===es?t:n[r])};return new Proxy(Object.create(null),n)}set(e,t){return this._locals[e.nid]=t,t}assertRegistered(e){for(let t=0,n=e.length;t<n;t++){let n=e[t];if(!this._locals[n.nid])throw Error(`Missing proxy instance ${n.sid}`)}}_receiveOneMessage(e){if(this._isDisposed)return;let t=e.byteLength,n=rs.read(e,0),r=n.readUInt8(),i=n.readUInt32();switch(r){case cs.RequestJSONArgs:case cs.RequestJSONArgsWithCancellation:{let{rpcId:e,method:a,args:o}=ss.deserializeRequestJSONArgs(n);this._uriTransformer&&(o=zo(o,this._uriTransformer)),this._receiveRequest(t,i,e,a,o,r===cs.RequestJSONArgsWithCancellation);break}case cs.RequestMixedArgs:case cs.RequestMixedArgsWithCancellation:{let{rpcId:e,method:a,args:o}=ss.deserializeRequestMixedArgs(n);this._uriTransformer&&(o=zo(o,this._uriTransformer)),this._receiveRequest(t,i,e,a,o,r===cs.RequestMixedArgsWithCancellation);break}case cs.Acknowledged:this._logger?.logIncoming(t,i,Xo.LocalSide,`ack`),this._onDidReceiveAcknowledge(i);break;case cs.Cancel:this._receiveCancel(t,i);break;case cs.ReplyOKEmpty:this._receiveReply(t,i,void 0);break;case cs.ReplyOKJSON:{let e=ss.deserializeReplyOKJSON(n);this._uriTransformer&&(e=zo(e,this._uriTransformer)),this._receiveReply(t,i,e);break}case cs.ReplyOKJSONWithBuffers:{let e=ss.deserializeReplyOKJSONWithBuffers(n,this._uriTransformer);this._receiveReply(t,i,e);break}case cs.ReplyOKVSBuffer:{let e=ss.deserializeReplyOKVSBuffer(n);this._receiveReply(t,i,e);break}case cs.ReplyErrError:{let e=ss.deserializeReplyErrError(n);this._uriTransformer&&(e=zo(e,this._uriTransformer)),this._receiveReplyErr(t,i,e);break}case cs.ReplyErrEmpty:this._receiveReplyErr(t,i,void 0);break;default:console.error(`received unexpected message`),console.error(e)}}_receiveRequest(e,t,n,r,i,a){this._logger?.logIncoming(e,t,Xo.OtherSide,`receiveRequest ${mi(n)}.${r}(`,i);let o=String(t),s,c;if(a){let e=new Ai;i.push(e.token),s=this._invokeHandler(n,r,i),c=()=>e.cancel()}else s=this._invokeHandler(n,r,i),c=Qo;this._cancelInvokedHandlers[o]=c;let l=ss.serializeAcknowledged(t);this._logger?.logOutgoing(l.byteLength,t,Xo.OtherSide,`ack`),this._protocol.send(l),s.then(e=>{delete this._cancelInvokedHandlers[o];let n=ss.serializeReplyOK(t,e,this._uriReplacer);this._logger?.logOutgoing(n.byteLength,t,Xo.OtherSide,`reply:`,e),this._protocol.send(n)},e=>{delete this._cancelInvokedHandlers[o];let n=ss.serializeReplyErr(t,e);this._logger?.logOutgoing(n.byteLength,t,Xo.OtherSide,`replyErr:`,e),this._protocol.send(n)})}_receiveCancel(e,t){this._logger?.logIncoming(e,t,Xo.OtherSide,`receiveCancel`);let n=String(t);this._cancelInvokedHandlers[n]?.()}_receiveReply(e,t,n){this._logger?.logIncoming(e,t,Xo.LocalSide,`receiveReply:`,n);let r=String(t);if(!this._pendingRPCReplies.hasOwnProperty(r))return;let i=this._pendingRPCReplies[r];delete this._pendingRPCReplies[r],i.resolveOk(n)}_receiveReplyErr(e,t,n){this._logger?.logIncoming(e,t,Xo.LocalSide,`receiveReplyErr:`,n);let r=String(t);if(!this._pendingRPCReplies.hasOwnProperty(r))return;let i=this._pendingRPCReplies[r];delete this._pendingRPCReplies[r];let a;n&&(n.$isError?(a=Error(),a.name=n.name,a.message=n.message,a.stack=n.stack):a=n),i.resolveErr(a)}_invokeHandler(e,t,n){try{return Promise.resolve(this._doInvokeHandler(e,t,n))}catch(e){return Promise.reject(e)}}_doInvokeHandler(e,t,n){let r=this._locals[e];if(!r)throw Error(`Unknown actor `+mi(e));let i=r[t];if(typeof i!=`function`)throw Error(`Unknown method `+t+` on actor `+mi(e));return i.apply(r,n)}_remoteCall(e,t,n){if(this._isDisposed)return new Vo;let r=null;if(n.length>0&&Oi.isCancellationToken(n[n.length-1])&&(r=n.pop()),r&&r.isCancellationRequested)return Promise.reject(ce());let i=ss.serializeRequestArguments(n,this._uriReplacer),a=++this._lastMessageId,o=String(a),s=new Bo,c=new v;r&&c.add(r.onCancellationRequested(()=>{let e=ss.serializeCancel(a);this._logger?.logOutgoing(e.byteLength,a,Xo.LocalSide,`cancel`),this._protocol.send(e)})),this._pendingRPCReplies[o]=new ns(s,c),this._onWillSendRequest(a);let l=ss.serializeRequest(a,e,t,i,!!r);return this._logger?.logOutgoing(l.byteLength,a,Xo.LocalSide,`request: ${mi(e)}.${t}(`,n),this._protocol.send(l),s}},ns=class{constructor(e,t){this._promise=e,this._disposable=t}resolveOk(e){this._promise.resolveOk(e),this._disposable.dispose()}resolveErr(e){this._promise.resolveErr(e),this._disposable.dispose()}},rs=class e{static alloc(t,n,r){let i=new e(b.alloc(r+1+4),0);return i.writeUInt8(t),i.writeUInt32(n),i}static read(t,n){return new e(t,n)}get buffer(){return this._buff}constructor(e,t){this._buff=e,this._offset=t}static sizeUInt8(){return 1}static{this.sizeUInt32=4}writeUInt8(e){this._buff.writeUInt8(e,this._offset),this._offset+=1}readUInt8(){let e=this._buff.readUInt8(this._offset);return this._offset+=1,e}writeUInt32(e){this._buff.writeUInt32BE(e,this._offset),this._offset+=4}readUInt32(){let e=this._buff.readUInt32BE(this._offset);return this._offset+=4,e}static sizeShortString(e){return 1+e.byteLength}writeShortString(e){this._buff.writeUInt8(e.byteLength,this._offset),this._offset+=1,this._buff.set(e,this._offset),this._offset+=e.byteLength}readShortString(){let e=this._buff.readUInt8(this._offset);this._offset+=1;let t=this._buff.slice(this._offset,this._offset+e),n=t.toString();return this._offset+=e,n}static sizeLongString(e){return 4+e.byteLength}writeLongString(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readLongString(){let e=this._buff.readUInt32BE(this._offset);this._offset+=4;let t=this._buff.slice(this._offset,this._offset+e),n=t.toString();return this._offset+=e,n}writeBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}static sizeVSBuffer(e){return 4+e.byteLength}writeVSBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readVSBuffer(){let e=this._buff.readUInt32BE(this._offset);this._offset+=4;let t=this._buff.slice(this._offset,this._offset+e);return this._offset+=e,t}static sizeMixedArray(e){let t=0;t+=1;for(let n=0,r=e.length;n<r;n++){let r=e[n];switch(t+=1,r.type){case ls.String:t+=this.sizeLongString(r.value);break;case ls.VSBuffer:t+=this.sizeVSBuffer(r.value);break;case ls.SerializedObjectWithBuffers:t+=this.sizeUInt32,t+=this.sizeLongString(r.value);for(let e=0;e<r.buffers.length;++e)t+=this.sizeVSBuffer(r.buffers[e]);break}}return t}writeMixedArray(e){this._buff.writeUInt8(e.length,this._offset),this._offset+=1;for(let t=0,n=e.length;t<n;t++){let n=e[t];switch(n.type){case ls.String:this.writeUInt8(ls.String),this.writeLongString(n.value);break;case ls.VSBuffer:this.writeUInt8(ls.VSBuffer),this.writeVSBuffer(n.value);break;case ls.SerializedObjectWithBuffers:this.writeUInt8(ls.SerializedObjectWithBuffers),this.writeUInt32(n.buffers.length),this.writeLongString(n.value);for(let e=0;e<n.buffers.length;++e)this.writeBuffer(n.buffers[e]);break;case ls.Undefined:this.writeUInt8(ls.Undefined);break}}}readMixedArray(){let e=this._buff.readUInt8(this._offset);this._offset+=1;let t=Array(e);for(let n=0;n<e;n++){let e=this.readUInt8();switch(e){case ls.String:t[n]=this.readLongString();break;case ls.VSBuffer:t[n]=this.readVSBuffer();break;case ls.SerializedObjectWithBuffers:{let e=this.readUInt32(),r=this.readLongString(),i=[];for(let t=0;t<e;++t)i.push(this.readVSBuffer());t[n]=new hi(qo(r,i,null));break}case ls.Undefined:t[n]=void 0;break}}return t}},os;(function(e){e[e.Simple=0]=`Simple`,e[e.Mixed=1]=`Mixed`})(os||={});var ss=class{static _useMixedArgSerialization(e){for(let t=0,n=e.length;t<n;t++)if(e[t]instanceof b||e[t]instanceof hi||e[t]===void 0)return!0;return!1}static serializeRequestArguments(e,t){if(this._useMixedArgSerialization(e)){let n=[];for(let r=0,i=e.length;r<i;r++){let i=e[r];if(i instanceof b)n[r]={type:ls.VSBuffer,value:i};else if(i===void 0)n[r]={type:ls.Undefined};else if(i instanceof hi){let{jsonString:e,referencedBuffers:a}=Ko(i.value,t);n[r]={type:ls.SerializedObjectWithBuffers,value:b.fromString(e),buffers:a}}else n[r]={type:ls.String,value:b.fromString(Jo(i,t))}}return{type:os.Mixed,args:n}}return{type:os.Simple,args:Jo(e,t)}}static serializeRequest(e,t,n,r,i){switch(r.type){case os.Simple:return this._requestJSONArgs(e,t,n,r.args,i);case os.Mixed:return this._requestMixedArgs(e,t,n,r.args,i)}}static _requestJSONArgs(e,t,n,r,i){let a=b.fromString(n),o=b.fromString(r),s=0;s+=rs.sizeUInt8(),s+=rs.sizeShortString(a),s+=rs.sizeLongString(o);let c=rs.alloc(i?cs.RequestJSONArgsWithCancellation:cs.RequestJSONArgs,e,s);return c.writeUInt8(t),c.writeShortString(a),c.writeLongString(o),c.buffer}static deserializeRequestJSONArgs(e){let t=e.readUInt8(),n=e.readShortString(),r=e.readLongString();return{rpcId:t,method:n,args:JSON.parse(r)}}static _requestMixedArgs(e,t,n,r,i){let a=b.fromString(n),o=0;o+=rs.sizeUInt8(),o+=rs.sizeShortString(a),o+=rs.sizeMixedArray(r);let s=rs.alloc(i?cs.RequestMixedArgsWithCancellation:cs.RequestMixedArgs,e,o);return s.writeUInt8(t),s.writeShortString(a),s.writeMixedArray(r),s.buffer}static deserializeRequestMixedArgs(e){let t=e.readUInt8(),n=e.readShortString(),r=e.readMixedArray(),i=Array(r.length);for(let e=0,t=r.length;e<t;e++){let t=r[e];typeof t==`string`?i[e]=JSON.parse(t):i[e]=t}return{rpcId:t,method:n,args:i}}static serializeAcknowledged(e){return rs.alloc(cs.Acknowledged,e,0).buffer}static serializeCancel(e){return rs.alloc(cs.Cancel,e,0).buffer}static serializeReplyOK(e,t,n){if(t===void 0)return this._serializeReplyOKEmpty(e);if(t instanceof b)return this._serializeReplyOKVSBuffer(e,t);if(t instanceof hi){let{jsonString:r,referencedBuffers:i}=Ko(t.value,n,!0);return this._serializeReplyOKJSONWithBuffers(e,r,i)}else return this._serializeReplyOKJSON(e,Uo(t,n))}static _serializeReplyOKEmpty(e){return rs.alloc(cs.ReplyOKEmpty,e,0).buffer}static _serializeReplyOKVSBuffer(e,t){let n=0;n+=rs.sizeVSBuffer(t);let r=rs.alloc(cs.ReplyOKVSBuffer,e,n);return r.writeVSBuffer(t),r.buffer}static deserializeReplyOKVSBuffer(e){return e.readVSBuffer()}static _serializeReplyOKJSON(e,t){let n=b.fromString(t),r=0;r+=rs.sizeLongString(n);let i=rs.alloc(cs.ReplyOKJSON,e,r);return i.writeLongString(n),i.buffer}static _serializeReplyOKJSONWithBuffers(e,t,n){let r=b.fromString(t),i=0;i+=rs.sizeUInt32,i+=rs.sizeLongString(r);for(let e of n)i+=rs.sizeVSBuffer(e);let a=rs.alloc(cs.ReplyOKJSONWithBuffers,e,i);a.writeUInt32(n.length),a.writeLongString(r);for(let e of n)a.writeBuffer(e);return a.buffer}static deserializeReplyOKJSON(e){let t=e.readLongString();return JSON.parse(t)}static deserializeReplyOKJSONWithBuffers(e,t){let n=e.readUInt32(),r=e.readLongString(),i=[];for(let t=0;t<n;++t)i.push(e.readVSBuffer());return new hi(qo(r,i,t))}static serializeReplyErr(e,t){let n=t?Uo(ne(t),null):void 0;if(typeof n!=`string`)return this._serializeReplyErrEmpty(e);let r=b.fromString(n),i=0;i+=rs.sizeLongString(r);let a=rs.alloc(cs.ReplyErrError,e,i);return a.writeLongString(r),a.buffer}static deserializeReplyErrError(e){let t=e.readLongString();return JSON.parse(t)}static _serializeReplyErrEmpty(e){return rs.alloc(cs.ReplyErrEmpty,e,0).buffer}},cs;(function(e){e[e.RequestJSONArgs=1]=`RequestJSONArgs`,e[e.RequestJSONArgsWithCancellation=2]=`RequestJSONArgsWithCancellation`,e[e.RequestMixedArgs=3]=`RequestMixedArgs`,e[e.RequestMixedArgsWithCancellation=4]=`RequestMixedArgsWithCancellation`,e[e.Acknowledged=5]=`Acknowledged`,e[e.Cancel=6]=`Cancel`,e[e.ReplyOKEmpty=7]=`ReplyOKEmpty`,e[e.ReplyOKVSBuffer=8]=`ReplyOKVSBuffer`,e[e.ReplyOKJSON=9]=`ReplyOKJSON`,e[e.ReplyOKJSONWithBuffers=10]=`ReplyOKJSONWithBuffers`,e[e.ReplyErrError=11]=`ReplyErrError`,e[e.ReplyErrEmpty=12]=`ReplyErrEmpty`})(cs||={});var ls;(function(e){e[e.String=1]=`String`,e[e.VSBuffer=2]=`VSBuffer`,e[e.SerializedObjectWithBuffers=3]=`SerializedObjectWithBuffers`,e[e.Undefined=4]=`Undefined`})(ls||={});function us(e){if(!e)return;let t=e.indexOf(`+`);return t<0?e:e.substr(0,t)}const ds=[`AI`,`Azure`,`Chat`,`Data Science`,`Debuggers`,`Extension Packs`,`Education`,`Formatters`,`Keymaps`,`Language Packs`,`Linters`,`Machine Learning`,`Notebooks`,`Programming Languages`,`SCM Providers`,`Snippets`,`Testing`,`Themes`,`Visualization`,`Other`];var fs;(function(e){e[e.System=0]=`System`,e[e.User=1]=`User`})(fs||={});var ps;(function(e){e.WIN32_X64=`win32-x64`,e.WIN32_ARM64=`win32-arm64`,e.LINUX_X64=`linux-x64`,e.LINUX_ARM64=`linux-arm64`,e.LINUX_ARMHF=`linux-armhf`,e.ALPINE_X64=`alpine-x64`,e.ALPINE_ARM64=`alpine-arm64`,e.DARWIN_X64=`darwin-x64`,e.DARWIN_ARM64=`darwin-arm64`,e.WEB=`web`,e.UNIVERSAL=`universal`,e.UNKNOWN=`unknown`,e.UNDEFINED=`undefined`})(ps||={});var ms=class{constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){if(e==null)return t==null;if(t==null)return!1;if(typeof e==`string`||typeof t==`string`){let n=typeof e==`string`?e:e.value,r=typeof t==`string`?t:t.value;return $i(n,r)}return e._lower===t._lower}static toKey(e){return typeof e==`string`?e.toLowerCase():e._lower}},hs=class{get size(){return this._set.size}constructor(e){if(this._set=new Set,e)for(let t of e)this.add(t)}add(e){this._set.add(ms.toKey(e))}delete(e){return this._set.delete(ms.toKey(e))}has(e){return this._set.has(ms.toKey(e))}},gs=class{constructor(){this._map=new Map}clear(){this._map.clear()}delete(e){this._map.delete(ms.toKey(e))}get(e){return this._map.get(ms.toKey(e))}has(e){return this._map.has(ms.toKey(e))}set(e,t){this._map.set(ms.toKey(e),t)}values(){return this._map.values()}forEach(e){this._map.forEach(e)}[Symbol.iterator](){return this._map[Symbol.iterator]()}},_s=class extends Error{constructor(e,t,n){super(`Error in extension ${ms.toKey(e)}: ${n??t.message}`,{cause:t}),this.name=`ExtensionError`,this.extension=e}},vs;(function(e){e.serviceIds=new Map,e.DI_TARGET=`$di$target`,e.DI_DEPENDENCIES=`$di$dependencies`;function t(t){return t[e.DI_DEPENDENCIES]||[]}e.getServiceDependencies=t})(vs||={});const ys=k(`instantiationService`);function bs(e,t,n){t[vs.DI_TARGET]===t?t[vs.DI_DEPENDENCIES].push({id:e,index:n}):(t[vs.DI_DEPENDENCIES]=[{id:e,index:n}],t[vs.DI_TARGET]=t)}function k(e){if(vs.serviceIds.has(e))return vs.serviceIds.get(e);let t=function(e,n,r){if(arguments.length!==3)throw Error(`@IServiceName-decorator can only be used to decorate a parameter`);bs(t,e,r)};return t.toString=()=>e,vs.serviceIds.set(e,t),t}const xs=k(`logService`),Ss=k(`loggerService`);var Cs=class{constructor(e,t=[],n=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=n}};const ws=[];var Ts;(function(e){e[e.Eager=0]=`Eager`,e[e.Delayed=1]=`Delayed`})(Ts||={});function Es(e,t,n){t instanceof Cs||(t=new Cs(t,[],!!n)),ws.push([e,t])}function Ds(){return ws}var Os=class{constructor(...e){this._entries=new Map;for(let[t,n]of e)this.set(t,n)}set(e,t){let n=this._entries.get(e);return this._entries.set(e,t),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};const ks=k(`IExtHostInitDataService`);var As=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}},js=class{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){let e=[];for(let t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){let n=this.lookupOrInsertNode(e),r=this.lookupOrInsertNode(t);n.outgoing.set(r.key,r),r.incoming.set(n.key,n)}removeNode(e){let t=this._hashFn(e);this._nodes.delete(t);for(let e of this._nodes.values())e.outgoing.delete(t),e.incoming.delete(t)}lookupOrInsertNode(e){let t=this._hashFn(e),n=this._nodes.get(t);return n||(n=new As(t,e),this._nodes.set(t,n)),n}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){let e=[];for(let[t,n]of this._nodes)e.push(`${t}\n\t(-> incoming)[${[...n.incoming.keys()].join(`, `)}]\n\t(outgoing ->)[${[...n.outgoing.keys()].join(`,`)}]\n`);return e.join(`
`)}findCycleSlow(){for(let[e,t]of this._nodes){let n=new Set([e]),r=this._findCycle(t,n);if(r)return r}}_findCycle(e,t){for(let[n,r]of e.outgoing){if(t.has(n))return[...t,n].join(` -> `);t.add(n);let e=this._findCycle(r,t);if(e)return e;t.delete(n)}}},Ms=class extends Error{constructor(e){super(`cyclic dependency between services`),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: \n${e.toString()}`}},Ns=class e{constructor(e=new Os,t=!1,n,r=!1){this._services=e,this._strict=t,this._parent=n,this._enableTracing=r,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set(ys,this),this._globalGraph=r?n?._globalGraph??new js(e=>e):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,yt(this._children),this._children.clear();for(let e of this._servicesToMaybeDispose)vt(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw Error(`InstantiationService has been disposed`)}createChild(t,n){this._throwIfDisposed();let r=this,i=new class extends e{dispose(){r._children.delete(i),super.dispose()}}(t,this._strict,this,this._enableTracing);return this._children.add(i),n?.add(i),i}invokeFunction(e,...t){this._throwIfDisposed();let n=Fs.traceInvocation(this._enableTracing,e),r=!1;try{let i={get:e=>{if(r)throw le(`service accessor is only valid during the invocation of its target method`);let t=this._getOrCreateServiceInstance(e,n);if(!t)throw Error(`[invokeFunction] unknown service '${e}'`);return t}};return e(i,...t)}finally{r=!0,n.stop()}}createInstance(e,...t){this._throwIfDisposed();let n,r;return e instanceof Cs?(n=Fs.traceCreation(this._enableTracing,e.ctor),r=this._createInstance(e.ctor,e.staticArguments.concat(t),n)):(n=Fs.traceCreation(this._enableTracing,e),r=this._createInstance(e,t,n)),n.stop(),r}_createInstance(e,t=[],n){let r=vs.getServiceDependencies(e).sort((e,t)=>e.index-t.index),i=[];for(let t of r){let r=this._getOrCreateServiceInstance(t.id,n);r||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${t.id}.`,!1),i.push(r)}let a=r.length>0?r[0].index:t.length;if(t.length!==a){console.trace(`[createInstance] First service dependency of ${e.name} at position ${a+1} conflicts with ${t.length} static arguments`);let n=a-t.length;t=n>0?t.concat(Array(n)):t.slice(0,a)}return Reflect.construct(e,t.concat(i))}_setCreatedServiceInstance(e,t){if(this._services.get(e)instanceof Cs)this._services.set(e,t);else if(this._parent)this._parent._setCreatedServiceInstance(e,t);else throw Error(`illegalState - setting UNKNOWN service instance`)}_getServiceInstanceOrDescriptor(e){let t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));let n=this._getServiceInstanceOrDescriptor(e);return n instanceof Cs?this._safeCreateAndCacheServiceInstance(e,n,t.branch(e,!0)):(t.branch(e,!1),n)}_safeCreateAndCacheServiceInstance(e,t,n){if(this._activeInstantiations.has(e))throw Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,n)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,n){let r=new js(e=>e.id.toString()),i=0,a=[{id:e,desc:t,_trace:n}],o=new Set;for(;a.length;){let t=a.pop();if(!o.has(String(t.id))){if(o.add(String(t.id)),r.lookupOrInsertNode(t),i++>1e3)throw new Ms(r);for(let n of vs.getServiceDependencies(t.desc.ctor)){let i=this._getServiceInstanceOrDescriptor(n.id);if(i||this._throwIfStrict(`[createInstance] ${e} depends on ${n.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(t.id),String(n.id)),i instanceof Cs){let e={id:n.id,desc:i,_trace:t._trace.branch(n.id,!0)};r.lookup(e)||a.push(e),r.insertEdge(t,e)}}}}for(;;){let e=r.roots();if(e.length===0){if(!r.isEmpty())throw new Ms(r);break}for(let{data:t}of e){let e=this._getServiceInstanceOrDescriptor(t.id);if(e instanceof Cs){let e=this._createServiceInstanceWithOwner(t.id,t.desc.ctor,t.desc.staticArguments,t.desc.supportsDelayedInstantiation,t._trace);this._setCreatedServiceInstance(t.id,e)}r.removeNode(t)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,n=[],r,i){if(this._services.get(e)instanceof Cs)return this._createServiceInstance(e,t,n,r,i,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,n,r,i);throw Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(t,n,r=[],i,a,o){if(i){let i=new e(void 0,this._strict,this,this._enableTracing);i._globalGraphImplicitDependency=String(t);let s=new Map,c=new jo(()=>{let e=i._createInstance(n,r,a);for(let[t,n]of s){let r=e[t];if(typeof r==`function`)for(let t of n)t.disposable=r.apply(e,t.listener)}return s.clear(),o.add(e),e});return new Proxy(Object.create(null),{get(e,t){if(!c.isInitialized&&typeof t==`string`&&(t.startsWith(`onDid`)||t.startsWith(`onWill`))){let e=s.get(t);e||(e=new Zt,s.set(t,e));let n=(n,r,i)=>{if(c.isInitialized)return c.value[t](n,r,i);{let t={listener:[n,r,i],disposable:void 0},a=e.push(t),o=_(()=>{a(),t.disposable?.dispose()});return o}};return n}if(t in e)return e[t];let n=c.value,r=n[t];return typeof r==`function`?(r=r.bind(n),e[t]=r,r):r},set(e,t,n){return c.value[t]=n,!0},getPrototypeOf(e){return n.prototype}})}else{let e=this._createInstance(n,r,a);return o.add(e),e}}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw Error(e)}},Ps;(function(e){e[e.None=0]=`None`,e[e.Creation=1]=`Creation`,e[e.Invocation=2]=`Invocation`,e[e.Branch=3]=`Branch`})(Ps||={});var Fs=class e{static{this.all=new Set}static{this._None=new class extends e{constructor(){super(Ps.None,null)}stop(){}branch(){return this}}}static traceInvocation(t,n){return t?new e(Ps.Invocation,n.name||Error().stack.split(`
`).slice(3,4).join(`
`)):e._None}static traceCreation(t,n){return t?new e(Ps.Creation,n.name):e._None}static{this._totals=0}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(t,n){let r=new e(Ps.Branch,t.toString());return this._dep.push([t,n,r]),r}stop(){let t=Date.now()-this._start;e._totals+=t;let n=!1;function r(e,t){let i=[],a=Array(e+1).join(`	`);for(let[o,s,c]of t._dep)if(s&&c){n=!0,i.push(`${a}CREATES -> ${o}`);let t=r(e+1,c);t&&i.push(t)}else i.push(`${a}uses -> ${o}`);return i.join(`
`)}let i=[`${this.type===Ps.Creation?`CREATE`:`CALL`} ${this.name}`,`${r(1,this)}`,`DONE, took ${t.toFixed(2)}ms (grand total ${e._totals.toFixed(2)}ms)`];(t>2||n)&&e.all.add(i.join(`
`))}};const Is=k(`IExtHostRpcService`);var Ls=class{constructor(e){this.getProxy=e.getProxy.bind(e),this.set=e.set.bind(e),this.dispose=e.dispose.bind(e),this.assertRegistered=e.assertRegistered.bind(e),this.drain=e.drain.bind(e)}};const Rs=k(`IURITransformerService`);var zs=class{constructor(e){e?(this.transformIncoming=e.transformIncoming.bind(e),this.transformOutgoing=e.transformOutgoing.bind(e),this.transformOutgoingURI=e.transformOutgoingURI.bind(e),this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)):(this.transformIncoming=e=>e,this.transformOutgoing=e=>e,this.transformOutgoingURI=e=>e,this.transformOutgoingScheme=e=>e)}};function A(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function j(e,t){return function(n,r){t(n,r,e)}}var Bs=class{constructor(){this._value=``,this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){let t=e.charCodeAt(0),n=this._value.charCodeAt(this._pos);return t-n}value(){return this._value[this._pos]}},Vs=class{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++){let t=this._value.charCodeAt(this._to);if(t===S.Period)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?Yi(e,this._value,0,e.length,this._from,this._to):Zi(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}},Hs=class{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){let e=this._value.charCodeAt(t);if(!(e===S.Slash||this._splitOnBackslash&&e===S.Backslash))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){let t=this._value.charCodeAt(this._to);if(t===S.Slash||this._splitOnBackslash&&t===S.Backslash)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?Yi(e,this._value,0,e.length,this._from,this._to):Zi(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}},Us;(function(e){e[e.Scheme=1]=`Scheme`,e[e.Authority=2]=`Authority`,e[e.Path=3]=`Path`,e[e.Query=4]=`Query`,e[e.Fragment=5]=`Fragment`})(Us||={});var Ws=class{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(Us.Scheme),this._value.authority&&this._states.push(Us.Authority),this._value.path&&(this._pathIterator=new Hs(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(Us.Path)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(Us.Query),this._value.fragment&&this._states.push(Us.Fragment)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===Us.Path&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===Us.Path&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===Us.Scheme)return Xi(e,this._value.scheme);if(this._states[this._stateIdx]===Us.Authority)return Xi(e,this._value.authority);if(this._states[this._stateIdx]===Us.Path)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===Us.Query)return Ji(e,this._value.query);if(this._states[this._stateIdx]===Us.Fragment)return Ji(e,this._value.fragment);throw Error()}value(){if(this._states[this._stateIdx]===Us.Scheme)return this._value.scheme;if(this._states[this._stateIdx]===Us.Authority)return this._value.authority;if(this._states[this._stateIdx]===Us.Path)return this._pathIterator.value();if(this._states[this._stateIdx]===Us.Query)return this._value.query;if(this._states[this._stateIdx]===Us.Fragment)return this._value.fragment;throw Error()}},Gs=class e{static{this.Val=Symbol(`undefined_placeholder`)}static wrap(t){return t===void 0?e.Val:t}static unwrap(t){return t===e.Val?void 0:t}},Ks=class{constructor(){this.height=1,this.value=void 0,this.key=void 0,this.left=void 0,this.mid=void 0,this.right=void 0}isEmpty(){return!this.left&&!this.mid&&!this.right&&this.value===void 0}rotateLeft(){let e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){let e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}},qs;(function(e){e[e.Left=-1]=`Left`,e[e.Mid=0]=`Mid`,e[e.Right=1]=`Right`})(qs||={});var Js=class e{static forUris(t=()=>!1,n=()=>!1){return new e(new Ws(t,n))}static forPaths(t=!1){return new e(new Hs(void 0,!t))}static forStrings(){return new e(new Bs)}static forConfigKeys(){return new e(new Vs)}constructor(e){this._iter=e}clear(){this._root=void 0}fill(e,t){if(t){let n=t.slice(0);Te(n);for(let t of n)this.set(t,e)}else{let t=e.slice(0);Te(t);for(let e of t)this.set(e[0],e[1])}}set(e,t){let n=this._iter.reset(e),r;this._root||(this._root=new Ks,this._root.segment=n.value());let i=[];for(r=this._root;;){let e=n.cmp(r.segment);if(e>0)r.left||(r.left=new Ks,r.left.segment=n.value()),i.push([qs.Left,r]),r=r.left;else if(e<0)r.right||(r.right=new Ks,r.right.segment=n.value()),i.push([qs.Right,r]),r=r.right;else if(n.hasNext())n.next(),r.mid||(r.mid=new Ks,r.mid.segment=n.value()),i.push([qs.Mid,r]),r=r.mid;else break}let a=Gs.unwrap(r.value);r.value=Gs.wrap(t),r.key=e;for(let e=i.length-1;e>=0;e--){let t=i[e][1];t.updateHeight();let n=t.balanceFactor();if(n<-1||n>1){let n=i[e][0],r=i[e+1][0];if(n===qs.Right&&r===qs.Right)i[e][1]=t.rotateLeft();else if(n===qs.Left&&r===qs.Left)i[e][1]=t.rotateRight();else if(n===qs.Right&&r===qs.Left)t.right=i[e+1][1]=i[e+1][1].rotateRight(),i[e][1]=t.rotateLeft();else if(n===qs.Left&&r===qs.Right)t.left=i[e+1][1]=i[e+1][1].rotateLeft(),i[e][1]=t.rotateRight();else throw Error();if(e>0)switch(i[e-1][0]){case qs.Left:i[e-1][1].left=i[e][1];break;case qs.Right:i[e-1][1].right=i[e][1];break;case qs.Mid:i[e-1][1].mid=i[e][1];break}else this._root=i[0][1]}}return a}get(e){return Gs.unwrap(this._getNode(e)?.value)}_getNode(e){let t=this._iter.reset(e),n=this._root;for(;n;){let e=t.cmp(n.segment);if(e>0)n=n.left;else if(e<0)n=n.right;else if(t.hasNext())t.next(),n=n.mid;else break}return n}has(e){let t=this._getNode(e);return!(t?.value===void 0&&t?.mid===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){let n=this._iter.reset(e),r=[],i=this._root;for(;i;){let e=n.cmp(i.segment);if(e>0)r.push([qs.Left,i]),i=i.left;else if(e<0)r.push([qs.Right,i]),i=i.right;else if(n.hasNext())n.next(),r.push([qs.Mid,i]),i=i.mid;else break}if(i){if(t?(i.left=void 0,i.mid=void 0,i.right=void 0,i.height=1):(i.key=void 0,i.value=void 0),!i.mid&&!i.value)if(i.left&&i.right){let e=[[qs.Right,i]],t=this._min(i.right,e);if(t.key){i.key=t.key,i.value=t.value,i.segment=t.segment;let n=t.right;if(e.length>1){let[t,r]=e[e.length-1];switch(t){case qs.Left:r.left=n;break;case qs.Mid:Ye(!1);case qs.Right:Ye(!1)}}else i.right=n;let a=this._balanceByStack(e);if(r.length>0){let[e,t]=r[r.length-1];switch(e){case qs.Left:t.left=a;break;case qs.Mid:t.mid=a;break;case qs.Right:t.right=a;break}}else this._root=a}}else{let e=i.left??i.right;if(r.length>0){let[t,n]=r[r.length-1];switch(t){case qs.Left:n.left=e;break;case qs.Mid:n.mid=e;break;case qs.Right:n.right=e;break}}else this._root=e}this._root=this._balanceByStack(r)??this._root}}_min(e,t){for(;e.left;)t.push([qs.Left,e]),e=e.left;return e}_balanceByStack(e){for(let t=e.length-1;t>=0;t--){let n=e[t][1];n.updateHeight();let r=n.balanceFactor();if(r>1?(n.right.balanceFactor()>=0||(n.right=n.right.rotateRight()),e[t][1]=n.rotateLeft()):r<-1&&(n.left.balanceFactor()<=0||(n.left=n.left.rotateLeft()),e[t][1]=n.rotateRight()),t>0)switch(e[t-1][0]){case qs.Left:e[t-1][1].left=e[t][1];break;case qs.Right:e[t-1][1].right=e[t][1];break;case qs.Mid:e[t-1][1].mid=e[t][1];break}else return e[0][1]}}findSubstr(e){let t=this._iter.reset(e),n=this._root,r;for(;n;){let e=t.cmp(n.segment);if(e>0)n=n.left;else if(e<0)n=n.right;else if(t.hasNext())t.next(),r=Gs.unwrap(n.value)||r,n=n.mid;else break}return n&&Gs.unwrap(n.value)||r}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){let n=this._iter.reset(e),r=this._root;for(;r;){let e=n.cmp(r.segment);if(e>0)r=r.left;else if(e<0)r=r.right;else if(n.hasNext())n.next(),r=r.mid;else if(r.mid)return this._entries(r.mid);else return t?Gs.unwrap(r.value):void 0}}hasElementOrSubtree(e){return this._findSuperstrOrElement(e,!0)!==void 0}forEach(e){for(let[t,n]of this)e(n,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){let t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value!==void 0&&t.push([e.key,Gs.unwrap(e.value)]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}_isBalanced(){let e=t=>{if(!t)return!0;let n=t.balanceFactor();return n<-1||n>1?!1:e(t.left)&&e(t.right)};return e(this._root)}};function Ys(e){if(!e||typeof e!=`object`||e instanceof RegExp)return e;let t=Array.isArray(e)?[]:{};return Object.entries(e).forEach(([e,n])=>{t[e]=n&&typeof n==`object`?Ys(n):n}),t}function Xs(e){if(!e||typeof e!=`object`)return e;let t=[e];for(;t.length>0;){let e=t.shift();for(let n in e)if(Zs.call(e,n)){let r=e[n];typeof r==`object`&&!Object.isFrozen(r)&&!et(r)&&t.push(r)}}return e}const Zs=Object.prototype.hasOwnProperty;function Qs(e,t){return $s(e,t,new Set)}function $s(e,t,n){if(at(e))return e;let r=t(e);if(r!==void 0)return r;if(Array.isArray(e)){let r=[];for(let i of e)r.push($s(i,t,n));return r}if($e(e)){if(n.has(e))throw Error(`Cannot clone recursive data-structure`);n.add(e);let r={};for(let i in e)Zs.call(e,i)&&(r[i]=$s(e[i],t,n));return n.delete(e),r}return e}function ec(e,t,n=!0){return $e(e)?($e(t)&&Object.keys(t).forEach(r=>{r in e?n&&($e(e[r])&&$e(t[r])?ec(e[r],t[r],n):e[r]=t[r]):e[r]=t[r]}),e):t}function tc(e,t){if(e===t)return!0;if(e==null||t==null||typeof e!=typeof t||typeof e!=`object`||Array.isArray(e)!==Array.isArray(t))return!1;let n,r;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(!tc(e[n],t[n]))return!1}else{let i=[];for(r in e)i.push(r);i.sort();let a=[];for(r in t)a.push(r);if(a.sort(),!tc(i,a))return!1;for(n=0;n<i.length;n++)if(!tc(e[i[n]],t[i[n]]))return!1}return!0}function nc(e){let t=new Set;return JSON.stringify(e,(e,n)=>{if($e(n)||Array.isArray(n)){if(t.has(n))return`[Circular]`;t.add(n)}return typeof n==`bigint`?`[BigInt ${n.toString()}]`:n})}function rc(e,t){let n=Object.create(null);for(let[r,i]of Object.entries(e))t(r,i)&&(n[r]=i);return n}var ic=class{constructor(){this._next=0}getNext(){return this._next++}},ac;(function(e){e[e.Unknown=0]=`Unknown`,e[e.File=1]=`File`,e[e.Directory=2]=`Directory`,e[e.SymbolicLink=64]=`SymbolicLink`})(ac||={});var oc;(function(e){e[e.Readonly=1]=`Readonly`,e[e.Locked=2]=`Locked`})(oc||={});var sc;(function(e){e[e.UPDATED=2]=`UPDATED`,e[e.ADDED=4]=`ADDED`,e[e.DELETED=8]=`DELETED`})(sc||={});var cc;(function(e){e[e.None=0]=`None`,e[e.FileReadWrite=2]=`FileReadWrite`,e[e.FileOpenReadWriteClose=4]=`FileOpenReadWriteClose`,e[e.FileReadStream=16]=`FileReadStream`,e[e.FileFolderCopy=8]=`FileFolderCopy`,e[e.PathCaseSensitive=1024]=`PathCaseSensitive`,e[e.Readonly=2048]=`Readonly`,e[e.Trash=4096]=`Trash`,e[e.FileWriteUnlock=8192]=`FileWriteUnlock`,e[e.FileAtomicRead=16384]=`FileAtomicRead`,e[e.FileAtomicWrite=32768]=`FileAtomicWrite`,e[e.FileAtomicDelete=65536]=`FileAtomicDelete`,e[e.FileClone=131072]=`FileClone`,e[e.FileRealpath=262144]=`FileRealpath`})(cc||={});var lc;(function(e){e.FileExists=`EntryExists`,e.FileNotFound=`EntryNotFound`,e.FileNotADirectory=`EntryNotADirectory`,e.FileIsADirectory=`EntryIsADirectory`,e.FileExceedsStorageQuota=`EntryExceedsStorageQuota`,e.FileTooLarge=`EntryTooLarge`,e.FileWriteLocked=`EntryWriteLocked`,e.NoPermissions=`NoPermissions`,e.Unavailable=`Unavailable`,e.Unknown=`Unknown`})(lc||={});var uc=class e extends Error{static create(t,n){let r=new e(t.toString(),n);return dc(r,n),r}constructor(e,t){super(e),this.code=t}};function dc(e,t){return e.name=t?`${t} (FileSystemError)`:`FileSystemError`,e}function fc(e){if(!e)return lc.Unknown;if(e instanceof uc)return e.code;let t=/^(.+) \(FileSystemError\)$/.exec(e.name);if(!t)return lc.Unknown;switch(t[1]){case lc.FileExists:return lc.FileExists;case lc.FileIsADirectory:return lc.FileIsADirectory;case lc.FileNotADirectory:return lc.FileNotADirectory;case lc.FileNotFound:return lc.FileNotFound;case lc.FileTooLarge:return lc.FileTooLarge;case lc.FileWriteLocked:return lc.FileWriteLocked;case lc.NoPermissions:return lc.NoPermissions;case lc.Unavailable:return lc.Unavailable}return lc.Unknown}function pc(e){if(e instanceof gc)return e.fileOperationResult;switch(fc(e)){case lc.FileNotFound:return _c.FILE_NOT_FOUND;case lc.FileIsADirectory:return _c.FILE_IS_DIRECTORY;case lc.FileNotADirectory:return _c.FILE_NOT_DIRECTORY;case lc.FileWriteLocked:return _c.FILE_WRITE_LOCKED;case lc.NoPermissions:return _c.FILE_PERMISSION_DENIED;case lc.FileExists:return _c.FILE_MOVE_CONFLICT;case lc.FileTooLarge:return _c.FILE_TOO_LARGE;default:return _c.FILE_OTHER_ERROR}}var mc;(function(e){e[e.CREATE=0]=`CREATE`,e[e.DELETE=1]=`DELETE`,e[e.MOVE=2]=`MOVE`,e[e.COPY=3]=`COPY`,e[e.WRITE=4]=`WRITE`})(mc||={});var hc;(function(e){e[e.UPDATED=0]=`UPDATED`,e[e.ADDED=1]=`ADDED`,e[e.DELETED=2]=`DELETED`})(hc||={}),class e{static{this.MIXED_CORRELATION=null}constructor(t,n){this.ignorePathCasing=n,this.correlationId=void 0,this.added=new u(()=>{let e=Js.forUris(()=>this.ignorePathCasing);return e.fill(this.rawAdded.map(e=>[e,!0])),e}),this.updated=new u(()=>{let e=Js.forUris(()=>this.ignorePathCasing);return e.fill(this.rawUpdated.map(e=>[e,!0])),e}),this.deleted=new u(()=>{let e=Js.forUris(()=>this.ignorePathCasing);return e.fill(this.rawDeleted.map(e=>[e,!0])),e}),this.rawAdded=[],this.rawUpdated=[],this.rawDeleted=[];for(let n of t){switch(n.type){case hc.ADDED:this.rawAdded.push(n.resource);break;case hc.UPDATED:this.rawUpdated.push(n.resource);break;case hc.DELETED:this.rawDeleted.push(n.resource);break}this.correlationId!==e.MIXED_CORRELATION&&(typeof n.cId==`number`?this.correlationId===void 0?this.correlationId=n.cId:this.correlationId!==n.cId&&(this.correlationId=e.MIXED_CORRELATION):this.correlationId!==void 0&&(this.correlationId=e.MIXED_CORRELATION))}}contains(e,...t){return this.doContains(e,{includeChildren:!1},...t)}affects(e,...t){return this.doContains(e,{includeChildren:!0},...t)}doContains(e,t,...n){if(!e)return!1;let r=n.length>0;return!!((!r||n.includes(hc.ADDED))&&(this.added.value.get(e)||t.includeChildren&&this.added.value.findSuperstr(e))||(!r||n.includes(hc.UPDATED))&&(this.updated.value.get(e)||t.includeChildren&&this.updated.value.findSuperstr(e))||(!r||n.includes(hc.DELETED))&&(this.deleted.value.findSubstr(e)||t.includeChildren&&this.deleted.value.findSuperstr(e)))}gotAdded(){return this.rawAdded.length>0}gotDeleted(){return this.rawDeleted.length>0}gotUpdated(){return this.rawUpdated.length>0}correlates(e){return this.correlationId===e}hasCorrelation(){return typeof this.correlationId==`number`}};var gc=class extends Error{constructor(e,t,n){super(e),this.fileOperationResult=t,this.options=n}},_c;(function(e){e[e.FILE_IS_DIRECTORY=0]=`FILE_IS_DIRECTORY`,e[e.FILE_NOT_FOUND=1]=`FILE_NOT_FOUND`,e[e.FILE_NOT_MODIFIED_SINCE=2]=`FILE_NOT_MODIFIED_SINCE`,e[e.FILE_MODIFIED_SINCE=3]=`FILE_MODIFIED_SINCE`,e[e.FILE_MOVE_CONFLICT=4]=`FILE_MOVE_CONFLICT`,e[e.FILE_WRITE_LOCKED=5]=`FILE_WRITE_LOCKED`,e[e.FILE_PERMISSION_DENIED=6]=`FILE_PERMISSION_DENIED`,e[e.FILE_TOO_LARGE=7]=`FILE_TOO_LARGE`,e[e.FILE_INVALID_PATH=8]=`FILE_INVALID_PATH`,e[e.FILE_NOT_DIRECTORY=9]=`FILE_NOT_DIRECTORY`,e[e.FILE_OTHER_ERROR=10]=`FILE_OTHER_ERROR`})(_c||={});var vc;(function(e){e[e.FILE=0]=`FILE`,e[e.FOLDER=1]=`FOLDER`,e[e.ROOT_FOLDER=2]=`ROOT_FOLDER`})(vc||={});function yc(e){if(!(typeof e.size!=`number`||typeof e.mtime!=`number`))return e.mtime.toString(29)+e.size.toString(31)}(class e{static{this.KB=1024}static{this.MB=e.KB*e.KB}static{this.GB=e.MB*e.KB}static{this.TB=e.GB*e.KB}static formatSize(t){return tt(t)||(t=0),t<e.KB?C(1908,`{0}B`,t.toFixed(0)):t<e.MB?C(1909,`{0}KB`,(t/e.KB).toFixed(2)):t<e.GB?C(1910,`{0}MB`,(t/e.MB).toFixed(2)):t<e.TB?C(1911,`{0}GB`,(t/e.GB).toFixed(2)):C(1912,`{0}TB`,(t/e.TB).toFixed(2))}});var bc;(function(e){e[e.Ignore=0]=`Ignore`,e[e.Info=1]=`Info`,e[e.Warning=2]=`Warning`,e[e.Error=3]=`Error`})(bc||={}),(function(e){let t=`error`,n=`warning`,r=`info`;function i(i){return i?$i(t,i)?e.Error:$i(n,i)||$i(`warn`,i)?e.Warning:$i(r,i)?e.Info:e.Ignore:e.Ignore}e.fromValue=i;function a(i){switch(i){case e.Error:return t;case e.Warning:return n;case e.Info:return r;default:return`ignore`}}e.toString=a})(bc||={});var xc=bc,Sc;(function(e){e[e.DEFAULT=0]=`DEFAULT`,e[e.OPTIONAL=1]=`OPTIONAL`,e[e.SILENT=2]=`SILENT`,e[e.URGENT=3]=`URGENT`})(Sc||={});var Cc;(function(e){e[e.WORKSPACE=0]=`WORKSPACE`,e[e.PROFILE=1]=`PROFILE`,e[e.APPLICATION=2]=`APPLICATION`})(Cc||={});var wc;(function(e){e[e.OFF=0]=`OFF`,e[e.ERROR=1]=`ERROR`})(wc||={});function Tc(e){let t=e;return typeof t?.id==`string`&&w.isUri(t.uri)}function Ec(e){let t=e;return typeof t?.id==`string`&&w.isUri(t.configPath)}var Dc;(function(e){e[e.EMPTY=1]=`EMPTY`,e[e.FOLDER=2]=`FOLDER`,e[e.WORKSPACE=3]=`WORKSPACE`})(Dc||={});let Oc=class{get folders(){return this._folders}set folders(e){this._folders=e,this.updateFoldersMap()}constructor(e,t,n,r,i){this._id=e,this._transient=n,this._configuration=r,this.ignorePathCasing=i,this.foldersMap=Js.forUris(this.ignorePathCasing,()=>!0),this.folders=t}update(e){this._id=e.id,this._configuration=e.configuration,this._transient=e.transient,this.ignorePathCasing=e.ignorePathCasing,this.folders=e.folders}get id(){return this._id}get transient(){return this._transient}get configuration(){return this._configuration}set configuration(e){this._configuration=e}getFolder(e){return e&&this.foldersMap.findSubstr(e)||null}updateFoldersMap(){this.foldersMap=Js.forUris(this.ignorePathCasing,()=>!0);for(let e of this.folders)this.foldersMap.set(e.uri,e)}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration}}};var kc=class{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toResource(e){return $a(this.uri,e)}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}};function Ac(e){return new kc({uri:e,index:0,name:Ya(e)},{uri:e.toString()})}C(2419,`Code Workspace`);var jc=class{constructor(){this._systemSchemes=new Set(Object.keys(O)),this._providerInfo=new Map,this.extUri=new Wa(e=>{let t=this._providerInfo.get(e.scheme);return!(t===void 0||t&cc.PathCaseSensitive)})}$acceptProviderInfos(e,t){t===null?this._providerInfo.delete(e.scheme):this._providerInfo.set(e.scheme,t)}isFreeScheme(e){return!this._providerInfo.has(e)&&!this._systemSchemes.has(e)}getCapabilities(e){return this._providerInfo.get(e)}};const Mc=k(`IExtHostFileSystemInfo`),Nc=(function(){if(typeof crypto.randomUUID==`function`)return crypto.randomUUID.bind(crypto);let e=new Uint8Array(16),t=[];for(let e=0;e<256;e++)t.push(e.toString(16).padStart(2,`0`));return function(){crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let n=0,r=``;return r+=t[e[n++]],r+=t[e[n++]],r+=t[e[n++]],r+=t[e[n++]],r+=`-`,r+=t[e[n++]],r+=t[e[n++]],r+=`-`,r+=t[e[n++]],r+=t[e[n++]],r+=`-`,r+=t[e[n++]],r+=t[e[n++]],r+=`-`,r+=t[e[n++]],r+=t[e[n++]],r+=t[e[n++]],r+=t[e[n++]],r+=t[e[n++]],r+=t[e[n++]],r}})(),Pc=Object.freeze({create:e=>we(e.map(e=>e.toString())).join(`\r
`),split:e=>e.split(`\r
`),parse:e=>Pc.split(e).filter(e=>!e.startsWith(`#`))});new Uint32Array(10);var Fc;(function(e){e[e.InitialConsonant=4352]=`InitialConsonant`,e[e.Vowel=4449]=`Vowel`,e[e.FinalConsonant=4520]=`FinalConsonant`,e[e.CompatibilityJamo=12593]=`CompatibilityJamo`})(Fc||={});var M;(function(e){e[e.NUL=0]=`NUL`,e[e.A=65]=`A`,e[e.B=66]=`B`,e[e.C=67]=`C`,e[e.D=68]=`D`,e[e.E=69]=`E`,e[e.F=70]=`F`,e[e.G=71]=`G`,e[e.H=72]=`H`,e[e.I=73]=`I`,e[e.J=74]=`J`,e[e.K=75]=`K`,e[e.L=76]=`L`,e[e.M=77]=`M`,e[e.N=78]=`N`,e[e.O=79]=`O`,e[e.P=80]=`P`,e[e.Q=81]=`Q`,e[e.R=82]=`R`,e[e.S=83]=`S`,e[e.T=84]=`T`,e[e.U=85]=`U`,e[e.V=86]=`V`,e[e.W=87]=`W`,e[e.X=88]=`X`,e[e.Y=89]=`Y`,e[e.Z=90]=`Z`,e[e.a=97]=`a`,e[e.b=98]=`b`,e[e.c=99]=`c`,e[e.d=100]=`d`,e[e.e=101]=`e`,e[e.f=102]=`f`,e[e.g=103]=`g`,e[e.h=104]=`h`,e[e.i=105]=`i`,e[e.j=106]=`j`,e[e.k=107]=`k`,e[e.l=108]=`l`,e[e.m=109]=`m`,e[e.n=110]=`n`,e[e.o=111]=`o`,e[e.p=112]=`p`,e[e.q=113]=`q`,e[e.r=114]=`r`,e[e.s=115]=`s`,e[e.t=116]=`t`,e[e.u=117]=`u`,e[e.v=118]=`v`,e[e.w=119]=`w`,e[e.x=120]=`x`,e[e.y=121]=`y`,e[e.z=122]=`z`})(M||={});var Ic;(function(e){e[e.fa=24934]=`fa`,e[e.fg=26470]=`fg`,e[e.fq=29030]=`fq`,e[e.fr=29286]=`fr`,e[e.ft=29798]=`ft`,e[e.fv=30310]=`fv`,e[e.fx=30822]=`fx`,e[e.hk=27496]=`hk`,e[e.hl=27752]=`hl`,e[e.ho=28520]=`ho`,e[e.ml=27757]=`ml`,e[e.nj=27246]=`nj`,e[e.nl=27758]=`nl`,e[e.np=28782]=`np`,e[e.qt=29809]=`qt`,e[e.rt=29810]=`rt`,e[e.sg=26483]=`sg`,e[e.sw=30579]=`sw`})(Ic||={}),new Uint8Array([M.r,M.R,M.s,M.e,M.E,M.f,M.a,M.q,M.Q,M.t,M.T,M.d,M.w,M.W,M.c,M.z,M.x,M.v,M.g]),new Uint16Array([M.k,M.o,M.i,M.O,M.j,M.p,M.u,M.P,M.h,Ic.hk,Ic.ho,Ic.hl,M.y,M.n,Ic.nj,Ic.np,Ic.nl,M.b,M.m,Ic.ml,M.l]),new Uint16Array([M.r,M.R,Ic.rt,M.s,Ic.sw,Ic.sg,M.e,M.f,Ic.fr,Ic.fa,Ic.fq,Ic.ft,Ic.fx,Ic.fv,Ic.fg,M.a,M.q,Ic.qt,M.t,M.T,M.d,M.w,M.c,M.z,M.x,M.v,M.g]),new Uint16Array([M.r,M.R,Ic.rt,M.s,Ic.sw,Ic.sg,M.e,M.E,M.f,Ic.fr,Ic.fa,Ic.fq,Ic.ft,Ic.fx,Ic.fv,Ic.fg,M.a,M.q,M.Q,Ic.qt,M.t,M.T,M.d,M.w,M.W,M.c,M.z,M.x,M.v,M.g,M.k,M.o,M.i,M.O,M.j,M.p,M.u,M.P,M.h,Ic.hk,Ic.ho,Ic.hl,M.y,M.n,Ic.nj,Ic.np,Ic.nl,M.b,M.m,Ic.ml,M.l]);function Lc(...e){return function(t,n){for(let r=0,i=e.length;r<i;r++){let i=e[r](t,n);if(i)return i}return null}}zc.bind(void 0,!1);const Rc=zc.bind(void 0,!0);function zc(e,t,n){if(!n||n.length<t.length)return null;let r;return r=e?ea(n,t):n.indexOf(t)===0,r?t.length>0?[{start:0,end:t.length}]:[]:null}function Bc(e,t){let n=t.toLowerCase().indexOf(e.toLowerCase());return n===-1?null:[{start:n,end:n+e.length}]}function Vc(e,t){return Hc(e.toLowerCase(),t.toLowerCase(),0,0)}function Hc(e,t,n,r){if(n===e.length)return[];if(r===t.length)return null;if(e[n]===t[r]){let i=null;return(i=Hc(e,t,n+1,r+1))?Yc({start:r,end:r+1},i):null}return Hc(e,t,n,r+1)}function Uc(e){return S.a<=e&&e<=S.z}function Wc(e){return S.A<=e&&e<=S.Z}function Gc(e){return S.Digit0<=e&&e<=S.Digit9}function Kc(e){return e===S.Space||e===S.Tab||e===S.LineFeed||e===S.CarriageReturn}const qc=new Set;`()[]{}<>\`'"-/;:,.?!`.split(``).forEach(e=>qc.add(e.charCodeAt(0)));function Jc(e){return Uc(e)||Wc(e)||Gc(e)}function Yc(e,t){return t.length===0?t=[e]:e.end===t[0].start?t[0].start=e.start:t.unshift(e),t}function Xc(e,t){for(let n=t;n<e.length;n++){let t=e.charCodeAt(n);if(Wc(t)||Gc(t)||n>0&&!Jc(e.charCodeAt(n-1)))return n}return e.length}function Zc(e,t,n,r){if(n===e.length)return[];if(r===t.length||e[n]!==t[r].toLowerCase())return null;{let i=null,a=r+1;for(i=Zc(e,t,n+1,r+1);!i&&(a=Xc(t,a))<t.length;)i=Zc(e,t,n+1,a),a++;return i===null?null:Yc({start:r,end:r+1},i)}}function Qc(e){let t=0,n=0,r=0,i=0,a=0;for(let o=0;o<e.length;o++)a=e.charCodeAt(o),Wc(a)&&t++,Uc(a)&&n++,Jc(a)&&r++,Gc(a)&&i++;let o=t/e.length,s=n/e.length,c=r/e.length,l=i/e.length;return{upperPercent:o,lowerPercent:s,alphaPercent:c,numericPercent:l}}function $c(e){let{upperPercent:t,lowerPercent:n}=e;return n===0&&t>.6}function el(e){let{upperPercent:t,lowerPercent:n,alphaPercent:r,numericPercent:i}=e;return n>.2&&t<.8&&r>.6&&i<.2}function tl(e){let t=0,n=0,r=0,i=0;for(let a=0;a<e.length;a++)r=e.charCodeAt(a),Wc(r)&&t++,Uc(r)&&n++,Kc(r)&&i++;return(t===0||n===0)&&i===0?e.length<=30:t<=5}function nl(e,t){if(!t||(t=t.trim(),t.length===0)||!tl(e))return null;t.length>60&&(t=t.substring(0,60));let n=Qc(t);if(!el(n)){if(!$c(n))return null;t=t.toLowerCase()}let r=null,i=0;for(e=e.toLowerCase();i<t.length&&(r=Zc(e,t,0,i))===null;)i=Xc(t,i+1);return r}Lc(Rc,nl,Bc),Lc(Rc,nl,Vc),new We(1e4);function rl(){let e=[],t=[];for(let e=0;e<=128;e++)t[e]=0;for(let n=0;n<=128;n++)e.push(t.slice(0));return e}function il(e){let t=[];for(let n=0;n<=e;n++)t[n]=0;return t}il(256),il(256),rl(),rl(),rl();var al;(function(e){e[e.Diag=1]=`Diag`,e[e.Left=2]=`Left`,e[e.LeftLeft=3]=`LeftLeft`})(al||={});var ol;(function(e){e.Default=[-100,0];function t(e){return!e||e.length===2&&e[0]===-100&&e[1]===0}e.isDefault=t})(ol||={}),class{static{this.default={boostFullMatch:!0,firstMatchCanBeWeak:!1}}constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}};const sl=Object.create(null);function N(e,t){if(Ze(t)){let n=sl[t];if(n===void 0)throw Error(`${e} references an unknown codicon: ${t}`);t=n}return sl[e]=t,{id:e}}function cl(){return sl}const ll={add:N(`add`,6e4),plus:N(`plus`,6e4),gistNew:N(`gist-new`,6e4),repoCreate:N(`repo-create`,6e4),lightbulb:N(`lightbulb`,60001),lightBulb:N(`light-bulb`,60001),repo:N(`repo`,60002),repoDelete:N(`repo-delete`,60002),gistFork:N(`gist-fork`,60003),repoForked:N(`repo-forked`,60003),gitPullRequest:N(`git-pull-request`,60004),gitPullRequestAbandoned:N(`git-pull-request-abandoned`,60004),recordKeys:N(`record-keys`,60005),keyboard:N(`keyboard`,60005),tag:N(`tag`,60006),gitPullRequestLabel:N(`git-pull-request-label`,60006),tagAdd:N(`tag-add`,60006),tagRemove:N(`tag-remove`,60006),person:N(`person`,60007),personFollow:N(`person-follow`,60007),personOutline:N(`person-outline`,60007),personFilled:N(`person-filled`,60007),gitBranch:N(`git-branch`,60008),gitBranchCreate:N(`git-branch-create`,60008),gitBranchDelete:N(`git-branch-delete`,60008),sourceControl:N(`source-control`,60008),mirror:N(`mirror`,60009),mirrorPublic:N(`mirror-public`,60009),star:N(`star`,60010),starAdd:N(`star-add`,60010),starDelete:N(`star-delete`,60010),starEmpty:N(`star-empty`,60010),comment:N(`comment`,60011),commentAdd:N(`comment-add`,60011),alert:N(`alert`,60012),warning:N(`warning`,60012),search:N(`search`,60013),searchSave:N(`search-save`,60013),logOut:N(`log-out`,60014),signOut:N(`sign-out`,60014),logIn:N(`log-in`,60015),signIn:N(`sign-in`,60015),eye:N(`eye`,60016),eyeUnwatch:N(`eye-unwatch`,60016),eyeWatch:N(`eye-watch`,60016),circleFilled:N(`circle-filled`,60017),primitiveDot:N(`primitive-dot`,60017),closeDirty:N(`close-dirty`,60017),debugBreakpoint:N(`debug-breakpoint`,60017),debugBreakpointDisabled:N(`debug-breakpoint-disabled`,60017),debugHint:N(`debug-hint`,60017),terminalDecorationSuccess:N(`terminal-decoration-success`,60017),primitiveSquare:N(`primitive-square`,60018),edit:N(`edit`,60019),pencil:N(`pencil`,60019),info:N(`info`,60020),issueOpened:N(`issue-opened`,60020),gistPrivate:N(`gist-private`,60021),gitForkPrivate:N(`git-fork-private`,60021),lock:N(`lock`,60021),mirrorPrivate:N(`mirror-private`,60021),close:N(`close`,60022),removeClose:N(`remove-close`,60022),x:N(`x`,60022),repoSync:N(`repo-sync`,60023),sync:N(`sync`,60023),clone:N(`clone`,60024),desktopDownload:N(`desktop-download`,60024),beaker:N(`beaker`,60025),microscope:N(`microscope`,60025),vm:N(`vm`,60026),deviceDesktop:N(`device-desktop`,60026),file:N(`file`,60027),fileText:N(`file-text`,60027),more:N(`more`,60028),ellipsis:N(`ellipsis`,60028),kebabHorizontal:N(`kebab-horizontal`,60028),mailReply:N(`mail-reply`,60029),reply:N(`reply`,60029),organization:N(`organization`,60030),organizationFilled:N(`organization-filled`,60030),organizationOutline:N(`organization-outline`,60030),newFile:N(`new-file`,60031),fileAdd:N(`file-add`,60031),newFolder:N(`new-folder`,60032),fileDirectoryCreate:N(`file-directory-create`,60032),trash:N(`trash`,60033),trashcan:N(`trashcan`,60033),history:N(`history`,60034),clock:N(`clock`,60034),folder:N(`folder`,60035),fileDirectory:N(`file-directory`,60035),symbolFolder:N(`symbol-folder`,60035),logoGithub:N(`logo-github`,60036),markGithub:N(`mark-github`,60036),github:N(`github`,60036),terminal:N(`terminal`,60037),console:N(`console`,60037),repl:N(`repl`,60037),zap:N(`zap`,60038),symbolEvent:N(`symbol-event`,60038),error:N(`error`,60039),stop:N(`stop`,60039),variable:N(`variable`,60040),symbolVariable:N(`symbol-variable`,60040),array:N(`array`,60042),symbolArray:N(`symbol-array`,60042),symbolModule:N(`symbol-module`,60043),symbolPackage:N(`symbol-package`,60043),symbolNamespace:N(`symbol-namespace`,60043),symbolObject:N(`symbol-object`,60043),symbolMethod:N(`symbol-method`,60044),symbolFunction:N(`symbol-function`,60044),symbolConstructor:N(`symbol-constructor`,60044),symbolBoolean:N(`symbol-boolean`,60047),symbolNull:N(`symbol-null`,60047),symbolNumeric:N(`symbol-numeric`,60048),symbolNumber:N(`symbol-number`,60048),symbolStructure:N(`symbol-structure`,60049),symbolStruct:N(`symbol-struct`,60049),symbolParameter:N(`symbol-parameter`,60050),symbolTypeParameter:N(`symbol-type-parameter`,60050),symbolKey:N(`symbol-key`,60051),symbolText:N(`symbol-text`,60051),symbolReference:N(`symbol-reference`,60052),goToFile:N(`go-to-file`,60052),symbolEnum:N(`symbol-enum`,60053),symbolValue:N(`symbol-value`,60053),symbolRuler:N(`symbol-ruler`,60054),symbolUnit:N(`symbol-unit`,60054),activateBreakpoints:N(`activate-breakpoints`,60055),archive:N(`archive`,60056),arrowBoth:N(`arrow-both`,60057),arrowDown:N(`arrow-down`,60058),arrowLeft:N(`arrow-left`,60059),arrowRight:N(`arrow-right`,60060),arrowSmallDown:N(`arrow-small-down`,60061),arrowSmallLeft:N(`arrow-small-left`,60062),arrowSmallRight:N(`arrow-small-right`,60063),arrowSmallUp:N(`arrow-small-up`,60064),arrowUp:N(`arrow-up`,60065),bell:N(`bell`,60066),bold:N(`bold`,60067),book:N(`book`,60068),bookmark:N(`bookmark`,60069),debugBreakpointConditionalUnverified:N(`debug-breakpoint-conditional-unverified`,60070),debugBreakpointConditional:N(`debug-breakpoint-conditional`,60071),debugBreakpointConditionalDisabled:N(`debug-breakpoint-conditional-disabled`,60071),debugBreakpointDataUnverified:N(`debug-breakpoint-data-unverified`,60072),debugBreakpointData:N(`debug-breakpoint-data`,60073),debugBreakpointDataDisabled:N(`debug-breakpoint-data-disabled`,60073),debugBreakpointLogUnverified:N(`debug-breakpoint-log-unverified`,60074),debugBreakpointLog:N(`debug-breakpoint-log`,60075),debugBreakpointLogDisabled:N(`debug-breakpoint-log-disabled`,60075),briefcase:N(`briefcase`,60076),broadcast:N(`broadcast`,60077),browser:N(`browser`,60078),bug:N(`bug`,60079),calendar:N(`calendar`,60080),caseSensitive:N(`case-sensitive`,60081),check:N(`check`,60082),checklist:N(`checklist`,60083),chevronDown:N(`chevron-down`,60084),chevronLeft:N(`chevron-left`,60085),chevronRight:N(`chevron-right`,60086),chevronUp:N(`chevron-up`,60087),chromeClose:N(`chrome-close`,60088),chromeMaximize:N(`chrome-maximize`,60089),chromeMinimize:N(`chrome-minimize`,60090),chromeRestore:N(`chrome-restore`,60091),circleOutline:N(`circle-outline`,60092),circle:N(`circle`,60092),debugBreakpointUnverified:N(`debug-breakpoint-unverified`,60092),terminalDecorationIncomplete:N(`terminal-decoration-incomplete`,60092),circleSlash:N(`circle-slash`,60093),circuitBoard:N(`circuit-board`,60094),clearAll:N(`clear-all`,60095),clippy:N(`clippy`,60096),closeAll:N(`close-all`,60097),cloudDownload:N(`cloud-download`,60098),cloudUpload:N(`cloud-upload`,60099),code:N(`code`,60100),collapseAll:N(`collapse-all`,60101),colorMode:N(`color-mode`,60102),commentDiscussion:N(`comment-discussion`,60103),creditCard:N(`credit-card`,60105),dash:N(`dash`,60108),dashboard:N(`dashboard`,60109),database:N(`database`,60110),debugContinue:N(`debug-continue`,60111),debugDisconnect:N(`debug-disconnect`,60112),debugPause:N(`debug-pause`,60113),debugRestart:N(`debug-restart`,60114),debugStart:N(`debug-start`,60115),debugStepInto:N(`debug-step-into`,60116),debugStepOut:N(`debug-step-out`,60117),debugStepOver:N(`debug-step-over`,60118),debugStop:N(`debug-stop`,60119),debug:N(`debug`,60120),deviceCameraVideo:N(`device-camera-video`,60121),deviceCamera:N(`device-camera`,60122),deviceMobile:N(`device-mobile`,60123),diffAdded:N(`diff-added`,60124),diffIgnored:N(`diff-ignored`,60125),diffModified:N(`diff-modified`,60126),diffRemoved:N(`diff-removed`,60127),diffRenamed:N(`diff-renamed`,60128),diff:N(`diff`,60129),diffSidebyside:N(`diff-sidebyside`,60129),discard:N(`discard`,60130),editorLayout:N(`editor-layout`,60131),emptyWindow:N(`empty-window`,60132),exclude:N(`exclude`,60133),extensions:N(`extensions`,60134),eyeClosed:N(`eye-closed`,60135),fileBinary:N(`file-binary`,60136),fileCode:N(`file-code`,60137),fileMedia:N(`file-media`,60138),filePdf:N(`file-pdf`,60139),fileSubmodule:N(`file-submodule`,60140),fileSymlinkDirectory:N(`file-symlink-directory`,60141),fileSymlinkFile:N(`file-symlink-file`,60142),fileZip:N(`file-zip`,60143),files:N(`files`,60144),filter:N(`filter`,60145),flame:N(`flame`,60146),foldDown:N(`fold-down`,60147),foldUp:N(`fold-up`,60148),fold:N(`fold`,60149),folderActive:N(`folder-active`,60150),folderOpened:N(`folder-opened`,60151),gear:N(`gear`,60152),gift:N(`gift`,60153),gistSecret:N(`gist-secret`,60154),gist:N(`gist`,60155),gitCommit:N(`git-commit`,60156),gitCompare:N(`git-compare`,60157),compareChanges:N(`compare-changes`,60157),gitMerge:N(`git-merge`,60158),githubAction:N(`github-action`,60159),githubAlt:N(`github-alt`,60160),globe:N(`globe`,60161),grabber:N(`grabber`,60162),graph:N(`graph`,60163),gripper:N(`gripper`,60164),heart:N(`heart`,60165),home:N(`home`,60166),horizontalRule:N(`horizontal-rule`,60167),hubot:N(`hubot`,60168),inbox:N(`inbox`,60169),issueReopened:N(`issue-reopened`,60171),issues:N(`issues`,60172),italic:N(`italic`,60173),jersey:N(`jersey`,60174),json:N(`json`,60175),kebabVertical:N(`kebab-vertical`,60176),key:N(`key`,60177),law:N(`law`,60178),lightbulbAutofix:N(`lightbulb-autofix`,60179),linkExternal:N(`link-external`,60180),link:N(`link`,60181),listOrdered:N(`list-ordered`,60182),listUnordered:N(`list-unordered`,60183),liveShare:N(`live-share`,60184),loading:N(`loading`,60185),location:N(`location`,60186),mailRead:N(`mail-read`,60187),mail:N(`mail`,60188),markdown:N(`markdown`,60189),megaphone:N(`megaphone`,60190),mention:N(`mention`,60191),milestone:N(`milestone`,60192),gitPullRequestMilestone:N(`git-pull-request-milestone`,60192),mortarBoard:N(`mortar-board`,60193),move:N(`move`,60194),multipleWindows:N(`multiple-windows`,60195),mute:N(`mute`,60196),noNewline:N(`no-newline`,60197),note:N(`note`,60198),octoface:N(`octoface`,60199),openPreview:N(`open-preview`,60200),package:N(`package`,60201),paintcan:N(`paintcan`,60202),pin:N(`pin`,60203),play:N(`play`,60204),run:N(`run`,60204),plug:N(`plug`,60205),preserveCase:N(`preserve-case`,60206),preview:N(`preview`,60207),project:N(`project`,60208),pulse:N(`pulse`,60209),question:N(`question`,60210),quote:N(`quote`,60211),radioTower:N(`radio-tower`,60212),reactions:N(`reactions`,60213),references:N(`references`,60214),refresh:N(`refresh`,60215),regex:N(`regex`,60216),remoteExplorer:N(`remote-explorer`,60217),remote:N(`remote`,60218),remove:N(`remove`,60219),replaceAll:N(`replace-all`,60220),replace:N(`replace`,60221),repoClone:N(`repo-clone`,60222),repoForcePush:N(`repo-force-push`,60223),repoPull:N(`repo-pull`,60224),repoPush:N(`repo-push`,60225),report:N(`report`,60226),requestChanges:N(`request-changes`,60227),rocket:N(`rocket`,60228),rootFolderOpened:N(`root-folder-opened`,60229),rootFolder:N(`root-folder`,60230),rss:N(`rss`,60231),ruby:N(`ruby`,60232),saveAll:N(`save-all`,60233),saveAs:N(`save-as`,60234),save:N(`save`,60235),screenFull:N(`screen-full`,60236),screenNormal:N(`screen-normal`,60237),searchStop:N(`search-stop`,60238),server:N(`server`,60240),settingsGear:N(`settings-gear`,60241),settings:N(`settings`,60242),shield:N(`shield`,60243),smiley:N(`smiley`,60244),sortPrecedence:N(`sort-precedence`,60245),splitHorizontal:N(`split-horizontal`,60246),splitVertical:N(`split-vertical`,60247),squirrel:N(`squirrel`,60248),starFull:N(`star-full`,60249),starHalf:N(`star-half`,60250),symbolClass:N(`symbol-class`,60251),symbolColor:N(`symbol-color`,60252),symbolConstant:N(`symbol-constant`,60253),symbolEnumMember:N(`symbol-enum-member`,60254),symbolField:N(`symbol-field`,60255),symbolFile:N(`symbol-file`,60256),symbolInterface:N(`symbol-interface`,60257),symbolKeyword:N(`symbol-keyword`,60258),symbolMisc:N(`symbol-misc`,60259),symbolOperator:N(`symbol-operator`,60260),symbolProperty:N(`symbol-property`,60261),wrench:N(`wrench`,60261),wrenchSubaction:N(`wrench-subaction`,60261),symbolSnippet:N(`symbol-snippet`,60262),tasklist:N(`tasklist`,60263),telescope:N(`telescope`,60264),textSize:N(`text-size`,60265),threeBars:N(`three-bars`,60266),thumbsdown:N(`thumbsdown`,60267),thumbsup:N(`thumbsup`,60268),tools:N(`tools`,60269),triangleDown:N(`triangle-down`,60270),triangleLeft:N(`triangle-left`,60271),triangleRight:N(`triangle-right`,60272),triangleUp:N(`triangle-up`,60273),twitter:N(`twitter`,60274),unfold:N(`unfold`,60275),unlock:N(`unlock`,60276),unmute:N(`unmute`,60277),unverified:N(`unverified`,60278),verified:N(`verified`,60279),versions:N(`versions`,60280),vmActive:N(`vm-active`,60281),vmOutline:N(`vm-outline`,60282),vmRunning:N(`vm-running`,60283),watch:N(`watch`,60284),whitespace:N(`whitespace`,60285),wholeWord:N(`whole-word`,60286),window:N(`window`,60287),wordWrap:N(`word-wrap`,60288),zoomIn:N(`zoom-in`,60289),zoomOut:N(`zoom-out`,60290),listFilter:N(`list-filter`,60291),listFlat:N(`list-flat`,60292),listSelection:N(`list-selection`,60293),selection:N(`selection`,60293),listTree:N(`list-tree`,60294),debugBreakpointFunctionUnverified:N(`debug-breakpoint-function-unverified`,60295),debugBreakpointFunction:N(`debug-breakpoint-function`,60296),debugBreakpointFunctionDisabled:N(`debug-breakpoint-function-disabled`,60296),debugStackframeActive:N(`debug-stackframe-active`,60297),circleSmallFilled:N(`circle-small-filled`,60298),debugStackframeDot:N(`debug-stackframe-dot`,60298),terminalDecorationMark:N(`terminal-decoration-mark`,60298),debugStackframe:N(`debug-stackframe`,60299),debugStackframeFocused:N(`debug-stackframe-focused`,60299),debugBreakpointUnsupported:N(`debug-breakpoint-unsupported`,60300),symbolString:N(`symbol-string`,60301),debugReverseContinue:N(`debug-reverse-continue`,60302),debugStepBack:N(`debug-step-back`,60303),debugRestartFrame:N(`debug-restart-frame`,60304),debugAlt:N(`debug-alt`,60305),callIncoming:N(`call-incoming`,60306),callOutgoing:N(`call-outgoing`,60307),menu:N(`menu`,60308),expandAll:N(`expand-all`,60309),feedback:N(`feedback`,60310),gitPullRequestReviewer:N(`git-pull-request-reviewer`,60310),groupByRefType:N(`group-by-ref-type`,60311),ungroupByRefType:N(`ungroup-by-ref-type`,60312),account:N(`account`,60313),gitPullRequestAssignee:N(`git-pull-request-assignee`,60313),bellDot:N(`bell-dot`,60314),debugConsole:N(`debug-console`,60315),library:N(`library`,60316),output:N(`output`,60317),runAll:N(`run-all`,60318),syncIgnored:N(`sync-ignored`,60319),pinned:N(`pinned`,60320),githubInverted:N(`github-inverted`,60321),serverProcess:N(`server-process`,60322),serverEnvironment:N(`server-environment`,60323),pass:N(`pass`,60324),issueClosed:N(`issue-closed`,60324),stopCircle:N(`stop-circle`,60325),playCircle:N(`play-circle`,60326),record:N(`record`,60327),debugAltSmall:N(`debug-alt-small`,60328),vmConnect:N(`vm-connect`,60329),cloud:N(`cloud`,60330),merge:N(`merge`,60331),export:N(`export`,60332),graphLeft:N(`graph-left`,60333),magnet:N(`magnet`,60334),notebook:N(`notebook`,60335),redo:N(`redo`,60336),checkAll:N(`check-all`,60337),pinnedDirty:N(`pinned-dirty`,60338),passFilled:N(`pass-filled`,60339),circleLargeFilled:N(`circle-large-filled`,60340),circleLarge:N(`circle-large`,60341),circleLargeOutline:N(`circle-large-outline`,60341),combine:N(`combine`,60342),gather:N(`gather`,60342),table:N(`table`,60343),variableGroup:N(`variable-group`,60344),typeHierarchy:N(`type-hierarchy`,60345),typeHierarchySub:N(`type-hierarchy-sub`,60346),typeHierarchySuper:N(`type-hierarchy-super`,60347),gitPullRequestCreate:N(`git-pull-request-create`,60348),runAbove:N(`run-above`,60349),runBelow:N(`run-below`,60350),notebookTemplate:N(`notebook-template`,60351),debugRerun:N(`debug-rerun`,60352),workspaceTrusted:N(`workspace-trusted`,60353),workspaceUntrusted:N(`workspace-untrusted`,60354),workspaceUnknown:N(`workspace-unknown`,60355),terminalCmd:N(`terminal-cmd`,60356),terminalDebian:N(`terminal-debian`,60357),terminalLinux:N(`terminal-linux`,60358),terminalPowershell:N(`terminal-powershell`,60359),terminalTmux:N(`terminal-tmux`,60360),terminalUbuntu:N(`terminal-ubuntu`,60361),terminalBash:N(`terminal-bash`,60362),arrowSwap:N(`arrow-swap`,60363),copy:N(`copy`,60364),personAdd:N(`person-add`,60365),filterFilled:N(`filter-filled`,60366),wand:N(`wand`,60367),debugLineByLine:N(`debug-line-by-line`,60368),inspect:N(`inspect`,60369),layers:N(`layers`,60370),layersDot:N(`layers-dot`,60371),layersActive:N(`layers-active`,60372),compass:N(`compass`,60373),compassDot:N(`compass-dot`,60374),compassActive:N(`compass-active`,60375),azure:N(`azure`,60376),issueDraft:N(`issue-draft`,60377),gitPullRequestClosed:N(`git-pull-request-closed`,60378),gitPullRequestDraft:N(`git-pull-request-draft`,60379),debugAll:N(`debug-all`,60380),debugCoverage:N(`debug-coverage`,60381),runErrors:N(`run-errors`,60382),folderLibrary:N(`folder-library`,60383),debugContinueSmall:N(`debug-continue-small`,60384),beakerStop:N(`beaker-stop`,60385),graphLine:N(`graph-line`,60386),graphScatter:N(`graph-scatter`,60387),pieChart:N(`pie-chart`,60388),bracket:N(`bracket`,60175),bracketDot:N(`bracket-dot`,60389),bracketError:N(`bracket-error`,60390),lockSmall:N(`lock-small`,60391),azureDevops:N(`azure-devops`,60392),verifiedFilled:N(`verified-filled`,60393),newline:N(`newline`,60394),layout:N(`layout`,60395),layoutActivitybarLeft:N(`layout-activitybar-left`,60396),layoutActivitybarRight:N(`layout-activitybar-right`,60397),layoutPanelLeft:N(`layout-panel-left`,60398),layoutPanelCenter:N(`layout-panel-center`,60399),layoutPanelJustify:N(`layout-panel-justify`,60400),layoutPanelRight:N(`layout-panel-right`,60401),layoutPanel:N(`layout-panel`,60402),layoutSidebarLeft:N(`layout-sidebar-left`,60403),layoutSidebarRight:N(`layout-sidebar-right`,60404),layoutStatusbar:N(`layout-statusbar`,60405),layoutMenubar:N(`layout-menubar`,60406),layoutCentered:N(`layout-centered`,60407),target:N(`target`,60408),indent:N(`indent`,60409),recordSmall:N(`record-small`,60410),errorSmall:N(`error-small`,60411),terminalDecorationError:N(`terminal-decoration-error`,60411),arrowCircleDown:N(`arrow-circle-down`,60412),arrowCircleLeft:N(`arrow-circle-left`,60413),arrowCircleRight:N(`arrow-circle-right`,60414),arrowCircleUp:N(`arrow-circle-up`,60415),layoutSidebarRightOff:N(`layout-sidebar-right-off`,60416),layoutPanelOff:N(`layout-panel-off`,60417),layoutSidebarLeftOff:N(`layout-sidebar-left-off`,60418),blank:N(`blank`,60419),heartFilled:N(`heart-filled`,60420),map:N(`map`,60421),mapHorizontal:N(`map-horizontal`,60421),foldHorizontal:N(`fold-horizontal`,60421),mapFilled:N(`map-filled`,60422),mapHorizontalFilled:N(`map-horizontal-filled`,60422),foldHorizontalFilled:N(`fold-horizontal-filled`,60422),circleSmall:N(`circle-small`,60423),bellSlash:N(`bell-slash`,60424),bellSlashDot:N(`bell-slash-dot`,60425),commentUnresolved:N(`comment-unresolved`,60426),gitPullRequestGoToChanges:N(`git-pull-request-go-to-changes`,60427),gitPullRequestNewChanges:N(`git-pull-request-new-changes`,60428),searchFuzzy:N(`search-fuzzy`,60429),commentDraft:N(`comment-draft`,60430),send:N(`send`,60431),sparkle:N(`sparkle`,60432),insert:N(`insert`,60433),mic:N(`mic`,60434),thumbsdownFilled:N(`thumbsdown-filled`,60435),thumbsupFilled:N(`thumbsup-filled`,60436),coffee:N(`coffee`,60437),snake:N(`snake`,60438),game:N(`game`,60439),vr:N(`vr`,60440),chip:N(`chip`,60441),piano:N(`piano`,60442),music:N(`music`,60443),micFilled:N(`mic-filled`,60444),repoFetch:N(`repo-fetch`,60445),copilot:N(`copilot`,60446),lightbulbSparkle:N(`lightbulb-sparkle`,60447),robot:N(`robot`,60448),sparkleFilled:N(`sparkle-filled`,60449),diffSingle:N(`diff-single`,60450),diffMultiple:N(`diff-multiple`,60451),surroundWith:N(`surround-with`,60452),share:N(`share`,60453),gitStash:N(`git-stash`,60454),gitStashApply:N(`git-stash-apply`,60455),gitStashPop:N(`git-stash-pop`,60456),vscode:N(`vscode`,60457),vscodeInsiders:N(`vscode-insiders`,60458),codeOss:N(`code-oss`,60459),runCoverage:N(`run-coverage`,60460),runAllCoverage:N(`run-all-coverage`,60461),coverage:N(`coverage`,60462),githubProject:N(`github-project`,60463),mapVertical:N(`map-vertical`,60464),foldVertical:N(`fold-vertical`,60464),mapVerticalFilled:N(`map-vertical-filled`,60465),foldVerticalFilled:N(`fold-vertical-filled`,60465),goToSearch:N(`go-to-search`,60466),percentage:N(`percentage`,60467),sortPercentage:N(`sort-percentage`,60467),attach:N(`attach`,60468),goToEditingSession:N(`go-to-editing-session`,60469),editSession:N(`edit-session`,60470),codeReview:N(`code-review`,60471),copilotWarning:N(`copilot-warning`,60472),python:N(`python`,60473),copilotLarge:N(`copilot-large`,60474),copilotWarningLarge:N(`copilot-warning-large`,60475),keyboardTab:N(`keyboard-tab`,60476),copilotBlocked:N(`copilot-blocked`,60477),copilotNotConnected:N(`copilot-not-connected`,60478),flag:N(`flag`,60479),lightbulbEmpty:N(`lightbulb-empty`,60480),symbolMethodArrow:N(`symbol-method-arrow`,60481),copilotUnavailable:N(`copilot-unavailable`,60482),repoPinned:N(`repo-pinned`,60483),keyboardTabAbove:N(`keyboard-tab-above`,60484),keyboardTabBelow:N(`keyboard-tab-below`,60485),gitPullRequestDone:N(`git-pull-request-done`,60486),mcp:N(`mcp`,60487),extensionsLarge:N(`extensions-large`,60488),layoutPanelDock:N(`layout-panel-dock`,60489),layoutSidebarLeftDock:N(`layout-sidebar-left-dock`,60490),layoutSidebarRightDock:N(`layout-sidebar-right-dock`,60491),copilotInProgress:N(`copilot-in-progress`,60492),copilotError:N(`copilot-error`,60493),copilotSuccess:N(`copilot-success`,60494),chatSparkle:N(`chat-sparkle`,60495),searchSparkle:N(`search-sparkle`,60496),editSparkle:N(`edit-sparkle`,60497),copilotSnooze:N(`copilot-snooze`,60498),sendToRemoteAgent:N(`send-to-remote-agent`,60499)},ul={dialogError:N(`dialog-error`,`error`),dialogWarning:N(`dialog-warning`,`warning`),dialogInfo:N(`dialog-info`,`info`),dialogClose:N(`dialog-close`,`close`),treeItemExpanded:N(`tree-item-expanded`,`chevron-down`),treeFilterOnTypeOn:N(`tree-filter-on-type-on`,`list-filter`),treeFilterOnTypeOff:N(`tree-filter-on-type-off`,`list-selection`),treeFilterClear:N(`tree-filter-clear`,`close`),treeItemLoading:N(`tree-item-loading`,`loading`),menuSelection:N(`menu-selection`,`check`),menuSubmenu:N(`menu-submenu`,`chevron-right`),menuBarMore:N(`menubar-more`,`more`),scrollbarButtonLeft:N(`scrollbar-button-left`,`triangle-left`),scrollbarButtonRight:N(`scrollbar-button-right`,`triangle-right`),scrollbarButtonUp:N(`scrollbar-button-up`,`triangle-up`),scrollbarButtonDown:N(`scrollbar-button-down`,`triangle-down`),toolBarMore:N(`toolbar-more`,`more`),quickInputBack:N(`quick-input-back`,`arrow-left`),dropDownButton:N(`drop-down-button`,60084),symbolCustomColor:N(`symbol-customcolor`,60252),exportIcon:N(`export`,60332),workspaceUnspecified:N(`workspace-unspecified`,60355),newLine:N(`newline`,60394),thumbsDownFilled:N(`thumbsdown-filled`,60435),thumbsUpFilled:N(`thumbsup-filled`,60436),gitFetch:N(`git-fetch`,60445),lightbulbSparkleAutofix:N(`lightbulb-sparkle-autofix`,60447),debugBreakpointPending:N(`debug-breakpoint-pending`,60377)},P={...ll,...ul};var dl;(function(e){function t(e){return!!e&&typeof e==`object`&&typeof e.id==`string`}e.isThemeColor=t})(dl||={});var fl;(function(e){e.iconNameSegment=`[A-Za-z0-9]+`,e.iconNameExpression=`[A-Za-z0-9-]+`,e.iconModifierExpression=`~[A-Za-z]+`,e.iconNameCharacter=`[A-Za-z0-9~-]`;let t=RegExp(`^(${e.iconNameExpression})(${e.iconModifierExpression})?$`);function n(e){let r=t.exec(e.id);if(!r)return n(P.error);let[,i,a]=r,o=[`codicon`,`codicon-`+i];return a&&o.push(`codicon-modifier-`+a.substring(1)),o}e.asClassNameArray=n;function r(e){return n(e).join(` `)}e.asClassName=r;function i(e){return`.`+n(e).join(`.`)}e.asCSSSelector=i;function a(e){return!!e&&typeof e==`object`&&typeof e.id==`string`&&(e.color===void 0||dl.isThemeColor(e.color))}e.isThemeIcon=a;let o=RegExp(`^\\$\\((${e.iconNameExpression}(?:${e.iconModifierExpression})?)\\)$`);function s(e){let t=o.exec(e);if(!t)return;let[,n]=t;return{id:n}}e.fromString=s;function c(e){return{id:e}}e.fromId=c;function l(e,t){let n=e.id,r=n.lastIndexOf(`~`);return r!==-1&&(n=n.substring(0,r)),t&&(n=`${n}~${t}`),{id:n}}e.modify=l;function u(e){let t=e.id.lastIndexOf(`~`);if(t!==-1)return e.id.substring(t+1)}e.getModifier=u;function d(e,t){return e.id===t.id&&e.color?.id===t.color?.id}e.isEqual=d})(fl||={});const pl=RegExp(`\\$\\(${fl.iconNameExpression}(?:${fl.iconModifierExpression})?\\)`,`g`),ml=RegExp(`(\\\\)?${pl.source}`,`g`);function hl(e){return e.replace(ml,(e,t)=>t?e:`\\${e}`)}RegExp(`\\\\${pl.source}`,`g`),RegExp(`(\\s)?(\\\\)?${pl.source}(\\s)?`,`g`),RegExp(`\\$\\(${fl.iconNameCharacter}+\\)`,`g`);var gl;(function(e){e[e.Paragraph=0]=`Paragraph`,e[e.Break=1]=`Break`})(gl||={});var _l=class e{static lift(t){let n=new e(t.value,t);return n.uris=t.uris,n.baseUri=t.baseUri?w.revive(t.baseUri):void 0,n}constructor(e=``,t=!1){if(this.value=e,typeof this.value!=`string`)throw h(`value`);typeof t==`boolean`?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=gl.Paragraph){return this.value+=yl(this.supportThemeIcons?hl(e):e).replace(/([ \t]+)/g,(e,t)=>`&nbsp;`.repeat(t.length)).replace(/\>/gm,`\\>`).replace(/\n/g,t===gl.Break?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`\n${bl(t,e)}\n`,this}appendLink(e,t,n){return this.value+=`[`,this.value+=this._escape(t,`]`),this.value+=`](`,this.value+=this._escape(String(e),`)`),n&&(this.value+=` "${this._escape(this._escape(n,`"`),`)`)}"`),this.value+=`)`,this}_escape(e,t){let n=new RegExp(zi(t),`g`);return e.replace(n,(t,n)=>e.charAt(n-1)===`\\`?t:`\\${t}`)}};function vl(e){return e instanceof _l?!0:e&&typeof e==`object`?typeof e.value==`string`&&(typeof e.isTrusted==`boolean`||typeof e.isTrusted==`object`||e.isTrusted===void 0)&&(typeof e.supportThemeIcons==`boolean`||e.supportThemeIcons===void 0):!1}function yl(e){return e.replace(/[\\`*_{}[\]()#+\-!~]/g,`\\$&`)}function bl(e,t){let n=e.match(/^`+/gm)?.reduce((e,t)=>e.length>t.length?e:t).length??0,r=n>=3?n+1:3;return[`${"`".repeat(r)}${t}`,e,`${"`".repeat(r)}`].join(`
`)}function xl(e){let t=[],n=e.split(`|`).map(e=>e.trim());e=n[0];let r=n[1];if(r){let e=/height=(\d+)/.exec(r),n=/width=(\d+)/.exec(r),i=e?e[1]:``,a=n?n[1]:``,o=isFinite(parseInt(a)),s=isFinite(parseInt(i));o&&t.push(`width="${a}"`),s&&t.push(`height="${i}"`)}return{href:e,dimensions:t}}function Sl(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Cl=Sl();function wl(e){Cl=e}const Tl=/[&<>"']/,El=new RegExp(Tl.source,`g`),Dl=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Ol=new RegExp(Dl.source,`g`),kl={"&":`&amp;`,"<":`&lt;`,">":`&gt;`,'"':`&quot;`,"'":`&#39;`},Al=e=>kl[e];function jl(e,t){if(t){if(Tl.test(e))return e.replace(El,Al)}else if(Dl.test(e))return e.replace(Ol,Al);return e}const Ml=/(^|[^\[])\^/g;function Nl(e,t){let n=typeof e==`string`?e:e.source;t||=``;let r={replace:(e,t)=>{let i=typeof t==`string`?t:t.source;return i=i.replace(Ml,`$1`),n=n.replace(e,i),r},getRegex:()=>new RegExp(n,t)};return r}function Pl(e){try{e=encodeURI(e).replace(/%25/g,`%`)}catch{return null}return e}const Fl={exec:()=>null};function Il(e,t){let n=e.replace(/\|/g,(e,t,n)=>{let r=!1,i=t;for(;--i>=0&&n[i]===`\\`;)r=!r;return r?`|`:` |`}),r=n.split(/ \|/),i=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push(``);for(;i<r.length;i++)r[i]=r[i].trim().replace(/\\\|/g,`|`);return r}function Ll(e,t,n){let r=e.length;if(r===0)return``;let i=0;for(;i<r;){let a=e.charAt(r-i-1);if(a===t&&!n)i++;else if(a!==t&&n)i++;else break}return e.slice(0,r-i)}function Rl(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]===`\\`)r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return-1}function zl(e,t,n,r){let i=t.href,a=t.title?jl(t.title):null,o=e[1].replace(/\\([\[\]])/g,`$1`);if(e[0].charAt(0)!==`!`){r.state.inLink=!0;let e={type:`link`,raw:n,href:i,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,e}return{type:`image`,raw:n,href:i,title:a,text:jl(o)}}function Bl(e,t){let n=e.match(/^(\s+)(?:```)/);if(n===null)return t;let r=n[1];return t.split(`
`).map(e=>{let t=e.match(/^\s+/);if(t===null)return e;let[n]=t;return n.length>=r.length?e.slice(r.length):e}).join(`
`)}var Vl=class{options;rules;lexer;constructor(e){this.options=e||Cl}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:`space`,raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let e=t[0].replace(/^ {1,4}/gm,``);return{type:`code`,raw:t[0],codeBlockStyle:`indented`,text:this.options.pedantic?e:Ll(e,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let e=t[0],n=Bl(e,t[3]||``);return{type:`code`,raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,`$1`):t[2],text:n}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(/#$/.test(e)){let t=Ll(e,`#`);(this.options.pedantic||!t||/ $/.test(t))&&(e=t.trim())}return{type:`heading`,raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:`hr`,raw:Ll(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let e=Ll(t[0],`
`).split(`
`),n=``,r=``,i=[];for(;e.length>0;){let t=!1,a=[],o;for(o=0;o<e.length;o++)if(/^ {0,3}>/.test(e[o]))a.push(e[o]),t=!0;else if(!t)a.push(e[o]);else break;e=e.slice(o);let s=a.join(`
`),c=s.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,``);n=n?`${n}\n${s}`:s,r=r?`${r}\n${c}`:c;let l=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(c,i,!0),this.lexer.state.top=l,e.length===0)break;let u=i[i.length-1];if(u?.type===`code`)break;if(u?.type===`blockquote`){let t=u,a=t.raw+`
`+e.join(`
`),o=this.blockquote(a);i[i.length-1]=o,n=n.substring(0,n.length-t.raw.length)+o.raw,r=r.substring(0,r.length-t.text.length)+o.text;break}else if(u?.type===`list`){let t=u,a=t.raw+`
`+e.join(`
`),o=this.list(a);i[i.length-1]=o,n=n.substring(0,n.length-u.raw.length)+o.raw,r=r.substring(0,r.length-t.raw.length)+o.raw,e=a.substring(i[i.length-1].raw.length).split(`
`);continue}}return{type:`blockquote`,raw:n,tokens:i,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),r=n.length>1,i={type:`list`,raw:``,ordered:r,start:r?+n.slice(0,-1):``,loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:`[*+-]`);let a=RegExp(`^( {0,3}${n})((?:[\t ][^\\n]*)?(?:\\n|$))`),o=!1;for(;e;){let n=!1,r=``,s=``;if(!(t=a.exec(e))||this.rules.block.hr.test(e))break;r=t[0],e=e.substring(r.length);let c=t[2].split(`
`,1)[0].replace(/^\t+/,e=>` `.repeat(3*e.length)),l=e.split(`
`,1)[0],u=!c.trim(),d=0;if(this.options.pedantic?(d=2,s=c.trimStart()):u?d=t[1].length+1:(d=t[2].search(/[^ ]/),d=d>4?1:d,s=c.slice(d),d+=t[1].length),u&&/^ *$/.test(l)&&(r+=l+`
`,e=e.substring(l.length+1),n=!0),!n){let t=RegExp(`^ {0,${Math.min(3,d-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),n=RegExp(`^ {0,${Math.min(3,d-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),i=RegExp(`^ {0,${Math.min(3,d-1)}}(?:\`\`\`|~~~)`),a=RegExp(`^ {0,${Math.min(3,d-1)}}#`);for(;e;){let o=e.split(`
`,1)[0];if(l=o,this.options.pedantic&&(l=l.replace(/^ {1,4}(?=( {4})*[^ ])/g,`  `)),i.test(l)||a.test(l)||t.test(l)||n.test(e))break;if(l.search(/[^ ]/)>=d||!l.trim())s+=`
`+l.slice(d);else{if(u||c.search(/[^ ]/)>=4||i.test(c)||a.test(c)||n.test(c))break;s+=`
`+l}!u&&!l.trim()&&(u=!0),r+=o+`
`,e=e.substring(o.length+1),c=l.slice(d)}}i.loose||(o?i.loose=!0:/\n *\n *$/.test(r)&&(o=!0));let f=null,p;this.options.gfm&&(f=/^\[[ xX]\] /.exec(s),f&&(p=f[0]!==`[ ] `,s=s.replace(/^\[[ xX]\] +/,``))),i.items.push({type:`list_item`,raw:r,task:!!f,checked:p,loose:!1,text:s,tokens:[]}),i.raw+=r}i.items[i.items.length-1].raw=i.items[i.items.length-1].raw.trimEnd(),i.items[i.items.length-1].text=i.items[i.items.length-1].text.trimEnd(),i.raw=i.raw.trimEnd();for(let e=0;e<i.items.length;e++)if(this.lexer.state.top=!1,i.items[e].tokens=this.lexer.blockTokens(i.items[e].text,[]),!i.loose){let t=i.items[e].tokens.filter(e=>e.type===`space`),n=t.length>0&&t.some(e=>/\n.*\n/.test(e.raw));i.loose=n}if(i.loose)for(let e=0;e<i.items.length;e++)i.items[e].loose=!0;return i}}html(e){let t=this.rules.block.html.exec(e);if(t){let e={type:`html`,block:!0,raw:t[0],pre:t[1]===`pre`||t[1]===`script`||t[1]===`style`,text:t[0]};return e}}def(e){let t=this.rules.block.def.exec(e);if(t){let e=t[1].toLowerCase().replace(/\s+/g,` `),n=t[2]?t[2].replace(/^<(.*)>$/,`$1`).replace(this.rules.inline.anyPunctuation,`$1`):``,r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,`$1`):t[3];return{type:`def`,tag:e,raw:t[0],href:n,title:r}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;let n=Il(t[1]),r=t[2].replace(/^\||\| *$/g,``).split(`|`),i=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,``).split(`
`):[],a={type:`table`,raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let e of r)/^ *-+: *$/.test(e)?a.align.push(`right`):/^ *:-+: *$/.test(e)?a.align.push(`center`):/^ *:-+ *$/.test(e)?a.align.push(`left`):a.align.push(null);for(let e=0;e<n.length;e++)a.header.push({text:n[e],tokens:this.lexer.inline(n[e]),header:!0,align:a.align[e]});for(let e of i)a.rows.push(Il(e,a.header.length).map((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:a.align[t]})));return a}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:`heading`,raw:t[0],depth:t[2].charAt(0)===`=`?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let e=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:`paragraph`,raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:`text`,raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:`escape`,raw:t[0],text:jl(t[1])}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:`html`,raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let e=t[2].trim();if(!this.options.pedantic&&/^</.test(e)){if(!/>$/.test(e))return;let t=Ll(e.slice(0,-1),`\\`);if((e.length-t.length)%2==0)return}else{let e=Rl(t[2],`()`);if(e>-1){let n=t[0].indexOf(`!`)===0?5:4,r=n+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,r).trim(),t[3]=``}}let n=t[2],r=``;if(this.options.pedantic){let e=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);e&&(n=e[1],r=e[3])}else r=t[3]?t[3].slice(1,-1):``;return n=n.trim(),/^</.test(n)&&(n=this.options.pedantic&&!/>$/.test(e)?n.slice(1):n.slice(1,-1)),zl(t,{href:n&&n.replace(this.rules.inline.anyPunctuation,`$1`),title:r&&r.replace(this.rules.inline.anyPunctuation,`$1`)},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let e=(n[2]||n[1]).replace(/\s+/g,` `),r=t[e.toLowerCase()];if(!r){let e=n[0].charAt(0);return{type:`text`,raw:e,text:e}}return zl(n,r,n[0],this.lexer)}}emStrong(e,t,n=``){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(/[\p{L}\p{N}]/u))return;let i=r[1]||r[2]||``;if(!i||!n||this.rules.inline.punctuation.exec(n)){[...r[0]].length-1;let n,i,a=0,o=r[0][0]===`*`?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(o.lastIndex=0,t=t.slice(-1*e.length+0);(r=o.exec(t))!=null;){if(n=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!n)continue;if(i=[...n].length,r[3]||r[4]){a+=i;continue}else r[5]||r[6];if(a-=i,a>0)continue;i=Math.min(i,i+a+0);let t=[...r[0]][0].length,o=e.slice(0,0+r.index+t+i);if(Math.min(0,i)%2){let e=o.slice(1,-1);return{type:`em`,raw:o,text:e,tokens:this.lexer.inlineTokens(e)}}let s=o.slice(2,-2);return{type:`strong`,raw:o,text:s,tokens:this.lexer.inlineTokens(s)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(/\n/g,` `),n=/[^ ]/.test(e),r=/^ /.test(e)&&/ $/.test(e);return n&&r&&(e=e.substring(1,e.length-1)),e=jl(e,!0),{type:`codespan`,raw:t[0],text:e}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:`br`,raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:`del`,raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let e,n;return t[2]===`@`?(e=jl(t[1]),n=`mailto:`+e):(e=jl(t[1]),n=e),{type:`link`,raw:t[0],text:e,href:n,tokens:[{type:`text`,raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,n;if(t[2]===`@`)e=jl(t[0]),n=`mailto:`+e;else{let r;do r=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??``;while(r!==t[0]);e=jl(t[0]),n=t[1]===`www.`?`http://`+t[0]:t[0]}return{type:`link`,raw:t[0],text:e,href:n,tokens:[{type:`text`,raw:e,text:e}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let e;return e=this.lexer.state.inRawBlock?t[0]:jl(t[0]),{type:`text`,raw:t[0],text:e}}}};const Hl=/^(?: *(?:\n|$))+/,Ul=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,Wl=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Gl=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Kl=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,ql=/(?:[*+-]|\d{1,9}[.)])/,Jl=Nl(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,ql).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Yl=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Xl=/^[^\n]+/,Zl=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Ql=Nl(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace(`label`,Zl).replace(`title`,/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),$l=Nl(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,ql).getRegex(),eu=`address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul`,tu=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,nu=Nl(`^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))`,`i`).replace(`comment`,tu).replace(`tag`,eu).replace(`attribute`,/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ru=Nl(Yl).replace(`hr`,Gl).replace(`heading`,` {0,3}#{1,6}(?:\\s|$)`).replace(`|lheading`,``).replace(`|table`,``).replace(`blockquote`,` {0,3}>`).replace(`fences`," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace(`list`,` {0,3}(?:[*+-]|1[.)]) `).replace(`html`,`</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)`).replace(`tag`,eu).getRegex(),iu=Nl(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace(`paragraph`,ru).getRegex(),au={blockquote:iu,code:Ul,def:Ql,fences:Wl,heading:Kl,hr:Gl,html:nu,lheading:Jl,list:$l,newline:Hl,paragraph:ru,table:Fl,text:Xl},ou=Nl(`^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)`).replace(`hr`,Gl).replace(`heading`,` {0,3}#{1,6}(?:\\s|$)`).replace(`blockquote`,` {0,3}>`).replace(`code`,` {4}[^\\n]`).replace(`fences`," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace(`list`,` {0,3}(?:[*+-]|1[.)]) `).replace(`html`,`</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)`).replace(`tag`,eu).getRegex(),su={...au,table:ou,paragraph:Nl(Yl).replace(`hr`,Gl).replace(`heading`,` {0,3}#{1,6}(?:\\s|$)`).replace(`|lheading`,``).replace(`table`,ou).replace(`blockquote`,` {0,3}>`).replace(`fences`," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace(`list`,` {0,3}(?:[*+-]|1[.)]) `).replace(`html`,`</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)`).replace(`tag`,eu).getRegex()},cu={...au,html:Nl(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace(`comment`,tu).replace(/tag/g,`(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b`).getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Fl,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Nl(Yl).replace(`hr`,Gl).replace(`heading`,` *#{1,6} *[^
]`).replace(`lheading`,Jl).replace(`|table`,``).replace(`blockquote`,` {0,3}>`).replace(`|fences`,``).replace(`|list`,``).replace(`|html`,``).replace(`|tag`,``).getRegex()},lu=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,uu=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,du=/^( {2,}|\\)\n(?!\s*$)/,fu=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,pu=`\\p{P}\\p{S}`,mu=Nl(/^((?![*_])[\spunctuation])/,`u`).replace(/punctuation/g,pu).getRegex(),hu=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,gu=Nl(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,`u`).replace(/punct/g,pu).getRegex(),_u=Nl(`^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])`,`gu`).replace(/punct/g,pu).getRegex(),vu=Nl(`^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])`,`gu`).replace(/punct/g,pu).getRegex(),yu=Nl(/\\([punct])/,`gu`).replace(/punct/g,pu).getRegex(),bu=Nl(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace(`scheme`,/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace(`email`,/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),xu=Nl(tu).replace(`(?:-->|$)`,`-->`).getRegex(),Su=Nl(`^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>`).replace(`comment`,xu).replace(`attribute`,/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Cu=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,wu=Nl(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace(`label`,Cu).replace(`href`,/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace(`title`,/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Tu=Nl(/^!?\[(label)\]\[(ref)\]/).replace(`label`,Cu).replace(`ref`,Zl).getRegex(),Eu=Nl(/^!?\[(ref)\](?:\[\])?/).replace(`ref`,Zl).getRegex(),Du=Nl(`reflink|nolink(?!\\()`,`g`).replace(`reflink`,Tu).replace(`nolink`,Eu).getRegex(),Ou={_backpedal:Fl,anyPunctuation:yu,autolink:bu,blockSkip:hu,br:du,code:uu,del:Fl,emStrongLDelim:gu,emStrongRDelimAst:_u,emStrongRDelimUnd:vu,escape:lu,link:wu,nolink:Eu,punctuation:mu,reflink:Tu,reflinkSearch:Du,tag:Su,text:fu,url:Fl},ku={...Ou,link:Nl(/^!?\[(label)\]\((.*?)\)/).replace(`label`,Cu).getRegex(),reflink:Nl(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace(`label`,Cu).getRegex()},Au={...Ou,escape:Nl(lu).replace(`])`,`~|])`).getRegex(),url:Nl(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,`i`).replace(`email`,/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},ju={...Au,br:Nl(du).replace(`{2,}`,`*`).getRegex(),text:Nl(Au.text).replace(`\\b_`,`\\b_| {2,}\\n`).replace(/\{2,\}/g,`*`).getRegex()},Mu={normal:au,gfm:su,pedantic:cu},Nu={normal:Ou,gfm:Au,breaks:ju,pedantic:ku};var Pu=class e{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Cl,this.options.tokenizer=this.options.tokenizer||new Vl,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={block:Mu.normal,inline:Nu.normal};this.options.pedantic?(t.block=Mu.pedantic,t.inline=Nu.pedantic):this.options.gfm&&(t.block=Mu.gfm,this.options.breaks?t.inline=Nu.breaks:t.inline=Nu.gfm),this.tokenizer.rules=t}static get rules(){return{block:Mu,inline:Nu}}static lex(t,n){let r=new e(n);return r.lex(t)}static lexInline(t,n){let r=new e(n);return r.inlineTokens(t)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){let t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){e=this.options.pedantic?e.replace(/\t/g,`    `).replace(/^ +$/gm,``):e.replace(/^( *)(\t+)/gm,(e,t,n)=>t+`    `.repeat(n.length));let r,i,a;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(n=>(r=n.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type===`paragraph`||i.type===`text`)?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type===`paragraph`||i.type===`text`)?(i.raw+=`
`+r.raw,i.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(a=e,this.options.extensions&&this.options.extensions.startBlock){let t=1/0,n=e.slice(1),r;this.options.extensions.startBlock.forEach(e=>{r=e.call({lexer:this},n),typeof r==`number`&&r>=0&&(t=Math.min(t,r))}),t<1/0&&t>=0&&(a=e.substring(0,t+1))}if(this.state.top&&(r=this.tokenizer.paragraph(a))){i=t[t.length-1],n&&i?.type===`paragraph`?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r),n=a.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&i.type===`text`?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(e){let t=`Infinite loop on byte: `+e.charCodeAt(0);if(this.options.silent){console.error(t);break}else throw Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,r,i,a=e,o,s,c;if(this.tokens.links){let e=Object.keys(this.tokens.links);if(e.length>0)for(;(o=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)e.includes(o[0].slice(o[0].lastIndexOf(`[`)+1,-1))&&(a=a.slice(0,o.index)+`[`+`a`.repeat(o[0].length-2)+`]`+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(o=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)a=a.slice(0,o.index)+`[`+`a`.repeat(o[0].length-2)+`]`+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(o=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,o.index)+`++`+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(s||(c=``),s=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(r=>(n=r.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&n.type===`text`&&r.type===`text`?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),r=t[t.length-1],r&&n.type===`text`&&r.type===`text`?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,a,c)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e))){e=e.substring(n.raw.length),t.push(n);continue}if(i=e,this.options.extensions&&this.options.extensions.startInline){let t=1/0,n=e.slice(1),r;this.options.extensions.startInline.forEach(e=>{r=e.call({lexer:this},n),typeof r==`number`&&r>=0&&(t=Math.min(t,r))}),t<1/0&&t>=0&&(i=e.substring(0,t+1))}if(n=this.tokenizer.inlineText(i)){e=e.substring(n.raw.length),n.raw.slice(-1)!==`_`&&(c=n.raw.slice(-1)),s=!0,r=t[t.length-1],r&&r.type===`text`?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(e){let t=`Infinite loop on byte: `+e.charCodeAt(0);if(this.options.silent){console.error(t);break}else throw Error(t)}}return t}},Fu=class{options;parser;constructor(e){this.options=e||Cl}space(e){return``}code({text:e,lang:t,escaped:n}){let r=(t||``).match(/^\S*/)?.[0],i=e.replace(/\n$/,``)+`
`;return r?`<pre><code class="language-`+jl(r)+`">`+(n?i:jl(i,!0))+`</code></pre>
`:`<pre><code>`+(n?i:jl(i,!0))+`</code></pre>
`}blockquote({tokens:e}){let t=this.parser.parse(e);return`<blockquote>\n${t}</blockquote>\n`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,r=``;for(let t=0;t<e.items.length;t++){let n=e.items[t];r+=this.listitem(n)}let i=t?`ol`:`ul`,a=t&&n!==1?` start="`+n+`"`:``;return`<`+i+a+`>
`+r+`</`+i+`>
`}listitem(e){let t=``;if(e.task){let n=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&e.tokens[0].type===`paragraph`?(e.tokens[0].text=n+` `+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type===`text`&&(e.tokens[0].tokens[0].text=n+` `+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:`text`,raw:n+` `,text:n+` `}):t+=n+` `}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>\n`}checkbox({checked:e}){return`<input `+(e?`checked="" `:``)+`disabled="" type="checkbox">`}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t=``,n=``;for(let t=0;t<e.header.length;t++)n+=this.tablecell(e.header[t]);t+=this.tablerow({text:n});let r=``;for(let t=0;t<e.rows.length;t++){let i=e.rows[t];n=``;for(let e=0;e<i.length;e++)n+=this.tablecell(i[e]);r+=this.tablerow({text:n})}return r&&=`<tbody>${r}</tbody>`,`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?`th`:`td`,r=e.align?`<${n} align="${e.align}">`:`<${n}>`;return r+t+`</${n}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return`<br>`}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let r=this.parser.parseInline(n),i=Pl(e);if(i===null)return r;e=i;let a=`<a href="`+e+`"`;return t&&(a+=` title="`+t+`"`),a+=`>`+r+`</a>`,a}image({href:e,title:t,text:n}){let r=Pl(e);if(r===null)return n;e=r;let i=`<img src="${e}" alt="${n}"`;return t&&(i+=` title="${t}"`),i+=`>`,i}text(e){return`tokens`in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}},Iu=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return``+e}image({text:e}){return``+e}br(){return``}},Lu=class e{options;renderer;textRenderer;constructor(e){this.options=e||Cl,this.options.renderer=this.options.renderer||new Fu,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Iu}static parse(t,n){let r=new e(n);return r.parse(t)}static parseInline(t,n){let r=new e(n);return r.parseInline(t)}parse(e,t=!0){let n=``;for(let r=0;r<e.length;r++){let i=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]){let e=i,t=this.options.extensions.renderers[e.type].call({parser:this},e);if(t!==!1||![`space`,`hr`,`heading`,`code`,`table`,`blockquote`,`list`,`html`,`paragraph`,`text`].includes(e.type)){n+=t||``;continue}}let a=i;switch(a.type){case`space`:n+=this.renderer.space(a);continue;case`hr`:n+=this.renderer.hr(a);continue;case`heading`:n+=this.renderer.heading(a);continue;case`code`:n+=this.renderer.code(a);continue;case`table`:n+=this.renderer.table(a);continue;case`blockquote`:n+=this.renderer.blockquote(a);continue;case`list`:n+=this.renderer.list(a);continue;case`html`:n+=this.renderer.html(a);continue;case`paragraph`:n+=this.renderer.paragraph(a);continue;case`text`:{let i=a,o=this.renderer.text(i);for(;r+1<e.length&&e[r+1].type===`text`;)i=e[++r],o+=`
`+this.renderer.text(i);t?n+=this.renderer.paragraph({type:`paragraph`,raw:o,text:o,tokens:[{type:`text`,raw:o,text:o}]}):n+=o;continue}default:{let e=`Token with "`+a.type+`" type was not found.`;if(this.options.silent)return console.error(e),``;throw Error(e)}}}return n}parseInline(e,t){t||=this.renderer;let n=``;for(let r=0;r<e.length;r++){let i=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]){let e=this.options.extensions.renderers[i.type].call({parser:this},i);if(e!==!1||![`escape`,`html`,`link`,`image`,`strong`,`em`,`codespan`,`br`,`del`,`text`].includes(i.type)){n+=e||``;continue}}let a=i;switch(a.type){case`escape`:n+=t.text(a);break;case`html`:n+=t.html(a);break;case`link`:n+=t.link(a);break;case`image`:n+=t.image(a);break;case`strong`:n+=t.strong(a);break;case`em`:n+=t.em(a);break;case`codespan`:n+=t.codespan(a);break;case`br`:n+=t.br(a);break;case`del`:n+=t.del(a);break;case`text`:n+=t.text(a);break;default:{let e=`Token with "`+a.type+`" type was not found.`;if(this.options.silent)return console.error(e),``;throw Error(e)}}}return n}},Ru=class{options;constructor(e){this.options=e||Cl}static passThroughHooks=new Set([`preprocess`,`postprocess`,`processAllTokens`]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}},zu=class{defaults=Sl();options=this.setOptions;parse=this.parseMarkdown(Pu.lex,Lu.parse);parseInline=this.parseMarkdown(Pu.lexInline,Lu.parseInline);Parser=Lu;Renderer=Fu;TextRenderer=Iu;Lexer=Pu;Tokenizer=Vl;Hooks=Ru;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(let r of e)switch(n=n.concat(t.call(this,r)),r.type){case`table`:{let e=r;for(let r of e.header)n=n.concat(this.walkTokens(r.tokens,t));for(let r of e.rows)for(let e of r)n=n.concat(this.walkTokens(e.tokens,t));break}case`list`:{let e=r;n=n.concat(this.walkTokens(e.items,t));break}default:{let e=r;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach(r=>{let i=e[r].flat(1/0);n=n.concat(this.walkTokens(i,t))}):e.tokens&&(n=n.concat(this.walkTokens(e.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(e=>{let n={...e};if(n.async=this.defaults.async||n.async||!1,e.extensions&&(e.extensions.forEach(e=>{if(!e.name)throw Error(`extension name required`);if(`renderer`in e){let n=t.renderers[e.name];n?t.renderers[e.name]=function(...t){let r=e.renderer.apply(this,t);return r===!1&&(r=n.apply(this,t)),r}:t.renderers[e.name]=e.renderer}if(`tokenizer`in e){if(!e.level||e.level!==`block`&&e.level!==`inline`)throw Error(`extension level must be 'block' or 'inline'`);let n=t[e.level];n?n.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&(e.level===`block`?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:e.level===`inline`&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}`childTokens`in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)}),n.extensions=t),e.renderer){let t=this.defaults.renderer||new Fu(this.defaults);for(let n in e.renderer){if(!(n in t))throw Error(`renderer '${n}' does not exist`);if([`options`,`parser`].includes(n))continue;let r=n,i=e.renderer[r],a=t[r];t[r]=(...e)=>{let n=i.apply(t,e);return n===!1&&(n=a.apply(t,e)),n||``}}n.renderer=t}if(e.tokenizer){let t=this.defaults.tokenizer||new Vl(this.defaults);for(let n in e.tokenizer){if(!(n in t))throw Error(`tokenizer '${n}' does not exist`);if([`options`,`rules`,`lexer`].includes(n))continue;let r=n,i=e.tokenizer[r],a=t[r];t[r]=(...e)=>{let n=i.apply(t,e);return n===!1&&(n=a.apply(t,e)),n}}n.tokenizer=t}if(e.hooks){let t=this.defaults.hooks||new Ru;for(let n in e.hooks){if(!(n in t))throw Error(`hook '${n}' does not exist`);if(n===`options`)continue;let r=n,i=e.hooks[r],a=t[r];Ru.passThroughHooks.has(n)?t[r]=e=>{if(this.defaults.async)return Promise.resolve(i.call(t,e)).then(e=>a.call(t,e));let n=i.call(t,e);return a.call(t,n)}:t[r]=(...e)=>{let n=i.apply(t,e);return n===!1&&(n=a.apply(t,e)),n}}n.hooks=t}if(e.walkTokens){let t=this.defaults.walkTokens,r=e.walkTokens;n.walkTokens=function(e){let n=[];return n.push(r.call(this,e)),t&&(n=n.concat(t.call(this,e))),n}}this.defaults={...this.defaults,...n}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Pu.lex(e,t??this.defaults)}parser(e,t){return Lu.parse(e,t??this.defaults)}parseMarkdown(e,t){let n=(n,r)=>{let i={...r},a={...this.defaults,...i},o=this.onError(!!a.silent,!!a.async);if(this.defaults.async===!0&&i.async===!1)return o(Error(`marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise.`));if(n==null)return o(Error(`marked(): input parameter is undefined or null`));if(typeof n!=`string`)return o(Error(`marked(): input parameter is of type `+Object.prototype.toString.call(n)+`, string expected`));if(a.hooks&&(a.hooks.options=a),a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(n):n).then(t=>e(t,a)).then(e=>a.hooks?a.hooks.processAllTokens(e):e).then(e=>a.walkTokens?Promise.all(this.walkTokens(e,a.walkTokens)).then(()=>e):e).then(e=>t(e,a)).then(e=>a.hooks?a.hooks.postprocess(e):e).catch(o);try{a.hooks&&(n=a.hooks.preprocess(n));let r=e(n,a);a.hooks&&(r=a.hooks.processAllTokens(r)),a.walkTokens&&this.walkTokens(r,a.walkTokens);let i=t(r,a);return a.hooks&&(i=a.hooks.postprocess(i)),i}catch(e){return o(e)}};return n}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let e=`<p>An error occurred:</p><pre>`+jl(n.message+``,!0)+`</pre>`;return t?Promise.resolve(e):e}if(t)return Promise.reject(n);throw n}}};const Bu=new zu;function Vu(e,t){return Bu.parse(e,t)}Vu.options=Vu.setOptions=function(e){return Bu.setOptions(e),Vu.defaults=Bu.defaults,wl(Vu.defaults),Vu},Vu.getDefaults=Sl,Vu.defaults=Cl,Vu.use=function(...e){return Bu.use(...e),Vu.defaults=Bu.defaults,wl(Vu.defaults),Vu},Vu.walkTokens=function(e,t){return Bu.walkTokens(e,t)},Vu.parseInline=Bu.parseInline,Vu.Parser=Lu,Vu.parser=Lu.parse,Vu.Renderer=Fu,Vu.TextRenderer=Iu,Vu.Lexer=Pu,Vu.lexer=Pu.lex,Vu.Tokenizer=Vl,Vu.Hooks=Ru,Vu.parse=Vu,Vu.options,Vu.setOptions,Vu.use,Vu.walkTokens,Vu.parseInline,Lu.parse,Pu.lex;function Hu(e){return JSON.stringify(e,Wu)}function Uu(e){let t=JSON.parse(e);return t=Gu(t),t}function Wu(e,t){return t instanceof RegExp?{$mid:Dn.Regexp,source:t.source,flags:t.flags}:t}function Gu(e,t=0){if(!e||t>200)return e;if(typeof e==`object`){switch(e.$mid){case Dn.Uri:return w.revive(e);case Dn.Regexp:return new RegExp(e.source,e.flags);case Dn.Date:return new Date(e.source)}if(e instanceof b||e instanceof Uint8Array)return e;if(Array.isArray(e))for(let n=0;n<e.length;++n)e[n]=Gu(e[n],t+1);else for(let n in e)Object.hasOwnProperty.call(e,n)&&(e[n]=Gu(e[n],t+1))}return e}const Ku=Object.freeze({text:`text/plain`,binary:`application/octet-stream`,unknown:`application/unknown`,markdown:`text/markdown`,latex:`text/latex`,uriList:`text/uri-list`,html:`text/html`}),qu=/^(.+)\/(.+?)(;.+)?$/;function Ju(e,t){let n=qu.exec(e);return n?`${n[1].toLowerCase()}/${n[2].toLowerCase()}${n[3]??``}`:t?void 0:e}const Yu=Symbol(`unset`);var Xu=class{constructor(){this.root=new Qu,this._size=0}get size(){return this._size}get nodes(){return this.root.children?.values()||pt.empty()}get entries(){return this.root.children?.entries()||pt.empty()}insert(e,t,n){this.opNode(e,e=>e._value=t,n)}mutate(e,t){this.opNode(e,e=>e._value=t(e._value===Yu?void 0:e._value))}mutatePath(e,t){this.opNode(e,()=>{},e=>t(e))}delete(e){let t=this.getPathToKey(e);if(!t)return;let n=t.length-1,r=t[n].node._value;if(r!==Yu){for(this._size--,t[n].node._value=Yu;n>0;n--){let{node:e,part:r}=t[n];if(e.children?.size||e._value!==Yu)break;t[n-1].node.children.delete(r)}return r}}*deleteRecursive(e){let t=this.getPathToKey(e);if(!t)return;let n=t[t.length-1].node;for(let e=t.length-1;e>0;e--){let n=t[e-1];if(n.node.children.delete(t[e].part),n.node.children.size>0||n.node._value!==Yu)break}for(let e of Zu(n))e._value!==Yu&&(this._size--,yield e._value);n===this.root&&(this.root._value=Yu,this.root.children=void 0)}find(e){let t=this.root;for(let n of e){let e=t.children?.get(n);if(!e)return;t=e}return t._value===Yu?void 0:t._value}hasKeyOrParent(e){let t=this.root;for(let n of e){let e=t.children?.get(n);if(!e)return!1;if(e._value!==Yu)return!0;t=e}return!1}hasKeyOrChildren(e){let t=this.root;for(let n of e){let e=t.children?.get(n);if(!e)return!1;t=e}return!0}hasKey(e){let t=this.root;for(let n of e){let e=t.children?.get(n);if(!e)return!1;t=e}return t._value!==Yu}getPathToKey(e){let t=[{part:``,node:this.root}],n=0;for(let r of e){let e=t[n].node.children?.get(r);if(!e)return;t.push({part:r,node:e}),n++}return t}opNode(e,t,n){let r=this.root;for(let t of e){if(r.children)if(r.children.has(t))r=r.children.get(t);else{let e=new Qu;r.children.set(t,e),r=e}else{let e=new Qu;r.children=new Map([[t,e]]),r=e}n?.(r)}let i=r._value===Yu?0:1;t(r);let a=r._value===Yu?0:1;this._size+=a-i}*values(){for(let{_value:e}of Zu(this.root))e!==Yu&&(yield e)}};function*Zu(e){let t=[e];for(;t.length>0;){let e=t.pop();if(yield e,e.children)for(let n of e.children.values())t.push(n)}}var Qu=class{constructor(){this._value=Yu}get value(){return this._value===Yu?void 0:this._value}set value(e){this._value=e===void 0?Yu:e}},$u;(function(e){e[e.Auto=1]=`Auto`,e[e.Hidden=2]=`Hidden`,e[e.Visible=3]=`Visible`})($u||={});const ed={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},td=`\`~!@#$%^&*()-=+[{]}\\|;:'",.<>/?`;function nd(e=``){let t=`(-?\\d*\\.\\d\\w*)|([^`;for(let n of td){if(e.indexOf(n)>=0)continue;t+=`\\`+n}return t+=`\\s]+)`,new RegExp(t,`g`)}const rd=nd();function id(e){let t=rd;if(e&&e instanceof RegExp)if(e.global)t=e;else{let n=`g`;e.ignoreCase&&(n+=`i`),e.multiline&&(n+=`m`),e.unicode&&(n+=`u`),t=new RegExp(e.source,n)}return t.lastIndex=0,t}const ad=new Zt;ad.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function od(e,t,n,r,i){if(t=id(t),i||=pt.first(ad),n.length>i.maxLen){let a=e-i.maxLen/2;return a<0?a=0:r+=a,n=n.substring(a,e+i.maxLen/2),od(e,t,n,r,i)}let a=Date.now(),o=e-1-r,s=-1,c=null;for(let e=1;!(Date.now()-a>=i.timeBudget);e++){let r=o-i.windowSize*e;t.lastIndex=Math.max(0,r);let a=sd(t,n,o,s);if(!a&&c||(c=a,r<=0))break;s=r}if(c){let e={word:c[0],startColumn:r+1+c.index,endColumn:r+1+c.index+c[0].length};return t.lastIndex=0,e}return null}function sd(e,t,n,r){let i;for(;i=e.exec(t);){let t=i.index||0;if(t<=n&&e.lastIndex>=n)return i;if(r>0&&t>r)return null}return null}var F;(function(e){e[e.LParen=0]=`LParen`,e[e.RParen=1]=`RParen`,e[e.Neg=2]=`Neg`,e[e.Eq=3]=`Eq`,e[e.NotEq=4]=`NotEq`,e[e.Lt=5]=`Lt`,e[e.LtEq=6]=`LtEq`,e[e.Gt=7]=`Gt`,e[e.GtEq=8]=`GtEq`,e[e.RegexOp=9]=`RegexOp`,e[e.RegexStr=10]=`RegexStr`,e[e.True=11]=`True`,e[e.False=12]=`False`,e[e.In=13]=`In`,e[e.Not=14]=`Not`,e[e.And=15]=`And`,e[e.Or=16]=`Or`,e[e.Str=17]=`Str`,e[e.QuotedStr=18]=`QuotedStr`,e[e.Error=19]=`Error`,e[e.EOF=20]=`EOF`})(F||={});function cd(...e){switch(e.length){case 1:return C(1766,`Did you mean {0}?`,e[0]);case 2:return C(1767,`Did you mean {0} or {1}?`,e[0],e[1]);case 3:return C(1768,`Did you mean {0}, {1} or {2}?`,e[0],e[1],e[2]);default:return}}const ld=C(1769,`Did you forget to open or close the quote?`),ud=C(1770,`Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.`);var dd=class e{constructor(){this._input=``,this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case F.LParen:return`(`;case F.RParen:return`)`;case F.Neg:return`!`;case F.Eq:return e.isTripleEq?`===`:`==`;case F.NotEq:return e.isTripleEq?`!==`:`!=`;case F.Lt:return`<`;case F.LtEq:return`<=`;case F.Gt:return`>=`;case F.GtEq:return`>=`;case F.RegexOp:return`=~`;case F.RegexStr:return e.lexeme;case F.True:return`true`;case F.False:return`false`;case F.In:return`in`;case F.Not:return`not`;case F.And:return`&&`;case F.Or:return`||`;case F.Str:return e.lexeme;case F.QuotedStr:return e.lexeme;case F.Error:return e.lexeme;case F.EOF:return`EOF`;default:throw le(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static{this._regexFlags=new Set([`i`,`g`,`s`,`m`,`y`,`u`].map(e=>e.charCodeAt(0)))}static{this._keywords=new Map([[`not`,F.Not],[`in`,F.In],[`false`,F.False],[`true`,F.True]])}get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();){this._start=this._current;let e=this._advance();switch(e){case S.OpenParen:this._addToken(F.LParen);break;case S.CloseParen:this._addToken(F.RParen);break;case S.ExclamationMark:if(this._match(S.Equals)){let e=this._match(S.Equals);this._tokens.push({type:F.NotEq,offset:this._start,isTripleEq:e})}else this._addToken(F.Neg);break;case S.SingleQuote:this._quotedString();break;case S.Slash:this._regex();break;case S.Equals:if(this._match(S.Equals)){let e=this._match(S.Equals);this._tokens.push({type:F.Eq,offset:this._start,isTripleEq:e})}else this._match(S.Tilde)?this._addToken(F.RegexOp):this._error(cd(`==`,`=~`));break;case S.LessThan:this._addToken(this._match(S.Equals)?F.LtEq:F.Lt);break;case S.GreaterThan:this._addToken(this._match(S.Equals)?F.GtEq:F.Gt);break;case S.Ampersand:this._match(S.Ampersand)?this._addToken(F.And):this._error(cd(`&&`));break;case S.Pipe:this._match(S.Pipe)?this._addToken(F.Or):this._error(cd(`||`));break;case S.Space:case S.CarriageReturn:case S.Tab:case S.LineFeed:case S.NoBreakSpace:break;default:this._string()}}return this._start=this._current,this._addToken(F.EOF),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?S.Null:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){let t=this._start,n=this._input.substring(this._start,this._current),r={type:F.Error,offset:this._start,lexeme:n};this._errors.push({offset:t,lexeme:n,additionalInfo:e}),this._tokens.push(r)}_string(){this.stringRe.lastIndex=this._start;let t=this.stringRe.exec(this._input);if(t){this._current=this._start+t[0].length;let n=this._input.substring(this._start,this._current),r=e._keywords.get(n);r?this._addToken(r):this._tokens.push({type:F.Str,lexeme:n,offset:this._start})}}_quotedString(){for(;this._peek()!==S.SingleQuote&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(ld);return}this._advance(),this._tokens.push({type:F.QuotedStr,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let t=this._current,n=!1,r=!1;for(;;){if(t>=this._input.length){this._current=t,this._error(ud);return}let e=this._input.charCodeAt(t);if(n)n=!1;else if(e===S.Slash&&!r){t++;break}else e===S.OpenSquareBracket?r=!0:e===S.Backslash?n=!0:e===S.CloseSquareBracket&&(r=!1);t++}for(;t<this._input.length&&e._regexFlags.has(this._input.charCodeAt(t));)t++;this._current=t;let i=this._input.substring(this._start,this._current);this._tokens.push({type:F.RegexStr,lexeme:i,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};const fd=new Map;fd.set(`false`,!1),fd.set(`true`,!0),fd.set(`isMac`,Zn),fd.set(`isLinux`,Qn),fd.set(`isWindows`,Xn),fd.set(`isWeb`,er),fd.set(`isMacNative`,Zn&&!er),fd.set(`isEdge`,yr),fd.set(`isFirefox`,_r),fd.set(`isChrome`,gr),fd.set(`isSafari`,vr);const pd=Object.prototype.hasOwnProperty;var md;(function(e){e[e.False=0]=`False`,e[e.True=1]=`True`,e[e.Defined=2]=`Defined`,e[e.Not=3]=`Not`,e[e.Equals=4]=`Equals`,e[e.NotEquals=5]=`NotEquals`,e[e.And=6]=`And`,e[e.Regex=7]=`Regex`,e[e.NotRegex=8]=`NotRegex`,e[e.Or=9]=`Or`,e[e.In=10]=`In`,e[e.NotIn=11]=`NotIn`,e[e.Greater=12]=`Greater`,e[e.GreaterEquals=13]=`GreaterEquals`,e[e.Smaller=14]=`Smaller`,e[e.SmallerEquals=15]=`SmallerEquals`})(md||={});const hd={regexParsingWithErrorRecovery:!0},gd=C(1746,`Empty context key expression`),_d=C(1747,`Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively.`),vd=C(1748,`'in' after 'not'.`),yd=C(1749,`closing parenthesis ')'`),bd=C(1750,`Unexpected token`),xd=C(1751,`Did you forget to put && or || before the token?`),Sd=C(1752,`Unexpected end of expression`),Cd=C(1753,`Did you forget to put a context key?`);var wd=class e{static{this._parseError=Error()}get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}constructor(e=hd){this._config=e,this._scanner=new dd,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(t){if(t===``){this._parsingErrors.push({message:gd,offset:0,lexeme:``,additionalInfo:_d});return}this._tokens=this._scanner.reset(t).scan(),this._current=0,this._parsingErrors=[];try{let t=this._expr();if(!this._isAtEnd()){let t=this._peek(),n=t.type===F.Str?xd:void 0;throw this._parsingErrors.push({message:bd,offset:t.offset,lexeme:dd.getLexeme(t),additionalInfo:n}),e._parseError}return t}catch(t){if(t!==e._parseError)throw t;return}}_expr(){return this._or()}_or(){let e=[this._and()];for(;this._matchOne(F.Or);){let t=this._and();e.push(t)}return e.length===1?e[0]:Td.or(...e)}_and(){let e=[this._term()];for(;this._matchOne(F.And);){let t=this._term();e.push(t)}return e.length===1?e[0]:Td.and(...e)}_term(){if(this._matchOne(F.Neg)){let e=this._peek();switch(e.type){case F.True:return this._advance(),Od.INSTANCE;case F.False:return this._advance(),kd.INSTANCE;case F.LParen:{this._advance();let e=this._expr();return this._consume(F.RParen,yd),e?.negate()}case F.Str:return this._advance(),Fd.create(e.lexeme);default:throw this._errExpectedButGot(`KEY | true | false | '(' expression ')'`,e)}}return this._primary()}_primary(){let t=this._peek();switch(t.type){case F.True:return this._advance(),Td.true();case F.False:return this._advance(),Td.false();case F.LParen:{this._advance();let e=this._expr();return this._consume(F.RParen,yd),e}case F.Str:{let e=t.lexeme;if(this._advance(),this._matchOne(F.RegexOp)){let t=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),t.type!==F.RegexStr)throw this._errExpectedButGot(`REGEX`,t);let n=t.lexeme,r=n.lastIndexOf(`/`),i=r===n.length-1?void 0:this._removeFlagsGY(n.substring(r+1)),a;try{a=new RegExp(n.substring(1,r),i)}catch{throw this._errExpectedButGot(`REGEX`,t)}return Vd.create(e,a)}switch(t.type){case F.RegexStr:case F.Error:{let n=[t.lexeme];this._advance();let r=this._peek(),i=0;for(let e=0;e<t.lexeme.length;e++)t.lexeme.charCodeAt(e)===S.OpenParen?i++:t.lexeme.charCodeAt(e)===S.CloseParen&&i--;for(;!this._isAtEnd()&&r.type!==F.And&&r.type!==F.Or;){switch(r.type){case F.LParen:i++;break;case F.RParen:i--;break;case F.RegexStr:case F.QuotedStr:for(let e=0;e<r.lexeme.length;e++)r.lexeme.charCodeAt(e)===S.OpenParen?i++:t.lexeme.charCodeAt(e)===S.CloseParen&&i--}if(i<0)break;n.push(dd.getLexeme(r)),this._advance(),r=this._peek()}let a=n.join(``),o=a.lastIndexOf(`/`),s=o===a.length-1?void 0:this._removeFlagsGY(a.substring(o+1)),c;try{c=new RegExp(a.substring(1,o),s)}catch{throw this._errExpectedButGot(`REGEX`,t)}return Td.regex(e,c)}case F.QuotedStr:{let n=t.lexeme;this._advance();let r=null;if(!Ii(n)){let e=n.indexOf(`/`),i=n.lastIndexOf(`/`);if(e!==i&&e>=0){let a=n.slice(e+1,i),o=n[i+1]===`i`?`i`:``;try{r=new RegExp(a,o)}catch{throw this._errExpectedButGot(`REGEX`,t)}}}if(r===null)throw this._errExpectedButGot(`REGEX`,t);return Vd.create(e,r)}default:throw this._errExpectedButGot(`REGEX`,this._peek())}}if(this._matchOne(F.Not)){this._consume(F.In,vd);let t=this._value();return Td.notIn(e,t)}let n=this._peek().type;switch(n){case F.Eq:{this._advance();let t=this._value();if(this._previous().type===F.QuotedStr)return Td.equals(e,t);switch(t){case`true`:return Td.has(e);case`false`:return Td.not(e);default:return Td.equals(e,t)}}case F.NotEq:{this._advance();let t=this._value();if(this._previous().type===F.QuotedStr)return Td.notEquals(e,t);switch(t){case`true`:return Td.not(e);case`false`:return Td.has(e);default:return Td.notEquals(e,t)}}case F.Lt:return this._advance(),zd.create(e,this._value());case F.LtEq:return this._advance(),Bd.create(e,this._value());case F.Gt:return this._advance(),Ld.create(e,this._value());case F.GtEq:return this._advance(),Rd.create(e,this._value());case F.In:return this._advance(),Td.in(e,this._value());default:return Td.has(e)}}case F.EOF:throw this._parsingErrors.push({message:Sd,offset:t.offset,lexeme:``,additionalInfo:Cd}),e._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){let e=this._peek();switch(e.type){case F.Str:case F.QuotedStr:return this._advance(),e.lexeme;case F.True:return this._advance(),`true`;case F.False:return this._advance(),`false`;case F.In:return this._advance(),`in`;default:return``}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,``)}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(t,n,r){let i=C(1754,`Expected: {0}
Received: '{1}'.`,t,dd.getLexeme(n)),a=n.offset,o=dd.getLexeme(n);return this._parsingErrors.push({message:i,offset:a,lexeme:o,additionalInfo:r}),e._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===F.EOF}},Td=class{static false(){return Od.INSTANCE}static true(){return kd.INSTANCE}static has(e){return Ad.create(e)}static equals(e,t){return jd.create(e,t)}static notEquals(e,t){return Pd.create(e,t)}static regex(e,t){return Vd.create(e,t)}static in(e,t){return Md.create(e,t)}static notIn(e,t){return Nd.create(e,t)}static not(e){return Fd.create(e)}static and(...e){return Wd.create(e,null,!0)}static or(...e){return Gd.create(e,null,!0)}static greater(e,t){return Ld.create(e,t)}static greaterEquals(e,t){return Rd.create(e,t)}static smaller(e,t){return zd.create(e,t)}static smallerEquals(e,t){return Bd.create(e,t)}static{this._parser=new wd({regexParsingWithErrorRecovery:!1})}static deserialize(e){if(e==null)return;let t=this._parser.parse(e);return t}};function Ed(e){let t=new wd({regexParsingWithErrorRecovery:!1});return e.map(e=>(t.parse(e),t.lexingErrors.length>0?t.lexingErrors.map(e=>({errorMessage:e.additionalInfo?C(1755,`Unexpected token. Hint: {0}`,e.additionalInfo):C(1756,`Unexpected token.`),offset:e.offset,length:e.lexeme.length})):t.parsingErrors.length>0?t.parsingErrors.map(e=>({errorMessage:e.additionalInfo?`${e.message}. ${e.additionalInfo}`:e.message,offset:e.offset,length:e.lexeme.length})):[]))}function Dd(e,t){return e.cmp(t)}var Od=class e{static{this.INSTANCE=new e}constructor(){this.type=md.False}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return`false`}keys(){return[]}map(e){return this}negate(){return kd.INSTANCE}},kd=class e{static{this.INSTANCE=new e}constructor(){this.type=md.True}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return`true`}keys(){return[]}map(e){return this}negate(){return Od.INSTANCE}},Ad=class e{static create(t,n=null){let r=fd.get(t);return typeof r==`boolean`?r?kd.INSTANCE:Od.INSTANCE:new e(t,n)}constructor(e,t){this.key=e,this.negated=t,this.type=md.Defined}cmp(e){return e.type===this.type?Kd(this.key,e.key):this.type-e.type}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=fd.get(this.key);return typeof e==`boolean`?e?kd.INSTANCE:Od.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||=Fd.create(this.key,this),this.negated}},jd=class e{static create(t,n,r=null){if(typeof n==`boolean`)return n?Ad.create(t,r):Fd.create(t,r);let i=fd.get(t);if(typeof i==`boolean`){let e=i?`true`:`false`;return n===e?kd.INSTANCE:Od.INSTANCE}return new e(t,n,r)}constructor(e,t,n){this.key=e,this.value=t,this.negated=n,this.type=md.Equals}cmp(e){return e.type===this.type?qd(this.key,this.value,e.key,e.value):this.type-e.type}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=fd.get(this.key);if(typeof e==`boolean`){let t=e?`true`:`false`;return this.value===t?kd.INSTANCE:Od.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||=Pd.create(this.key,this.value,this),this.negated}},Md=class e{static create(t,n){return new e(t,n)}constructor(e,t){this.key=e,this.valueKey=t,this.type=md.In,this.negated=null}cmp(e){return e.type===this.type?qd(this.key,this.valueKey,e.key,e.valueKey):this.type-e.type}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.valueKey),n=e.getValue(this.key);return Array.isArray(t)?t.includes(n):typeof n==`string`&&typeof t==`object`&&t?pd.call(t,n):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||=Nd.create(this.key,this.valueKey),this.negated}},Nd=class e{static create(t,n){return new e(t,n)}constructor(e,t){this.key=e,this.valueKey=t,this.type=md.NotIn,this._negated=Md.create(e,t)}cmp(e){return e.type===this.type?this._negated.cmp(e._negated):this.type-e.type}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}},Pd=class e{static create(t,n,r=null){if(typeof n==`boolean`)return n?Fd.create(t,r):Ad.create(t,r);let i=fd.get(t);if(typeof i==`boolean`){let e=i?`true`:`false`;return n===e?Od.INSTANCE:kd.INSTANCE}return new e(t,n,r)}constructor(e,t,n){this.key=e,this.value=t,this.negated=n,this.type=md.NotEquals}cmp(e){return e.type===this.type?qd(this.key,this.value,e.key,e.value):this.type-e.type}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){let e=fd.get(this.key);if(typeof e==`boolean`){let t=e?`true`:`false`;return this.value===t?Od.INSTANCE:kd.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||=jd.create(this.key,this.value,this),this.negated}},Fd=class e{static create(t,n=null){let r=fd.get(t);return typeof r==`boolean`?r?Od.INSTANCE:kd.INSTANCE:new e(t,n)}constructor(e,t){this.key=e,this.negated=t,this.type=md.Not}cmp(e){return e.type===this.type?Kd(this.key,e.key):this.type-e.type}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){let e=fd.get(this.key);return typeof e==`boolean`?e?Od.INSTANCE:kd.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||=Ad.create(this.key,this),this.negated}};function Id(e,t){if(typeof e==`string`){let t=parseFloat(e);isNaN(t)||(e=t)}return typeof e==`string`||typeof e==`number`?t(e):Od.INSTANCE}var Ld=class e{static create(t,n,r=null){return Id(n,n=>new e(t,n,r))}constructor(e,t,n){this.key=e,this.value=t,this.negated=n,this.type=md.Greater}cmp(e){return e.type===this.type?qd(this.key,this.value,e.key,e.value):this.type-e.type}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value==`string`?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||=Bd.create(this.key,this.value,this),this.negated}},Rd=class e{static create(t,n,r=null){return Id(n,n=>new e(t,n,r))}constructor(e,t,n){this.key=e,this.value=t,this.negated=n,this.type=md.GreaterEquals}cmp(e){return e.type===this.type?qd(this.key,this.value,e.key,e.value):this.type-e.type}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value==`string`?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||=zd.create(this.key,this.value,this),this.negated}},zd=class e{static create(t,n,r=null){return Id(n,n=>new e(t,n,r))}constructor(e,t,n){this.key=e,this.value=t,this.negated=n,this.type=md.Smaller}cmp(e){return e.type===this.type?qd(this.key,this.value,e.key,e.value):this.type-e.type}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value==`string`?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||=Rd.create(this.key,this.value,this),this.negated}},Bd=class e{static create(t,n,r=null){return Id(n,n=>new e(t,n,r))}constructor(e,t,n){this.key=e,this.value=t,this.negated=n,this.type=md.SmallerEquals}cmp(e){return e.type===this.type?qd(this.key,this.value,e.key,e.value):this.type-e.type}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value==`string`?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||=Ld.create(this.key,this.value,this),this.negated}},Vd=class e{static create(t,n){return new e(t,n)}constructor(e,t){this.key=e,this.regexp=t,this.type=md.Regex,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;let t=this.regexp?this.regexp.source:``,n=e.regexp?e.regexp.source:``;return t<n?-1:t>n?1:0}equals(e){if(e.type===this.type){let t=this.regexp?this.regexp.source:``,n=e.regexp?e.regexp.source:``;return this.key===e.key&&t===n}return!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){let e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:`/invalid/`;return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||=Hd.create(this),this.negated}},Hd=class e{static create(t){return new e(t)}constructor(e){this._actual=e,this.type=md.NotRegex}cmp(e){return e.type===this.type?this._actual.cmp(e._actual):this.type-e.type}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(t){return new e(this._actual.map(t))}negate(){return this._actual}};function Ud(e){let t=null;for(let n=0,r=e.length;n<r;n++){let r=e[n].substituteConstants();if(e[n]!==r&&t===null){t=[];for(let r=0;r<n;r++)t[r]=e[r]}t!==null&&(t[n]=r)}return t===null?e:t}var Wd=class e{static create(t,n,r){return e._normalizeArr(t,n,r)}constructor(e,t){this.expr=e,this.negated=t,this.type=md.And}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let n=Dd(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let t=Ud(this.expr);return t===this.expr?this:e.create(t,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(t,n,r){let i=[],a=!1;for(let e of t){if(!e)continue;if(e.type===md.True){a=!0;continue}if(e.type===md.False)return Od.INSTANCE;if(e.type===md.And){i.push(...e.expr);continue}i.push(e)}if(i.length===0&&a)return kd.INSTANCE;if(i.length!==0){if(i.length===1)return i[0];i.sort(Dd);for(let e=1;e<i.length;e++)i[e-1].equals(i[e])&&(i.splice(e,1),e--);if(i.length===1)return i[0];for(;i.length>1;){let t=i[i.length-1];if(t.type!==md.Or)break;i.pop();let n=i.pop(),a=i.length===0,o=Gd.create(t.expr.map(t=>e.create([t,n],null,r)),null,a);o&&(i.push(o),i.sort(Dd))}if(i.length===1)return i[0];if(r){for(let e=0;e<i.length;e++)for(let t=e+1;t<i.length;t++)if(i[e].negate().equals(i[t]))return Od.INSTANCE;if(i.length===1)return i[0]}return new e(i,n)}}serialize(){return this.expr.map(e=>e.serialize()).join(` && `)}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(t){return new e(this.expr.map(e=>e.map(t)),null)}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());this.negated=Gd.create(e,this,!0)}return this.negated}},Gd=class e{static create(t,n,r){return e._normalizeArr(t,n,r)}constructor(e,t){this.expr=e,this.negated=t,this.type=md.Or}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,n=this.expr.length;t<n;t++){let n=Dd(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,n=this.expr.length;t<n;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){let t=Ud(this.expr);return t===this.expr?this:e.create(t,this.negated,!1)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(t,n,r){let i=[],a=!1;if(t){for(let e=0,n=t.length;e<n;e++){let n=t[e];if(n){if(n.type===md.False){a=!0;continue}if(n.type===md.True)return kd.INSTANCE;if(n.type===md.Or){i=i.concat(n.expr);continue}i.push(n)}}if(i.length===0&&a)return Od.INSTANCE;i.sort(Dd)}if(i.length!==0){if(i.length===1)return i[0];for(let e=1;e<i.length;e++)i[e-1].equals(i[e])&&(i.splice(e,1),e--);if(i.length===1)return i[0];if(r){for(let e=0;e<i.length;e++)for(let t=e+1;t<i.length;t++)if(i[e].negate().equals(i[t]))return kd.INSTANCE;if(i.length===1)return i[0]}return new e(i,n)}}serialize(){return this.expr.map(e=>e.serialize()).join(` || `)}keys(){let e=[];for(let t of this.expr)e.push(...t.keys());return e}map(t){return new e(this.expr.map(e=>e.map(t)),null)}negate(){if(!this.negated){let t=[];for(let e of this.expr)t.push(e.negate());for(;t.length>1;){let n=t.shift(),r=t.shift(),i=[];for(let e of Jd(n))for(let t of Jd(r))i.push(Wd.create([e,t],null,!1));t.unshift(e.create(i,null,!1))}this.negated=e.create(t,this,!0)}return this.negated}},I=class e extends Ad{static{this._info=[]}static all(){return e._info.values()}constructor(t,n,r){super(t,null),this._defaultValue=n,typeof r==`object`?e._info.push({...r,key:t}):r!==!0&&e._info.push({key:t,description:r,type:n==null?void 0:typeof n})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return jd.create(this.key,e)}notEqualsTo(e){return Pd.create(this.key,e)}greater(e){return Ld.create(this.key,e)}};function Kd(e,t){return e<t?-1:e>t?1:0}function qd(e,t,n,r){return e<n?-1:e>n?1:t<r?-1:t>r?1:0}function Jd(e){return e.type===md.Or?e.expr:[e]}var Yd;(function(e){e[e.Unknown=0]=`Unknown`,e[e.Disabled=1]=`Disabled`,e[e.Enabled=2]=`Enabled`})(Yd||={}),new I(`accessibilityModeEnabled`,!1);var Xd;(function(e){e[e.None=0]=`None`,e[e.Keep=1]=`Keep`,e[e.Brackets=2]=`Brackets`,e[e.Advanced=3]=`Advanced`,e[e.Full=4]=`Full`})(Xd||={});var Zd=class{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},Qd=class{constructor(e,t,n,r){this.id=e,this.name=t,this.defaultValue=n,this.schema=r}applyUpdate(e,t){return ef(e,t)}compute(e,t,n){return n}},$d=class{constructor(e,t){this.newValue=e,this.didChange=t}};function ef(e,t){if(typeof e!=`object`||typeof t!=`object`||!e||!t)return new $d(t,e!==t);if(Array.isArray(e)||Array.isArray(t)){let n=Array.isArray(e)&&Array.isArray(t)&&ge(e,t);return new $d(t,!n)}let n=!1;for(let r in t)if(t.hasOwnProperty(r)){let i=ef(e[r],t[r]);i.didChange&&(e[r]=i.newValue,n=!0)}return new $d(e,n)}var tf=class{constructor(e){this.schema=void 0,this.id=e,this.name=`_never_`,this.defaultValue=void 0}applyUpdate(e,t){return ef(e,t)}validate(e){return this.defaultValue}},nf=class{constructor(e,t,n,r){this.id=e,this.name=t,this.defaultValue=n,this.schema=r}applyUpdate(e,t){return ef(e,t)}validate(e){return e===void 0?this.defaultValue:e}compute(e,t,n){return n}};function L(e,t){return e===void 0?t:e===`false`?!1:!!e}var R=class extends nf{constructor(e,t,n,r=void 0){r!==void 0&&(r.type=`boolean`,r.default=n),super(e,t,n,r)}validate(e){return L(e,this.defaultValue)}};function rf(e,t,n,r){if(e===void 0)return t;let i=parseInt(e,10);return isNaN(i)?t:(i=Math.max(n,i),i=Math.min(r,i),i|0)}var af=class e extends nf{static clampedInt(e,t,n,r){return rf(e,t,n,r)}constructor(e,t,n,r,i,a=void 0){a!==void 0&&(a.type=`integer`,a.default=n,a.minimum=r,a.maximum=i),super(e,t,n,a),this.minimum=r,this.maximum=i}validate(t){return e.clampedInt(t,this.defaultValue,this.minimum,this.maximum)}},sf=class e extends nf{static clamp(e,t,n){return e<t?t:e>n?n:e}static float(e,t){if(typeof e==`number`)return e;if(e===void 0)return t;let n=parseFloat(e);return isNaN(n)?t:n}constructor(e,t,n,r,i,a,o){i!==void 0&&(i.type=`number`,i.default=n,i.minimum=a,i.maximum=o),super(e,t,n,i),this.validationFn=r,this.minimum=a,this.maximum=o}validate(t){return this.validationFn(e.float(t,this.defaultValue))}},cf=class e extends nf{static string(e,t){return typeof e==`string`?e:t}constructor(e,t,n,r=void 0){r!==void 0&&(r.type=`string`,r.default=n),super(e,t,n,r)}validate(t){return e.string(t,this.defaultValue)}};function lf(e,t,n,r){return typeof e==`string`?r&&e in r?r[e]:n.indexOf(e)===-1?t:e:t}var uf=class extends nf{constructor(e,t,n,r,i=void 0){i!==void 0&&(i.type=`string`,i.enum=r,i.default=n),super(e,t,n,i),this._allowedValues=r}validate(e){return lf(e,this.defaultValue,this._allowedValues)}},df=class extends Qd{constructor(e,t,n,r,i,a,o=void 0){o!==void 0&&(o.type=`string`,o.enum=i,o.default=r),super(e,t,n,o),this._allowedValues=i,this._convert=a}validate(e){return typeof e!=`string`||this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}};function ff(e){switch(e){case`none`:return Xd.None;case`keep`:return Xd.Keep;case`brackets`:return Xd.Brackets;case`advanced`:return Xd.Advanced;case`full`:return Xd.Full}}var pf=class extends Qd{constructor(){super(B.accessibilitySupport,`accessibilitySupport`,Yd.Unknown,{type:`string`,enum:[`auto`,`on`,`off`],enumDescriptions:[C(266,`Use platform APIs to detect when a Screen Reader is attached.`),C(267,`Optimize for usage with a Screen Reader.`),C(268,`Assume a screen reader is not attached.`)],default:`auto`,tags:[`accessibility`],description:C(269,`Controls if the UI should run in a mode where it is optimized for screen readers.`)})}validate(e){switch(e){case`auto`:return Yd.Unknown;case`off`:return Yd.Disabled;case`on`:return Yd.Enabled}return this.defaultValue}compute(e,t,n){return n===Yd.Unknown?e.accessibilitySupport:n}},mf=class extends Qd{constructor(){let e={insertSpace:!0,ignoreEmptyLines:!0};super(B.comments,`comments`,e,{"editor.comments.insertSpace":{type:`boolean`,default:e.insertSpace,description:C(270,`Controls whether a space character is inserted when commenting.`)},"editor.comments.ignoreEmptyLines":{type:`boolean`,default:e.ignoreEmptyLines,description:C(271,`Controls if empty lines should be ignored with toggle, add or remove actions for line comments.`)}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{insertSpace:L(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:L(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}},hf;(function(e){e[e.Hidden=0]=`Hidden`,e[e.Blink=1]=`Blink`,e[e.Smooth=2]=`Smooth`,e[e.Phase=3]=`Phase`,e[e.Expand=4]=`Expand`,e[e.Solid=5]=`Solid`})(hf||={});function gf(e){switch(e){case`blink`:return hf.Blink;case`smooth`:return hf.Smooth;case`phase`:return hf.Phase;case`expand`:return hf.Expand;case`solid`:return hf.Solid}}var _f;(function(e){e[e.Line=1]=`Line`,e[e.Block=2]=`Block`,e[e.Underline=3]=`Underline`,e[e.LineThin=4]=`LineThin`,e[e.BlockOutline=5]=`BlockOutline`,e[e.UnderlineThin=6]=`UnderlineThin`})(_f||={});function vf(e){switch(e){case`line`:return _f.Line;case`block`:return _f.Block;case`underline`:return _f.Underline;case`line-thin`:return _f.LineThin;case`block-outline`:return _f.BlockOutline;case`underline-thin`:return _f.UnderlineThin}}var yf=class extends tf{constructor(){super(B.editorClassName)}compute(e,t,n){let r=[`monaco-editor`];return t.get(B.extraEditorClassName)&&r.push(t.get(B.extraEditorClassName)),e.extraEditorClassName&&r.push(e.extraEditorClassName),t.get(B.mouseStyle)===`default`?r.push(`mouse-default`):t.get(B.mouseStyle)===`copy`&&r.push(`mouse-copy`),t.get(B.showUnused)&&r.push(`showUnused`),t.get(B.showDeprecated)&&r.push(`showDeprecated`),r.join(` `)}},bf=class extends R{constructor(){super(B.emptySelectionClipboard,`emptySelectionClipboard`,!0,{description:C(272,`Controls whether copying without a selection copies the current line.`)})}compute(e,t,n){return n&&e.emptySelectionClipboard}},xf=class extends Qd{constructor(){let e={cursorMoveOnType:!0,findOnType:!0,seedSearchStringFromSelection:`always`,autoFindInSelection:`never`,globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0,history:`workspace`,replaceHistory:`workspace`};super(B.find,`find`,e,{"editor.find.cursorMoveOnType":{type:`boolean`,default:e.cursorMoveOnType,description:C(273,`Controls whether the cursor should jump to find matches while typing.`)},"editor.find.seedSearchStringFromSelection":{type:`string`,enum:[`never`,`always`,`selection`],default:e.seedSearchStringFromSelection,enumDescriptions:[C(274,`Never seed search string from the editor selection.`),C(275,`Always seed search string from the editor selection, including word at cursor position.`),C(276,`Only seed search string from the editor selection.`)],description:C(277,`Controls whether the search string in the Find Widget is seeded from the editor selection.`)},"editor.find.autoFindInSelection":{type:`string`,enum:[`never`,`always`,`multiline`],default:e.autoFindInSelection,enumDescriptions:[C(278,`Never turn on Find in Selection automatically (default).`),C(279,`Always turn on Find in Selection automatically.`),C(280,`Turn on Find in Selection automatically when multiple lines of content are selected.`)],description:C(281,`Controls the condition for turning on Find in Selection automatically.`)},"editor.find.globalFindClipboard":{type:`boolean`,default:e.globalFindClipboard,description:C(282,`Controls whether the Find Widget should read or modify the shared find clipboard on macOS.`),included:Zn},"editor.find.addExtraSpaceOnTop":{type:`boolean`,default:e.addExtraSpaceOnTop,description:C(283,`Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.`)},"editor.find.loop":{type:`boolean`,default:e.loop,description:C(284,`Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.`)},"editor.find.history":{type:`string`,enum:[`never`,`workspace`],default:`workspace`,enumDescriptions:[C(285,`Do not store search history from the find widget.`),C(286,`Store search history across the active workspace`)],description:C(287,`Controls how the find widget history should be stored`)},"editor.find.replaceHistory":{type:`string`,enum:[`never`,`workspace`],default:`workspace`,enumDescriptions:[C(288,`Do not store history from the replace widget.`),C(289,`Store replace history across the active workspace`)],description:C(290,`Controls how the replace widget history should be stored`)},"editor.find.findOnType":{type:`boolean`,default:e.findOnType,description:C(291,`Controls whether the Find Widget should search as you type.`)}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{cursorMoveOnType:L(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),findOnType:L(t.findOnType,this.defaultValue.findOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection==`boolean`?e.seedSearchStringFromSelection?`always`:`never`:lf(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,[`never`,`always`,`selection`]),autoFindInSelection:typeof e.autoFindInSelection==`boolean`?e.autoFindInSelection?`always`:`never`:lf(t.autoFindInSelection,this.defaultValue.autoFindInSelection,[`never`,`always`,`multiline`]),globalFindClipboard:L(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:L(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:L(t.loop,this.defaultValue.loop),history:lf(t.history,this.defaultValue.history,[`never`,`workspace`]),replaceHistory:lf(t.replaceHistory,this.defaultValue.replaceHistory,[`never`,`workspace`])}}},Sf=class e extends Qd{static{this.OFF=`"liga" off, "calt" off`}static{this.ON=`"liga" on, "calt" on`}constructor(){super(B.fontLigatures,`fontLigatures`,e.OFF,{anyOf:[{type:`boolean`,description:C(292,`Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.`)},{type:`string`,description:C(293,`Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.`)}],description:C(294,`Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property.`),default:!1})}validate(t){return t===void 0?this.defaultValue:typeof t==`string`?t===`false`||t.length===0?e.OFF:t===`true`?e.ON:t:t?e.ON:e.OFF}},Cf=class e extends Qd{static{this.OFF=`normal`}static{this.TRANSLATE=`translate`}constructor(){super(B.fontVariations,`fontVariations`,e.OFF,{anyOf:[{type:`boolean`,description:C(295,`Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.`)},{type:`string`,description:C(296,`Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.`)}],description:C(297,`Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property.`),default:!1})}validate(t){return t===void 0?this.defaultValue:typeof t==`string`?t===`false`?e.OFF:t===`true`?e.TRANSLATE:t:t?e.TRANSLATE:e.OFF}compute(e,t,n){return e.fontInfo.fontVariationSettings}},wf=class extends tf{constructor(){super(B.fontInfo)}compute(e,t,n){return e.fontInfo}},Tf=class extends tf{constructor(){super(B.effectiveCursorStyle)}compute(e,t,n){return e.inputMode===`overtype`?t.get(B.overtypeCursorStyle):t.get(B.cursorStyle)}},Ef=class extends tf{constructor(){super(B.effectiveEditContext)}compute(e,t){return e.editContextSupported&&t.get(B.editContext)}},Df=class extends tf{constructor(){super(B.effectiveAllowVariableFonts)}compute(e,t){let n=e.accessibilitySupport;return n===Yd.Enabled?t.get(B.allowVariableFontsInAccessibilityMode):t.get(B.allowVariableFonts)}},Of=class extends nf{constructor(){super(B.fontSize,`fontSize`,hp.fontSize,{type:`number`,minimum:6,maximum:100,default:hp.fontSize,description:C(298,`Controls the font size in pixels.`)})}validate(e){let t=sf.float(e,this.defaultValue);return t===0?hp.fontSize:sf.clamp(t,6,100)}compute(e,t,n){return e.fontInfo.fontSize}},kf=class e extends Qd{static{this.SUGGESTION_VALUES=[`normal`,`bold`,`100`,`200`,`300`,`400`,`500`,`600`,`700`,`800`,`900`]}static{this.MINIMUM_VALUE=1}static{this.MAXIMUM_VALUE=1e3}constructor(){super(B.fontWeight,`fontWeight`,hp.fontWeight,{anyOf:[{type:`number`,minimum:e.MINIMUM_VALUE,maximum:e.MAXIMUM_VALUE,errorMessage:C(299,`Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.`)},{type:`string`,pattern:`^(normal|bold|1000|[1-9][0-9]{0,2})$`},{enum:e.SUGGESTION_VALUES}],default:hp.fontWeight,description:C(300,`Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.`)})}validate(t){return t===`normal`||t===`bold`?t:String(af.clampedInt(t,hp.fontWeight,e.MINIMUM_VALUE,e.MAXIMUM_VALUE))}},Af=class extends Qd{constructor(){let e={multiple:`peek`,multipleDefinitions:`peek`,multipleTypeDefinitions:`peek`,multipleDeclarations:`peek`,multipleImplementations:`peek`,multipleReferences:`peek`,multipleTests:`peek`,alternativeDefinitionCommand:`editor.action.goToReferences`,alternativeTypeDefinitionCommand:`editor.action.goToReferences`,alternativeDeclarationCommand:`editor.action.goToReferences`,alternativeImplementationCommand:``,alternativeReferenceCommand:``,alternativeTestsCommand:``},t={type:`string`,enum:[`peek`,`gotoAndPeek`,`goto`],default:e.multiple,enumDescriptions:[C(301,`Show Peek view of the results (default)`),C(302,`Go to the primary result and show a Peek view`),C(303,`Go to the primary result and enable Peek-less navigation to others`)]},n=[``,`editor.action.referenceSearch.trigger`,`editor.action.goToReferences`,`editor.action.peekImplementation`,`editor.action.goToImplementation`,`editor.action.peekTypeDefinition`,`editor.action.goToTypeDefinition`,`editor.action.peekDeclaration`,`editor.action.revealDeclaration`,`editor.action.peekDefinition`,`editor.action.revealDefinitionAside`,`editor.action.revealDefinition`];super(B.gotoLocation,`gotoLocation`,e,{"editor.gotoLocation.multiple":{deprecationMessage:C(304,`This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.`)},"editor.gotoLocation.multipleDefinitions":{description:C(305,`Controls the behavior the 'Go to Definition'-command when multiple target locations exist.`),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:C(306,`Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist.`),...t},"editor.gotoLocation.multipleDeclarations":{description:C(307,`Controls the behavior the 'Go to Declaration'-command when multiple target locations exist.`),...t},"editor.gotoLocation.multipleImplementations":{description:C(308,`Controls the behavior the 'Go to Implementations'-command when multiple target locations exist.`),...t},"editor.gotoLocation.multipleReferences":{description:C(309,`Controls the behavior the 'Go to References'-command when multiple target locations exist.`),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:`string`,default:e.alternativeDefinitionCommand,enum:n,description:C(310,`Alternative command id that is being executed when the result of 'Go to Definition' is the current location.`)},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:`string`,default:e.alternativeTypeDefinitionCommand,enum:n,description:C(311,`Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.`)},"editor.gotoLocation.alternativeDeclarationCommand":{type:`string`,default:e.alternativeDeclarationCommand,enum:n,description:C(312,`Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.`)},"editor.gotoLocation.alternativeImplementationCommand":{type:`string`,default:e.alternativeImplementationCommand,enum:n,description:C(313,`Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.`)},"editor.gotoLocation.alternativeReferenceCommand":{type:`string`,default:e.alternativeReferenceCommand,enum:n,description:C(314,`Alternative command id that is being executed when the result of 'Go to Reference' is the current location.`)}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{multiple:lf(t.multiple,this.defaultValue.multiple,[`peek`,`gotoAndPeek`,`goto`]),multipleDefinitions:t.multipleDefinitions??lf(t.multipleDefinitions,`peek`,[`peek`,`gotoAndPeek`,`goto`]),multipleTypeDefinitions:t.multipleTypeDefinitions??lf(t.multipleTypeDefinitions,`peek`,[`peek`,`gotoAndPeek`,`goto`]),multipleDeclarations:t.multipleDeclarations??lf(t.multipleDeclarations,`peek`,[`peek`,`gotoAndPeek`,`goto`]),multipleImplementations:t.multipleImplementations??lf(t.multipleImplementations,`peek`,[`peek`,`gotoAndPeek`,`goto`]),multipleReferences:t.multipleReferences??lf(t.multipleReferences,`peek`,[`peek`,`gotoAndPeek`,`goto`]),multipleTests:t.multipleTests??lf(t.multipleTests,`peek`,[`peek`,`gotoAndPeek`,`goto`]),alternativeDefinitionCommand:cf.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:cf.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:cf.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:cf.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:cf.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:cf.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},jf=class extends Qd{constructor(){let e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(B.hover,`hover`,e,{"editor.hover.enabled":{type:`boolean`,default:e.enabled,description:C(315,`Controls whether the hover is shown.`)},"editor.hover.delay":{type:`number`,default:e.delay,minimum:0,maximum:1e4,description:C(316,`Controls the delay in milliseconds after which the hover is shown.`)},"editor.hover.sticky":{type:`boolean`,default:e.sticky,description:C(317,`Controls whether the hover should remain visible when mouse is moved over it.`)},"editor.hover.hidingDelay":{type:`integer`,minimum:0,default:e.hidingDelay,description:C(318,"Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:`boolean`,default:e.above,description:C(319,`Prefer showing hovers above the line, if there's space.`)}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{enabled:L(t.enabled,this.defaultValue.enabled),delay:af.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:L(t.sticky,this.defaultValue.sticky),hidingDelay:af.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:L(t.above,this.defaultValue.above)}}},Mf;(function(e){e[e.None=0]=`None`,e[e.Text=1]=`Text`,e[e.Blocks=2]=`Blocks`})(Mf||={});var Nf=class e extends tf{constructor(){super(B.layoutInfo)}compute(t,n,r){return e.computeLayout(n,{memory:t.memory,outerWidth:t.outerWidth,outerHeight:t.outerHeight,isDominatedByLongLines:t.isDominatedByLongLines,lineHeight:t.fontInfo.lineHeight,viewLineCount:t.viewLineCount,lineNumbersDigitCount:t.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:t.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:t.fontInfo.maxDigitWidth,pixelRatio:t.pixelRatio,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){let t=e.height/e.lineHeight,n=Math.floor(e.paddingTop/e.lineHeight),r=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(r=Math.max(r,t-1));let i=(n+e.viewLineCount+r)/(e.pixelRatio*e.height),a=Math.floor(e.viewLineCount/i);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:n,extraLinesBeyondLastLine:r,desiredRatio:i,minimapLineCount:a}}static _computeMinimapLayout(t,n){let r=t.outerWidth,i=t.outerHeight,a=t.pixelRatio;if(!t.minimap.enabled)return{renderMinimap:Mf.None,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(a*i),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:i};let o=n.stableMinimapLayoutInput,s=o&&t.outerHeight===o.outerHeight&&t.lineHeight===o.lineHeight&&t.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&t.pixelRatio===o.pixelRatio&&t.scrollBeyondLastLine===o.scrollBeyondLastLine&&t.paddingTop===o.paddingTop&&t.paddingBottom===o.paddingBottom&&t.minimap.enabled===o.minimap.enabled&&t.minimap.side===o.minimap.side&&t.minimap.size===o.minimap.size&&t.minimap.showSlider===o.minimap.showSlider&&t.minimap.renderCharacters===o.minimap.renderCharacters&&t.minimap.maxColumn===o.minimap.maxColumn&&t.minimap.scale===o.minimap.scale&&t.verticalScrollbarWidth===o.verticalScrollbarWidth&&t.isViewportWrapping===o.isViewportWrapping,c=t.lineHeight,l=t.typicalHalfwidthCharacterWidth,u=t.scrollBeyondLastLine,d=t.minimap.renderCharacters,f=a>=2?Math.round(t.minimap.scale*2):t.minimap.scale,p=t.minimap.maxColumn,ee=t.minimap.size,m=t.minimap.side,te=t.verticalScrollbarWidth,ne=t.viewLineCount,re=t.remainingWidth,ie=t.isViewportWrapping,ae=d?2:3,oe=Math.floor(a*i),se=oe/a,ce=!1,h=!1,le=ae*f,ue=f/a,de=1;if(ee===`fill`||ee===`fit`){let{typicalViewportLineCount:r,extraLinesBeforeFirstLine:o,extraLinesBeyondLastLine:l,desiredRatio:d,minimapLineCount:p}=e.computeContainedMinimapLineCount({viewLineCount:ne,scrollBeyondLastLine:u,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,height:i,lineHeight:c,pixelRatio:a}),m=ne/p;if(m>1)ce=!0,h=!0,f=1,le=1,ue=f/a;else{let e=!1,i=f+1;if(ee===`fit`){let t=Math.ceil((o+ne+l)*le);ie&&s&&re<=n.stableFitRemainingWidth?(e=!0,i=n.stableFitMaxMinimapScale):e=t>oe}if(ee===`fill`||e){ce=!0;let e=f;le=Math.min(c*a,Math.max(1,Math.floor(1/d))),ie&&s&&re<=n.stableFitRemainingWidth&&(i=n.stableFitMaxMinimapScale),f=Math.min(i,Math.max(1,Math.floor(le/ae))),f>e&&(de=Math.min(2,f/e)),ue=f/a/de,oe=Math.ceil(Math.max(r,o+ne+l)*le),ie?(n.stableMinimapLayoutInput=t,n.stableFitRemainingWidth=re,n.stableFitMaxMinimapScale=f):(n.stableMinimapLayoutInput=null,n.stableFitRemainingWidth=0)}}}let fe=Math.floor(p*ue),pe=Math.min(fe,Math.max(0,Math.floor((re-te-2)*ue/(l+ue)))+8),me=Math.floor(a*pe),he=me/a;me=Math.floor(me*de);let ge=d?Mf.Text:Mf.Blocks,_e=m===`left`?0:r-pe-te;return{renderMinimap:ge,minimapLeft:_e,minimapWidth:pe,minimapHeightIsEditorHeight:ce,minimapIsSampling:h,minimapScale:f,minimapLineHeight:le,minimapCanvasInnerWidth:me,minimapCanvasInnerHeight:oe,minimapCanvasOuterWidth:he,minimapCanvasOuterHeight:se}}static computeLayout(t,n){let r=n.outerWidth|0,i=n.outerHeight|0,a=n.lineHeight|0,o=n.lineNumbersDigitCount|0,s=n.typicalHalfwidthCharacterWidth,c=n.maxDigitWidth,l=n.pixelRatio,u=n.viewLineCount,d=t.get(B.wordWrapOverride2),f=d===`inherit`?t.get(B.wordWrapOverride1):d,p=f===`inherit`?t.get(B.wordWrap):f,ee=t.get(B.wordWrapColumn),m=n.isDominatedByLongLines,te=t.get(B.glyphMargin),ne=t.get(B.lineNumbers).renderType!==Jf.Off,re=t.get(B.lineNumbersMinChars),ie=t.get(B.scrollBeyondLastLine),ae=t.get(B.padding),oe=t.get(B.minimap),se=t.get(B.scrollbar),ce=se.verticalScrollbarSize,h=se.verticalHasArrows,le=se.arrowSize,ue=se.horizontalScrollbarSize,de=t.get(B.folding),fe=t.get(B.showFoldingControls)!==`never`,pe=t.get(B.lineDecorationsWidth);de&&fe&&(pe+=16);let me=0;if(ne){let e=Math.max(o,re);me=Math.round(e*c)}let he=0;te&&(he=a*n.glyphMarginDecorationLaneCount);let ge=0,_e=ge+he,ve=_e+me,ye=ve+pe,be=r-he-me-pe,xe=!1,Se=!1,Ce=-1;t.get(B.accessibilitySupport)===Yd.Enabled&&f===`inherit`&&m?(xe=!0,Se=!0):p===`on`||p===`bounded`?Se=!0:p===`wordWrapColumn`&&(Ce=ee);let we=e._computeMinimapLayout({outerWidth:r,outerHeight:i,lineHeight:a,typicalHalfwidthCharacterWidth:s,pixelRatio:l,scrollBeyondLastLine:ie,paddingTop:ae.top,paddingBottom:ae.bottom,minimap:oe,verticalScrollbarWidth:ce,viewLineCount:u,remainingWidth:be,isViewportWrapping:Se},n.memory||new Zd);we.renderMinimap!==Mf.None&&we.minimapLeft===0&&(ge+=we.minimapWidth,_e+=we.minimapWidth,ve+=we.minimapWidth,ye+=we.minimapWidth);let Te=be-we.minimapWidth,Ee=Math.max(1,Math.floor((Te-ce-2)/s)),De=h?le:0;return Se&&(Ce=Math.max(1,Ee),p===`bounded`&&(Ce=Math.min(Ce,ee))),{width:r,height:i,glyphMarginLeft:ge,glyphMarginWidth:he,glyphMarginDecorationLaneCount:n.glyphMarginDecorationLaneCount,lineNumbersLeft:_e,lineNumbersWidth:me,decorationsLeft:ve,decorationsWidth:pe,contentLeft:ye,contentWidth:Te,minimap:we,viewportColumn:Ee,isWordWrapMinified:xe,isViewportWrapping:Se,wrappingColumn:Ce,verticalScrollbarWidth:ce,horizontalScrollbarHeight:ue,overviewRuler:{top:De,width:ce,height:i-2*De,right:0}}}},Pf=class extends Qd{constructor(){super(B.wrappingStrategy,`wrappingStrategy`,`simple`,{"editor.wrappingStrategy":{enumDescriptions:[C(320,`Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width.`),C(321,`Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.`)],type:`string`,enum:[`simple`,`advanced`],default:`simple`,description:C(322,`Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.`)}})}validate(e){return lf(e,`simple`,[`simple`,`advanced`])}compute(e,t,n){let r=t.get(B.accessibilitySupport);return r===Yd.Enabled?`advanced`:n}},Ff;(function(e){e.Off=`off`,e.OnCode=`onCode`,e.On=`on`})(Ff||={});var If=class extends Qd{constructor(){let e={enabled:Ff.OnCode};super(B.lightbulb,`lightbulb`,e,{"editor.lightbulb.enabled":{type:`string`,enum:[Ff.Off,Ff.OnCode,Ff.On],default:e.enabled,enumDescriptions:[C(323,`Disable the code action menu.`),C(324,`Show the code action menu when the cursor is on lines with code.`),C(325,`Show the code action menu when the cursor is on lines with code or on empty lines.`)],description:C(326,`Enables the Code Action lightbulb in the editor.`)}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{enabled:lf(t.enabled,this.defaultValue.enabled,[Ff.Off,Ff.OnCode,Ff.On])}}},Lf=class extends Qd{constructor(){let e={enabled:!0,maxLineCount:5,defaultModel:`outlineModel`,scrollWithEditor:!0};super(B.stickyScroll,`stickyScroll`,e,{"editor.stickyScroll.enabled":{type:`boolean`,default:e.enabled,description:C(327,`Shows the nested current scopes during the scroll at the top of the editor.`)},"editor.stickyScroll.maxLineCount":{type:`number`,default:e.maxLineCount,minimum:1,maximum:20,description:C(328,`Defines the maximum number of sticky lines to show.`)},"editor.stickyScroll.defaultModel":{type:`string`,enum:[`outlineModel`,`foldingProviderModel`,`indentationModel`],default:e.defaultModel,description:C(329,`Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.`)},"editor.stickyScroll.scrollWithEditor":{type:`boolean`,default:e.scrollWithEditor,description:C(330,`Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.`)}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{enabled:L(t.enabled,this.defaultValue.enabled),maxLineCount:af.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:lf(t.defaultModel,this.defaultValue.defaultModel,[`outlineModel`,`foldingProviderModel`,`indentationModel`]),scrollWithEditor:L(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},Rf=class extends Qd{constructor(){let e={enabled:`on`,fontSize:0,fontFamily:``,padding:!1,maximumLength:43};super(B.inlayHints,`inlayHints`,e,{"editor.inlayHints.enabled":{type:`string`,default:e.enabled,description:C(331,`Enables the inlay hints in the editor.`),enum:[`on`,`onUnlessPressed`,`offUnlessPressed`,`off`],markdownEnumDescriptions:[C(332,`Inlay hints are enabled`),C(333,`Inlay hints are showing by default and hide when holding {0}`,Zn?`Ctrl+Option`:`Ctrl+Alt`),C(334,`Inlay hints are hidden by default and show when holding {0}`,Zn?`Ctrl+Option`:`Ctrl+Alt`),C(335,`Inlay hints are disabled`)]},"editor.inlayHints.fontSize":{type:`number`,default:e.fontSize,markdownDescription:C(336,`Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.`,"`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:`string`,default:e.fontFamily,markdownDescription:C(337,`Controls font family of inlay hints in the editor. When set to empty, the {0} is used.`,"`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:`boolean`,default:e.padding,description:C(338,`Enables the padding around the inlay hints in the editor.`)},"editor.inlayHints.maximumLength":{type:`number`,default:e.maximumLength,markdownDescription:C(339,"Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return typeof t.enabled==`boolean`&&(t.enabled=t.enabled?`on`:`off`),{enabled:lf(t.enabled,this.defaultValue.enabled,[`on`,`off`,`offUnlessPressed`,`onUnlessPressed`]),fontSize:af.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:cf.string(t.fontFamily,this.defaultValue.fontFamily),padding:L(t.padding,this.defaultValue.padding),maximumLength:af.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,2**53-1)}}},zf=class extends Qd{constructor(){super(B.lineDecorationsWidth,`lineDecorationsWidth`,10)}validate(e){if(typeof e==`string`&&/^\d+(\.\d+)?ch$/.test(e)){let t=parseFloat(e.substring(0,e.length-2));return-t}else return af.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,n){return n<0?af.clampedInt(-n*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):n}},Bf=class extends sf{constructor(){super(B.lineHeight,`lineHeight`,hp.lineHeight,e=>sf.clamp(e,0,150),{markdownDescription:C(340,`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)},0,150)}compute(e,t,n){return e.fontInfo.lineHeight}},Vf=class extends Qd{constructor(){let e={enabled:!0,size:`proportional`,side:`right`,showSlider:`mouseover`,autohide:`none`,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,markSectionHeaderRegex:`\\bMARK:\\s*(?<separator>-?)\\s*(?<label>.*)$`,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(B.minimap,`minimap`,e,{"editor.minimap.enabled":{type:`boolean`,default:e.enabled,description:C(341,`Controls whether the minimap is shown.`)},"editor.minimap.autohide":{type:`string`,enum:[`none`,`mouseover`,`scroll`],enumDescriptions:[C(342,`The minimap is always shown.`),C(343,`The minimap is hidden when mouse is not over the minimap and shown when mouse is over the minimap.`),C(344,`The minimap is only shown when the editor is scrolled`)],default:e.autohide,description:C(345,`Controls whether the minimap is hidden automatically.`)},"editor.minimap.size":{type:`string`,enum:[`proportional`,`fill`,`fit`],enumDescriptions:[C(346,`The minimap has the same size as the editor contents (and might scroll).`),C(347,`The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling).`),C(348,`The minimap will shrink as necessary to never be larger than the editor (no scrolling).`)],default:e.size,description:C(349,`Controls the size of the minimap.`)},"editor.minimap.side":{type:`string`,enum:[`left`,`right`],default:e.side,description:C(350,`Controls the side where to render the minimap.`)},"editor.minimap.showSlider":{type:`string`,enum:[`always`,`mouseover`],default:e.showSlider,description:C(351,`Controls when the minimap slider is shown.`)},"editor.minimap.scale":{type:`number`,default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:C(352,`Scale of content drawn in the minimap: 1, 2 or 3.`)},"editor.minimap.renderCharacters":{type:`boolean`,default:e.renderCharacters,description:C(353,`Render the actual characters on a line as opposed to color blocks.`)},"editor.minimap.maxColumn":{type:`number`,default:e.maxColumn,description:C(354,`Limit the width of the minimap to render at most a certain number of columns.`)},"editor.minimap.showRegionSectionHeaders":{type:`boolean`,default:e.showRegionSectionHeaders,description:C(355,`Controls whether named regions are shown as section headers in the minimap.`)},"editor.minimap.showMarkSectionHeaders":{type:`boolean`,default:e.showMarkSectionHeaders,description:C(356,`Controls whether MARK: comments are shown as section headers in the minimap.`)},"editor.minimap.markSectionHeaderRegex":{type:`string`,default:e.markSectionHeaderRegex,description:C(357,"Defines the regular expression used to find section headers in comments. The regex must contain a named match group `label` (written as `(?<label>.+)`) that encapsulates the section header, otherwise it will not work. Optionally you can include another match group named `separator`. Use \\n in the pattern to match multi-line headers.")},"editor.minimap.sectionHeaderFontSize":{type:`number`,default:e.sectionHeaderFontSize,description:C(358,`Controls the font size of section headers in the minimap.`)},"editor.minimap.sectionHeaderLetterSpacing":{type:`number`,default:e.sectionHeaderLetterSpacing,description:C(359,`Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.`)}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e,n=this.defaultValue.markSectionHeaderRegex,r=e.markSectionHeaderRegex;if(typeof r==`string`)try{new RegExp(r,`d`),n=r}catch{}return{enabled:L(t.enabled,this.defaultValue.enabled),autohide:lf(t.autohide,this.defaultValue.autohide,[`none`,`mouseover`,`scroll`]),size:lf(t.size,this.defaultValue.size,[`proportional`,`fill`,`fit`]),side:lf(t.side,this.defaultValue.side,[`right`,`left`]),showSlider:lf(t.showSlider,this.defaultValue.showSlider,[`always`,`mouseover`]),renderCharacters:L(t.renderCharacters,this.defaultValue.renderCharacters),scale:af.clampedInt(t.scale,1,1,3),maxColumn:af.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:L(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:L(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),markSectionHeaderRegex:n,sectionHeaderFontSize:sf.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:sf.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}};function Hf(e){return e===`ctrlCmd`?Zn?`metaKey`:`ctrlKey`:`altKey`}var Uf=class extends Qd{constructor(){super(B.padding,`padding`,{top:0,bottom:0},{"editor.padding.top":{type:`number`,default:0,minimum:0,maximum:1e3,description:C(360,`Controls the amount of space between the top edge of the editor and the first line.`)},"editor.padding.bottom":{type:`number`,default:0,minimum:0,maximum:1e3,description:C(361,`Controls the amount of space between the bottom edge of the editor and the last line.`)}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{top:af.clampedInt(t.top,0,0,1e3),bottom:af.clampedInt(t.bottom,0,0,1e3)}}},Wf=class extends Qd{constructor(){let e={enabled:!0,cycle:!0};super(B.parameterHints,`parameterHints`,e,{"editor.parameterHints.enabled":{type:`boolean`,default:e.enabled,description:C(362,`Enables a pop-up that shows parameter documentation and type information as you type.`)},"editor.parameterHints.cycle":{type:`boolean`,default:e.cycle,description:C(363,`Controls whether the parameter hints menu cycles or closes when reaching the end of the list.`)}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{enabled:L(t.enabled,this.defaultValue.enabled),cycle:L(t.cycle,this.defaultValue.cycle)}}},Gf=class extends tf{constructor(){super(B.pixelRatio)}compute(e,t,n){return e.pixelRatio}},Kf=class extends Qd{constructor(){super(B.placeholder,`placeholder`,void 0)}validate(e){return e===void 0?this.defaultValue:typeof e==`string`?e:this.defaultValue}},qf=class extends Qd{constructor(){let e={other:`on`,comments:`off`,strings:`off`},t=[{type:`boolean`},{type:`string`,enum:[`on`,`inline`,`off`],enumDescriptions:[C(364,`Quick suggestions show inside the suggest widget`),C(365,`Quick suggestions show as ghost text`),C(366,`Quick suggestions are disabled`)]}];super(B.quickSuggestions,`quickSuggestions`,e,{type:`object`,additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:C(367,`Enable quick suggestions inside strings.`)},comments:{anyOf:t,default:e.comments,description:C(368,`Enable quick suggestions inside comments.`)},other:{anyOf:t,default:e.other,description:C(369,`Enable quick suggestions outside of strings and comments.`)}},default:e,markdownDescription:C(370,`Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.`,"`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e==`boolean`){let t=e?`on`:`off`;return{comments:t,strings:t,other:t}}if(!e||typeof e!=`object`)return this.defaultValue;let{other:t,comments:n,strings:r}=e,i=[`on`,`inline`,`off`],a,o,s;return a=typeof t==`boolean`?t?`on`:`off`:lf(t,this.defaultValue.other,i),o=typeof n==`boolean`?n?`on`:`off`:lf(n,this.defaultValue.comments,i),s=typeof r==`boolean`?r?`on`:`off`:lf(r,this.defaultValue.strings,i),{other:a,comments:o,strings:s}}},Jf;(function(e){e[e.Off=0]=`Off`,e[e.On=1]=`On`,e[e.Relative=2]=`Relative`,e[e.Interval=3]=`Interval`,e[e.Custom=4]=`Custom`})(Jf||={});var Yf=class extends Qd{constructor(){super(B.lineNumbers,`lineNumbers`,{renderType:Jf.On,renderFn:null},{type:`string`,enum:[`off`,`on`,`relative`,`interval`],enumDescriptions:[C(371,`Line numbers are not rendered.`),C(372,`Line numbers are rendered as absolute number.`),C(373,`Line numbers are rendered as distance in lines to cursor position.`),C(374,`Line numbers are rendered every 10 lines.`)],default:`on`,description:C(375,`Controls the display of line numbers.`)})}validate(e){let t=this.defaultValue.renderType,n=this.defaultValue.renderFn;return e!==void 0&&(typeof e==`function`?(t=Jf.Custom,n=e):t=e===`interval`?Jf.Interval:e===`relative`?Jf.Relative:e===`on`?Jf.On:Jf.Off),{renderType:t,renderFn:n}}},Xf=class extends Qd{constructor(){let e=[],t={type:`number`,description:C(376,`Number of monospace characters at which this editor ruler will render.`)};super(B.rulers,`rulers`,e,{type:`array`,items:{anyOf:[t,{type:[`object`],properties:{column:t,color:{type:`string`,description:C(377,`Color of this editor ruler.`),format:`color-hex`}}}]},default:e,description:C(378,`Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.`)})}validate(e){if(Array.isArray(e)){let t=[];for(let n of e)if(typeof n==`number`)t.push({column:af.clampedInt(n,0,0,1e4),color:null});else if(n&&typeof n==`object`){let e=n;t.push({column:af.clampedInt(e.column,0,0,1e4),color:e.color})}return t.sort((e,t)=>e.column-t.column),t}return this.defaultValue}},Zf=class extends Qd{constructor(){super(B.readOnlyMessage,`readOnlyMessage`,void 0)}validate(e){return!e||typeof e!=`object`?this.defaultValue:e}};function Qf(e,t){if(typeof e!=`string`)return t;switch(e){case`hidden`:return $u.Hidden;case`visible`:return $u.Visible;default:return $u.Auto}}var $f=class extends Qd{constructor(){let e={vertical:$u.Auto,horizontal:$u.Auto,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(B.scrollbar,`scrollbar`,e,{"editor.scrollbar.vertical":{type:`string`,enum:[`auto`,`visible`,`hidden`],enumDescriptions:[C(379,`The vertical scrollbar will be visible only when necessary.`),C(380,`The vertical scrollbar will always be visible.`),C(381,`The vertical scrollbar will always be hidden.`)],default:`auto`,description:C(382,`Controls the visibility of the vertical scrollbar.`)},"editor.scrollbar.horizontal":{type:`string`,enum:[`auto`,`visible`,`hidden`],enumDescriptions:[C(383,`The horizontal scrollbar will be visible only when necessary.`),C(384,`The horizontal scrollbar will always be visible.`),C(385,`The horizontal scrollbar will always be hidden.`)],default:`auto`,description:C(386,`Controls the visibility of the horizontal scrollbar.`)},"editor.scrollbar.verticalScrollbarSize":{type:`number`,default:e.verticalScrollbarSize,description:C(387,`The width of the vertical scrollbar.`)},"editor.scrollbar.horizontalScrollbarSize":{type:`number`,default:e.horizontalScrollbarSize,description:C(388,`The height of the horizontal scrollbar.`)},"editor.scrollbar.scrollByPage":{type:`boolean`,default:e.scrollByPage,description:C(389,`Controls whether clicks scroll by page or jump to click position.`)},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:`boolean`,default:e.ignoreHorizontalScrollbarInContentHeight,description:C(390,`When set, the horizontal scrollbar will not increase the size of the editor's content.`)}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e,n=af.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),r=af.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:af.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:Qf(t.vertical,this.defaultValue.vertical),horizontal:Qf(t.horizontal,this.defaultValue.horizontal),useShadows:L(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:L(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:L(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:L(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:L(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:n,horizontalSliderSize:af.clampedInt(t.horizontalSliderSize,n,0,1e3),verticalScrollbarSize:r,verticalSliderSize:af.clampedInt(t.verticalSliderSize,r,0,1e3),scrollByPage:L(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:L(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}};const ep=`inUntrustedWorkspace`,tp={allowedCharacters:`editor.unicodeHighlight.allowedCharacters`,invisibleCharacters:`editor.unicodeHighlight.invisibleCharacters`,nonBasicASCII:`editor.unicodeHighlight.nonBasicASCII`,ambiguousCharacters:`editor.unicodeHighlight.ambiguousCharacters`,includeComments:`editor.unicodeHighlight.includeComments`,includeStrings:`editor.unicodeHighlight.includeStrings`,allowedLocales:`editor.unicodeHighlight.allowedLocales`};var np=class extends Qd{constructor(){let e={nonBasicASCII:ep,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:ep,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(B.unicodeHighlighting,`unicodeHighlight`,e,{[tp.nonBasicASCII]:{restricted:!0,type:[`boolean`,`string`],enum:[!0,!1,ep],default:e.nonBasicASCII,description:C(391,`Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.`)},[tp.invisibleCharacters]:{restricted:!0,type:`boolean`,default:e.invisibleCharacters,description:C(392,`Controls whether characters that just reserve space or have no width at all are highlighted.`)},[tp.ambiguousCharacters]:{restricted:!0,type:`boolean`,default:e.ambiguousCharacters,description:C(393,`Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.`)},[tp.includeComments]:{restricted:!0,type:[`boolean`,`string`],enum:[!0,!1,ep],default:e.includeComments,description:C(394,`Controls whether characters in comments should also be subject to Unicode highlighting.`)},[tp.includeStrings]:{restricted:!0,type:[`boolean`,`string`],enum:[!0,!1,ep],default:e.includeStrings,description:C(395,`Controls whether characters in strings should also be subject to Unicode highlighting.`)},[tp.allowedCharacters]:{restricted:!0,type:`object`,default:e.allowedCharacters,description:C(396,`Defines allowed characters that are not being highlighted.`),additionalProperties:{type:`boolean`}},[tp.allowedLocales]:{restricted:!0,type:`object`,additionalProperties:{type:`boolean`},default:e.allowedLocales,description:C(397,`Unicode characters that are common in allowed locales are not being highlighted.`)}})}applyUpdate(e,t){let n=!1;t.allowedCharacters&&e&&(tc(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},n=!0)),t.allowedLocales&&e&&(tc(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},n=!0));let r=super.applyUpdate(e,t);return n?new $d(r.newValue,!0):r}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{nonBasicASCII:op(t.nonBasicASCII,ep,[!0,!1,ep]),invisibleCharacters:L(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:L(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:op(t.includeComments,ep,[!0,!1,ep]),includeStrings:op(t.includeStrings,ep,[!0,!1,ep]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!=`object`||!e)return t;let n={};for(let[t,r]of Object.entries(e))r===!0&&(n[t]=!0);return n}},rp=class extends Qd{constructor(){let e={enabled:!0,mode:`subwordSmart`,showToolbar:`onHover`,suppressSuggestions:!1,keepOnBlur:!1,fontFamily:`default`,syntaxHighlightingEnabled:!0,edits:{enabled:!0,showCollapsed:!1,renderSideBySide:`auto`,allowCodeShifting:`always`},experimental:{suppressInlineSuggestions:``,triggerCommandOnProviderChange:!1}};super(B.inlineSuggest,`inlineSuggest`,e,{"editor.inlineSuggest.enabled":{type:`boolean`,default:e.enabled,description:C(398,`Controls whether to automatically show inline suggestions in the editor.`)},"editor.inlineSuggest.showToolbar":{type:`string`,default:e.showToolbar,enum:[`always`,`onHover`,`never`],enumDescriptions:[C(399,`Show the inline suggestion toolbar whenever an inline suggestion is shown.`),C(400,`Show the inline suggestion toolbar when hovering over an inline suggestion.`),C(401,`Never show the inline suggestion toolbar.`)],description:C(402,`Controls when to show the inline suggestion toolbar.`)},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:`boolean`,default:e.syntaxHighlightingEnabled,description:C(403,`Controls whether to show syntax highlighting for inline suggestions in the editor.`)},"editor.inlineSuggest.suppressSuggestions":{type:`boolean`,default:e.suppressSuggestions,description:C(404,`Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.`)},"editor.inlineSuggest.experimental.suppressInlineSuggestions":{type:`string`,default:e.experimental.suppressInlineSuggestions,tags:[`experimental`],description:C(405,`Suppresses inline completions for specified extension IDs -- comma separated.`),experiment:{mode:`startup`}},"editor.inlineSuggest.experimental.triggerCommandOnProviderChange":{type:`boolean`,default:e.experimental.triggerCommandOnProviderChange,tags:[`experimental`],description:C(406,`Controls whether to trigger a command when the inline suggestion provider changes.`),experiment:{mode:`startup`}},"editor.inlineSuggest.fontFamily":{type:`string`,default:e.fontFamily,description:C(407,`Controls the font family of the inline suggestions.`)},"editor.inlineSuggest.edits.allowCodeShifting":{type:`string`,default:e.edits.allowCodeShifting,description:C(408,`Controls whether showing a suggestion will shift the code to make space for the suggestion inline.`),enum:[`always`,`horizontal`,`never`],tags:[`nextEditSuggestions`]},"editor.inlineSuggest.edits.renderSideBySide":{type:`string`,default:e.edits.renderSideBySide,description:C(409,`Controls whether larger suggestions can be shown side by side.`),enum:[`auto`,`never`],enumDescriptions:[C(410,`Larger suggestions will show side by side if there is enough space, otherwise they will be shown below.`),C(411,`Larger suggestions are never shown side by side and will always be shown below.`)],tags:[`nextEditSuggestions`]},"editor.inlineSuggest.edits.showCollapsed":{type:`boolean`,default:e.edits.showCollapsed,description:C(412,`Controls whether the suggestion will show as collapsed until jumping to it.`),tags:[`nextEditSuggestions`]}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{enabled:L(t.enabled,this.defaultValue.enabled),mode:lf(t.mode,this.defaultValue.mode,[`prefix`,`subword`,`subwordSmart`]),showToolbar:lf(t.showToolbar,this.defaultValue.showToolbar,[`always`,`onHover`,`never`]),suppressSuggestions:L(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:L(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:cf.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:L(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled),edits:{enabled:L(t.edits?.enabled,this.defaultValue.edits.enabled),showCollapsed:L(t.edits?.showCollapsed,this.defaultValue.edits.showCollapsed),allowCodeShifting:lf(t.edits?.allowCodeShifting,this.defaultValue.edits.allowCodeShifting,[`always`,`horizontal`,`never`]),renderSideBySide:lf(t.edits?.renderSideBySide,this.defaultValue.edits.renderSideBySide,[`never`,`auto`])},experimental:{suppressInlineSuggestions:cf.string(t.experimental?.suppressInlineSuggestions,this.defaultValue.experimental.suppressInlineSuggestions),triggerCommandOnProviderChange:L(t.experimental?.triggerCommandOnProviderChange,this.defaultValue.experimental.triggerCommandOnProviderChange)}}}},ip=class extends Qd{constructor(){let e={enabled:ed.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:ed.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(B.bracketPairColorization,`bracketPairColorization`,e,{"editor.bracketPairColorization.enabled":{type:`boolean`,default:e.enabled,markdownDescription:C(413,`Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.`,"`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:`boolean`,default:e.independentColorPoolPerBracketType,description:C(414,`Controls whether each bracket type has its own independent color pool.`)}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{enabled:L(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:L(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},ap=class extends Qd{constructor(){let e={bracketPairs:!1,bracketPairsHorizontal:`active`,highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(B.guides,`guides`,e,{"editor.guides.bracketPairs":{type:[`boolean`,`string`],enum:[!0,`active`,!1],enumDescriptions:[C(415,`Enables bracket pair guides.`),C(416,`Enables bracket pair guides only for the active bracket pair.`),C(417,`Disables bracket pair guides.`)],default:e.bracketPairs,description:C(418,`Controls whether bracket pair guides are enabled or not.`)},"editor.guides.bracketPairsHorizontal":{type:[`boolean`,`string`],enum:[!0,`active`,!1],enumDescriptions:[C(419,`Enables horizontal guides as addition to vertical bracket pair guides.`),C(420,`Enables horizontal guides only for the active bracket pair.`),C(421,`Disables horizontal bracket pair guides.`)],default:e.bracketPairsHorizontal,description:C(422,`Controls whether horizontal bracket pair guides are enabled or not.`)},"editor.guides.highlightActiveBracketPair":{type:`boolean`,default:e.highlightActiveBracketPair,description:C(423,`Controls whether the editor should highlight the active bracket pair.`)},"editor.guides.indentation":{type:`boolean`,default:e.indentation,description:C(424,`Controls whether the editor should render indent guides.`)},"editor.guides.highlightActiveIndentation":{type:[`boolean`,`string`],enum:[!0,`always`,!1],enumDescriptions:[C(425,`Highlights the active indent guide.`),C(426,`Highlights the active indent guide even if bracket guides are highlighted.`),C(427,`Do not highlight the active indent guide.`)],default:e.highlightActiveIndentation,description:C(428,`Controls whether the editor should highlight the active indent guide.`)}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{bracketPairs:op(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,`active`]),bracketPairsHorizontal:op(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,`active`]),highlightActiveBracketPair:L(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:L(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:op(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,`always`])}}};function op(e,t,n){let r=n.indexOf(e);return r===-1?t:n[r]}var sp=class extends Qd{constructor(){let e={insertMode:`insert`,filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:`always`,showIcons:!0,showStatusBar:!1,preview:!1,previewMode:`subwordSmart`,showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(B.suggest,`suggest`,e,{"editor.suggest.insertMode":{type:`string`,enum:[`insert`,`replace`],enumDescriptions:[C(429,`Insert suggestion without overwriting text right of the cursor.`),C(430,`Insert suggestion and overwrite text right of the cursor.`)],default:e.insertMode,description:C(431,`Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.`)},"editor.suggest.filterGraceful":{type:`boolean`,default:e.filterGraceful,description:C(432,`Controls whether filtering and sorting suggestions accounts for small typos.`)},"editor.suggest.localityBonus":{type:`boolean`,default:e.localityBonus,description:C(433,`Controls whether sorting favors words that appear close to the cursor.`)},"editor.suggest.shareSuggestSelections":{type:`boolean`,default:e.shareSuggestSelections,markdownDescription:C(434,"Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:`string`,enum:[`always`,`never`,`whenTriggerCharacter`,`whenQuickSuggestion`],enumDescriptions:[C(435,`Always select a suggestion when automatically triggering IntelliSense.`),C(436,`Never select a suggestion when automatically triggering IntelliSense.`),C(437,`Select a suggestion only when triggering IntelliSense from a trigger character.`),C(438,`Select a suggestion only when triggering IntelliSense as you type.`)],default:e.selectionMode,markdownDescription:C(439,"Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:`boolean`,default:e.snippetsPreventQuickSuggestions,description:C(440,`Controls whether an active snippet prevents quick suggestions.`)},"editor.suggest.showIcons":{type:`boolean`,default:e.showIcons,description:C(441,`Controls whether to show or hide icons in suggestions.`)},"editor.suggest.showStatusBar":{type:`boolean`,default:e.showStatusBar,description:C(442,`Controls the visibility of the status bar at the bottom of the suggest widget.`)},"editor.suggest.preview":{type:`boolean`,default:e.preview,description:C(443,`Controls whether to preview the suggestion outcome in the editor.`)},"editor.suggest.showInlineDetails":{type:`boolean`,default:e.showInlineDetails,description:C(444,`Controls whether suggest details show inline with the label or only in the details widget.`)},"editor.suggest.maxVisibleSuggestions":{type:`number`,deprecationMessage:C(445,`This setting is deprecated. The suggest widget can now be resized.`)},"editor.suggest.filteredTypes":{type:`object`,deprecationMessage:C(446,`This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.`)},"editor.suggest.showMethods":{type:`boolean`,default:!0,markdownDescription:C(447,"When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:`boolean`,default:!0,markdownDescription:C(448,"When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:`boolean`,default:!0,markdownDescription:C(449,"When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:`boolean`,default:!0,markdownDescription:C(450,"When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:`boolean`,default:!0,markdownDescription:C(451,"When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:`boolean`,default:!0,markdownDescription:C(452,"When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:`boolean`,default:!0,markdownDescription:C(453,"When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:`boolean`,default:!0,markdownDescription:C(454,"When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:`boolean`,default:!0,markdownDescription:C(455,"When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:`boolean`,default:!0,markdownDescription:C(456,"When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:`boolean`,default:!0,markdownDescription:C(457,"When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:`boolean`,default:!0,markdownDescription:C(458,"When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:`boolean`,default:!0,markdownDescription:C(459,"When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:`boolean`,default:!0,markdownDescription:C(460,"When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:`boolean`,default:!0,markdownDescription:C(461,"When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:`boolean`,default:!0,markdownDescription:C(462,"When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:`boolean`,default:!0,markdownDescription:C(463,"When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:`boolean`,default:!0,markdownDescription:C(464,"When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:`boolean`,default:!0,markdownDescription:C(465,"When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:`boolean`,default:!0,markdownDescription:C(466,"When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:`boolean`,default:!0,markdownDescription:C(467,"When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:`boolean`,default:!0,markdownDescription:C(468,"When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:`boolean`,default:!0,markdownDescription:C(469,"When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:`boolean`,default:!0,markdownDescription:C(470,"When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:`boolean`,default:!0,markdownDescription:C(471,"When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:`boolean`,default:!0,markdownDescription:C(472,"When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:`boolean`,default:!0,markdownDescription:C(473,"When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:`boolean`,default:!0,markdownDescription:C(474,"When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:`boolean`,default:!0,markdownDescription:C(475,"When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:`boolean`,default:!0,markdownDescription:C(476,"When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{insertMode:lf(t.insertMode,this.defaultValue.insertMode,[`insert`,`replace`]),filterGraceful:L(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:L(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:L(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:L(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:lf(t.selectionMode,this.defaultValue.selectionMode,[`always`,`never`,`whenQuickSuggestion`,`whenTriggerCharacter`]),showIcons:L(t.showIcons,this.defaultValue.showIcons),showStatusBar:L(t.showStatusBar,this.defaultValue.showStatusBar),preview:L(t.preview,this.defaultValue.preview),previewMode:lf(t.previewMode,this.defaultValue.previewMode,[`prefix`,`subword`,`subwordSmart`]),showInlineDetails:L(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:L(t.showMethods,this.defaultValue.showMethods),showFunctions:L(t.showFunctions,this.defaultValue.showFunctions),showConstructors:L(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:L(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:L(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:L(t.showFields,this.defaultValue.showFields),showVariables:L(t.showVariables,this.defaultValue.showVariables),showClasses:L(t.showClasses,this.defaultValue.showClasses),showStructs:L(t.showStructs,this.defaultValue.showStructs),showInterfaces:L(t.showInterfaces,this.defaultValue.showInterfaces),showModules:L(t.showModules,this.defaultValue.showModules),showProperties:L(t.showProperties,this.defaultValue.showProperties),showEvents:L(t.showEvents,this.defaultValue.showEvents),showOperators:L(t.showOperators,this.defaultValue.showOperators),showUnits:L(t.showUnits,this.defaultValue.showUnits),showValues:L(t.showValues,this.defaultValue.showValues),showConstants:L(t.showConstants,this.defaultValue.showConstants),showEnums:L(t.showEnums,this.defaultValue.showEnums),showEnumMembers:L(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:L(t.showKeywords,this.defaultValue.showKeywords),showWords:L(t.showWords,this.defaultValue.showWords),showColors:L(t.showColors,this.defaultValue.showColors),showFiles:L(t.showFiles,this.defaultValue.showFiles),showReferences:L(t.showReferences,this.defaultValue.showReferences),showFolders:L(t.showFolders,this.defaultValue.showFolders),showTypeParameters:L(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:L(t.showSnippets,this.defaultValue.showSnippets),showUsers:L(t.showUsers,this.defaultValue.showUsers),showIssues:L(t.showIssues,this.defaultValue.showIssues)}}},cp=class extends Qd{constructor(){super(B.smartSelect,`smartSelect`,{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:C(477,`Whether leading and trailing whitespace should always be selected.`),default:!0,type:`boolean`},"editor.smartSelect.selectSubwords":{description:C(478,`Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected.`),default:!0,type:`boolean`}})}validate(e){return!e||typeof e!=`object`?this.defaultValue:{selectLeadingAndTrailingWhitespace:L(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:L(e.selectSubwords,this.defaultValue.selectSubwords)}}},lp=class extends Qd{constructor(){let e=[];super(B.wordSegmenterLocales,`wordSegmenterLocales`,e,{anyOf:[{type:`string`},{type:`array`,items:{type:`string`}}],description:C(479,`Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.).`),type:`array`,items:{type:`string`},default:e})}validate(e){if(typeof e==`string`&&(e=[e]),Array.isArray(e)){let t=[];for(let n of e)if(typeof n==`string`)try{Intl.Segmenter.supportedLocalesOf(n).length>0&&t.push(n)}catch{}return t}return this.defaultValue}},up;(function(e){e[e.None=0]=`None`,e[e.Same=1]=`Same`,e[e.Indent=2]=`Indent`,e[e.DeepIndent=3]=`DeepIndent`})(up||={});var dp=class extends Qd{constructor(){super(B.wrappingIndent,`wrappingIndent`,up.Same,{"editor.wrappingIndent":{type:`string`,enum:[`none`,`same`,`indent`,`deepIndent`],enumDescriptions:[C(480,`No indentation. Wrapped lines begin at column 1.`),C(481,`Wrapped lines get the same indentation as the parent.`),C(482,`Wrapped lines get +1 indentation toward the parent.`),C(483,`Wrapped lines get +2 indentation toward the parent.`)],description:C(484,`Controls the indentation of wrapped lines.`),default:`same`}})}validate(e){switch(e){case`none`:return up.None;case`same`:return up.Same;case`indent`:return up.Indent;case`deepIndent`:return up.DeepIndent}return up.Same}compute(e,t,n){let r=t.get(B.accessibilitySupport);return r===Yd.Enabled?up.None:n}},fp=class extends tf{constructor(){super(B.wrappingInfo)}compute(e,t,n){let r=t.get(B.layoutInfo);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:r.isWordWrapMinified,isViewportWrapping:r.isViewportWrapping,wrappingColumn:r.wrappingColumn}}},pp=class extends Qd{constructor(){let e={enabled:!0,showDropSelector:`afterDrop`};super(B.dropIntoEditor,`dropIntoEditor`,e,{"editor.dropIntoEditor.enabled":{type:`boolean`,default:e.enabled,markdownDescription:C(485,"Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:`string`,markdownDescription:C(486,`Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped.`),enum:[`afterDrop`,`never`],enumDescriptions:[C(487,`Show the drop selector widget after a file is dropped into the editor.`),C(488,`Never show the drop selector widget. Instead the default drop provider is always used.`)],default:`afterDrop`}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{enabled:L(t.enabled,this.defaultValue.enabled),showDropSelector:lf(t.showDropSelector,this.defaultValue.showDropSelector,[`afterDrop`,`never`])}}},mp=class extends Qd{constructor(){let e={enabled:!0,showPasteSelector:`afterPaste`};super(B.pasteAs,`pasteAs`,e,{"editor.pasteAs.enabled":{type:`boolean`,default:e.enabled,markdownDescription:C(489,`Controls whether you can paste content in different ways.`)},"editor.pasteAs.showPasteSelector":{type:`string`,markdownDescription:C(490,`Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted.`),enum:[`afterPaste`,`never`],enumDescriptions:[C(491,`Show the paste selector widget after content is pasted into the editor.`),C(492,`Never show the paste selector widget. Instead the default pasting behavior is always used.`)],default:`afterPaste`}})}validate(e){if(!e||typeof e!=`object`)return this.defaultValue;let t=e;return{enabled:L(t.enabled,this.defaultValue.enabled),showPasteSelector:lf(t.showPasteSelector,this.defaultValue.showPasteSelector,[`afterPaste`,`never`])}}};const hp={fontFamily:Zn?`Menlo, Monaco, 'Courier New', monospace`:Xn?`Consolas, 'Courier New', monospace`:`'Droid Sans Mono', 'monospace', monospace`,fontWeight:`normal`,fontSize:Zn?12:14,lineHeight:0,letterSpacing:0},gp=[];function z(e){return gp[e.id]=e,e}var B;(function(e){e[e.acceptSuggestionOnCommitCharacter=0]=`acceptSuggestionOnCommitCharacter`,e[e.acceptSuggestionOnEnter=1]=`acceptSuggestionOnEnter`,e[e.accessibilitySupport=2]=`accessibilitySupport`,e[e.accessibilityPageSize=3]=`accessibilityPageSize`,e[e.allowOverflow=4]=`allowOverflow`,e[e.allowVariableLineHeights=5]=`allowVariableLineHeights`,e[e.allowVariableFonts=6]=`allowVariableFonts`,e[e.allowVariableFontsInAccessibilityMode=7]=`allowVariableFontsInAccessibilityMode`,e[e.ariaLabel=8]=`ariaLabel`,e[e.ariaRequired=9]=`ariaRequired`,e[e.autoClosingBrackets=10]=`autoClosingBrackets`,e[e.autoClosingComments=11]=`autoClosingComments`,e[e.screenReaderAnnounceInlineSuggestion=12]=`screenReaderAnnounceInlineSuggestion`,e[e.autoClosingDelete=13]=`autoClosingDelete`,e[e.autoClosingOvertype=14]=`autoClosingOvertype`,e[e.autoClosingQuotes=15]=`autoClosingQuotes`,e[e.autoIndent=16]=`autoIndent`,e[e.autoIndentOnPaste=17]=`autoIndentOnPaste`,e[e.autoIndentOnPasteWithinString=18]=`autoIndentOnPasteWithinString`,e[e.automaticLayout=19]=`automaticLayout`,e[e.autoSurround=20]=`autoSurround`,e[e.bracketPairColorization=21]=`bracketPairColorization`,e[e.guides=22]=`guides`,e[e.codeLens=23]=`codeLens`,e[e.codeLensFontFamily=24]=`codeLensFontFamily`,e[e.codeLensFontSize=25]=`codeLensFontSize`,e[e.colorDecorators=26]=`colorDecorators`,e[e.colorDecoratorsLimit=27]=`colorDecoratorsLimit`,e[e.columnSelection=28]=`columnSelection`,e[e.comments=29]=`comments`,e[e.contextmenu=30]=`contextmenu`,e[e.copyWithSyntaxHighlighting=31]=`copyWithSyntaxHighlighting`,e[e.cursorBlinking=32]=`cursorBlinking`,e[e.cursorSmoothCaretAnimation=33]=`cursorSmoothCaretAnimation`,e[e.cursorStyle=34]=`cursorStyle`,e[e.cursorSurroundingLines=35]=`cursorSurroundingLines`,e[e.cursorSurroundingLinesStyle=36]=`cursorSurroundingLinesStyle`,e[e.cursorWidth=37]=`cursorWidth`,e[e.cursorHeight=38]=`cursorHeight`,e[e.disableLayerHinting=39]=`disableLayerHinting`,e[e.disableMonospaceOptimizations=40]=`disableMonospaceOptimizations`,e[e.domReadOnly=41]=`domReadOnly`,e[e.dragAndDrop=42]=`dragAndDrop`,e[e.dropIntoEditor=43]=`dropIntoEditor`,e[e.editContext=44]=`editContext`,e[e.emptySelectionClipboard=45]=`emptySelectionClipboard`,e[e.experimentalGpuAcceleration=46]=`experimentalGpuAcceleration`,e[e.experimentalWhitespaceRendering=47]=`experimentalWhitespaceRendering`,e[e.extraEditorClassName=48]=`extraEditorClassName`,e[e.fastScrollSensitivity=49]=`fastScrollSensitivity`,e[e.find=50]=`find`,e[e.fixedOverflowWidgets=51]=`fixedOverflowWidgets`,e[e.folding=52]=`folding`,e[e.foldingStrategy=53]=`foldingStrategy`,e[e.foldingHighlight=54]=`foldingHighlight`,e[e.foldingImportsByDefault=55]=`foldingImportsByDefault`,e[e.foldingMaximumRegions=56]=`foldingMaximumRegions`,e[e.unfoldOnClickAfterEndOfLine=57]=`unfoldOnClickAfterEndOfLine`,e[e.fontFamily=58]=`fontFamily`,e[e.fontInfo=59]=`fontInfo`,e[e.fontLigatures=60]=`fontLigatures`,e[e.fontSize=61]=`fontSize`,e[e.fontWeight=62]=`fontWeight`,e[e.fontVariations=63]=`fontVariations`,e[e.formatOnPaste=64]=`formatOnPaste`,e[e.formatOnType=65]=`formatOnType`,e[e.glyphMargin=66]=`glyphMargin`,e[e.gotoLocation=67]=`gotoLocation`,e[e.hideCursorInOverviewRuler=68]=`hideCursorInOverviewRuler`,e[e.hover=69]=`hover`,e[e.inDiffEditor=70]=`inDiffEditor`,e[e.inlineSuggest=71]=`inlineSuggest`,e[e.letterSpacing=72]=`letterSpacing`,e[e.lightbulb=73]=`lightbulb`,e[e.lineDecorationsWidth=74]=`lineDecorationsWidth`,e[e.lineHeight=75]=`lineHeight`,e[e.lineNumbers=76]=`lineNumbers`,e[e.lineNumbersMinChars=77]=`lineNumbersMinChars`,e[e.linkedEditing=78]=`linkedEditing`,e[e.links=79]=`links`,e[e.matchBrackets=80]=`matchBrackets`,e[e.minimap=81]=`minimap`,e[e.mouseStyle=82]=`mouseStyle`,e[e.mouseWheelScrollSensitivity=83]=`mouseWheelScrollSensitivity`,e[e.mouseWheelZoom=84]=`mouseWheelZoom`,e[e.multiCursorMergeOverlapping=85]=`multiCursorMergeOverlapping`,e[e.multiCursorModifier=86]=`multiCursorModifier`,e[e.multiCursorPaste=87]=`multiCursorPaste`,e[e.multiCursorLimit=88]=`multiCursorLimit`,e[e.occurrencesHighlight=89]=`occurrencesHighlight`,e[e.occurrencesHighlightDelay=90]=`occurrencesHighlightDelay`,e[e.overtypeCursorStyle=91]=`overtypeCursorStyle`,e[e.overtypeOnPaste=92]=`overtypeOnPaste`,e[e.overviewRulerBorder=93]=`overviewRulerBorder`,e[e.overviewRulerLanes=94]=`overviewRulerLanes`,e[e.padding=95]=`padding`,e[e.pasteAs=96]=`pasteAs`,e[e.parameterHints=97]=`parameterHints`,e[e.peekWidgetDefaultFocus=98]=`peekWidgetDefaultFocus`,e[e.placeholder=99]=`placeholder`,e[e.definitionLinkOpensInPeek=100]=`definitionLinkOpensInPeek`,e[e.quickSuggestions=101]=`quickSuggestions`,e[e.quickSuggestionsDelay=102]=`quickSuggestionsDelay`,e[e.readOnly=103]=`readOnly`,e[e.readOnlyMessage=104]=`readOnlyMessage`,e[e.renameOnType=105]=`renameOnType`,e[e.renderRichScreenReaderContent=106]=`renderRichScreenReaderContent`,e[e.renderControlCharacters=107]=`renderControlCharacters`,e[e.renderFinalNewline=108]=`renderFinalNewline`,e[e.renderLineHighlight=109]=`renderLineHighlight`,e[e.renderLineHighlightOnlyWhenFocus=110]=`renderLineHighlightOnlyWhenFocus`,e[e.renderValidationDecorations=111]=`renderValidationDecorations`,e[e.renderWhitespace=112]=`renderWhitespace`,e[e.revealHorizontalRightPadding=113]=`revealHorizontalRightPadding`,e[e.roundedSelection=114]=`roundedSelection`,e[e.rulers=115]=`rulers`,e[e.scrollbar=116]=`scrollbar`,e[e.scrollBeyondLastColumn=117]=`scrollBeyondLastColumn`,e[e.scrollBeyondLastLine=118]=`scrollBeyondLastLine`,e[e.scrollPredominantAxis=119]=`scrollPredominantAxis`,e[e.selectionClipboard=120]=`selectionClipboard`,e[e.selectionHighlight=121]=`selectionHighlight`,e[e.selectionHighlightMaxLength=122]=`selectionHighlightMaxLength`,e[e.selectionHighlightMultiline=123]=`selectionHighlightMultiline`,e[e.selectOnLineNumbers=124]=`selectOnLineNumbers`,e[e.showFoldingControls=125]=`showFoldingControls`,e[e.showUnused=126]=`showUnused`,e[e.snippetSuggestions=127]=`snippetSuggestions`,e[e.smartSelect=128]=`smartSelect`,e[e.smoothScrolling=129]=`smoothScrolling`,e[e.stickyScroll=130]=`stickyScroll`,e[e.stickyTabStops=131]=`stickyTabStops`,e[e.stopRenderingLineAfter=132]=`stopRenderingLineAfter`,e[e.suggest=133]=`suggest`,e[e.suggestFontSize=134]=`suggestFontSize`,e[e.suggestLineHeight=135]=`suggestLineHeight`,e[e.suggestOnTriggerCharacters=136]=`suggestOnTriggerCharacters`,e[e.suggestSelection=137]=`suggestSelection`,e[e.tabCompletion=138]=`tabCompletion`,e[e.tabIndex=139]=`tabIndex`,e[e.trimWhitespaceOnDelete=140]=`trimWhitespaceOnDelete`,e[e.unicodeHighlighting=141]=`unicodeHighlighting`,e[e.unusualLineTerminators=142]=`unusualLineTerminators`,e[e.useShadowDOM=143]=`useShadowDOM`,e[e.useTabStops=144]=`useTabStops`,e[e.wordBreak=145]=`wordBreak`,e[e.wordSegmenterLocales=146]=`wordSegmenterLocales`,e[e.wordSeparators=147]=`wordSeparators`,e[e.wordWrap=148]=`wordWrap`,e[e.wordWrapBreakAfterCharacters=149]=`wordWrapBreakAfterCharacters`,e[e.wordWrapBreakBeforeCharacters=150]=`wordWrapBreakBeforeCharacters`,e[e.wordWrapColumn=151]=`wordWrapColumn`,e[e.wordWrapOverride1=152]=`wordWrapOverride1`,e[e.wordWrapOverride2=153]=`wordWrapOverride2`,e[e.wrappingIndent=154]=`wrappingIndent`,e[e.wrappingStrategy=155]=`wrappingStrategy`,e[e.showDeprecated=156]=`showDeprecated`,e[e.inertialScroll=157]=`inertialScroll`,e[e.inlayHints=158]=`inlayHints`,e[e.wrapOnEscapedLineFeeds=159]=`wrapOnEscapedLineFeeds`,e[e.effectiveCursorStyle=160]=`effectiveCursorStyle`,e[e.editorClassName=161]=`editorClassName`,e[e.pixelRatio=162]=`pixelRatio`,e[e.tabFocusMode=163]=`tabFocusMode`,e[e.layoutInfo=164]=`layoutInfo`,e[e.wrappingInfo=165]=`wrappingInfo`,e[e.defaultColorDecorators=166]=`defaultColorDecorators`,e[e.colorDecoratorsActivatedOn=167]=`colorDecoratorsActivatedOn`,e[e.inlineCompletionsAccessibilityVerbose=168]=`inlineCompletionsAccessibilityVerbose`,e[e.effectiveEditContext=169]=`effectiveEditContext`,e[e.scrollOnMiddleClick=170]=`scrollOnMiddleClick`,e[e.effectiveAllowVariableFonts=171]=`effectiveAllowVariableFonts`})(B||={}),z(new R(B.acceptSuggestionOnCommitCharacter,`acceptSuggestionOnCommitCharacter`,!0,{markdownDescription:C(493,"Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),z(new uf(B.acceptSuggestionOnEnter,`acceptSuggestionOnEnter`,`on`,[`on`,`smart`,`off`],{markdownEnumDescriptions:[``,C(494,"Only accept a suggestion with `Enter` when it makes a textual change."),``],markdownDescription:C(495,"Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),z(new pf),z(new af(B.accessibilityPageSize,`accessibilityPageSize`,500,1,Ni.MAX_SAFE_SMALL_INTEGER,{description:C(496,`Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default.`),tags:[`accessibility`]})),z(new R(B.allowOverflow,`allowOverflow`,!0)),z(new R(B.allowVariableLineHeights,`allowVariableLineHeights`,!0,{description:C(497,`Controls whether to allow using variable line heights in the editor.`)})),z(new R(B.allowVariableFonts,`allowVariableFonts`,!0,{description:C(498,`Controls whether to allow using variable fonts in the editor.`)})),z(new R(B.allowVariableFontsInAccessibilityMode,`allowVariableFontsInAccessibilityMode`,!1,{description:C(499,`Controls whether to allow using variable fonts in the editor in the accessibility mode.`),tags:[`accessibility`]})),z(new cf(B.ariaLabel,`ariaLabel`,C(500,`Editor content`))),z(new R(B.ariaRequired,`ariaRequired`,!1,void 0)),z(new R(B.screenReaderAnnounceInlineSuggestion,`screenReaderAnnounceInlineSuggestion`,!0,{description:C(501,`Control whether inline suggestions are announced by a screen reader.`),tags:[`accessibility`]})),z(new uf(B.autoClosingBrackets,`autoClosingBrackets`,`languageDefined`,[`always`,`languageDefined`,`beforeWhitespace`,`never`],{enumDescriptions:[``,C(502,`Use language configurations to determine when to autoclose brackets.`),C(503,`Autoclose brackets only when the cursor is to the left of whitespace.`),``],description:C(504,`Controls whether the editor should automatically close brackets after the user adds an opening bracket.`)})),z(new uf(B.autoClosingComments,`autoClosingComments`,`languageDefined`,[`always`,`languageDefined`,`beforeWhitespace`,`never`],{enumDescriptions:[``,C(505,`Use language configurations to determine when to autoclose comments.`),C(506,`Autoclose comments only when the cursor is to the left of whitespace.`),``],description:C(507,`Controls whether the editor should automatically close comments after the user adds an opening comment.`)})),z(new uf(B.autoClosingDelete,`autoClosingDelete`,`auto`,[`always`,`auto`,`never`],{enumDescriptions:[``,C(508,`Remove adjacent closing quotes or brackets only if they were automatically inserted.`),``],description:C(509,`Controls whether the editor should remove adjacent closing quotes or brackets when deleting.`)})),z(new uf(B.autoClosingOvertype,`autoClosingOvertype`,`auto`,[`always`,`auto`,`never`],{enumDescriptions:[``,C(510,`Type over closing quotes or brackets only if they were automatically inserted.`),``],description:C(511,`Controls whether the editor should type over closing quotes or brackets.`)})),z(new uf(B.autoClosingQuotes,`autoClosingQuotes`,`languageDefined`,[`always`,`languageDefined`,`beforeWhitespace`,`never`],{enumDescriptions:[``,C(512,`Use language configurations to determine when to autoclose quotes.`),C(513,`Autoclose quotes only when the cursor is to the left of whitespace.`),``],description:C(514,`Controls whether the editor should automatically close quotes after the user adds an opening quote.`)})),z(new df(B.autoIndent,`autoIndent`,Xd.Full,`full`,[`none`,`keep`,`brackets`,`advanced`,`full`],ff,{enumDescriptions:[C(515,`The editor will not insert indentation automatically.`),C(516,`The editor will keep the current line's indentation.`),C(517,`The editor will keep the current line's indentation and honor language defined brackets.`),C(518,`The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages.`),C(519,`The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.`)],description:C(520,`Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.`)})),z(new R(B.autoIndentOnPaste,`autoIndentOnPaste`,!1,{description:C(521,`Controls whether the editor should automatically auto-indent the pasted content.`)})),z(new R(B.autoIndentOnPasteWithinString,`autoIndentOnPasteWithinString`,!0,{description:C(522,`Controls whether the editor should automatically auto-indent the pasted content when pasted within a string. This takes effect when autoIndentOnPaste is true.`)})),z(new R(B.automaticLayout,`automaticLayout`,!1)),z(new uf(B.autoSurround,`autoSurround`,`languageDefined`,[`languageDefined`,`quotes`,`brackets`,`never`],{enumDescriptions:[C(523,`Use language configurations to determine when to automatically surround selections.`),C(524,`Surround with quotes but not brackets.`),C(525,`Surround with brackets but not quotes.`),``],description:C(526,`Controls whether the editor should automatically surround selections when typing quotes or brackets.`)})),z(new ip),z(new ap),z(new R(B.stickyTabStops,`stickyTabStops`,!1,{description:C(527,`Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.`)})),z(new R(B.codeLens,`codeLens`,!0,{description:C(528,`Controls whether the editor shows CodeLens.`)})),z(new cf(B.codeLensFontFamily,`codeLensFontFamily`,``,{description:C(529,`Controls the font family for CodeLens.`)})),z(new af(B.codeLensFontSize,`codeLensFontSize`,0,0,100,{type:`number`,default:0,minimum:0,maximum:100,markdownDescription:C(530,"Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),z(new R(B.colorDecorators,`colorDecorators`,!0,{description:C(531,`Controls whether the editor should render the inline color decorators and color picker.`)})),z(new uf(B.colorDecoratorsActivatedOn,`colorDecoratorsActivatedOn`,`clickAndHover`,[`clickAndHover`,`hover`,`click`],{enumDescriptions:[C(532,`Make the color picker appear both on click and hover of the color decorator`),C(533,`Make the color picker appear on hover of the color decorator`),C(534,`Make the color picker appear on click of the color decorator`)],description:C(535,`Controls the condition to make a color picker appear from a color decorator.`)})),z(new af(B.colorDecoratorsLimit,`colorDecoratorsLimit`,500,1,1e6,{markdownDescription:C(536,`Controls the max number of color decorators that can be rendered in an editor at once.`)})),z(new R(B.columnSelection,`columnSelection`,!1,{description:C(537,`Enable that the selection with the mouse and keys is doing column selection.`)})),z(new mf),z(new R(B.contextmenu,`contextmenu`,!0)),z(new R(B.copyWithSyntaxHighlighting,`copyWithSyntaxHighlighting`,!0,{description:C(538,`Controls whether syntax highlighting should be copied into the clipboard.`)})),z(new df(B.cursorBlinking,`cursorBlinking`,hf.Blink,`blink`,[`blink`,`smooth`,`phase`,`expand`,`solid`],gf,{description:C(539,`Control the cursor animation style.`)})),z(new uf(B.cursorSmoothCaretAnimation,`cursorSmoothCaretAnimation`,`off`,[`off`,`explicit`,`on`],{enumDescriptions:[C(540,`Smooth caret animation is disabled.`),C(541,`Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture.`),C(542,`Smooth caret animation is always enabled.`)],description:C(543,`Controls whether the smooth caret animation should be enabled.`)})),z(new df(B.cursorStyle,`cursorStyle`,_f.Line,`line`,[`line`,`block`,`underline`,`line-thin`,`block-outline`,`underline-thin`],vf,{description:C(544,`Controls the cursor style in insert input mode.`)})),z(new df(B.overtypeCursorStyle,`overtypeCursorStyle`,_f.Block,`block`,[`line`,`block`,`underline`,`line-thin`,`block-outline`,`underline-thin`],vf,{description:C(545,`Controls the cursor style in overtype input mode.`)})),z(new af(B.cursorSurroundingLines,`cursorSurroundingLines`,0,0,Ni.MAX_SAFE_SMALL_INTEGER,{description:C(546,`Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.`)})),z(new uf(B.cursorSurroundingLinesStyle,`cursorSurroundingLinesStyle`,`default`,[`default`,`all`],{enumDescriptions:[C(547,"`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),C(548,"`cursorSurroundingLines` is enforced always.")],markdownDescription:C(549,"Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),z(new af(B.cursorWidth,`cursorWidth`,0,0,Ni.MAX_SAFE_SMALL_INTEGER,{markdownDescription:C(550,"Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),z(new af(B.cursorHeight,`cursorHeight`,0,0,Ni.MAX_SAFE_SMALL_INTEGER,{markdownDescription:C(551,"Controls the height of the cursor when `#editor.cursorStyle#` is set to `line`. Cursor's max height depends on line height.")})),z(new R(B.disableLayerHinting,`disableLayerHinting`,!1)),z(new R(B.disableMonospaceOptimizations,`disableMonospaceOptimizations`,!1)),z(new R(B.domReadOnly,`domReadOnly`,!1)),z(new R(B.dragAndDrop,`dragAndDrop`,!0,{description:C(552,`Controls whether the editor should allow moving selections via drag and drop.`)})),z(new bf),z(new pp),z(new R(B.editContext,`editContext`,!0,{description:C(553,`Sets whether the EditContext API should be used instead of the text area to power input in the editor.`),included:gr||yr||$n})),z(new R(B.renderRichScreenReaderContent,`renderRichScreenReaderContent`,!1,{description:C(554,"Whether to render rich screen reader content when the `editor.editContext` is enabled.")})),z(new Lf),z(new uf(B.experimentalGpuAcceleration,`experimentalGpuAcceleration`,`off`,[`off`,`on`],{tags:[`experimental`],enumDescriptions:[C(555,`Use regular DOM-based rendering.`),C(556,`Use GPU acceleration.`)],description:C(557,`Controls whether to use the experimental GPU acceleration to render the editor.`)})),z(new uf(B.experimentalWhitespaceRendering,`experimentalWhitespaceRendering`,`svg`,[`svg`,`font`,`off`],{enumDescriptions:[C(558,`Use a new rendering method with svgs.`),C(559,`Use a new rendering method with font characters.`),C(560,`Use the stable rendering method.`)],description:C(561,`Controls whether whitespace is rendered with a new, experimental method.`)})),z(new cf(B.extraEditorClassName,`extraEditorClassName`,``)),z(new sf(B.fastScrollSensitivity,`fastScrollSensitivity`,5,e=>e<=0?5:e,{markdownDescription:C(562,"Scrolling speed multiplier when pressing `Alt`.")})),z(new xf),z(new R(B.fixedOverflowWidgets,`fixedOverflowWidgets`,!1)),z(new R(B.folding,`folding`,!0,{description:C(563,`Controls whether the editor has code folding enabled.`)})),z(new uf(B.foldingStrategy,`foldingStrategy`,`auto`,[`auto`,`indentation`],{enumDescriptions:[C(564,`Use a language-specific folding strategy if available, else the indentation-based one.`),C(565,`Use the indentation-based folding strategy.`)],description:C(566,`Controls the strategy for computing folding ranges.`)})),z(new R(B.foldingHighlight,`foldingHighlight`,!0,{description:C(567,`Controls whether the editor should highlight folded ranges.`)})),z(new R(B.foldingImportsByDefault,`foldingImportsByDefault`,!1,{description:C(568,`Controls whether the editor automatically collapses import ranges.`)})),z(new af(B.foldingMaximumRegions,`foldingMaximumRegions`,5e3,10,65e3,{description:C(569,`The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.`)})),z(new R(B.unfoldOnClickAfterEndOfLine,`unfoldOnClickAfterEndOfLine`,!1,{description:C(570,`Controls whether clicking on the empty content after a folded line will unfold the line.`)})),z(new cf(B.fontFamily,`fontFamily`,hp.fontFamily,{description:C(571,`Controls the font family.`)})),z(new wf),z(new Sf),z(new Of),z(new kf),z(new Cf),z(new R(B.formatOnPaste,`formatOnPaste`,!1,{description:C(572,`Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.`)})),z(new R(B.formatOnType,`formatOnType`,!1,{description:C(573,`Controls whether the editor should automatically format the line after typing.`)})),z(new R(B.glyphMargin,`glyphMargin`,!0,{description:C(574,`Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.`)})),z(new Af),z(new R(B.hideCursorInOverviewRuler,`hideCursorInOverviewRuler`,!1,{description:C(575,`Controls whether the cursor should be hidden in the overview ruler.`)})),z(new jf),z(new R(B.inDiffEditor,`inDiffEditor`,!1)),z(new R(B.inertialScroll,`inertialScroll`,!1,{description:C(576,`Make scrolling inertial - mostly useful with touchpad on linux.`)})),z(new sf(B.letterSpacing,`letterSpacing`,hp.letterSpacing,e=>sf.clamp(e,-5,20),{description:C(577,`Controls the letter spacing in pixels.`)})),z(new If),z(new zf),z(new Bf),z(new Yf),z(new af(B.lineNumbersMinChars,`lineNumbersMinChars`,5,1,300)),z(new R(B.linkedEditing,`linkedEditing`,!1,{description:C(578,`Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.`)})),z(new R(B.links,`links`,!0,{description:C(579,`Controls whether the editor should detect links and make them clickable.`)})),z(new uf(B.matchBrackets,`matchBrackets`,`always`,[`always`,`near`,`never`],{description:C(580,`Highlight matching brackets.`)})),z(new Vf),z(new uf(B.mouseStyle,`mouseStyle`,`text`,[`text`,`default`,`copy`])),z(new sf(B.mouseWheelScrollSensitivity,`mouseWheelScrollSensitivity`,1,e=>e===0?1:e,{markdownDescription:C(581,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),z(new R(B.mouseWheelZoom,`mouseWheelZoom`,!1,{markdownDescription:Zn?C(582,"Zoom the font of the editor when using mouse wheel and holding `Cmd`."):C(583,"Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),z(new R(B.multiCursorMergeOverlapping,`multiCursorMergeOverlapping`,!0,{description:C(584,`Merge multiple cursors when they are overlapping.`)})),z(new df(B.multiCursorModifier,`multiCursorModifier`,`altKey`,`alt`,[`ctrlCmd`,`alt`],Hf,{markdownEnumDescriptions:[C(585,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),C(586,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:C(587,`The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).`)})),z(new uf(B.multiCursorPaste,`multiCursorPaste`,`spread`,[`spread`,`full`],{markdownEnumDescriptions:[C(588,`Each cursor pastes a single line of the text.`),C(589,`Each cursor pastes the full text.`)],markdownDescription:C(590,`Controls pasting when the line count of the pasted text matches the cursor count.`)})),z(new af(B.multiCursorLimit,`multiCursorLimit`,1e4,1,1e5,{markdownDescription:C(591,`Controls the max number of cursors that can be in an active editor at once.`)})),z(new uf(B.occurrencesHighlight,`occurrencesHighlight`,`singleFile`,[`off`,`singleFile`,`multiFile`],{markdownEnumDescriptions:[C(592,`Does not highlight occurrences.`),C(593,`Highlights occurrences only in the current file.`),C(594,`Experimental: Highlights occurrences across all valid open files.`)],markdownDescription:C(595,`Controls whether occurrences should be highlighted across open files.`)})),z(new af(B.occurrencesHighlightDelay,`occurrencesHighlightDelay`,0,0,2e3,{description:C(596,`Controls the delay in milliseconds after which occurrences are highlighted.`),tags:[`preview`]})),z(new R(B.overtypeOnPaste,`overtypeOnPaste`,!0,{description:C(597,`Controls whether pasting should overtype.`)})),z(new R(B.overviewRulerBorder,`overviewRulerBorder`,!0,{description:C(598,`Controls whether a border should be drawn around the overview ruler.`)})),z(new af(B.overviewRulerLanes,`overviewRulerLanes`,3,0,3)),z(new Uf),z(new mp),z(new Wf),z(new uf(B.peekWidgetDefaultFocus,`peekWidgetDefaultFocus`,`tree`,[`tree`,`editor`],{enumDescriptions:[C(599,`Focus the tree when opening peek`),C(600,`Focus the editor when opening peek`)],description:C(601,`Controls whether to focus the inline editor or the tree in the peek widget.`)})),z(new Kf),z(new R(B.definitionLinkOpensInPeek,`definitionLinkOpensInPeek`,!1,{description:C(602,`Controls whether the Go to Definition mouse gesture always opens the peek widget.`)})),z(new qf),z(new af(B.quickSuggestionsDelay,`quickSuggestionsDelay`,10,0,Ni.MAX_SAFE_SMALL_INTEGER,{description:C(603,`Controls the delay in milliseconds after which quick suggestions will show up.`),experiment:{mode:`startup`}})),z(new R(B.readOnly,`readOnly`,!1)),z(new Zf),z(new R(B.renameOnType,`renameOnType`,!1,{description:C(604,`Controls whether the editor auto renames on type.`),markdownDeprecationMessage:C(605,"Deprecated, use `editor.linkedEditing` instead.")})),z(new R(B.renderControlCharacters,`renderControlCharacters`,!0,{description:C(606,`Controls whether the editor should render control characters.`),restricted:!0})),z(new uf(B.renderFinalNewline,`renderFinalNewline`,Qn?`dimmed`:`on`,[`off`,`on`,`dimmed`],{description:C(607,`Render last line number when the file ends with a newline.`)})),z(new uf(B.renderLineHighlight,`renderLineHighlight`,`line`,[`none`,`gutter`,`line`,`all`],{enumDescriptions:[``,``,``,C(608,`Highlights both the gutter and the current line.`)],description:C(609,`Controls how the editor should render the current line highlight.`)})),z(new R(B.renderLineHighlightOnlyWhenFocus,`renderLineHighlightOnlyWhenFocus`,!1,{description:C(610,`Controls if the editor should render the current line highlight only when the editor is focused.`)})),z(new uf(B.renderValidationDecorations,`renderValidationDecorations`,`editable`,[`editable`,`on`,`off`])),z(new uf(B.renderWhitespace,`renderWhitespace`,`selection`,[`none`,`boundary`,`selection`,`trailing`,`all`],{enumDescriptions:[``,C(611,`Render whitespace characters except for single spaces between words.`),C(612,`Render whitespace characters only on selected text.`),C(613,`Render only trailing whitespace characters.`),``],description:C(614,`Controls how the editor should render whitespace characters.`)})),z(new af(B.revealHorizontalRightPadding,`revealHorizontalRightPadding`,15,0,1e3)),z(new R(B.roundedSelection,`roundedSelection`,!0,{description:C(615,`Controls whether selections should have rounded corners.`)})),z(new Xf),z(new $f),z(new af(B.scrollBeyondLastColumn,`scrollBeyondLastColumn`,4,0,Ni.MAX_SAFE_SMALL_INTEGER,{description:C(616,`Controls the number of extra characters beyond which the editor will scroll horizontally.`)})),z(new R(B.scrollBeyondLastLine,`scrollBeyondLastLine`,!0,{description:C(617,`Controls whether the editor will scroll beyond the last line.`)})),z(new R(B.scrollOnMiddleClick,`scrollOnMiddleClick`,!1,{description:C(618,`Controls whether the editor will scroll when the middle button is pressed.`)})),z(new R(B.scrollPredominantAxis,`scrollPredominantAxis`,!0,{description:C(619,`Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.`)})),z(new R(B.selectionClipboard,`selectionClipboard`,!0,{description:C(620,`Controls whether the Linux primary clipboard should be supported.`),included:Qn})),z(new R(B.selectionHighlight,`selectionHighlight`,!0,{description:C(621,`Controls whether the editor should highlight matches similar to the selection.`)})),z(new af(B.selectionHighlightMaxLength,`selectionHighlightMaxLength`,200,0,Ni.MAX_SAFE_SMALL_INTEGER,{description:C(622,`Controls how many characters can be in the selection before similiar matches are not highlighted. Set to zero for unlimited.`)})),z(new R(B.selectionHighlightMultiline,`selectionHighlightMultiline`,!1,{description:C(623,`Controls whether the editor should highlight selection matches that span multiple lines.`)})),z(new R(B.selectOnLineNumbers,`selectOnLineNumbers`,!0)),z(new uf(B.showFoldingControls,`showFoldingControls`,`mouseover`,[`always`,`never`,`mouseover`],{enumDescriptions:[C(624,`Always show the folding controls.`),C(625,`Never show the folding controls and reduce the gutter size.`),C(626,`Only show the folding controls when the mouse is over the gutter.`)],description:C(627,`Controls when the folding controls on the gutter are shown.`)})),z(new R(B.showUnused,`showUnused`,!0,{description:C(628,`Controls fading out of unused code.`)})),z(new R(B.showDeprecated,`showDeprecated`,!0,{description:C(629,`Controls strikethrough deprecated variables.`)})),z(new Rf),z(new uf(B.snippetSuggestions,`snippetSuggestions`,`inline`,[`top`,`bottom`,`inline`,`none`],{enumDescriptions:[C(630,`Show snippet suggestions on top of other suggestions.`),C(631,`Show snippet suggestions below other suggestions.`),C(632,`Show snippets suggestions with other suggestions.`),C(633,`Do not show snippet suggestions.`)],description:C(634,`Controls whether snippets are shown with other suggestions and how they are sorted.`)})),z(new cp),z(new R(B.smoothScrolling,`smoothScrolling`,!1,{description:C(635,`Controls whether the editor will scroll using an animation.`)})),z(new af(B.stopRenderingLineAfter,`stopRenderingLineAfter`,1e4,-1,Ni.MAX_SAFE_SMALL_INTEGER)),z(new sp),z(new rp),z(new R(B.inlineCompletionsAccessibilityVerbose,`inlineCompletionsAccessibilityVerbose`,!1,{description:C(636,`Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.`)})),z(new af(B.suggestFontSize,`suggestFontSize`,0,0,1e3,{markdownDescription:C(637,`Font size for the suggest widget. When set to {0}, the value of {1} is used.`,"`0`","`#editor.fontSize#`")})),z(new af(B.suggestLineHeight,`suggestLineHeight`,0,0,1e3,{markdownDescription:C(638,`Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.`,"`0`","`#editor.lineHeight#`")})),z(new R(B.suggestOnTriggerCharacters,`suggestOnTriggerCharacters`,!0,{description:C(639,`Controls whether suggestions should automatically show up when typing trigger characters.`)})),z(new uf(B.suggestSelection,`suggestSelection`,`first`,[`first`,`recentlyUsed`,`recentlyUsedByPrefix`],{markdownEnumDescriptions:[C(640,`Always select the first suggestion.`),C(641,"Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),C(642,"Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:C(643,`Controls how suggestions are pre-selected when showing the suggest list.`)})),z(new uf(B.tabCompletion,`tabCompletion`,`off`,[`on`,`off`,`onlySnippets`],{enumDescriptions:[C(644,`Tab complete will insert the best matching suggestion when pressing tab.`),C(645,`Disable tab completions.`),C(646,`Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.`)],description:C(647,`Enables tab completions.`)})),z(new af(B.tabIndex,`tabIndex`,0,-1,Ni.MAX_SAFE_SMALL_INTEGER)),z(new R(B.trimWhitespaceOnDelete,`trimWhitespaceOnDelete`,!1,{description:C(648,`Controls whether the editor will also delete the next line's indentation whitespace when deleting a newline.`)})),z(new np),z(new uf(B.unusualLineTerminators,`unusualLineTerminators`,`prompt`,[`auto`,`off`,`prompt`],{enumDescriptions:[C(649,`Unusual line terminators are automatically removed.`),C(650,`Unusual line terminators are ignored.`),C(651,`Unusual line terminators prompt to be removed.`)],description:C(652,`Remove unusual line terminators that might cause problems.`)})),z(new R(B.useShadowDOM,`useShadowDOM`,!0)),z(new R(B.useTabStops,`useTabStops`,!0,{description:C(653,`Spaces and tabs are inserted and deleted in alignment with tab stops.`)})),z(new uf(B.wordBreak,`wordBreak`,`normal`,[`normal`,`keepAll`],{markdownEnumDescriptions:[C(654,`Use the default line break rule.`),C(655,`Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.`)],description:C(656,`Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.`)})),z(new lp),z(new cf(B.wordSeparators,`wordSeparators`,td,{description:C(657,`Characters that will be used as word separators when doing word related navigations or operations.`)})),z(new uf(B.wordWrap,`wordWrap`,`off`,[`off`,`on`,`wordWrapColumn`,`bounded`],{markdownEnumDescriptions:[C(658,`Lines will never wrap.`),C(659,`Lines will wrap at the viewport width.`),C(660,"Lines will wrap at `#editor.wordWrapColumn#`."),C(661,"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:C(662,`Controls how lines should wrap.`)})),z(new cf(B.wordWrapBreakAfterCharacters,`wordWrapBreakAfterCharacters`,` 	})]?|/&.,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣`)),z(new cf(B.wordWrapBreakBeforeCharacters,`wordWrapBreakBeforeCharacters`,`([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋`)),z(new af(B.wordWrapColumn,`wordWrapColumn`,80,1,Ni.MAX_SAFE_SMALL_INTEGER,{markdownDescription:C(663,"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),z(new uf(B.wordWrapOverride1,`wordWrapOverride1`,`inherit`,[`off`,`on`,`inherit`])),z(new uf(B.wordWrapOverride2,`wordWrapOverride2`,`inherit`,[`off`,`on`,`inherit`])),z(new R(B.wrapOnEscapedLineFeeds,`wrapOnEscapedLineFeeds`,!1,{markdownDescription:C(664,'Controls whether literal `\\n` shall trigger a wordWrap when `#editor.wordWrap#` is enabled.\n\nFor example:\n```c\nchar* str="hello\\nworld"\n```\nwill be displayed as\n```c\nchar* str="hello\\n\n           world"\n```')})),z(new Tf),z(new yf),z(new uf(B.defaultColorDecorators,`defaultColorDecorators`,`auto`,[`auto`,`always`,`never`],{enumDescriptions:[C(665,`Show default color decorators only when no extension provides colors decorators.`),C(666,`Always show default color decorators.`),C(667,`Never show default color decorators.`)],description:C(668,`Controls whether inline color decorations should be shown using the default document color provider.`)})),z(new Gf),z(new R(B.tabFocusMode,`tabFocusMode`,!1,{markdownDescription:C(669,`Controls whether the editor receives tabs or defers them to the workbench for navigation.`)})),z(new Nf),z(new fp),z(new dp),z(new Pf),z(new Ef),z(new Df);var _p=class e{constructor(e,t){this.lineNumber=e,this.column=t}with(t=this.lineNumber,n=this.column){return t===this.lineNumber&&n===this.column?this:new e(t,n)}delta(e=0,t=0){return this.with(Math.max(1,this.lineNumber+e),Math.max(1,this.column+t))}equals(t){return e.equals(this,t)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(t){return e.isBefore(this,t)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(t){return e.isBeforeOrEqual(this,t)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){let n=e.lineNumber|0,r=t.lineNumber|0;if(n===r){let n=e.column|0,r=t.column|0;return n-r}return n-r}clone(){return new e(this.lineNumber,this.column)}toString(){return`(`+this.lineNumber+`,`+this.column+`)`}static lift(t){return new e(t.lineNumber,t.column)}static isIPosition(e){return e&&typeof e.lineNumber==`number`&&typeof e.column==`number`}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},vp=class e{constructor(e,t,n,r){e>n||e===n&&t>r?(this.startLineNumber=n,this.startColumn=r,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=n,this.endColumn=r)}isEmpty(){return e.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(t){return e.containsPosition(this,t)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(t){return e.containsRange(this,t)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(t){return e.strictContainsRange(this,t)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(t){return e.plusRange(this,t)}static plusRange(t,n){let r,i,a,o;return n.startLineNumber<t.startLineNumber?(r=n.startLineNumber,i=n.startColumn):n.startLineNumber===t.startLineNumber?(r=n.startLineNumber,i=Math.min(n.startColumn,t.startColumn)):(r=t.startLineNumber,i=t.startColumn),n.endLineNumber>t.endLineNumber?(a=n.endLineNumber,o=n.endColumn):n.endLineNumber===t.endLineNumber?(a=n.endLineNumber,o=Math.max(n.endColumn,t.endColumn)):(a=t.endLineNumber,o=t.endColumn),new e(r,i,a,o)}intersectRanges(t){return e.intersectRanges(this,t)}static intersectRanges(t,n){let r=t.startLineNumber,i=t.startColumn,a=t.endLineNumber,o=t.endColumn,s=n.startLineNumber,c=n.startColumn,l=n.endLineNumber,u=n.endColumn;return r<s?(r=s,i=c):r===s&&(i=Math.max(i,c)),a>l?(a=l,o=u):a===l&&(o=Math.min(o,u)),r>a||r===a&&i>o?null:new e(r,i,a,o)}equalsRange(t){return e.equalsRange(this,t)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return e.getEndPosition(this)}static getEndPosition(e){return new _p(e.endLineNumber,e.endColumn)}getStartPosition(){return e.getStartPosition(this)}static getStartPosition(e){return new _p(e.startLineNumber,e.startColumn)}toString(){return`[`+this.startLineNumber+`,`+this.startColumn+` -> `+this.endLineNumber+`,`+this.endColumn+`]`}setEndPosition(t,n){return new e(this.startLineNumber,this.startColumn,t,n)}setStartPosition(t,n){return new e(t,n,this.endLineNumber,this.endColumn)}collapseToStart(){return e.collapseToStart(this)}static collapseToStart(t){return new e(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn)}collapseToEnd(){return e.collapseToEnd(this)}static collapseToEnd(t){return new e(t.endLineNumber,t.endColumn,t.endLineNumber,t.endColumn)}delta(t){return new e(this.startLineNumber+t,this.startColumn,this.endLineNumber+t,this.endColumn)}isSingleLine(){return this.startLineNumber===this.endLineNumber}static fromPositions(t,n=t){return new e(t.lineNumber,t.column,n.lineNumber,n.column)}static lift(t){return t?new e(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber==`number`&&typeof e.startColumn==`number`&&typeof e.endLineNumber==`number`&&typeof e.endColumn==`number`}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static areOnlyIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber-1||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn-1||t.endLineNumber<e.startLineNumber-1||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn-1)}static compareRangesUsingStarts(e,t){if(e&&t){let n=e.startLineNumber|0,r=t.startLineNumber|0;if(n===r){let n=e.startColumn|0,r=t.startColumn|0;if(n===r){let n=e.endLineNumber|0,r=t.endLineNumber|0;if(n===r){let n=e.endColumn|0,r=t.endColumn|0;return n-r}return n-r}return n-r}return n-r}let n=e?1:0,r=t?1:0;return n-r}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}},yp;(function(e){e[e.Null=0]=`Null`,e[e.PlainText=1]=`PlainText`})(yp||={});var bp;(function(e){e[e.NotSet=-1]=`NotSet`,e[e.None=0]=`None`,e[e.Italic=1]=`Italic`,e[e.Bold=2]=`Bold`,e[e.Underline=4]=`Underline`,e[e.Strikethrough=8]=`Strikethrough`})(bp||={});var xp;(function(e){e[e.None=0]=`None`,e[e.DefaultForeground=1]=`DefaultForeground`,e[e.DefaultBackground=2]=`DefaultBackground`})(xp||={});var Sp;(function(e){e[e.Other=0]=`Other`,e[e.Comment=1]=`Comment`,e[e.String=2]=`String`,e[e.RegEx=3]=`RegEx`})(Sp||={});var Cp;(function(e){e[e.LANGUAGEID_MASK=255]=`LANGUAGEID_MASK`,e[e.TOKEN_TYPE_MASK=768]=`TOKEN_TYPE_MASK`,e[e.BALANCED_BRACKETS_MASK=1024]=`BALANCED_BRACKETS_MASK`,e[e.FONT_STYLE_MASK=30720]=`FONT_STYLE_MASK`,e[e.FOREGROUND_MASK=16744448]=`FOREGROUND_MASK`,e[e.BACKGROUND_MASK=4278190080]=`BACKGROUND_MASK`,e[e.ITALIC_MASK=2048]=`ITALIC_MASK`,e[e.BOLD_MASK=4096]=`BOLD_MASK`,e[e.UNDERLINE_MASK=8192]=`UNDERLINE_MASK`,e[e.STRIKETHROUGH_MASK=16384]=`STRIKETHROUGH_MASK`,e[e.SEMANTIC_USE_ITALIC=1]=`SEMANTIC_USE_ITALIC`,e[e.SEMANTIC_USE_BOLD=2]=`SEMANTIC_USE_BOLD`,e[e.SEMANTIC_USE_UNDERLINE=4]=`SEMANTIC_USE_UNDERLINE`,e[e.SEMANTIC_USE_STRIKETHROUGH=8]=`SEMANTIC_USE_STRIKETHROUGH`,e[e.SEMANTIC_USE_FOREGROUND=16]=`SEMANTIC_USE_FOREGROUND`,e[e.SEMANTIC_USE_BACKGROUND=32]=`SEMANTIC_USE_BACKGROUND`,e[e.LANGUAGEID_OFFSET=0]=`LANGUAGEID_OFFSET`,e[e.TOKEN_TYPE_OFFSET=8]=`TOKEN_TYPE_OFFSET`,e[e.BALANCED_BRACKETS_OFFSET=10]=`BALANCED_BRACKETS_OFFSET`,e[e.FONT_STYLE_OFFSET=11]=`FONT_STYLE_OFFSET`,e[e.FOREGROUND_OFFSET=15]=`FOREGROUND_OFFSET`,e[e.BACKGROUND_OFFSET=24]=`BACKGROUND_OFFSET`})(Cp||={});var wp=class{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new x,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),_(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();let n=new Tp(this,e,t);return this._factories.set(e,n),_(()=>{let t=this._factories.get(e);!t||t!==n||(this._factories.delete(e),t.dispose())})}async getOrCreate(e){let t=this.get(e);if(t)return t;let n=this._factories.get(e);return!n||n.isResolved?null:(await n.resolve(),this.get(e))}isResolved(e){let t=this.get(e);if(t)return!0;let n=this._factories.get(e);return!!(!n||n.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>xp.DefaultBackground?this._colorMap[xp.DefaultBackground]:null}},Tp=class extends y{get isResolved(){return this._isResolved}constructor(e,t,n){super(),this._registry=e,this._languageId=t,this._factory=n,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||=this._create(),this._resolvePromise}async _create(){let e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}},Ep;(function(e){e[e.Increase=0]=`Increase`,e[e.Decrease=1]=`Decrease`})(Ep||={});var V;(function(e){e[e.Method=0]=`Method`,e[e.Function=1]=`Function`,e[e.Constructor=2]=`Constructor`,e[e.Field=3]=`Field`,e[e.Variable=4]=`Variable`,e[e.Class=5]=`Class`,e[e.Struct=6]=`Struct`,e[e.Interface=7]=`Interface`,e[e.Module=8]=`Module`,e[e.Property=9]=`Property`,e[e.Event=10]=`Event`,e[e.Operator=11]=`Operator`,e[e.Unit=12]=`Unit`,e[e.Value=13]=`Value`,e[e.Constant=14]=`Constant`,e[e.Enum=15]=`Enum`,e[e.EnumMember=16]=`EnumMember`,e[e.Keyword=17]=`Keyword`,e[e.Text=18]=`Text`,e[e.Color=19]=`Color`,e[e.File=20]=`File`,e[e.Reference=21]=`Reference`,e[e.Customcolor=22]=`Customcolor`,e[e.Folder=23]=`Folder`,e[e.TypeParameter=24]=`TypeParameter`,e[e.User=25]=`User`,e[e.Issue=26]=`Issue`,e[e.Tool=27]=`Tool`,e[e.Snippet=28]=`Snippet`})(V||={});var Dp;(function(e){let t=new Map;t.set(V.Method,P.symbolMethod),t.set(V.Function,P.symbolFunction),t.set(V.Constructor,P.symbolConstructor),t.set(V.Field,P.symbolField),t.set(V.Variable,P.symbolVariable),t.set(V.Class,P.symbolClass),t.set(V.Struct,P.symbolStruct),t.set(V.Interface,P.symbolInterface),t.set(V.Module,P.symbolModule),t.set(V.Property,P.symbolProperty),t.set(V.Event,P.symbolEvent),t.set(V.Operator,P.symbolOperator),t.set(V.Unit,P.symbolUnit),t.set(V.Value,P.symbolValue),t.set(V.Enum,P.symbolEnum),t.set(V.Constant,P.symbolConstant),t.set(V.Enum,P.symbolEnum),t.set(V.EnumMember,P.symbolEnumMember),t.set(V.Keyword,P.symbolKeyword),t.set(V.Snippet,P.symbolSnippet),t.set(V.Text,P.symbolText),t.set(V.Color,P.symbolColor),t.set(V.File,P.symbolFile),t.set(V.Reference,P.symbolReference),t.set(V.Customcolor,P.symbolCustomColor),t.set(V.Folder,P.symbolFolder),t.set(V.TypeParameter,P.symbolTypeParameter),t.set(V.User,P.account),t.set(V.Issue,P.issues),t.set(V.Tool,P.tools);function n(e){let n=t.get(e);return n||=(console.info(`No codicon found for CompletionItemKind `+e),P.symbolProperty),n}e.toIcon=n;function r(e){switch(e){case V.Method:return C(786,`Method`);case V.Function:return C(787,`Function`);case V.Constructor:return C(788,`Constructor`);case V.Field:return C(789,`Field`);case V.Variable:return C(790,`Variable`);case V.Class:return C(791,`Class`);case V.Struct:return C(792,`Struct`);case V.Interface:return C(793,`Interface`);case V.Module:return C(794,`Module`);case V.Property:return C(795,`Property`);case V.Event:return C(796,`Event`);case V.Operator:return C(797,`Operator`);case V.Unit:return C(798,`Unit`);case V.Value:return C(799,`Value`);case V.Constant:return C(800,`Constant`);case V.Enum:return C(801,`Enum`);case V.EnumMember:return C(802,`Enum Member`);case V.Keyword:return C(803,`Keyword`);case V.Text:return C(804,`Text`);case V.Color:return C(805,`Color`);case V.File:return C(806,`File`);case V.Reference:return C(807,`Reference`);case V.Customcolor:return C(808,`Custom Color`);case V.Folder:return C(809,`Folder`);case V.TypeParameter:return C(810,`Type Parameter`);case V.User:return C(811,`User`);case V.Issue:return C(812,`Issue`);case V.Tool:return C(813,`Tool`);case V.Snippet:return C(814,`Snippet`);default:return``}}e.toLabel=r;let i=new Map;i.set(`method`,V.Method),i.set(`function`,V.Function),i.set(`constructor`,V.Constructor),i.set(`field`,V.Field),i.set(`variable`,V.Variable),i.set(`class`,V.Class),i.set(`struct`,V.Struct),i.set(`interface`,V.Interface),i.set(`module`,V.Module),i.set(`property`,V.Property),i.set(`event`,V.Event),i.set(`operator`,V.Operator),i.set(`unit`,V.Unit),i.set(`value`,V.Value),i.set(`constant`,V.Constant),i.set(`enum`,V.Enum),i.set(`enum-member`,V.EnumMember),i.set(`enumMember`,V.EnumMember),i.set(`keyword`,V.Keyword),i.set(`snippet`,V.Snippet),i.set(`text`,V.Text),i.set(`color`,V.Color),i.set(`file`,V.File),i.set(`reference`,V.Reference),i.set(`customcolor`,V.Customcolor),i.set(`folder`,V.Folder),i.set(`type-parameter`,V.TypeParameter),i.set(`typeParameter`,V.TypeParameter),i.set(`account`,V.User),i.set(`issue`,V.Issue),i.set(`tool`,V.Tool);function a(e,t){let n=i.get(e);return n===void 0&&!t&&(n=V.Property),n}e.fromString=a})(Dp||={});var Op;(function(e){e[e.Deprecated=1]=`Deprecated`})(Op||={});var kp;(function(e){e[e.None=0]=`None`,e[e.KeepWhitespace=1]=`KeepWhitespace`,e[e.InsertAsSnippet=4]=`InsertAsSnippet`})(kp||={});var Ap;(function(e){e[e.Word=0]=`Word`,e[e.Line=1]=`Line`,e[e.Suggest=2]=`Suggest`})(Ap||={});var jp;(function(e){e[e.Invoke=0]=`Invoke`,e[e.TriggerCharacter=1]=`TriggerCharacter`,e[e.TriggerForIncompleteCompletions=2]=`TriggerForIncompleteCompletions`})(jp||={});var Mp;(function(e){e[e.Automatic=0]=`Automatic`,e[e.Explicit=1]=`Explicit`})(Mp||={});var Np;(function(e){e[e.Accepted=0]=`Accepted`,e[e.Rejected=1]=`Rejected`,e[e.Ignored=2]=`Ignored`})(Np||={});var Pp;(function(e){e[e.Invoke=1]=`Invoke`,e[e.Auto=2]=`Auto`})(Pp||={});var Fp;(function(e){e[e.Automatic=0]=`Automatic`,e[e.PasteAs=1]=`PasteAs`})(Fp||={});var Ip;(function(e){e[e.Invoke=1]=`Invoke`,e[e.TriggerCharacter=2]=`TriggerCharacter`,e[e.ContentChange=3]=`ContentChange`})(Ip||={});var Lp;(function(e){e[e.Text=0]=`Text`,e[e.Read=1]=`Read`,e[e.Write=2]=`Write`})(Lp||={});function Rp(e){return e&&w.isUri(e.uri)&&vp.isIRange(e.range)&&(vp.isIRange(e.originSelectionRange)||vp.isIRange(e.targetSelectionRange))}function zp(e){return e&&w.isUri(e.uri)&&vp.isIRange(e.range)}var H;(function(e){e[e.File=0]=`File`,e[e.Module=1]=`Module`,e[e.Namespace=2]=`Namespace`,e[e.Package=3]=`Package`,e[e.Class=4]=`Class`,e[e.Method=5]=`Method`,e[e.Property=6]=`Property`,e[e.Field=7]=`Field`,e[e.Constructor=8]=`Constructor`,e[e.Enum=9]=`Enum`,e[e.Interface=10]=`Interface`,e[e.Function=11]=`Function`,e[e.Variable=12]=`Variable`,e[e.Constant=13]=`Constant`,e[e.String=14]=`String`,e[e.Number=15]=`Number`,e[e.Boolean=16]=`Boolean`,e[e.Array=17]=`Array`,e[e.Object=18]=`Object`,e[e.Key=19]=`Key`,e[e.Null=20]=`Null`,e[e.EnumMember=21]=`EnumMember`,e[e.Struct=22]=`Struct`,e[e.Event=23]=`Event`,e[e.Operator=24]=`Operator`,e[e.TypeParameter=25]=`TypeParameter`})(H||={}),H.Array,C(815,`array`),H.Boolean,C(816,`boolean`),H.Class,C(817,`class`),H.Constant,C(818,`constant`),H.Constructor,C(819,`constructor`),H.Enum,C(820,`enumeration`),H.EnumMember,C(821,`enumeration member`),H.Event,C(822,`event`),H.Field,C(823,`field`),H.File,C(824,`file`),H.Function,C(825,`function`),H.Interface,C(826,`interface`),H.Key,C(827,`key`),H.Method,C(828,`method`),H.Module,C(829,`module`),H.Namespace,C(830,`namespace`),H.Null,C(831,`null`),H.Number,C(832,`number`),H.Object,C(833,`object`),H.Operator,C(834,`operator`),H.Package,C(835,`package`),H.Property,C(836,`property`),H.String,C(837,`string`),H.Struct,C(838,`struct`),H.TypeParameter,C(839,`type parameter`),H.Variable,C(840,`variable`);var Bp;(function(e){e[e.Deprecated=1]=`Deprecated`})(Bp||={});var Vp;(function(e){let t=new Map;t.set(H.File,P.symbolFile),t.set(H.Module,P.symbolModule),t.set(H.Namespace,P.symbolNamespace),t.set(H.Package,P.symbolPackage),t.set(H.Class,P.symbolClass),t.set(H.Method,P.symbolMethod),t.set(H.Property,P.symbolProperty),t.set(H.Field,P.symbolField),t.set(H.Constructor,P.symbolConstructor),t.set(H.Enum,P.symbolEnum),t.set(H.Interface,P.symbolInterface),t.set(H.Function,P.symbolFunction),t.set(H.Variable,P.symbolVariable),t.set(H.Constant,P.symbolConstant),t.set(H.String,P.symbolString),t.set(H.Number,P.symbolNumber),t.set(H.Boolean,P.symbolBoolean),t.set(H.Array,P.symbolArray),t.set(H.Object,P.symbolObject),t.set(H.Key,P.symbolKey),t.set(H.Null,P.symbolNull),t.set(H.EnumMember,P.symbolEnumMember),t.set(H.Struct,P.symbolStruct),t.set(H.Event,P.symbolEvent),t.set(H.Operator,P.symbolOperator),t.set(H.TypeParameter,P.symbolTypeParameter);function n(e){let n=t.get(e);return n||=(console.info(`No codicon found for SymbolKind `+e),P.symbolProperty),n}e.toIcon=n;let r=new Map;r.set(H.File,V.File),r.set(H.Module,V.Module),r.set(H.Namespace,V.Module),r.set(H.Package,V.Module),r.set(H.Class,V.Class),r.set(H.Method,V.Method),r.set(H.Property,V.Property),r.set(H.Field,V.Field),r.set(H.Constructor,V.Constructor),r.set(H.Enum,V.Enum),r.set(H.Interface,V.Interface),r.set(H.Function,V.Function),r.set(H.Variable,V.Variable),r.set(H.Constant,V.Constant),r.set(H.String,V.Text),r.set(H.Number,V.Value),r.set(H.Boolean,V.Value),r.set(H.Array,V.Value),r.set(H.Object,V.Value),r.set(H.Key,V.Keyword),r.set(H.Null,V.Value),r.set(H.EnumMember,V.EnumMember),r.set(H.Struct,V.Struct),r.set(H.Event,V.Event),r.set(H.Operator,V.Operator),r.set(H.TypeParameter,V.TypeParameter);function i(e){let t=r.get(e);return t===void 0&&(console.info(`No completion kind found for SymbolKind `+e),t=V.File),t}e.toCompletionKind=i})(Vp||={});var Hp=class e{static{this.Comment=new e(`comment`)}static{this.Imports=new e(`imports`)}static{this.Region=new e(`region`)}static fromValue(t){switch(t){case`comment`:return e.Comment;case`imports`:return e.Imports;case`region`:return e.Region}return new e(t)}constructor(e){this.value=e}},Up;(function(e){e[e.AIGenerated=1]=`AIGenerated`})(Up||={});var Wp;(function(e){e[e.Invoke=0]=`Invoke`,e[e.Automatic=1]=`Automatic`})(Wp||={});var Gp;(function(e){function t(e){return!e||typeof e!=`object`?!1:typeof e.id==`string`&&typeof e.title==`string`}e.is=t})(Gp||={});var Kp;(function(e){e[e.Collapsed=0]=`Collapsed`,e[e.Expanded=1]=`Expanded`})(Kp||={});var qp;(function(e){e[e.Unresolved=0]=`Unresolved`,e[e.Resolved=1]=`Resolved`})(qp||={});var Jp;(function(e){e[e.Current=0]=`Current`,e[e.Outdated=1]=`Outdated`})(Jp||={});var Yp;(function(e){e[e.Editing=0]=`Editing`,e[e.Preview=1]=`Preview`})(Yp||={});var Xp;(function(e){e[e.Published=0]=`Published`,e[e.Draft=1]=`Draft`})(Xp||={});var Zp;(function(e){e[e.Type=1]=`Type`,e[e.Parameter=2]=`Parameter`})(Zp||={}),new wp;var Qp;(function(e){e[e.None=0]=`None`,e[e.Option=1]=`Option`,e[e.Default=2]=`Default`,e[e.Preferred=3]=`Preferred`})(Qp||={});var $p;(function(e){e[e.Left=1]=`Left`,e[e.Center=2]=`Center`,e[e.Right=4]=`Right`,e[e.Full=7]=`Full`})($p||={});var em;(function(e){e[e.Left=1]=`Left`,e[e.Center=2]=`Center`,e[e.Right=3]=`Right`})(em||={});var tm;(function(e){e[e.Inline=1]=`Inline`,e[e.Gutter=2]=`Gutter`})(tm||={});var nm;(function(e){e[e.Normal=1]=`Normal`,e[e.Underlined=2]=`Underlined`})(nm||={});var rm;(function(e){e[e.LTR=0]=`LTR`,e[e.RTL=1]=`RTL`})(rm||={});var im;(function(e){e[e.Both=0]=`Both`,e[e.Right=1]=`Right`,e[e.Left=2]=`Left`,e[e.None=3]=`None`})(im||={});var am;(function(e){e[e.TextDefined=0]=`TextDefined`,e[e.LF=1]=`LF`,e[e.CRLF=2]=`CRLF`})(am||={});var om;(function(e){e[e.LF=1]=`LF`,e[e.CRLF=2]=`CRLF`})(om||={});var sm;(function(e){e[e.LF=0]=`LF`,e[e.CRLF=1]=`CRLF`})(sm||={});var cm=class{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}},lm;(function(e){e[e.AlwaysGrowsWhenTypingAtEdges=0]=`AlwaysGrowsWhenTypingAtEdges`,e[e.NeverGrowsWhenTypingAtEdges=1]=`NeverGrowsWhenTypingAtEdges`,e[e.GrowsOnlyWhenTypingBefore=2]=`GrowsOnlyWhenTypingBefore`,e[e.GrowsOnlyWhenTypingAfter=3]=`GrowsOnlyWhenTypingAfter`})(lm||={});var um;(function(e){e[e.Left=0]=`Left`,e[e.Right=1]=`Right`,e[e.None=2]=`None`,e[e.LeftOfInjectedText=3]=`LeftOfInjectedText`,e[e.RightOfInjectedText=4]=`RightOfInjectedText`})(um||={});var dm;(function(e){e[e.FIRST_LINE_DETECTION_LENGTH_LIMIT=1e3]=`FIRST_LINE_DETECTION_LENGTH_LIMIT`})(dm||={});var fm=class{constructor(e,t,n){this.regex=e,this.wordSeparators=t,this.simpleSearch=n}},pm=class{constructor(e,t,n){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=n}},mm;(function(e){e[e.Unnecessary=1]=`Unnecessary`,e[e.Deprecated=2]=`Deprecated`})(mm||={});var hm;(function(e){e[e.Hint=1]=`Hint`,e[e.Info=2]=`Info`,e[e.Warning=4]=`Warning`,e[e.Error=8]=`Error`})(hm||={}),(function(e){function t(e,t){return t-e}e.compare=t;let n=Object.create(null);n[e.Error]=C(1960,`Error`),n[e.Warning]=C(1961,`Warning`),n[e.Info]=C(1962,`Info`);function r(e){return n[e]||``}e.toString=r;let i=Object.create(null);i[e.Error]=C(1963,`Errors`),i[e.Warning]=C(1964,`Warnings`),i[e.Info]=C(1965,`Infos`);function a(e){return i[e]||``}e.toStringPlural=a;function o(t){switch(t){case xc.Error:return e.Error;case xc.Warning:return e.Warning;case xc.Info:return e.Info;case xc.Ignore:return e.Hint}}e.fromSeverity=o;function s(t){switch(t){case e.Error:return xc.Error;case e.Warning:return xc.Warning;case e.Info:return xc.Info;case e.Hint:return xc.Ignore}}e.toSeverity=s})(hm||={});var gm;(function(e){function t(e){return n(e,!0)}e.makeKey=t;function n(e,t){let n=[``];return e.source?n.push(e.source.replace(`¦`,`\\¦`)):n.push(``),e.code?typeof e.code==`string`?n.push(e.code.replace(`¦`,`\\¦`)):n.push(e.code.value.replace(`¦`,`\\¦`)):n.push(``),e.severity!==void 0&&e.severity!==null?n.push(hm.toString(e.severity)):n.push(``),e.message&&t?n.push(e.message.replace(`¦`,`\\¦`)):n.push(``),e.startLineNumber!==void 0&&e.startLineNumber!==null?n.push(e.startLineNumber.toString()):n.push(``),e.startColumn!==void 0&&e.startColumn!==null?n.push(e.startColumn.toString()):n.push(``),e.endLineNumber!==void 0&&e.endLineNumber!==null?n.push(e.endLineNumber.toString()):n.push(``),e.endColumn!==void 0&&e.endColumn!==null?n.push(e.endColumn.toString()):n.push(``),n.push(``),n.join(`¦`)}e.makeKeyOptionalMessage=n})(gm||={});const _m=k(`progressService`);k(`editorProgressService`);var vm;(function(e){e[e.Explorer=1]=`Explorer`,e[e.Scm=3]=`Scm`,e[e.Extensions=5]=`Extensions`,e[e.Window=10]=`Window`,e[e.Notification=15]=`Notification`,e[e.Dialog=20]=`Dialog`})(vm||={}),Object.freeze({total(){},worked(){},done(){}});var ym=class{static{this.None=Object.freeze({report(){}})}get value(){return this._value}constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}};let bm=class extends y{constructor(e,t){super(),this.deferred=new No,t.withProgress(e,e=>(this.reporter=e,this.lastStep&&e.report(this.lastStep),this.deferred.p)),this._register(_(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};bm=A([j(1,_m)],bm);var xm=class{constructor(){this.data=new Map}add(e,t){qe(Ze(e)),qe($e(t)),qe(!this.data.has(e),`There is already an extension with this id`),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}dispose(){this.data.forEach(e=>{ut(e.dispose)&&e.dispose()}),this.data.clear()}};const Sm=new xm;function Cm(e,t){return t&&(e.stack||e.stacktrace)?C(105,`{0}: {1}`,Tm(e),wm(e.stack)||wm(e.stacktrace)):Tm(e)}function wm(e){return Array.isArray(e)?e.join(`
`):e}function Tm(e){return e.code===`ERR_UNC_HOST_NOT_ALLOWED`?`${e.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof e.code==`string`&&typeof e.errno==`number`&&typeof e.syscall==`string`?C(106,`A system error occurred ({0})`,e.message):e.message||C(107,`An unknown error occurred. Please consult the log for more details.`)}function Em(e=null,t=!1){if(!e)return C(107,`An unknown error occurred. Please consult the log for more details.`);if(Array.isArray(e)){let n=be(e),r=Em(n[0],t);return n.length>1?C(108,`{0} ({1} errors in total)`,r,n.length):r}if(Ze(e))return e;if(e.detail){let n=e.detail;if(n.error)return Cm(n.error,t);if(n.exception)return Cm(n.exception,t)}return e.stack?Cm(e,t):e.message?e.message:C(107,`An unknown error occurred. Please consult the log for more details.`)}var Dm=class extends y{constructor(e,t=``,n=``,r=!0,i){super(),this._onDidChange=this._register(new x),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=n,this._enabled=r,this._actionCallback=i}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||``}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}};(class e{constructor(){this.id=e.ID,this.label=``,this.tooltip=``,this.class=`separator`,this.enabled=!1,this.checked=!1}static join(...t){let n=[];for(let r of t)r.length&&(n=n.length?[...n,new e,...r]:r);return n}static{this.ID=`vs.actions.separator`}async run(){}}),class e extends Dm{static{this.ID=`vs.actions.empty`}constructor(){super(e.ID,C(43,`(empty)`),void 0,!1)}};const Om={EditorPane:`workbench.contributions.editors`,EditorFactory:`workbench.contributions.editor.inputFactories`},km={id:`default`,displayName:C(3938,`Text Editor`),providerDisplayName:C(3939,`Built-in`)};var Am;(function(e){e[e.PROGRAMMATIC=1]=`PROGRAMMATIC`,e[e.USER=2]=`USER`,e[e.EDIT=3]=`EDIT`,e[e.NAVIGATION=4]=`NAVIGATION`,e[e.JUMP=5]=`JUMP`})(Am||={});var jm;(function(e){e[e.IDENTICAL=1]=`IDENTICAL`,e[e.SIMILAR=2]=`SIMILAR`,e[e.DIFFERENT=3]=`DIFFERENT`})(jm||={});function Mm(e,t,n){for(let r of n.visibleEditorPanes)if(r.group.id===t&&e.matches(r.input))return r.getViewState()}function Nm(e){if(Um(e))return!1;let t=e;return w.isUri(t?.resource)}function Pm(e){if(Um(e))return!1;let t=e;return t?.original!==void 0&&t.modified!==void 0}function Fm(e){if(Um(e))return!1;let t=e;return!t||t.resources&&!Array.isArray(t.resources)?!1:!!t.resources||!!t.multiDiffSource}function Im(e){if(Um(e)||Pm(e))return!1;let t=e;return t?.primary!==void 0&&t.secondary!==void 0}function Lm(e){if(Um(e))return!1;let t=e;return w.isUri(t?.base?.resource)&&w.isUri(t?.input1?.resource)&&w.isUri(t?.input2?.resource)&&w.isUri(t?.result?.resource)}var Rm;(function(e){e[e.SHORT=0]=`SHORT`,e[e.MEDIUM=1]=`MEDIUM`,e[e.LONG=2]=`LONG`})(Rm||={});var zm;(function(e){e[e.EXPLICIT=1]=`EXPLICIT`,e[e.AUTO=2]=`AUTO`,e[e.FOCUS_CHANGE=3]=`FOCUS_CHANGE`,e[e.WINDOW_CHANGE=4]=`WINDOW_CHANGE`})(zm||={});var Bm=class{constructor(){this.mapIdToSaveSource=new Map}registerSource(e,t){let n=this.mapIdToSaveSource.get(e);return n||(n={source:e,label:t},this.mapIdToSaveSource.set(e,n)),n.source}getSourceLabel(e){return this.mapIdToSaveSource.get(e)?.label??e}};new Bm;var Vm;(function(e){e[e.None=0]=`None`,e[e.Readonly=2]=`Readonly`,e[e.Untitled=4]=`Untitled`,e[e.Singleton=8]=`Singleton`,e[e.RequiresTrust=16]=`RequiresTrust`,e[e.CanSplitInGroup=32]=`CanSplitInGroup`,e[e.ForceDescription=64]=`ForceDescription`,e[e.CanDropIntoEditor=128]=`CanDropIntoEditor`,e[e.MultipleEditors=256]=`MultipleEditors`,e[e.Scratchpad=512]=`Scratchpad`})(Vm||={});var Hm=class extends y{};function Um(e){return e instanceof Hm}function Wm(e){let t=e;return w.isUri(t?.preferredResource)}function Gm(e){let t=e;return Um(t?.primary)&&Um(t?.secondary)}function Km(e){let t=e;return Um(t?.modified)&&Um(t?.original)}var qm;(function(e){e[e.UNKNOWN=0]=`UNKNOWN`,e[e.REPLACE=1]=`REPLACE`,e[e.MOVE=2]=`MOVE`,e[e.UNPIN=3]=`UNPIN`})(qm||={});var Jm;(function(e){e[e.GROUP_ACTIVE=0]=`GROUP_ACTIVE`,e[e.GROUP_INDEX=1]=`GROUP_INDEX`,e[e.GROUP_LABEL=2]=`GROUP_LABEL`,e[e.GROUP_LOCKED=3]=`GROUP_LOCKED`,e[e.EDITORS_SELECTION=4]=`EDITORS_SELECTION`,e[e.EDITOR_OPEN=5]=`EDITOR_OPEN`,e[e.EDITOR_CLOSE=6]=`EDITOR_CLOSE`,e[e.EDITOR_MOVE=7]=`EDITOR_MOVE`,e[e.EDITOR_ACTIVE=8]=`EDITOR_ACTIVE`,e[e.EDITOR_LABEL=9]=`EDITOR_LABEL`,e[e.EDITOR_CAPABILITIES=10]=`EDITOR_CAPABILITIES`,e[e.EDITOR_PIN=11]=`EDITOR_PIN`,e[e.EDITOR_TRANSIENT=12]=`EDITOR_TRANSIENT`,e[e.EDITOR_STICKY=13]=`EDITOR_STICKY`,e[e.EDITOR_DIRTY=14]=`EDITOR_DIRTY`,e[e.EDITOR_WILL_DISPOSE=15]=`EDITOR_WILL_DISPOSE`})(Jm||={});var Ym;(function(e){e[e.PRIMARY=1]=`PRIMARY`,e[e.SECONDARY=2]=`SECONDARY`,e[e.BOTH=3]=`BOTH`,e[e.ANY=4]=`ANY`})(Ym||={});var Xm=class{getOriginalUri(e,t){if(!e)return;if(Lm(e))return Qm.getOriginalUri(e.result,t);if(t?.supportSideBySide){let{primary:n,secondary:r}=this.getSideEditors(e);if(n&&r){if(t?.supportSideBySide===Ym.BOTH)return{primary:this.getOriginalUri(n,{filterByScheme:t.filterByScheme}),secondary:this.getOriginalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===Ym.ANY)return this.getOriginalUri(n,{filterByScheme:t.filterByScheme})??this.getOriginalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===Ym.PRIMARY?n:r}}if(Pm(e)||Fm(e)||Im(e)||Lm(e))return;let n=Wm(e)?e.preferredResource:e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}getSideEditors(e){return Gm(e)||Im(e)?{primary:e.primary,secondary:e.secondary}:Km(e)||Pm(e)?{primary:e.modified,secondary:e.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(e,t){if(!e)return;if(Lm(e))return Qm.getCanonicalUri(e.result,t);if(t?.supportSideBySide){let{primary:n,secondary:r}=this.getSideEditors(e);if(n&&r){if(t?.supportSideBySide===Ym.BOTH)return{primary:this.getCanonicalUri(n,{filterByScheme:t.filterByScheme}),secondary:this.getCanonicalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===Ym.ANY)return this.getCanonicalUri(n,{filterByScheme:t.filterByScheme})??this.getCanonicalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===Ym.PRIMARY?n:r}}if(Pm(e)||Fm(e)||Im(e)||Lm(e))return;let n=e.resource;return!n||!t||!t.filterByScheme?n:this.filterUri(n,t.filterByScheme)}filterUri(e,t){if(Array.isArray(t)){if(t.some(t=>e.scheme===t))return e}else if(t===e.scheme)return e}},Zm;(function(e){e[e.UNKNOWN=0]=`UNKNOWN`,e[e.KEYBOARD=1]=`KEYBOARD`,e[e.MOUSE=2]=`MOUSE`})(Zm||={});const Qm=new Xm;var $m;(function(e){e[e.LEFT=0]=`LEFT`,e[e.RIGHT=1]=`RIGHT`})($m||={});var eh=class{constructor(){this.editorSerializerConstructors=new Map,this.editorSerializerInstances=new Map}start(e){let t=this.instantiationService=e.get(ys);for(let[e,n]of this.editorSerializerConstructors)this.createEditorSerializer(e,n,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,n){let r=n.createInstance(t);this.editorSerializerInstances.set(e,r)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw Error(`Can only register one file editor factory.`);this.fileEditorFactory=e}getFileEditorFactory(){return st(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),_(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e==`string`?e:e.typeId)}};Sm.add(Om.EditorFactory,new eh);var th;(function(e){e[e.MOST_RECENTLY_ACTIVE=0]=`MOST_RECENTLY_ACTIVE`,e[e.SEQUENTIAL=1]=`SEQUENTIAL`})(th||={});var nh;(function(e){e[e.NotOmitted=0]=`NotOmitted`,e[e.Partial=1]=`Partial`,e[e.Full=2]=`Full`})(nh||={});var rh;(function(e){e.icon=P.error;function t(e){return{filterUri:e.resource,owner:e.owner,problemMessage:e.message,filterRange:{startLineNumber:e.startLineNumber,endLineNumber:e.endLineNumber,startColumn:e.startColumn,endColumn:e.endColumn}}}e.fromMarker=t;function n(t){return{id:r(t),name:i(t),icon:e.icon,value:t,kind:`diagnostic`,...t}}e.toEntry=n;function r(e){return[e.filterUri,e.owner,e.filterSeverity,e.filterRange?.startLineNumber].join(`:`)}e.id=r;function i(e){let t;if((function(e){e[e.MaxChars=30]=`MaxChars`,e[e.MaxSpaceLookback=10]=`MaxSpaceLookback`})(t||={}),e.problemMessage){if(e.problemMessage.length<t.MaxChars)return e.problemMessage;let n=e.problemMessage.lastIndexOf(` `,t.MaxChars);return n===-1||n+t.MaxSpaceLookback<t.MaxChars?e.problemMessage.substring(0,t.MaxChars)+`…`:e.problemMessage.substring(0,n)+`…`}let n=C(5420,`All Problems`);return e.filterUri&&(n=C(5421,`Problems in {0}`,Xa(e.filterUri))),n}e.label=i})(rh||={});var ih;(function(e){function t(e){return w.isUri(e.value)?e.value:zp(e.value)?e.value.uri:void 0}e.toUri=t})(ih||={});function ah(e){return e.kind===`image`}var oh;(function(e){e.Instruction=`vscode.prompt.instructions.root`,e.InstructionReference=`vscode.prompt.instructions`,e.PromptFile=`vscode.prompt.file`})(oh||={});const sh=k(`contextKeyService`);var ch;(function(e){e[e.STORAGE_DOES_NOT_EXIST=0]=`STORAGE_DOES_NOT_EXIST`,e[e.STORAGE_IN_MEMORY=1]=`STORAGE_IN_MEMORY`})(ch||={});var lh;(function(e){e[e.None=0]=`None`,e[e.Initialized=1]=`Initialized`,e[e.Closed=2]=`Closed`})(lh||={}),class e extends y{static{this.DEFAULT_FLUSH_DELAY=100}constructor(t,n=Object.create(null)){super(),this.database=t,this.options=n,this._onDidChangeStorage=this._register(new fn),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=lh.None,this.cache=new Map,this.flushDelayer=this._register(new yo(e.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.pendingClose=void 0,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){this._onDidChangeStorage.pause();try{e.changed?.forEach((e,t)=>this.acceptExternal(t,e)),e.deleted?.forEach(e=>this.acceptExternal(e,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,t){if(this.state===lh.Closed)return;let n=!1;if(at(t))n=this.cache.delete(e);else{let r=this.cache.get(e);r!==t&&(this.cache.set(e,t),n=!0)}n&&this._onDidChangeStorage.fire({key:e,external:!0})}get items(){return this.cache}get size(){return this.cache.size}async init(){this.state===lh.None&&(this.state=lh.Initialized,this.options.hint!==ch.STORAGE_DOES_NOT_EXIST&&(this.cache=await this.database.getItems()))}get(e,t){let n=this.cache.get(e);return at(n)?t:n}getBoolean(e,t){let n=this.get(e);return at(n)?t:n===`true`}getNumber(e,t){let n=this.get(e);return at(n)?t:parseInt(n,10)}getObject(e,t){let n=this.get(e);return at(n)?t:Uu(n)}async set(e,t,n=!1){if(this.state===lh.Closed)return;if(at(t))return this.delete(e,n);let r=$e(t)||Array.isArray(t)?Hu(t):String(t),i=this.cache.get(e);if(i!==r)return this.cache.set(e,r),this.pendingInserts.set(e,r),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:n}),this.doFlush()}async delete(e,t=!1){if(this.state===lh.Closed)return;let n=this.cache.delete(e);if(n)return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:t}),this.doFlush()}async optimize(){if(this.state!==lh.Closed)return await this.flush(0),this.database.optimize()}async close(){return this.pendingClose||=this.doClose(),this.pendingClose}async doClose(){this.state=lh.Closed;try{await this.doFlush(0)}catch{}await this.database.close(()=>this.cache)}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;let e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)this.whenFlushedCallbacks.pop()?.()})}async flush(e){if(!(this.state===lh.Closed||this.pendingClose))return this.doFlush(e)}async doFlush(e){return this.options.hint===ch.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),e)}async whenFlushed(){if(this.hasPending)return new Promise(e=>this.whenFlushedCallbacks.push(e))}isInMemory(){return this.options.hint===ch.STORAGE_IN_MEMORY}};function uh(e){return dh(e,0)}function dh(e,t){switch(typeof e){case`object`:return e===null?fh(349,t):Array.isArray(e)?hh(e,t):gh(e,t);case`string`:return mh(e,t);case`boolean`:return ph(e,t);case`number`:return fh(e,t);case`undefined`:return fh(937,t);default:return fh(617,t)}}function fh(e,t){return(t<<5)-t+e|0}function ph(e,t){return fh(e?433:863,t)}function mh(e,t){t=fh(149417,t);for(let n=0,r=e.length;n<r;n++)t=fh(e.charCodeAt(n),t);return t}function hh(e,t){return t=fh(104579,t),e.reduce((e,t)=>dh(t,e),t)}function gh(e,t){return t=fh(181387,t),Object.keys(e).sort().reduce((t,n)=>(t=mh(n,t),dh(e[n],t)),t)}var _h;(function(e){e[e.BLOCK_SIZE=64]=`BLOCK_SIZE`,e[e.UNICODE_REPLACEMENT=65533]=`UNICODE_REPLACEMENT`})(_h||={});function vh(e,t,n=32){let r=n-t,i=~((1<<r)-1);return(e<<t|(i&e)>>>r)>>>0}function yh(e,t=32){return e instanceof ArrayBuffer?qt(b.wrap(new Uint8Array(e))):(e>>>0).toString(16).padStart(t/4,`0`)}(class e{static{this._bigBlock32=new DataView(new ArrayBuffer(320))}constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(_h.BLOCK_SIZE+3),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){let t=e.length;if(t===0)return;let n=this._buff,r=this._buffLen,i=this._leftoverHighSurrogate,a,o;for(i===0?(a=e.charCodeAt(0),o=0):(a=i,o=-1,i=0);;){let s=a;if(na(a))if(o+1<t){let t=e.charCodeAt(o+1);ra(t)?(o++,s=ia(a,t)):s=_h.UNICODE_REPLACEMENT}else{i=a;break}else ra(a)&&(s=_h.UNICODE_REPLACEMENT);if(r=this._push(n,r,s),o++,o<t)a=e.charCodeAt(o);else break}this._buffLen=r,this._leftoverHighSurrogate=i}_push(e,t,n){return n<128?e[t++]=n:n<2048?(e[t++]=192|(n&1984)>>>6,e[t++]=128|(n&63)>>>0):n<65536?(e[t++]=224|(n&61440)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0):(e[t++]=240|(n&1835008)>>>18,e[t++]=128|(n&258048)>>>12,e[t++]=128|(n&4032)>>>6,e[t++]=128|(n&63)>>>0),t>=_h.BLOCK_SIZE&&(this._step(),t-=_h.BLOCK_SIZE,this._totalLen+=_h.BLOCK_SIZE,e[0]=e[_h.BLOCK_SIZE+0],e[1]=e[_h.BLOCK_SIZE+1],e[2]=e[_h.BLOCK_SIZE+2]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,_h.UNICODE_REPLACEMENT)),this._totalLen+=this._buffLen,this._wrapUp()),yh(this._h0)+yh(this._h1)+yh(this._h2)+yh(this._h3)+yh(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,this._buff.subarray(this._buffLen).fill(0),this._buffLen>56&&(this._step(),this._buff.fill(0));let e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){let t=e._bigBlock32,n=this._buffDV;for(let e=0;e<64;e+=4)t.setUint32(e,n.getUint32(e,!1),!1);for(let e=64;e<320;e+=4)t.setUint32(e,vh(t.getUint32(e-12,!1)^t.getUint32(e-32,!1)^t.getUint32(e-56,!1)^t.getUint32(e-64,!1),1),!1);let r=this._h0,i=this._h1,a=this._h2,o=this._h3,s=this._h4,c,l,u;for(let e=0;e<80;e++)e<20?(c=i&a|~i&o,l=1518500249):e<40?(c=i^a^o,l=1859775393):e<60?(c=i&a|i&o|a&o,l=2400959708):(c=i^a^o,l=3395469782),u=vh(r,5)+c+s+l+t.getUint32(e*4,!1)&4294967295,s=o,o=a,a=vh(i,30),i=r,r=u;this._h0=this._h0+r&4294967295,this._h1=this._h1+i&4294967295,this._h2=this._h2+a&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+s&4294967295}});const bh=k(`environmentService`),xh=k(`fileService`),Sh=k(`IUriIdentityService`);var Ch;(function(e){e.Settings=`settings`,e.Keybindings=`keybindings`,e.Snippets=`snippets`,e.Prompts=`prompts`,e.Tasks=`tasks`,e.Extensions=`extensions`,e.GlobalState=`globalState`,e.Mcp=`mcp`})(Ch||={});function wh(e){let t=e;return!!(t&&typeof t==`object`&&typeof t.id==`string`&&typeof t.isDefault==`boolean`&&typeof t.name==`string`&&w.isUri(t.location)&&w.isUri(t.globalStorageHome)&&w.isUri(t.settingsResource)&&w.isUri(t.keybindingsResource)&&w.isUri(t.tasksResource)&&w.isUri(t.snippetsHome)&&w.isUri(t.promptsHome)&&w.isUri(t.extensionsResource)&&w.isUri(t.mcpResource))}function Th(e,t,n,r,i,a){return{id:e,name:t,location:n,isDefault:!1,icon:i?.icon,globalStorageHome:a&&i?.useDefaultFlags?.globalState?a.globalStorageHome:$a(n,`globalStorage`),settingsResource:a&&i?.useDefaultFlags?.settings?a.settingsResource:$a(n,`settings.json`),keybindingsResource:a&&i?.useDefaultFlags?.keybindings?a.keybindingsResource:$a(n,`keybindings.json`),tasksResource:a&&i?.useDefaultFlags?.tasks?a.tasksResource:$a(n,`tasks.json`),snippetsHome:a&&i?.useDefaultFlags?.snippets?a.snippetsHome:$a(n,`snippets`),promptsHome:a&&i?.useDefaultFlags?.prompts?a.promptsHome:$a(n,`prompts`),extensionsResource:a&&i?.useDefaultFlags?.extensions?a.extensionsResource:$a(n,`extensions.json`),mcpResource:a&&i?.useDefaultFlags?.mcp?a.mcpResource:$a(n,`mcp.json`),cacheHome:$a(r,e),useDefaultFlags:i?.useDefaultFlags,isTransient:i?.transient,workspaces:i?.workspaces}}let Eh=class extends y{static{this.PROFILES_KEY=`userDataProfiles`}static{this.PROFILE_ASSOCIATIONS_KEY=`profileAssociations`}get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}constructor(e,t,n,r){super(),this.environmentService=e,this.fileService=t,this.uriIdentityService=n,this.logService=r,this._onDidChangeProfiles=this._register(new x),this.onDidChangeProfiles=this._onDidChangeProfiles.event,this._onWillCreateProfile=this._register(new x),this.onWillCreateProfile=this._onWillCreateProfile.event,this._onWillRemoveProfile=this._register(new x),this.onWillRemoveProfile=this._onWillRemoveProfile.event,this._onDidResetWorkspaces=this._register(new x),this.onDidResetWorkspaces=this._onDidResetWorkspaces.event,this.profileCreationPromises=new Map,this.transientProfilesObject={profiles:[],emptyWindows:new Map},this.profilesHome=$a(this.environmentService.userRoamingDataHome,`profiles`),this.profilesCacheHome=$a(this.environmentService.cacheHome,`CachedProfilesData`)}init(){this._profilesObject=void 0}get profilesObject(){if(!this._profilesObject){let e=this.createDefaultProfile(),t=[e];try{for(let n of this.getStoredProfiles()){if(!n.name||!Ze(n.name)||!n.location){this.logService.warn(`Skipping the invalid stored profile`,n.location||n.name);continue}t.push(Th(Xa(n.location),n.name,n.location,this.profilesCacheHome,{icon:n.icon,useDefaultFlags:n.useDefaultFlags},e))}}catch(e){this.logService.error(e)}let n=new Map;if(t.length)try{let e=this.getStoredProfileAssociations();if(e.workspaces)for(let[n,r]of Object.entries(e.workspaces)){let e=w.parse(n),i=t.find(e=>e.id===r);if(i){let t=i.workspaces?i.workspaces.slice(0):[];t.push(e),i.workspaces=t}}if(e.emptyWindows)for(let[r,i]of Object.entries(e.emptyWindows)){let e=t.find(e=>e.id===i);e&&n.set(r,e)}}catch(e){this.logService.error(e)}this._profilesObject={profiles:t,emptyWindows:n}}return this._profilesObject}createDefaultProfile(){let e=Th(`__default__profile__`,C(2401,`Default`),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...e,extensionsResource:this.getDefaultProfileExtensionsLocation()??e.extensionsResource,isDefault:!0}}async createTransientProfile(e){let t=`Temp`,n=RegExp(`${zi(t)}\\s(\\d+)`),r=0;for(let e of this.profiles){let t=n.exec(e.name),i=t?parseInt(t[1]):0;r=i>r?i:r}let i=`${t} ${r+1}`;return this.createProfile(uh(Nc()).toString(16),i,{transient:!0},e)}async createNamedProfile(e,t,n){return this.createProfile(uh(Nc()).toString(16),e,t,n)}async createProfile(e,t,n,r){let i=await this.doCreateProfile(e,t,n,r);return i}async doCreateProfile(e,t,n,r){if(!Ze(t)||!t)throw Error("Name of the profile is mandatory and must be of type `string`");let i=this.profileCreationPromises.get(t);return i||(i=(async()=>{try{let i=this.profiles.find(r=>r.id===e||!r.isTransient&&!n?.transient&&r.name===t);if(i)throw Error(`Profile with ${t} name already exists`);let a=r?this.getWorkspace(r):void 0;w.isUri(a)&&(n={...n,workspaces:[a]});let o=Th(e,t,$a(this.profilesHome,e),this.profilesCacheHome,n,this.defaultProfile);await this.fileService.createFolder(o.location);let s=[];return this._onWillCreateProfile.fire({profile:o,join(e){s.push(e)}}),await Po.settled(s),a&&!w.isUri(a)&&this.updateEmptyWindowAssociation(a,o,!!o.isTransient),this.updateProfiles([o],[],[]),o}finally{this.profileCreationPromises.delete(t)}})(),this.profileCreationPromises.set(t,i)),i}async updateProfile(e,t){let n=[];for(let r of this.profiles){let i;if(e.id===r.id)r.isDefault?t.workspaces&&(i=r,i.workspaces=t.workspaces):i=Th(r.id,t.name??r.name,r.location,this.profilesCacheHome,{icon:t.icon===null?void 0:t.icon??r.icon,transient:t.transient??r.isTransient,useDefaultFlags:t.useDefaultFlags??r.useDefaultFlags,workspaces:t.workspaces??r.workspaces},this.defaultProfile);else if(t.workspaces){let e=r.workspaces?.filter(e=>!t.workspaces?.some(t=>this.uriIdentityService.extUri.isEqual(e,t)));r.workspaces?.length!==e?.length&&(i=r,i.workspaces=e)}i&&n.push(i)}if(!n.length)throw e.isDefault?Error(`Cannot update default profile`):Error(`Profile '${e.name}' does not exist`);this.updateProfiles([],[],n);let r=this.profiles.find(t=>t.id===e.id);if(!r)throw Error(`Profile '${e.name}' was not updated`);return r}async removeProfile(e){if(e.isDefault)throw Error(`Cannot remove default profile`);let t=this.profiles.find(t=>t.id===e.id);if(!t)throw Error(`Profile '${e.name}' does not exist`);let n=[];this._onWillRemoveProfile.fire({profile:t,join(e){n.push(e)}});try{await Promise.allSettled(n)}catch(e){this.logService.error(e)}this.updateProfiles([],[t],[]);try{await this.fileService.del(t.cacheHome,{recursive:!0})}catch(e){pc(e)!==_c.FILE_NOT_FOUND&&this.logService.error(e)}}async setProfileForWorkspace(e,t){let n=this.profiles.find(e=>e.id===t.id);if(!n)throw Error(`Profile '${t.name}' does not exist`);let r=this.getWorkspace(e);if(w.isUri(r)){let e=n.workspaces?[...n.workspaces]:[];e.some(e=>this.uriIdentityService.extUri.isEqual(e,r))||(e.push(r),await this.updateProfile(n,{workspaces:e}))}else this.updateEmptyWindowAssociation(r,n,!1),this.updateStoredProfiles(this.profiles)}unsetWorkspace(e,t=!1){let n=this.getWorkspace(e);if(w.isUri(n)){let t=this.getProfileForWorkspace(e);t&&this.updateProfile(t,{workspaces:t.workspaces?.filter(e=>!this.uriIdentityService.extUri.isEqual(e,n))})}else this.updateEmptyWindowAssociation(n,void 0,t),this.updateStoredProfiles(this.profiles)}async resetWorkspaces(){this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.emptyWindows.clear();for(let e of this.profiles)e.workspaces=void 0;this.updateProfiles([],[],this.profiles),this._onDidResetWorkspaces.fire()}async cleanUp(){if(await this.fileService.exists(this.profilesHome)){let e=await this.fileService.resolve(this.profilesHome);await Promise.all((e.children||[]).filter(e=>e.isDirectory&&this.profiles.every(t=>!this.uriIdentityService.extUri.isEqual(t.location,e.resource))).map(e=>this.fileService.del(e.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){let e=this.transientProfilesObject.profiles.filter(e=>!this.isProfileAssociatedToWorkspace(e));await Promise.allSettled(e.map(e=>this.removeProfile(e)))}getProfileForWorkspace(e){let t=this.getWorkspace(e);return w.isUri(t)?this.profiles.find(e=>e.workspaces?.some(e=>this.uriIdentityService.extUri.isEqual(e,t))):this.profilesObject.emptyWindows.get(t)??this.transientProfilesObject.emptyWindows.get(t)}getWorkspace(e){return Tc(e)?e.uri:Ec(e)?e.configPath:e.id}isProfileAssociatedToWorkspace(e){return!!(e.workspaces?.length||[...this.profilesObject.emptyWindows.values()].some(t=>this.uriIdentityService.extUri.isEqual(t.location,e.location))||[...this.transientProfilesObject.emptyWindows.values()].some(t=>this.uriIdentityService.extUri.isEqual(t.location,e.location)))}updateProfiles(e,t,n){let r=[...this.profiles,...e],i=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];let a=[];for(let e of r){if(t.some(t=>e.id===t.id)){for(let t of[...this.profilesObject.emptyWindows.keys()])e.id===this.profilesObject.emptyWindows.get(t)?.id&&this.profilesObject.emptyWindows.delete(t);continue}if(!e.isDefault){e=n.find(t=>e.id===t.id)??e;let t=i.find(t=>e.id===t.id);if(e.isTransient)this.transientProfilesObject.profiles.push(e);else if(t){for(let[t,n]of this.transientProfilesObject.emptyWindows.entries())if(e.id===n.id){this.transientProfilesObject.emptyWindows.delete(t),this.profilesObject.emptyWindows.set(t,e);break}}}e.workspaces?.length===0&&(e.workspaces=void 0),a.push(e)}this.updateStoredProfiles(a),this.triggerProfilesChanges(e,t,n)}triggerProfilesChanges(e,t,n){this._onDidChangeProfiles.fire({added:e,removed:t,updated:n,all:this.profiles})}updateEmptyWindowAssociation(e,t,n){n=t?.isTransient?!0:n,n?t?this.transientProfilesObject.emptyWindows.set(e,t):this.transientProfilesObject.emptyWindows.delete(e):(this.transientProfilesObject.emptyWindows.delete(e),t?this.profilesObject.emptyWindows.set(e,t):this.profilesObject.emptyWindows.delete(e))}updateStoredProfiles(e){let t=[],n={},r={};for(let r of e){if(r.isTransient)continue;if(r.isDefault||t.push({location:r.location,name:r.name,icon:r.icon,useDefaultFlags:r.useDefaultFlags}),r.workspaces)for(let e of r.workspaces)n[e.toString()]=r.id}for(let[e,t]of this.profilesObject.emptyWindows.entries())r[e.toString()]=t.id;this.saveStoredProfileAssociations({workspaces:n,emptyWindows:r}),this.saveStoredProfiles(t),this._profilesObject=void 0}getStoredProfiles(){return[]}saveStoredProfiles(e){throw Error(`not implemented`)}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(e){throw Error(`not implemented`)}getDefaultProfileExtensionsLocation(){}};Eh=A([j(0,bh),j(1,xh),j(2,Sh),j(3,xs)],Eh);const Dh=`__$__targetStorageMarker`;var Oh;(function(e){e[e.NONE=0]=`NONE`,e[e.SHUTDOWN=1]=`SHUTDOWN`})(Oh||={});var kh;(function(e){e[e.APPLICATION=-1]=`APPLICATION`,e[e.PROFILE=0]=`PROFILE`,e[e.WORKSPACE=1]=`WORKSPACE`})(kh||={});var Ah;(function(e){e[e.USER=0]=`USER`,e[e.MACHINE=1]=`MACHINE`})(Ah||={});function jh(e){let t=e.get(Dh);if(t)try{return JSON.parse(t)}catch{}return Object.create(null)}(class e extends y{static{this.DEFAULT_FLUSH_INTERVAL=60*1e3}constructor(t={flushInterval:e.DEFAULT_FLUSH_INTERVAL}){super(),this._onDidChangeValue=this._register(new fn),this._onDidChangeTarget=this._register(new fn),this.onDidChangeTarget=this._onDidChangeTarget.event,this._onWillSaveState=this._register(new x),this.onWillSaveState=this._onWillSaveState.event,this.runFlushWhenIdle=this._register(new xt),this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0,this.flushWhenIdleScheduler=this._register(new Do(()=>this.doFlushWhenIdle(),t.flushInterval))}onDidChangeValue(e,t,n){return en.filter(this._onDidChangeValue.event,n=>n.scope===e&&(t===void 0||n.key===t),n)}doFlushWhenIdle(){this.runFlushWhenIdle.value=Oo(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){yt([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||=(async()=>{Tn(`code/willInitStorage`);try{await this.doInitialize()}finally{Tn(`code/didInitStorage`)}this.flushWhenIdleScheduler.schedule()})(),this.initializationPromise}emitDidChangeValue(e,t){let{key:n,external:r}=t;if(n===Dh){switch(e){case kh.APPLICATION:this._applicationKeyTargets=void 0;break;case kh.PROFILE:this._profileKeyTargets=void 0;break;case kh.WORKSPACE:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:n,target:this.getKeyTargets(e)[n],external:r})}emitWillSaveState(e){this._onWillSaveState.fire({reason:e})}get(e,t,n){return this.getStorage(t)?.get(e,n)}getBoolean(e,t,n){return this.getStorage(t)?.getBoolean(e,n)}getNumber(e,t,n){return this.getStorage(t)?.getNumber(e,n)}getObject(e,t,n){return this.getStorage(t)?.getObject(e,n)}storeAll(e,t){this.withPausedEmitters(()=>{for(let n of e)this.store(n.key,n.value,n.scope,n.target,t)})}store(e,t,n,r,i=!1){if(at(t)){this.remove(e,n,i);return}this.withPausedEmitters(()=>{this.updateKeyTarget(e,n,r),this.getStorage(n)?.set(e,t,i)})}remove(e,t,n=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(e,t,void 0),this.getStorage(t)?.delete(e,n)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(e,t){let n=[],r=this.getKeyTargets(e);for(let e of Object.keys(r)){let i=r[e];i===t&&n.push(e)}return n}updateKeyTarget(e,t,n,r=!1){let i=this.getKeyTargets(t);typeof n==`number`?i[e]!==n&&(i[e]=n,this.getStorage(t)?.set(Dh,JSON.stringify(i),r)):typeof i[e]==`number`&&(delete i[e],this.getStorage(t)?.set(Dh,JSON.stringify(i),r))}get workspaceKeyTargets(){return this._workspaceKeyTargets||=this.loadKeyTargets(kh.WORKSPACE),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||=this.loadKeyTargets(kh.PROFILE),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||=this.loadKeyTargets(kh.APPLICATION),this._applicationKeyTargets}getKeyTargets(e){switch(e){case kh.APPLICATION:return this.applicationKeyTargets;case kh.PROFILE:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){let t=this.getStorage(e);return t?jh(t):Object.create(null)}isNew(e){return this.getBoolean(`__$__isNewStorageMarker`,e)===!0}async flush(e=Oh.NONE){this._onWillSaveState.fire({reason:e});let t=this.getStorage(kh.APPLICATION),n=this.getStorage(kh.PROFILE),r=this.getStorage(kh.WORKSPACE);switch(e){case Oh.NONE:await Po.settled([t?.whenFlushed()??Promise.resolve(),n?.whenFlushed()??Promise.resolve(),r?.whenFlushed()??Promise.resolve()]);break;case Oh.SHUTDOWN:await Po.settled([t?.flush(0)??Promise.resolve(),n?.flush(0)??Promise.resolve(),r?.flush(0)??Promise.resolve()]);break}}async log(){let e=this.getStorage(kh.APPLICATION)?.items??new Map,t=this.getStorage(kh.PROFILE)?.items??new Map,n=this.getStorage(kh.WORKSPACE)?.items??new Map;return Nh(e,t,n,this.getLogDetails(kh.APPLICATION)??``,this.getLogDetails(kh.PROFILE)??``,this.getLogDetails(kh.WORKSPACE)??``)}async optimize(e){return await this.flush(),this.getStorage(e)?.optimize()}async switch(e,t){return this.emitWillSaveState(Oh.NONE),wh(e)?this.switchToProfile(e,t):this.switchToWorkspace(e,t)}canSwitchProfile(e,t){return!(e.id===t.id||Mh(t)&&Mh(e))}switchData(e,t,n){this.withPausedEmitters(()=>{let r=new Set;for(let[i,a]of e){r.add(i);let e=t.get(i);e!==a&&this.emitDidChangeValue(n,{key:i,external:!0})}for(let[e]of t.items)r.has(e)||this.emitDidChangeValue(n,{key:e,external:!0})})}});function Mh(e){return e.isDefault||!!e.useDefaultFlags?.globalState}async function Nh(e,t,n,r,i,a){let o=e=>{try{return JSON.parse(e)}catch{return e}},s=new Map,c=new Map;e.forEach((e,t)=>{s.set(t,e),c.set(t,o(e))});let l=new Map,u=new Map;t.forEach((e,t)=>{l.set(t,e),u.set(t,o(e))});let d=new Map,f=new Map;n.forEach((e,t)=>{d.set(t,e),f.set(t,o(e))}),r===i?console.group(`Storage: Application & Profile (path: ${r}, default profile)`):console.group(`Storage: Application (path: ${r})`);let p=[];if(s.forEach((e,t)=>{p.push({key:t,value:e})}),console.table(p),console.groupEnd(),console.log(c),r!==i){console.group(`Storage: Profile (path: ${i}, profile specific)`);let e=[];l.forEach((t,n)=>{e.push({key:n,value:t})}),console.table(e),console.groupEnd(),console.log(u)}console.group(`Storage: Workspace (path: ${a})`);let ee=[];d.forEach((e,t)=>{ee.push({key:t,value:e})}),console.table(ee),console.groupEnd(),console.log(f)}const Ph=k(`storageService`);var Fh;(function(e){e[e.APPLICATION=1]=`APPLICATION`,e[e.USER=2]=`USER`,e[e.USER_LOCAL=3]=`USER_LOCAL`,e[e.USER_REMOTE=4]=`USER_REMOTE`,e[e.WORKSPACE=5]=`WORKSPACE`,e[e.WORKSPACE_FOLDER=6]=`WORKSPACE_FOLDER`,e[e.DEFAULT=7]=`DEFAULT`,e[e.MEMORY=8]=`MEMORY`})(Fh||={});function Ih(e,t){let n=Object.create(null);for(let r in e)Lh(n,r,e[r],t);return n}function Lh(e,t,n,r){let i=t.split(`.`),a=i.pop(),o=e;for(let e=0;e<i.length;e++){let n=i[e],a=o[n];switch(typeof a){case`undefined`:a=o[n]=Object.create(null);break;case`object`:if(a===null){r(`Ignoring ${t} as ${i.slice(0,e+1).join(`.`)} is null`);return}break;default:r(`Ignoring ${t} as ${i.slice(0,e+1).join(`.`)} is ${JSON.stringify(a)}`);return}o=a}if(typeof o==`object`&&o)try{o[a]=n}catch{r(`Ignoring ${t} as ${i.join(`.`)} is ${JSON.stringify(o)}`)}else r(`Ignoring ${t} as ${i.join(`.`)} is ${JSON.stringify(o)}`)}function Rh(e,t){let n=t.split(`.`);zh(e,n)}function zh(e,t){if(!e)return;let n=t.shift();if(t.length===0){delete e[n];return}if(Object.keys(e).indexOf(n)!==-1){let r=e[n];typeof r==`object`&&!Array.isArray(r)&&(zh(r,t),Object.keys(r).length===0&&delete e[n])}}function Bh(e,t,n){function r(e,t){let n=e;for(let e of t){if(typeof n!=`object`||!n)return;n=n[e]}return n}let i=t.split(`.`),a=r(e,i);return a===void 0?n:a}function Vh(e){return e.replace(/^\[/,``).replace(/]$/g,``).replace(/\]\[/g,`, `)}function Hh(e){let t=!1,n=new Map,r=new Map,i=i=>{if(e===i)return!0;let a=JSON.stringify(i);if(a.length<30)return!0;let o=n.get(a);if(!o){let e={schemas:[i]};return n.set(a,e),r.set(i,e),!0}return o.schemas.push(i),r.set(i,o),t=!0,!1};if(Wh(e,i),n.clear(),!t)return JSON.stringify(e);let a=`$defs`;for(;e.hasOwnProperty(a);)a+=`_`;let o=[];function s(e){return JSON.stringify(e,(t,n)=>{if(n!==e){let e=r.get(n);if(e&&e.schemas.length>1)return e.id||(e.id=`_${o.length}`,o.push(e.schemas[0])),{$ref:`#/${a}/${e.id}`}}return n})}let c=s(e),l=[];for(let e=0;e<o.length;e++)l.push(`"_${e}":${s(o[e])}`);return l.length?`${c.substring(0,c.length-1)},"${a}":{${l.join(`,`)}}}`:c}function Uh(e){return typeof e==`object`&&!!e}function Wh(e,t){if(!e||typeof e!=`object`)return;let n=(...e)=>{for(let t of e)Uh(t)&&o.push(t)},r=(...e)=>{for(let t of e)if(Uh(t))for(let e in t){let n=t[e];Uh(n)&&o.push(n)}},i=(...e)=>{for(let t of e)if(Array.isArray(t))for(let e of t)Uh(e)&&o.push(e)},a=e=>{if(Array.isArray(e))for(let t of e)Uh(t)&&o.push(t);else Uh(e)&&o.push(e)},o=[e],s=o.pop();for(;s;){let e=t(s);e&&(n(s.additionalItems,s.additionalProperties,s.not,s.contains,s.propertyNames,s.if,s.then,s.else,s.unevaluatedItems,s.unevaluatedProperties),r(s.definitions,s.$defs,s.properties,s.patternProperties,s.dependencies,s.dependentSchemas),i(s.anyOf,s.allOf,s.oneOf,s.prefixItems),a(s.items)),s=o.pop()}}const Gh={JSONContribution:`base.contributions.json`};function Kh(e){return e.length>0&&e.charAt(e.length-1)===`#`?e.substring(0,e.length-1):e}var qh=class extends y{constructor(){super(...arguments),this.schemasById={},this.schemaAssociations={},this._onDidChangeSchema=this._register(new x),this.onDidChangeSchema=this._onDidChangeSchema.event,this._onDidChangeSchemaAssociations=this._register(new x),this.onDidChangeSchemaAssociations=this._onDidChangeSchemaAssociations.event}registerSchema(e,t,n){let r=Kh(e);this.schemasById[r]=t,this._onDidChangeSchema.fire(e),n&&n.add(_(()=>{delete this.schemasById[r],this._onDidChangeSchema.fire(e)}))}registerSchemaAssociation(e,t){let n=Kh(e);return this.schemaAssociations[n]||(this.schemaAssociations[n]=[]),this.schemaAssociations[n].includes(t)||(this.schemaAssociations[n].push(t),this._onDidChangeSchemaAssociations.fire()),_(()=>{let e=this.schemaAssociations[n];if(e){let r=e.indexOf(t);r!==-1&&(e.splice(r,1),e.length===0&&delete this.schemaAssociations[n],this._onDidChangeSchemaAssociations.fire())}})}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){let t=this.schemasById[e];return t?Hh(t):void 0}hasSchemaContent(e){return!!this.schemasById[e]}getSchemaAssociations(){return this.schemaAssociations}};const Jh=new qh;Sm.add(Gh.JSONContribution,Jh);var Yh;(function(e){e.Multiline=`multilineText`,e.Singleline=`singlelineText`})(Yh||={});const Xh={Configuration:`base.contributions.configuration`};var Zh;(function(e){e[e.APPLICATION=1]=`APPLICATION`,e[e.MACHINE=2]=`MACHINE`,e[e.APPLICATION_MACHINE=3]=`APPLICATION_MACHINE`,e[e.WINDOW=4]=`WINDOW`,e[e.RESOURCE=5]=`RESOURCE`,e[e.LANGUAGE_OVERRIDABLE=6]=`LANGUAGE_OVERRIDABLE`,e[e.MACHINE_OVERRIDABLE=7]=`MACHINE_OVERRIDABLE`})(Zh||={});const Qh={properties:{},patternProperties:{}},$h={properties:{},patternProperties:{}},eg={properties:{},patternProperties:{}},tg={properties:{},patternProperties:{}},ng={properties:{},patternProperties:{}},rg={properties:{},patternProperties:{}},ig={properties:{},patternProperties:{}},ag=`vscode://schemas/settings/resourceLanguage`,og=Sm.as(Gh.JSONContribution);var sg=class extends y{constructor(){super(),this.registeredConfigurationDefaults=[],this.overrideIdentifiers=new Set,this._onDidSchemaChange=this._register(new x),this.onDidSchemaChange=this._onDidSchemaChange.event,this._onDidUpdateConfiguration=this._register(new x),this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:`defaultOverrides`,title:C(1737,`Default Language Configuration Overrides`),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},og.registerSchema(ag,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){return this.registerConfigurations([e],t),e}registerConfigurations(e,t=!0){let n=new Set;this.doRegisterConfigurations(e,t,n),og.registerSchema(ag,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}deregisterConfigurations(e){let t=new Set;this.doDeregisterConfigurations(e,t),og.registerSchema(ag,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){let n=new Set;this.doDeregisterConfigurations(t,n),this.doRegisterConfigurations(e,!1,n),og.registerSchema(ag,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n})}registerDefaultConfigurations(e){let t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);let n=[];for(let{overrides:r,source:i}of e)for(let e in r){t.add(e);let a=this.configurationDefaultsOverrides.get(e)??this.configurationDefaultsOverrides.set(e,{configurationDefaultOverrides:[]}).get(e),o=r[e];if(a.configurationDefaultOverrides.push({value:o,source:i}),dg.test(e)){let t=this.mergeDefaultConfigurationsForOverrideIdentifier(e,o,i,a.configurationDefaultOverrideValue);if(!t)continue;a.configurationDefaultOverrideValue=t,this.updateDefaultOverrideProperty(e,t,i),n.push(...fg(e))}else{let t=this.mergeDefaultConfigurationsForConfigurationProperty(e,o,i,a.configurationDefaultOverrideValue);if(!t)continue;a.configurationDefaultOverrideValue=t;let n=this.configurationProperties[e];n&&(this.updatePropertyDefaultValue(e,n),this.updateSchema(e,n))}}this.doRegisterOverrideIdentifiers(n)}deregisterDefaultConfigurations(e){let t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){for(let t of e){let e=this.registeredConfigurationDefaults.indexOf(t);e!==-1&&this.registeredConfigurationDefaults.splice(e,1)}for(let{overrides:n,source:r}of e)for(let e in n){let i=this.configurationDefaultsOverrides.get(e);if(!i)continue;let a=i.configurationDefaultOverrides.findIndex(t=>r?t.source?.id===r.id:t.value===n[e]);if(a===-1)continue;if(i.configurationDefaultOverrides.splice(a,1),i.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(e),dg.test(e)){let t;for(let n of i.configurationDefaultOverrides)t=this.mergeDefaultConfigurationsForOverrideIdentifier(e,n.value,n.source,t);t&&!lt(t.value)?(i.configurationDefaultOverrideValue=t,this.updateDefaultOverrideProperty(e,t,r)):(this.configurationDefaultsOverrides.delete(e),delete this.configurationProperties[e],delete this.defaultLanguageConfigurationOverridesNode.properties[e])}else{let t;for(let n of i.configurationDefaultOverrides)t=this.mergeDefaultConfigurationsForConfigurationProperty(e,n.value,n.source,t);i.configurationDefaultOverrideValue=t;let n=this.configurationProperties[e];n&&(this.updatePropertyDefaultValue(e,n),this.updateSchema(e,n))}t.add(e)}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,t,n){let r={type:`object`,default:t.value,description:C(1738,`Configure settings to be overridden for {0}.`,Vh(e)),$ref:ag,defaultDefaultValue:t.value,source:n,defaultValueSource:n};this.configurationProperties[e]=r,this.defaultLanguageConfigurationOverridesNode.properties[e]=r}mergeDefaultConfigurationsForOverrideIdentifier(e,t,n,r){let i=r?.value||{},a=r?.source??new Map;if(!(a instanceof Map)){console.error(`objectConfigurationSources is not a Map`);return}for(let e of Object.keys(t)){let r=t[e],o=$e(r)&&(rt(i[e])||$e(i[e]));if(o){if(i[e]={...i[e]??{},...r},n)for(let t in r)a.set(`${e}.${t}`,n)}else i[e]=r,n?a.set(e,n):a.delete(e)}return{value:i,source:a}}mergeDefaultConfigurationsForConfigurationProperty(e,t,n,r){let i=this.configurationProperties[e],a=r?.value??i?.defaultDefaultValue,o=n,s=$e(t)&&(i!==void 0&&i.type===`object`||i===void 0&&(rt(a)||$e(a)));if(s){if(o=r?.source??new Map,!(o instanceof Map)){console.error(`defaultValueSource is not a Map`);return}for(let r in t)n&&o.set(`${e}.${r}`,n);t={...$e(a)?a:{},...t}}return{value:t,source:o}}deltaConfiguration(e){let t=!1,n=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,n),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,n),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,n),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,n),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:n,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(let t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,n){e.forEach(e=>{this.validateAndRegisterProperties(e,t,e.extensionInfo,e.restrictedProperties,void 0,n),this.configurationContributors.push(e),this.registerJSONConfiguration(e)})}doDeregisterConfigurations(e,t){let n=e=>{if(e.properties)for(let n in e.properties){t.add(n);let r=this.configurationProperties[n];r?.policy?.name&&this.policyConfigurations.delete(r.policy.name),delete this.configurationProperties[n],this.removeFromSchema(n,e.properties[n])}e.allOf?.forEach(e=>n(e))};for(let t of e){n(t);let e=this.configurationContributors.indexOf(t);e!==-1&&this.configurationContributors.splice(e,1)}}validateAndRegisterProperties(e,t=!0,n,r,i=Zh.WINDOW,a){i=at(e.scope)?i:e.scope;let o=e.properties;if(o)for(let e in o){let s=o[e];if(t&&hg(e,s)){delete o[e];continue}s.source=n,s.defaultDefaultValue=o[e].default,this.updatePropertyDefaultValue(e,s),dg.test(e)?s.scope=void 0:(s.scope=at(s.scope)?i:s.scope,s.restricted=at(s.restricted)?!!r?.includes(e):s.restricted),s.experiment?s.tags?.some(e=>e.toLowerCase()===`onexp`)||(s.tags=s.tags??[],s.tags.push(`onExP`)):s.tags?.some(e=>e.toLowerCase()===`onexp`)&&(console.error(`Invalid tag 'onExP' found for property '${e}'. Please use 'experiment' property instead.`),s.experiment={mode:`startup`});let c=o[e].hasOwnProperty(`included`)&&!o[e].included,l=o[e].policy?.name;c?(this.excludedConfigurationProperties[e]=o[e],l&&(this.policyConfigurations.set(l,e),a.add(e)),delete o[e]):(a.add(e),l&&this.policyConfigurations.set(l,e),this.configurationProperties[e]=o[e],!o[e].deprecationMessage&&o[e].markdownDeprecationMessage&&(o[e].deprecationMessage=o[e].markdownDeprecationMessage))}let s=e.allOf;if(s)for(let e of s)this.validateAndRegisterProperties(e,t,n,r,i,a)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){let e=new Map;for(let[t,n]of this.configurationDefaultsOverrides)n.configurationDefaultOverrideValue&&e.set(t,n.configurationDefaultOverrideValue);return e}registerJSONConfiguration(e){let t=e=>{let n=e.properties;if(n)for(let e in n)this.updateSchema(e,n[e]);let r=e.allOf;r?.forEach(t)};t(e)}updateSchema(e,t){switch(Qh.properties[e]=t,t.scope){case Zh.APPLICATION:$h.properties[e]=t;break;case Zh.MACHINE:tg.properties[e]=t;break;case Zh.APPLICATION_MACHINE:eg.properties[e]=t;break;case Zh.MACHINE_OVERRIDABLE:ng.properties[e]=t;break;case Zh.WINDOW:rg.properties[e]=t;break;case Zh.RESOURCE:ig.properties[e]=t;break;case Zh.LANGUAGE_OVERRIDABLE:ig.properties[e]=t,this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(delete Qh.properties[e],t.scope){case Zh.APPLICATION:delete $h.properties[e];break;case Zh.MACHINE:delete tg.properties[e];break;case Zh.APPLICATION_MACHINE:delete eg.properties[e];break;case Zh.MACHINE_OVERRIDABLE:delete ng.properties[e];break;case Zh.WINDOW:delete rg.properties[e];break;case Zh.RESOURCE:case Zh.LANGUAGE_OVERRIDABLE:delete ig.properties[e],delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(let e of this.overrideIdentifiers.values()){let t=`[${e}]`,n={type:`object`,description:C(1739,`Configure editor settings to be overridden for a language.`),errorMessage:C(1740,`This setting does not support per-language configuration.`),$ref:ag};this.updatePropertyDefaultValue(t,n),Qh.properties[t]=n,$h.properties[t]=n,eg.properties[t]=n,tg.properties[t]=n,ng.properties[t]=n,rg.properties[t]=n,ig.properties[t]=n}}registerOverridePropertyPatternKey(){let e={type:`object`,description:C(1739,`Configure editor settings to be overridden for a language.`),errorMessage:C(1740,`This setting does not support per-language configuration.`),$ref:ag};Qh.patternProperties[ug]=e,$h.patternProperties[ug]=e,eg.patternProperties[ug]=e,tg.patternProperties[ug]=e,ng.patternProperties[ug]=e,rg.patternProperties[ug]=e,ig.patternProperties[ug]=e,this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){let n=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue,r,i;n&&(!t.disallowConfigurationDefault||!n.source)&&(r=n.value,i=n.source),rt(r)&&(r=t.defaultDefaultValue,i=void 0),rt(r)&&(r=pg(t.type)),t.default=r,t.defaultValueSource=i}};const cg=`\\[([^\\]]+)\\]`,lg=new RegExp(cg,`g`),ug=`^(${cg})+$`,dg=new RegExp(ug);function fg(e){let t=[];if(dg.test(e)){let n=lg.exec(e);for(;n?.length;){let r=n[1].trim();r&&t.push(r),n=lg.exec(e)}}return we(t)}function pg(e){let t=Array.isArray(e)?e[0]:e;switch(t){case`boolean`:return!1;case`integer`:case`number`:return 0;case`string`:return``;case`array`:return[];case`object`:return{};default:return null}}const mg=new sg;Sm.add(Xh.Configuration,mg);function hg(e,t){return e.trim()?dg.test(e)?C(1742,`Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.`,e):mg.getConfigurationProperties()[e]===void 0?t.policy?.name&&mg.getPolicyConfigurations().get(t.policy?.name)!==void 0?C(1744,`Cannot register '{0}'. The associated policy {1} is already registered with {2}.`,e,t.policy?.name,mg.getPolicyConfigurations().get(t.policy?.name)):null:C(1743,`Cannot register '{0}'. This property is already registered.`,e):C(1741,`Cannot register an empty property`)}const gg=`^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$`;var _g;(function(e){e.COMMAND=`command`,e.SETTINGS_SYNC=`settingsSync`})(_g||={});var vg;(function(e){e.NoneOrRelevance=`NoneOrRelevance`,e.LastUpdatedDate=`LastUpdatedDate`,e.Title=`Title`,e.PublisherName=`PublisherName`,e.InstallCount=`InstallCount`,e.PublishedDate=`PublishedDate`,e.AverageRating=`AverageRating`,e.WeightedRating=`WeightedRating`})(vg||={});var yg;(function(e){e[e.Default=0]=`Default`,e[e.Ascending=1]=`Ascending`,e[e.Descending=2]=`Descending`})(yg||={});var bg;(function(e){e.Category=`Category`,e.ExtensionId=`ExtensionId`,e.ExtensionName=`ExtensionName`,e.ExcludeWithFlags=`ExcludeWithFlags`,e.Featured=`Featured`,e.SearchText=`SearchText`,e.Tag=`Tag`,e.Target=`Target`})(bg||={});var xg;(function(e){e.Install=`install`,e.Uninstall=`uninstall`})(xg||={});var Sg;(function(e){e[e.None=1]=`None`,e[e.Install=2]=`Install`,e[e.Update=3]=`Update`,e[e.Migrate=4]=`Migrate`})(Sg||={});var Cg;(function(e){e.Timeout=`Timeout`,e.Cancelled=`Cancelled`,e.Failed=`Failed`,e.DownloadFailedWriting=`DownloadFailedWriting`,e.Offline=`Offline`})(Cg||={});var wg;(function(e){e.NotFound=`NotFound`,e.Unsupported=`Unsupported`,e.Deprecated=`Deprecated`,e.Malicious=`Malicious`,e.Incompatible=`Incompatible`,e.IncompatibleApi=`IncompatibleApi`,e.IncompatibleTargetPlatform=`IncompatibleTargetPlatform`,e.ReleaseVersionNotFound=`ReleaseVersionNotFound`,e.Invalid=`Invalid`,e.Download=`Download`,e.DownloadSignature=`DownloadSignature`,e.DownloadFailedWriting=`DownloadFailedWriting`,e.UpdateMetadata=`UpdateMetadata`,e.Extract=`Extract`,e.Scanning=`Scanning`,e.ScanningExtension=`ScanningExtension`,e.ReadRemoved=`ReadRemoved`,e.UnsetRemoved=`UnsetRemoved`,e.Delete=`Delete`,e.Rename=`Rename`,e.IntializeDefaultProfile=`IntializeDefaultProfile`,e.AddToProfile=`AddToProfile`,e.InstalledExtensionNotFound=`InstalledExtensionNotFound`,e.PostInstall=`PostInstall`,e.CorruptZip=`CorruptZip`,e.IncompleteZip=`IncompleteZip`,e.PackageNotSigned=`PackageNotSigned`,e.SignatureVerificationInternal=`SignatureVerificationInternal`,e.SignatureVerificationFailed=`SignatureVerificationFailed`,e.NotAllowed=`NotAllowed`,e.Gallery=`Gallery`,e.Cancelled=`Cancelled`,e.Unknown=`Unknown`,e.Internal=`Internal`})(wg||={});var Tg;(function(e){e.NotSigned=`NotSigned`,e.Success=`Success`,e.RequiredArgumentMissing=`RequiredArgumentMissing`,e.InvalidArgument=`InvalidArgument`,e.PackageIsUnreadable=`PackageIsUnreadable`,e.UnhandledException=`UnhandledException`,e.SignatureManifestIsMissing=`SignatureManifestIsMissing`,e.SignatureManifestIsUnreadable=`SignatureManifestIsUnreadable`,e.SignatureIsMissing=`SignatureIsMissing`,e.SignatureIsUnreadable=`SignatureIsUnreadable`,e.CertificateIsUnreadable=`CertificateIsUnreadable`,e.SignatureArchiveIsUnreadable=`SignatureArchiveIsUnreadable`,e.FileAlreadyExists=`FileAlreadyExists`,e.SignatureArchiveIsInvalidZip=`SignatureArchiveIsInvalidZip`,e.SignatureArchiveHasSameSignatureFile=`SignatureArchiveHasSameSignatureFile`,e.PackageIntegrityCheckFailed=`PackageIntegrityCheckFailed`,e.SignatureIsInvalid=`SignatureIsInvalid`,e.SignatureManifestIsInvalid=`SignatureManifestIsInvalid`,e.SignatureIntegrityCheckFailed=`SignatureIntegrityCheckFailed`,e.EntryIsMissing=`EntryIsMissing`,e.EntryIsTampered=`EntryIsTampered`,e.Untrusted=`Untrusted`,e.CertificateRevoked=`CertificateRevoked`,e.SignatureIsNotValid=`SignatureIsNotValid`,e.UnknownError=`UnknownError`,e.PackageIsInvalidZip=`PackageIsInvalidZip`,e.SignatureArchiveHasTooManyEntries=`SignatureArchiveHasTooManyEntries`})(Tg||={}),Nn(1797,`Extensions`),Nn(1798,`Preferences`),Sm.as(Xh.Configuration).registerConfiguration({id:`extensions`,order:30,title:C(1799,`Extensions`),type:`object`,properties:{"extensions.allowed":{type:`object`,markdownDescription:C(1800,`Specify a list of extensions that are allowed to use. This helps maintain a secure and consistent development environment by restricting the use of unauthorized extensions. For more information on how to configure this setting, please visit the [Configure Allowed Extensions](https://code.visualstudio.com/docs/setup/enterprise#_configure-allowed-extensions) section.`),default:`*`,defaultSnippets:[{body:{},description:C(1801,`No extensions are allowed.`)},{body:{"*":!0},description:C(1802,`All extensions are allowed.`)}],scope:Zh.APPLICATION,policy:{name:`AllowedExtensions`,minimumVersion:`1.96`,description:C(1803,`Specify a list of extensions that are allowed to use. This helps maintain a secure and consistent development environment by restricting the use of unauthorized extensions. More information: https://code.visualstudio.com/docs/setup/enterprise#_configure-allowed-extensions`)},additionalProperties:!1,patternProperties:{"([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$":{anyOf:[{type:[`boolean`,`string`],enum:[!0,!1,`stable`],description:C(1804,`Allow or disallow the extension.`),enumDescriptions:[C(1805,`Extension is allowed.`),C(1806,`Extension is not allowed.`),C(1807,`Allow only stable versions of the extension.`)]},{type:`array`,items:{type:`string`},description:C(1808,"Allow or disallow specific versions of the extension. To specifcy a platform specific version, use the format `platform@1.2.3`, e.g. `win32-x64@1.2.3`. Supported platforms are `win32-x64`, `win32-arm64`, `linux-x64`, `linux-arm64`, `linux-armhf`, `alpine-x64`, `alpine-arm64`, `darwin-x64`, `darwin-arm64`")}]},"([a-z0-9A-Z][a-z0-9-A-Z]*)$":{type:[`boolean`,`string`],enum:[!0,!1,`stable`],description:C(1809,`Allow or disallow all extensions from the publisher.`),enumDescriptions:[C(1810,`All extensions from the publisher are allowed.`),C(1811,`All extensions from the publisher are not allowed.`),C(1812,`Allow only stable versions of the extensions from the publisher.`)]},"\\*":{type:`boolean`,enum:[!0,!1],description:C(1813,`Allow or disallow all extensions.`),enumDescriptions:[C(1814,`Allow all extensions.`),C(1815,`Disallow all extensions.`)]}}}}});var Eg;(function(e){e[e.NONE=0]=`NONE`,e[e.CRASH=1]=`CRASH`,e[e.ERROR=2]=`ERROR`,e[e.USAGE=3]=`USAGE`})(Eg||={});var Dg;(function(e){e.OFF=`off`,e.CRASH=`crash`,e.ERROR=`error`,e.ON=`all`})(Dg||={});var Og=class{constructor(e){this.value=e,this.isTrustedTelemetryValue=!0}},kg=class{constructor(){this.telemetryLevel=Eg.NONE,this.sessionId=`someValue.sessionId`,this.machineId=`someValue.machineId`,this.sqmId=`someValue.sqmId`,this.devDeviceId=`someValue.devDeviceId`,this.firstSessionDate=`someValue.firstSessionDate`,this.sendErrorTelemetry=!1}publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}};new kg;const Ag={id:`telemetry`,name:C(2043,`Telemetry`)},jg=new Set([`ssh-remote`,`dev-container`,`attached-container`,`wsl`,`tunnel`,`codespaces`,`amlext`]);function Mg(e){if(!e)return`none`;let t=us(e);return jg.has(t)?t:`other`}function Ng(e,t){if(!e||!e.includes(`/`)&&!e.includes(`\\`))return e;let n=e,r=[];for(let n of t)for(;;){let t=n.exec(e);if(!t)break;r.push([t.index,n.lastIndex])}let i=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,a=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g,o=0;for(n=``;;){let t=a.exec(e);if(!t)break;let s=r.some(([e,n])=>t.index<n&&e<a.lastIndex);!i.test(t[0])&&!s&&(n+=e.substring(o,t.index)+`<REDACTED: user-file-path>`,o=a.lastIndex)}return o<e.length&&(n+=e.substr(o)),n}function Pg(e){if(!e)return e;let t=[{label:`Google API Key`,regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:`JWT`,regex:/eyJ[0eXAiOiJKV1Qi|hbGci|a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+/},{label:`Slack Token`,regex:/xox[pbar]\-[A-Za-z0-9]/},{label:`GitHub Token`,regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:`Generic Secret`,regex:/(key|token|sig|secret|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/i},{label:`CLI Credentials`,regex:/((login|psexec|(certutil|psexec)\.exe).{1,50}(\s-u(ser(name)?)?\s+.{3,100})?\s-(admin|user|vm|root)?p(ass(word)?)?\s+["']?[^$\-\/\s]|(^|[\s\r\n\\])net(\.exe)?.{1,5}(user\s+|share\s+\/user:| user -? secrets ? set) \s + [^ $\s \/])/},{label:`Microsoft Entra ID`,regex:/eyJ(?:0eXAiOiJKV1Qi|hbGci|[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.)/},{label:`Email`,regex:/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/}];for(let n of t)if(n.regex.test(e))return`<REDACTED: ${n.label}>`;return e}function Fg(e,t){return Qs(e,e=>{if(e instanceof Og||Object.hasOwnProperty.call(e,`isTrustedTelemetryValue`))return e.value;if(typeof e==`string`){let n=e.replaceAll(`%20`,` `);n=Ng(n,t);for(let e of t)n=n.replace(e,``);return n=Pg(n),n}})}function Ig(e,t){return e.uuid&&t.uuid?e.uuid===t.uuid:e.id===t.id?!0:Xi(e.id,t.id)===0}new ms(`pprice.better-merge`);var Lg=class{constructor(){this._generators=new Map,this._cache=new WeakMap}register(e,t){this._generators.set(e,t)}readActivationEvents(e){return this._cache.has(e)||this._cache.set(e,this._readActivationEvents(e)),this._cache.get(e)}createActivationEventsMap(e){let t=Object.create(null);for(let n of e){let e=this.readActivationEvents(n);e.length>0&&(t[ms.toKey(n.identifier)]=e)}return t}_readActivationEvents(e){if(e.main===void 0&&e.browser===void 0)return[];let t=Array.isArray(e.activationEvents)?e.activationEvents.slice(0):[];for(let n=0;n<t.length;n++)t[n]===`onUri`&&(t[n]=`onUri:${ms.toKey(e.identifier)}`);if(!e.contributes)return t;for(let n in e.contributes){let r=this._generators.get(n);if(!r)continue;let i=e.contributes[n],a=Array.isArray(i)?i:[i];try{r(a,t)}catch(e){m(e)}}return t}};const Rg=new Lg,zg=Object.freeze({identifier:new ms(`nullExtensionDescription`),name:`Null Extension Description`,version:`0.0.0`,publisher:`vscode`,engines:{vscode:``},extensionLocation:w.parse(`void:location`),isBuiltin:!1,targetPlatform:ps.UNDEFINED,isUserBuiltin:!1,isUnderDevelopment:!1,preRelease:!1});var Bg=class{constructor(e){this.dependency=e}},Vg;(function(e){e[e.EagerAutoStart=1]=`EagerAutoStart`,e[e.EagerManualStart=2]=`EagerManualStart`,e[e.LazyAutoStart=3]=`LazyAutoStart`})(Vg||={});function Hg(e,t){return e.enabledApiProposals?e.enabledApiProposals.includes(t):!1}function U(e,t){if(!Hg(e,t))throw Error(`Extension '${e.identifier.value}' CANNOT use API proposal: ${t}.\nIts package.json#enabledApiProposals-property declares: ${e.enabledApiProposals?.join(`, `)??`[]`} but NOT ${t}.\n The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api ${e.identifier.value}`)}var Ug;(function(e){e[e.Normal=0]=`Normal`,e[e.Immediate=1]=`Immediate`})(Ug||={});const Wg=k(`extensionService`),Gg={activeComment:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts`},aiRelatedInformation:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts`},aiSettingsSearch:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiSettingsSearch.d.ts`},aiTextSearchProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts`,version:2},authIssuers:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authIssuers.d.ts`},authLearnMore:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts`},authProviderSpecific:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authProviderSpecific.d.ts`},authSession:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts`},canonicalUriProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts`},chatEditing:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatEditing.d.ts`},chatOutputRenderer:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatOutputRenderer.d.ts`},chatParticipantAdditions:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts`},chatParticipantPrivate:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts`,version:9},chatProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts`},chatReferenceBinaryData:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceBinaryData.d.ts`},chatReferenceDiagnostic:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceDiagnostic.d.ts`},chatSessionsProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatSessionsProvider.d.ts`},chatStatusItem:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatStatusItem.d.ts`},chatTab:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts`},codeActionAI:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts`},codeActionRanges:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts`},codiconDecoration:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts`},commentReactor:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts`},commentReveal:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts`},commentThreadApplicability:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts`},commentingRangeHint:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts`},commentsDraftState:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts`},contribAccessibilityHelpContent:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts`},contribCommentEditorActionsMenu:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts`},contribCommentPeekContext:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts`},contribCommentThreadAdditionalMenu:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts`},contribCommentsViewThreadMenus:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts`},contribDebugCreateConfiguration:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDebugCreateConfiguration.d.ts`},contribDiffEditorGutterToolBarMenus:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts`},contribEditSessions:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts`},contribEditorContentMenu:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts`},contribLabelFormatterWorkspaceTooltip:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts`},contribLanguageModelToolSets:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLanguageModelToolSets.d.ts`},contribMenuBarHome:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts`},contribMergeEditorMenus:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts`},contribMultiDiffEditorMenus:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts`},contribNotebookStaticPreloads:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts`},contribRemoteHelp:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts`},contribShareMenu:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts`},contribSourceControlHistoryItemMenu:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts`},contribSourceControlHistoryTitleMenu:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryTitleMenu.d.ts`},contribSourceControlInputBoxMenu:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts`},contribSourceControlTitleMenu:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts`},contribStatusBarItems:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts`},contribViewContainerTitle:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewContainerTitle.d.ts`},contribViewsRemote:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts`},contribViewsWelcome:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts`},customEditorMove:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts`},dataChannels:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.dataChannels.d.ts`},debugVisualization:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts`},defaultChatParticipant:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts`,version:4},diffCommand:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts`},diffContentOptions:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts`},documentFiltersExclusive:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts`},editSessionIdentityProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts`},editorHoverVerbosityLevel:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts`},editorInsets:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts`},embeddings:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts`},extensionRuntime:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts`},extensionsAny:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts`},externalUriOpener:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts`},fileSearchProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts`},fileSearchProvider2:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider2.d.ts`},findFiles2:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts`,version:2},findTextInFiles:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts`},findTextInFiles2:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles2.d.ts`},fsChunks:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts`},idToken:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.idToken.d.ts`},inlineCompletionsAdditions:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts`},interactive:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts`},interactiveWindow:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts`},ipc:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts`},languageModelCapabilities:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelCapabilities.d.ts`},languageModelDataPart:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelDataPart.d.ts`,version:3},languageModelSystem:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts`},languageModelToolResultAudience:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelToolResultAudience.d.ts`},languageStatusText:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts`},mappedEditsProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts`},multiDocumentHighlightProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts`},nativeWindowHandle:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.nativeWindowHandle.d.ts`},newSymbolNamesProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts`},notebookCellExecution:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts`},notebookControllerAffinityHidden:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts`},notebookDeprecated:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts`},notebookExecution:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts`},notebookKernelSource:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts`},notebookLiveShare:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts`},notebookMessaging:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts`},notebookMime:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts`},notebookReplDocument:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookReplDocument.d.ts`},notebookVariableProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts`},portsAttributes:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts`},profileContentHandlers:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts`},quickDiffProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts`},quickInputButtonLocation:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickInputButtonLocation.d.ts`},quickPickItemTooltip:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts`},quickPickSortByLabel:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts`},remoteCodingAgents:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.remoteCodingAgents.d.ts`},resolvers:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts`},scmActionButton:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts`},scmHistoryProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts`},scmMultiDiffEditor:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts`},scmProviderOptions:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmProviderOptions.d.ts`},scmSelectedProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts`},scmTextDocument:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts`},scmValidation:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts`},secretStorageKeys:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.secretStorageKeys.d.ts`},shareProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts`},speech:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts`},statusBarItemTooltip:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.statusBarItemTooltip.d.ts`},tabInputMultiDiff:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts`},tabInputTextMerge:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts`},taskExecutionTerminal:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskExecutionTerminal.d.ts`},taskPresentationGroup:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts`},taskProblemMatcherStatus:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskProblemMatcherStatus.d.ts`},telemetry:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts`},terminalCompletionProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalCompletionProvider.d.ts`},terminalDataWriteEvent:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts`},terminalDimensions:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts`},terminalExecuteCommandEvent:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts`},terminalQuickFixProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts`},terminalSelection:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts`},terminalShellEnv:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalShellEnv.d.ts`},testObserver:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts`},testRelatedCode:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts`},textDocumentChangeReason:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textDocumentChangeReason.d.ts`},textEditorDiffInformation:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textEditorDiffInformation.d.ts`},textSearchComplete2:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchComplete2.d.ts`},textSearchProvider:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts`},textSearchProvider2:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider2.d.ts`},timeline:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts`},tokenInformation:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts`},toolProgress:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.toolProgress.d.ts`},treeViewActiveItem:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts`},treeViewMarkdownMessage:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts`},treeViewReveal:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts`},tunnelFactory:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts`},tunnels:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts`},valueSelectionInQuickPick:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.valueSelectionInQuickPick.d.ts`},workspaceTrust:{proposal:`https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts`}},Kg=Object.freeze(Gg),qg=Sm.as(Gh.JSONContribution);var Jg=class e{static _toSet(e){let t=new hs;for(let n=0,r=e.length;n<r;n++)t.add(e[n].description.identifier);return t}static compute(t,n){if(!t||!t.length)return new e(n,[]);if(!n||!n.length)return new e([],t);let r=this._toSet(t),i=this._toSet(n),a=n.filter(e=>!r.has(e.description.identifier)),o=t.filter(e=>!i.has(e.description.identifier));return new e(a,o)}constructor(e,t){this.added=e,this.removed=t}},Yg=class{constructor(e,t,n){this.name=e,this.defaultExtensionKind=t,this.canHandleResolver=n,this._handler=null,this._users=null,this._delta=null}setHandler(e){if(this._handler!==null)throw Error(`Handler already set!`);return this._handler=e,this._handle(),{dispose:()=>{this._handler=null}}}acceptUsers(e){this._delta=Jg.compute(this._users,e),this._users=e,this._handle()}_handle(){if(!(this._handler===null||this._users===null||this._delta===null))try{this._handler(this._users,this._delta)}catch(e){m(e)}}};const Xg={type:`string`,enum:[`ui`,`workspace`],enumDescriptions:[C(13131,`UI extension kind. In a remote window, such extensions are enabled only when available on the local machine.`),C(13132,`Workspace extension kind. In a remote window, such extensions are enabled only when available on the remote.`)]},Zg=`vscode://schemas/vscode-extensions`,Qg={properties:{engines:{type:`object`,description:C(13133,`Engine compatibility.`),properties:{vscode:{type:`string`,description:C(13134,`For VS Code extensions, specifies the VS Code version that the extension is compatible with. Cannot be *. For example: ^0.10.5 indicates compatibility with a minimum VS Code version of 0.10.5.`),default:`^1.22.0`}}},publisher:{description:C(13135,`The publisher of the VS Code extension.`),type:`string`},displayName:{description:C(13136,`The display name for the extension used in the VS Code gallery.`),type:`string`},categories:{description:C(13137,`The categories used by the VS Code gallery to categorize the extension.`),type:`array`,uniqueItems:!0,items:{oneOf:[{type:`string`,enum:ds},{type:`string`,const:`Languages`,deprecationMessage:C(13138,`Use 'Programming  Languages' instead`)}]}},galleryBanner:{type:`object`,description:C(13139,`Banner used in the VS Code marketplace.`),properties:{color:{description:C(13140,`The banner color on the VS Code marketplace page header.`),type:`string`},theme:{description:C(13141,`The color theme for the font used in the banner.`),type:`string`,enum:[`dark`,`light`]}}},contributes:{description:C(13142,`All contributions of the VS Code extension represented by this package.`),type:`object`,properties:{},default:{}},preview:{type:`boolean`,description:C(13143,`Sets the extension to be flagged as a Preview in the Marketplace.`)},enableProposedApi:{type:`boolean`,deprecationMessage:C(13144,"Use `enabledApiProposals` instead.")},enabledApiProposals:{markdownDescription:C(13145,`Enable API proposals to try them out. Only valid **during development**. Extensions **cannot be published** with this property. For more details visit: https://code.visualstudio.com/api/advanced-topics/using-proposed-api`),type:`array`,uniqueItems:!0,items:{type:`string`,enum:Object.keys(Kg).map(e=>e),markdownEnumDescriptions:Object.values(Kg).map(e=>e.proposal)}},api:{markdownDescription:C(13146,`Describe the API provided by this extension. For more details visit: https://code.visualstudio.com/api/advanced-topics/remote-extensions#handling-dependencies-with-remote-extensions`),type:`string`,enum:[`none`],enumDescriptions:[C(13147,`Give up entirely the ability to export any APIs. This allows other extensions that depend on this extension to run in a separate extension host process or in a remote machine.`)]},activationEvents:{description:C(13148,`Activation events for the VS Code extension.`),type:`array`,items:{type:`string`,defaultSnippets:[{label:`onWebviewPanel`,description:C(13149,`An activation event emmited when a webview is loaded of a certain viewType`),body:`onWebviewPanel:viewType`},{label:`onLanguage`,description:C(13150,`An activation event emitted whenever a file that resolves to the specified language gets opened.`),body:"onLanguage:${1:languageId}"},{label:`onCommand`,description:C(13151,`An activation event emitted whenever the specified command gets invoked.`),body:"onCommand:${2:commandId}"},{label:`onDebug`,description:C(13152,`An activation event emitted whenever a user is about to start debugging or about to setup debug configurations.`),body:`onDebug`},{label:`onDebugInitialConfigurations`,description:C(13153,`An activation event emitted whenever a "launch.json" needs to be created (and all provideDebugConfigurations methods need to be called).`),body:`onDebugInitialConfigurations`},{label:`onDebugDynamicConfigurations`,description:C(13154,`An activation event emitted whenever a list of all debug configurations needs to be created (and all provideDebugConfigurations methods for the "dynamic" scope need to be called).`),body:`onDebugDynamicConfigurations`},{label:`onDebugResolve`,description:C(13155,`An activation event emitted whenever a debug session with the specific type is about to be launched (and a corresponding resolveDebugConfiguration method needs to be called).`),body:"onDebugResolve:${6:type}"},{label:`onDebugAdapterProtocolTracker`,description:C(13156,`An activation event emitted whenever a debug session with the specific type is about to be launched and a debug protocol tracker might be needed.`),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:`workspaceContains`,description:C(13157,`An activation event emitted whenever a folder is opened that contains at least a file matching the specified glob pattern.`),body:"workspaceContains:${4:filePattern}"},{label:`onStartupFinished`,description:C(13158,"An activation event emitted after the start-up finished (after all `*` activated extensions have finished activating)."),body:`onStartupFinished`},{label:`onTaskType`,description:C(13159,`An activation event emitted whenever tasks of a certain type need to be listed or resolved.`),body:"onTaskType:${1:taskType}"},{label:`onFileSystem`,description:C(13160,`An activation event emitted whenever a file or folder is accessed with the given scheme.`),body:"onFileSystem:${1:scheme}"},{label:`onEditSession`,description:C(13161,`An activation event emitted whenever an edit session is accessed with the given scheme.`),body:"onEditSession:${1:scheme}"},{label:`onSearch`,description:C(13162,`An activation event emitted whenever a search is started in the folder with the given scheme.`),body:"onSearch:${7:scheme}"},{label:`onView`,body:"onView:${5:viewId}",description:C(13163,`An activation event emitted whenever the specified view is expanded.`)},{label:`onUri`,body:`onUri`,description:C(13164,`An activation event emitted whenever a system-wide Uri directed towards this extension is open.`)},{label:`onOpenExternalUri`,body:`onOpenExternalUri`,description:C(13165,`An activation event emitted whenever a external uri (such as an http or https link) is being opened.`)},{label:`onCustomEditor`,body:"onCustomEditor:${9:viewType}",description:C(13166,`An activation event emitted whenever the specified custom editor becomes visible.`)},{label:`onNotebook`,body:"onNotebook:${1:type}",description:C(13167,`An activation event emitted whenever the specified notebook document is opened.`)},{label:`onAuthenticationRequest`,body:"onAuthenticationRequest:${11:authenticationProviderId}",description:C(13168,`An activation event emitted whenever sessions are requested from the specified authentication provider.`)},{label:`onRenderer`,description:C(13169,`An activation event emitted whenever a notebook output renderer is used.`),body:"onRenderer:${11:rendererId}"},{label:`onTerminalProfile`,body:"onTerminalProfile:${1:terminalId}",description:C(13170,`An activation event emitted when a specific terminal profile is launched.`)},{label:`onTerminalQuickFixRequest`,body:"onTerminalQuickFixRequest:${1:quickFixId}",description:C(13171,`An activation event emitted when a command matches the selector associated with this ID`)},{label:`onWalkthrough`,body:"onWalkthrough:${1:walkthroughID}",description:C(13172,`An activation event emitted when a specified walkthrough is opened.`)},{label:`onIssueReporterOpened`,body:`onIssueReporterOpened`,description:C(13173,`An activation event emitted when the issue reporter is opened.`)},{label:`onChatParticipant`,body:"onChatParticipant:${1:participantId}",description:C(13174,`An activation event emitted when the specified chat participant is invoked.`)},{label:`onLanguageModelTool`,body:"onLanguageModelTool:${1:toolId}",description:C(13175,`An activation event emitted when the specified language model tool is invoked.`)},{label:`onTerminal`,body:`onTerminal:{1:shellType}`,description:C(13176,`An activation event emitted when a terminal of the given shell type is opened.`)},{label:`onTerminalCompletionsRequested`,body:`onTerminalCompletionsRequested`,description:C(13177,`An activation event emitted when terminal completions are requested.`)},{label:`onTerminalShellIntegration`,body:"onTerminalShellIntegration:${1:shellType}",description:C(13178,`An activation event emitted when terminal shell integration is activated for the given shell type.`)},{label:`onMcpCollection`,description:C(13179,`An activation event emitted whenver a tool from the MCP server is requested.`),body:"onMcpCollection:${2:collectionId}"},{label:`*`,description:C(13180,`An activation event emitted on VS Code startup. To ensure a great end user experience, please use this activation event in your extension only when no other activation events combination works in your use-case.`),body:`*`}]}},badges:{type:`array`,description:C(13181,`Array of badges to display in the sidebar of the Marketplace's extension page.`),items:{type:`object`,required:[`url`,`href`,`description`],properties:{url:{type:`string`,description:C(13182,`Badge image URL.`)},href:{type:`string`,description:C(13183,`Badge link.`)},description:{type:`string`,description:C(13184,`Badge description.`)}}}},markdown:{type:`string`,description:C(13185,`Controls the Markdown rendering engine used in the Marketplace. Either github (default) or standard.`),enum:[`github`,`standard`],default:`github`},qna:{default:`marketplace`,description:C(13186,`Controls the Q&A link in the Marketplace. Set to marketplace to enable the default Marketplace Q & A site. Set to a string to provide the URL of a custom Q & A site. Set to false to disable Q & A altogether.`),anyOf:[{type:[`string`,`boolean`],enum:[`marketplace`,!1]},{type:`string`}]},extensionDependencies:{description:C(13187,"Dependencies to other extensions. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:`array`,uniqueItems:!0,items:{type:`string`,pattern:gg}},extensionPack:{description:C(13188,"A set of extensions that can be installed together. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:`array`,uniqueItems:!0,items:{type:`string`,pattern:gg}},extensionKind:{description:C(13189,"Define the kind of an extension. `ui` extensions are installed and run on the local machine while `workspace` extensions run on the remote."),type:`array`,items:Xg,default:[`workspace`],defaultSnippets:[{body:[`ui`],description:C(13190,`Define an extension which can run only on the local machine when connected to remote window.`)},{body:[`workspace`],description:C(13191,`Define an extension which can run only on the remote machine when connected remote window.`)},{body:[`ui`,`workspace`],description:C(13192,`Define an extension which can run on either side, with a preference towards running on the local machine.`)},{body:[`workspace`,`ui`],description:C(13193,`Define an extension which can run on either side, with a preference towards running on the remote machine.`)},{body:[],description:C(13194,`Define an extension which cannot run in a remote context, neither on the local, nor on the remote machine.`)}]},capabilities:{description:C(13195,`Declare the set of supported capabilities by the extension.`),type:`object`,properties:{virtualWorkspaces:{description:C(13196,`Declares whether the extension should be enabled in virtual workspaces. A virtual workspace is a workspace which is not backed by any on-disk resources. When false, this extension will be automatically disabled in virtual workspaces. Default is true.`),type:[`boolean`,`object`],defaultSnippets:[{label:`limited`,body:{supported:"${1:limited}",description:"${2}"}},{label:`false`,body:{supported:!1,description:"${2}"}}],default:(!0).valueOf,properties:{supported:{markdownDescription:C(13197,`Declares the level of support for virtual workspaces by the extension.`),type:[`string`,`boolean`],enum:[`limited`,!0,!1],enumDescriptions:[C(13198,`The extension will be enabled in virtual workspaces with some functionality disabled.`),C(13199,`The extension will be enabled in virtual workspaces with all functionality enabled.`),C(13200,`The extension will not be enabled in virtual workspaces.`)]},description:{type:`string`,markdownDescription:C(13201,"A description of how virtual workspaces affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}},untrustedWorkspaces:{description:C(13202,`Declares how the extension should be handled in untrusted workspaces.`),type:`object`,required:[`supported`],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:C(13203,`Declares the level of support for untrusted workspaces by the extension.`),type:[`string`,`boolean`],enum:[`limited`,!0,!1],enumDescriptions:[C(13204,`The extension will be enabled in untrusted workspaces with some functionality disabled.`),C(13205,`The extension will be enabled in untrusted workspaces with all functionality enabled.`),C(13206,`The extension will not be enabled in untrusted workspaces.`)]},restrictedConfigurations:{description:C(13207,`A list of configuration keys contributed by the extension that should not use workspace values in untrusted workspaces.`),type:`array`,items:{type:`string`}},description:{type:`string`,markdownDescription:C(13208,"A description of how workspace trust affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}}}},sponsor:{description:C(13209,`Specify the location from where users can sponsor your extension.`),type:`object`,defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{url:{description:C(13210,`URL from where users can sponsor your extension. It must be a valid URL with a HTTP or HTTPS protocol. Example value: https://github.com/sponsors/nvaccess`),type:`string`}}},scripts:{type:`object`,properties:{"vscode:prepublish":{description:C(13211,`Script executed before the package is published as a VS Code extension.`),type:`string`},"vscode:uninstall":{description:C(13212,`Uninstall hook for VS Code extension. Script that gets executed when the extension is completely uninstalled from VS Code which is when VS Code is restarted (shutdown and start) after the extension is uninstalled. Only Node scripts are supported.`),type:`string`}}},icon:{type:`string`,description:C(13213,`The path to a 128x128 pixel icon.`)},l10n:{type:`string`,description:C(13214,`The relative path to a folder containing localization (bundle.l10n.*.json) files. Must be specified if you are using the vscode.l10n API.`)},pricing:{type:`string`,markdownDescription:C(13215,`The pricing information for the extension. Can be Free (default) or Trial. For more details visit: https://code.visualstudio.com/api/working-with-extensions/publishing-extension#extension-pricing-label`),enum:[`Free`,`Trial`],default:`Free`}}};var $g=class{constructor(){this._extensionPoints=new Map}registerExtensionPoint(e){if(this._extensionPoints.has(e.extensionPoint))throw Error(`Duplicate extension point: `+e.extensionPoint);let t=new Yg(e.extensionPoint,e.defaultExtensionKind,e.canHandleResolver);return this._extensionPoints.set(e.extensionPoint,t),e.activationEventsGenerator&&Rg.register(e.extensionPoint,e.activationEventsGenerator),Qg.properties.contributes.properties[e.extensionPoint]=e.jsonSchema,qg.registerSchema(Zg,Qg),t}getExtensionPoints(){return Array.from(this._extensionPoints.values())}};const e_={ExtensionsRegistry:`ExtensionsRegistry`};Sm.add(e_.ExtensionsRegistry,new $g);const t_=Sm.as(e_.ExtensionsRegistry);qg.registerSchema(Zg,Qg),qg.registerSchema(`vscode://schemas/vscode-product`,{properties:{extensionEnabledApiProposals:{description:C(13216,`API proposals that the respective extensions can freely use.`),type:`object`,properties:{},additionalProperties:{anyOf:[{type:`array`,uniqueItems:!0,items:{type:`string`,enum:Object.keys(Kg),markdownEnumDescriptions:Object.values(Kg).map(e=>e.proposal)}}]}}}}),new I(`isMac`,Zn,C(1757,`Whether the operating system is macOS`)),new I(`isLinux`,Qn,C(1758,`Whether the operating system is Linux`)),new I(`isWindows`,Xn,C(1759,`Whether the operating system is Windows`));const n_=new I(`isWeb`,er,C(1760,`Whether the platform is a web browser`));new I(`isMacNative`,Zn&&!er,C(1761,`Whether the operating system is macOS on a non-browser platform`)),new I(`isIOS`,rr,C(1762,`Whether the operating system is iOS`)),new I(`isMobile`,ir,C(1763,`Whether the platform is a mobile web browser`)),new I(`isDevelopment`,!1,!0),new I(`productQualityType`,``,C(1764,`Quality type of VS Code`)),new I(`inputFocus`,!1,C(1765,`Whether keyboard focus is inside an input box`));const r_=k(`languageService`),i_=k(`modelService`);var a_=class extends Hm{constructor(){super(...arguments),this._onDidChangeDirty=this._register(new x),this._onDidChangeLabel=this._register(new x),this._onDidChangeCapabilities=this._register(new x),this._onWillDispose=this._register(new x),this.onDidChangeDirty=this._onDidChangeDirty.event,this.onDidChangeLabel=this._onDidChangeLabel.event,this.onDidChangeCapabilities=this._onDidChangeCapabilities.event,this.onWillDispose=this._onWillDispose.event}get editorId(){}get capabilities(){return Vm.Readonly}hasCapability(e){return e===Vm.None?this.capabilities===Vm.None:(this.capabilities&e)!==0}isReadonly(){return this.hasCapability(Vm.Readonly)}getName(){return`Editor ${this.typeId}`}getDescription(e){}getTitle(e){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(Rm.SHORT)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(e,t){return this}async saveAs(e,t){return this}async revert(e,t){}async rename(e,t){}copy(){return this}canMove(e,t){return!0}matches(e){if(Um(e))return this===e;let t=e.options?.override;return this.editorId!==t&&t!==void 0&&this.editorId!==void 0?!1:Ja(this.resource,Qm.getCanonicalUri(e))}prefersEditorPane(e){return e.at(0)}toUntyped(e){}isDisposed(){return this._store.isDisposed}dispose(){this.isDisposed()||this._onWillDispose.fire(),super.dispose()}};const o_=k(`editorService`);var s_;let c_=class extends a_{static{s_=this}static{this.ID=`workbench.editorinputs.sidebysideEditorInput`}get typeId(){return s_.ID}get capabilities(){let e=this.primary.capabilities;return e&=~Vm.CanSplitInGroup,this.secondary.hasCapability(Vm.RequiresTrust)&&(e|=Vm.RequiresTrust),this.secondary.hasCapability(Vm.Singleton)&&(e|=Vm.Singleton),e|=Vm.MultipleEditors,e}get resource(){if(this.hasIdenticalSides)return this.primary.resource}constructor(e,t,n,r,i){super(),this.preferredName=e,this.preferredDescription=t,this.secondary=n,this.primary=r,this.editorService=i,this.hasIdenticalSides=this.primary.matches(this.secondary),this.registerListeners()}registerListeners(){this._register(en.once(en.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this._register(this.primary.onDidChangeDirty(()=>this._onDidChangeDirty.fire())),this._register(this.primary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.secondary.onDidChangeCapabilities(()=>this._onDidChangeCapabilities.fire())),this._register(this.primary.onDidChangeLabel(()=>this._onDidChangeLabel.fire())),this._register(this.secondary.onDidChangeLabel(()=>this._onDidChangeLabel.fire()))}getName(){let e=this.getPreferredName();return e||(this.hasIdenticalSides?this.primary.getName():C(3943,`{0} - {1}`,this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.preferredName}getDescription(e){let t=this.getPreferredDescription();return t||(this.hasIdenticalSides?this.primary.getDescription(e):super.getDescription(e))}getPreferredDescription(){return this.preferredDescription}getTitle(e){let t;t=this.hasIdenticalSides?this.primary.getTitle(e)??this.getName():super.getTitle(e);let n=this.getPreferredTitle();return n&&(t=`${n} (${t})`),t}getPreferredTitle(){if(this.preferredName&&this.preferredDescription)return`${this.preferredName} ${this.preferredDescription}`;if(this.preferredName||this.preferredDescription)return this.preferredName??this.preferredDescription}getLabelExtraClasses(){return this.hasIdenticalSides?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.hasIdenticalSides?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){let e=this.primary.getTelemetryDescriptor();return{...e,...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(e,t){let n=await this.primary.save(e,t);return this.saveResultToEditor(n)}async saveAs(e,t){let n=await this.primary.saveAs(e,t);return this.saveResultToEditor(n)}saveResultToEditor(e){if(!e||!this.hasIdenticalSides)return e;if(this.primary.matches(e))return this;if(e instanceof a_)return new s_(this.preferredName,this.preferredDescription,e,e,this.editorService);if(!Pm(e)&&!Fm(e)&&!Im(e)&&!Lm(e))return{primary:e,secondary:e,label:this.preferredName,description:this.preferredDescription}}revert(e,t){return this.primary.revert(e,t)}async rename(e,t){if(!this.hasIdenticalSides)return;let n=await this.primary.rename(e,t);if(n){if(Um(n.editor))return{editor:new s_(this.preferredName,this.preferredDescription,n.editor,n.editor,this.editorService),options:{...n.options,viewState:Mm(this,e,this.editorService)}};if(Nm(n.editor))return{editor:{label:this.preferredName,description:this.preferredDescription,primary:n.editor,secondary:n.editor,options:{...n.options,viewState:Mm(this,e,this.editorService)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(e){let t=this.primary.toUntyped(e),n=this.secondary.toUntyped(e);if(t&&n&&!Pm(t)&&!Pm(n)&&!Fm(t)&&!Fm(n)&&!Im(t)&&!Im(n)&&!Lm(t)&&!Lm(n)){let r={label:this.preferredName,description:this.preferredDescription,primary:t,secondary:n};return typeof e?.preserveViewState==`number`&&(r.options={viewState:Mm(this,e.preserveViewState,this.editorService)}),r}}matches(e){return this===e?!0:Km(e)||Pm(e)?!1:e instanceof s_||Im(e)?this.primary.matches(e.primary)&&this.secondary.matches(e.secondary):!1}};c_=s_=A([j(4,o_)],c_);var l_=class extends y{constructor(){super(...arguments),this._onWillDispose=this._register(new x),this.onWillDispose=this._onWillDispose.event,this.resolved=!1}async resolve(){this.resolved=!0}isResolved(){return this.resolved}isDisposed(){return this._store.isDisposed}dispose(){this._onWillDispose.fire(),super.dispose()}};const u_={ModesRegistry:`editor.modesRegistry`};var d_=class extends y{constructor(){super(),this._onDidChangeLanguages=this._register(new x),this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,n=this._languages.length;t<n;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}};const f_=new d_;Sm.add(u_.ModesRegistry,f_);const p_=`plaintext`;f_.registerLanguage({id:p_,extensions:[`.txt`],aliases:[C(842,`Plain Text`),`text`],mimetypes:[Ku.text]}),Sm.as(Xh.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1},"[go]":{"editor.insertSpaces":!1},"[makefile]":{"editor.insertSpaces":!1},"[shellscript]":{"files.eol":`
`},"[yaml]":{"editor.insertSpaces":!0,"editor.tabSize":2}}}]);const m_=`languageDetection`,h_=k(`ILanguageDetectionService`),g_=k(`accessibilityService`);var __;let v_=class extends l_{static{__=this}static{this.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY=600}constructor(e,t,n,r,i){super(),this.modelService=e,this.languageService=t,this.languageDetectionService=n,this.accessibilityService=r,this.textEditorModelHandle=void 0,this.modelDisposeListener=this._register(new xt),this.autoDetectLanguageThrottler=this._register(new yo(__.AUTO_DETECT_LANGUAGE_THROTTLE_DELAY)),this._blockLanguageChangeListener=!1,this._languageChangeSource=void 0,i&&this.handleExistingModel(i)}handleExistingModel(e){let t=this.modelService.getModel(e);if(!t)throw Error(`Document with resource ${e.toString(!0)} does not exist`);this.textEditorModelHandle=e,this.registerModelDisposeListener(t)}registerModelDisposeListener(e){this.modelDisposeListener.value=e.onWillDispose(()=>{this.textEditorModelHandle=void 0,this.dispose()})}get textEditorModel(){return this.textEditorModelHandle?this.modelService.getModel(this.textEditorModelHandle):null}isReadonly(){return!0}get languageChangeSource(){return this._languageChangeSource}get hasLanguageSetExplicitly(){return typeof this._languageChangeSource==`string`}setLanguageId(e,t){this._languageChangeSource=`user`,this.setLanguageIdInternal(e,t)}setLanguageIdInternal(e,t){if(this.isResolved()&&!(!e||e===this.textEditorModel.getLanguageId())){this._blockLanguageChangeListener=!0;try{this.textEditorModel.setLanguage(this.languageService.createById(e),t)}finally{this._blockLanguageChangeListener=!1}}}installModelListeners(e){let t=this._register(e.onDidChangeLanguage(e=>{e.source===m_||this._blockLanguageChangeListener||(this._languageChangeSource=`api`,t.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}autoDetectLanguage(){return this.autoDetectLanguageThrottler.trigger(()=>this.doAutoDetectLanguage())}async doAutoDetectLanguage(){if(this.hasLanguageSetExplicitly||!this.textEditorModelHandle||!this.languageDetectionService.isEnabledForLanguage(this.getLanguageId()??p_))return;let e=await this.languageDetectionService.detectLanguage(this.textEditorModelHandle),t=this.getLanguageId();if(e&&e!==t&&!this.isDisposed()){this.setLanguageIdInternal(e,m_);let t=this.languageService.getLanguageName(e);this.accessibilityService.alert(C(3944,`Language {0} was automatically detected and set as the language mode.`,t??e))}}createTextEditorModel(e,t,n){let r=this.getFirstLineText(e),i=this.getOrCreateLanguage(t,this.languageService,n,r);return this.doCreateTextEditorModel(e,i,t)}doCreateTextEditorModel(e,t,n){let r=n&&this.modelService.getModel(n);return r?this.updateTextEditorModel(e,t.languageId):(r=this.modelService.createModel(e,t,n),this.createdEditorModel=!0,this.registerModelDisposeListener(r)),this.textEditorModelHandle=r.uri,r}getFirstLineText(e){let t=e;if(typeof t.getFirstLineText==`function`)return t.getFirstLineText(dm.FIRST_LINE_DETECTION_LENGTH_LIMIT);let n=e;return n.getLineContent(1).substr(0,dm.FIRST_LINE_DETECTION_LENGTH_LIMIT)}getOrCreateLanguage(e,t,n,r){return!n||n===p_?t.createByFilepathOrFirstLine(e??null,r):t.createById(n)}updateTextEditorModel(e,t,n){this.isResolved()&&(e&&this.modelService.updateModel(this.textEditorModel,e,n),t&&t!==p_&&this.textEditorModel.getLanguageId()!==t&&this.textEditorModel.setLanguage(this.languageService.createById(t)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.textEditorModelHandle}dispose(){this.modelDisposeListener.dispose(),this.textEditorModelHandle&&this.createdEditorModel&&this.modelService.destroyModel(this.textEditorModelHandle),this.textEditorModelHandle=void 0,this.createdEditorModel=!1,super.dispose()}};v_=__=A([j(0,i_),j(1,r_),j(2,h_),j(3,g_)],v_);var y_=class extends l_{get originalModel(){return this._originalModel}get modifiedModel(){return this._modifiedModel}constructor(e,t){super(),this._originalModel=e,this._modifiedModel=t}async resolve(){await Promise.all([this._originalModel?.resolve(),this._modifiedModel?.resolve()])}isResolved(){return!!(this._originalModel?.isResolved()&&this._modifiedModel?.isResolved())}dispose(){super.dispose()}},b_=class extends y_{get originalModel(){return this._originalModel}get modifiedModel(){return this._modifiedModel}get textDiffEditorModel(){return this._textDiffEditorModel}constructor(e,t){super(e,t),this._textDiffEditorModel=void 0,this._originalModel=e,this._modifiedModel=t,this.updateTextDiffEditorModel()}async resolve(){await super.resolve(),this.updateTextDiffEditorModel()}updateTextDiffEditorModel(){this.originalModel?.isResolved()&&this.modifiedModel?.isResolved()&&(this._textDiffEditorModel?(this._textDiffEditorModel.original=this.originalModel.textEditorModel,this._textDiffEditorModel.modified=this.modifiedModel.textEditorModel):this._textDiffEditorModel={original:this.originalModel.textEditorModel,modified:this.modifiedModel.textEditorModel})}isResolved(){return!!this._textDiffEditorModel}isReadonly(){return!!this.modifiedModel&&this.modifiedModel.isReadonly()}dispose(){this._textDiffEditorModel=void 0,super.dispose()}};function x_(e,t=Xn){return Fa(e,t)?e.charAt(0).toUpperCase()+e.slice(1):e}function S_(e,t){return e.replace(/^~($|\/|\\)/,`${t}$1`)}function C_(e,t=Kr){let n=Array(e.length),r=!1;for(let i=0;i<e.length;i++){let a=e[i];if(a===``){n[i]=`.${t}`;continue}if(!a){n[i]=a;continue}r=!0;let o=``,s=a;s.indexOf(`\\\\`)===0?(o=s.substr(0,s.indexOf(`\\\\`)+2),s=s.substr(s.indexOf(`\\\\`)+2)):s.indexOf(t)===0?(o=s.substr(0,s.indexOf(t)+t.length),s=s.substr(s.indexOf(t)+t.length)):s.indexOf(`~`)===0&&(o=s.substr(0,s.indexOf(`~`)+1),s=s.substr(s.indexOf(`~`)+1));let c=s.split(t);for(let a=1;r&&a<=c.length;a++)for(let s=c.length-a;r&&s>=0;s--){r=!1;let l=c.slice(s,s+a).join(t);for(let n=0;!r&&n<e.length;n++)if(n!==i&&e[n]&&e[n].indexOf(l)>-1){let i=s+a===c.length,o=s>0&&e[n].indexOf(t)>-1?t+l:l,u=e[n].endsWith(o);r=!i||u}if(!r){let e=``;(c[0].endsWith(`:`)||o!==``)&&(s===1&&(s=0,a++,l=c[0]+t+l),s>0&&(e=c[0]+t),e=o+e),s>0&&(e=e+`…`+t),e+=l,s+a<c.length&&(e=e+t+`…`),n[i]=e}}r&&(n[i]=a)}return n}var w_;(function(e){e[e.TEXT=0]=`TEXT`,e[e.VARIABLE=1]=`VARIABLE`,e[e.SEPARATOR=2]=`SEPARATOR`})(w_||={});function T_(e){let t=e;return typeof t?.resolve==`function`&&typeof t?.isResolved==`function`}var E_;(function(e){e[e.ACTIVATE=1]=`ACTIVATE`,e[e.RESTORE=2]=`RESTORE`,e[e.PRESERVE=3]=`PRESERVE`})(E_||={});var D_;(function(e){e[e.PICK=0]=`PICK`,e[e.EXCLUSIVE_ONLY=1]=`EXCLUSIVE_ONLY`})(D_||={});var O_;(function(e){e[e.API=0]=`API`,e[e.USER=1]=`USER`})(O_||={});var k_;(function(e){e[e.Center=0]=`Center`,e[e.CenterIfOutsideViewport=1]=`CenterIfOutsideViewport`,e[e.NearTop=2]=`NearTop`,e[e.NearTopIfOutsideViewport=3]=`NearTopIfOutsideViewport`})(k_||={});var A_;(function(e){e.PROGRAMMATIC=`api`,e.NAVIGATION=`code.navigation`,e.JUMP=`code.jump`})(A_||={});var j_;let M_=class extends c_{static{j_=this}static{this.ID=`workbench.editors.diffEditorInput`}get typeId(){return j_.ID}get editorId(){return this.modified.editorId===this.original.editorId?this.modified.editorId:void 0}get capabilities(){let e=super.capabilities;return this.labels.forceDescription&&(e|=Vm.ForceDescription),e}constructor(e,t,n,r,i,a){super(e,t,n,r,a),this.original=n,this.modified=r,this.forceOpenAsBinary=i,this.cachedModel=void 0,this.labels=this.computeLabels()}computeLabels(){let e,t=!1;if(this.preferredName)e=this.preferredName;else{let n=this.original.getName(),r=this.modified.getName();e=C(3942,`{0} ↔ {1}`,n,r),t=n===r}let n,r,i;if(this.preferredDescription)n=this.preferredDescription,r=this.preferredDescription,i=this.preferredDescription;else{n=this.computeLabel(this.original.getDescription(Rm.SHORT),this.modified.getDescription(Rm.SHORT)),i=this.computeLabel(this.original.getDescription(Rm.LONG),this.modified.getDescription(Rm.LONG));let e=this.original.getDescription(Rm.MEDIUM),t=this.modified.getDescription(Rm.MEDIUM);if(typeof e==`string`&&typeof t==`string`&&(e||t)){let[n,i]=C_([e,t]);r=this.computeLabel(n,i)}}let a=this.computeLabel(this.original.getTitle(Rm.SHORT)??this.original.getName(),this.modified.getTitle(Rm.SHORT)??this.modified.getName(),` ↔ `),o=this.computeLabel(this.original.getTitle(Rm.MEDIUM)??this.original.getName(),this.modified.getTitle(Rm.MEDIUM)??this.modified.getName(),` ↔ `),s=this.computeLabel(this.original.getTitle(Rm.LONG)??this.original.getName(),this.modified.getTitle(Rm.LONG)??this.modified.getName(),` ↔ `),c=this.getPreferredTitle();return c&&(a=`${c} (${a})`,o=`${c} (${o})`,s=`${c} (${s})`),{name:e,shortDescription:n,mediumDescription:r,longDescription:i,forceDescription:t,shortTitle:a,mediumTitle:o,longTitle:s}}computeLabel(e,t,n=` - `){if(!(!e||!t))return e===t?t:`${e}${n}${t}`}getName(){return this.labels.name}getDescription(e=Rm.MEDIUM){switch(e){case Rm.SHORT:return this.labels.shortDescription;case Rm.LONG:return this.labels.longDescription;case Rm.MEDIUM:default:return this.labels.mediumDescription}}getTitle(e){switch(e){case Rm.SHORT:return this.labels.shortTitle;case Rm.LONG:return this.labels.longTitle;default:case Rm.MEDIUM:return this.labels.mediumTitle}}async resolve(){let e=await this.createModel();return this.cachedModel?.dispose(),this.cachedModel=e,this.cachedModel}prefersEditorPane(e){return this.forceOpenAsBinary?e.find(e=>e.typeId===`workbench.editors.binaryResourceDiffEditor`):e.find(e=>e.typeId===`workbench.editors.textDiffEditor`)}async createModel(){let[e,t]=await Promise.all([this.original.resolve(),this.modified.resolve()]);return t instanceof v_&&e instanceof v_?new b_(e,t):new y_(T_(e)?e:void 0,T_(t)?t:void 0)}toUntyped(e){let t=super.toUntyped(e);if(t)return{...t,modified:t.primary,original:t.secondary}}matches(e){return this===e?!0:e instanceof j_?this.modified.matches(e.modified)&&this.original.matches(e.original)&&e.forceOpenAsBinary===this.forceOpenAsBinary:Pm(e)?this.modified.matches(e.modified)&&this.original.matches(e.original):!1}dispose(){this.cachedModel&&=(this.cachedModel.dispose(),void 0),super.dispose()}};M_=j_=A([j(5,o_)],M_);var N_;new I(`workbenchState`,void 0,{type:`string`,description:C(3866,`The kind of workspace opened in the window, either 'empty' (no workspace), 'folder' (single folder) or 'workspace' (multi-root workspace)`)}),new I(`workspaceFolderCount`,0,C(3867,`The number of root folders in the workspace`)),new I(`openFolderWorkspaceSupport`,!0,!0),new I(`enterMultiRootWorkspaceSupport`,!0,!0),new I(`emptyWorkspaceSupport`,!0,!0),new I(`dirtyWorkingCopies`,!1,C(3868,`Whether there are any working copies with unsaved changes`));const P_=new I(`remoteName`,``,C(3869,`The name of the remote the window is connected to or an empty string if not connected to any remote`));new I(`virtualWorkspace`,``,C(3870,`The scheme of the current workspace is from a virtual file system or an empty string.`)),new I(`temporaryWorkspace`,!1,C(3871,`The scheme of the current workspace is from a temporary file system.`)),new I(`hasWebFileSystemAccess`,!1,!0),new I(`embedderIdentifier`,void 0,C(3872,`The identifier of the embedder according to the product service, if one is defined`)),new I(`isSandboxWorkspace`,!1,!0),new I(`isFullscreen`,!1,C(3873,`Whether the main window is in fullscreen mode`)),new I(`isAuxiliaryWindowFocusedContext`,!1,C(3874,`Whether an auxiliary window is focused`)),new I(`isAuxiliaryWindow`,!1,C(3875,`Window is an auxiliary window`)),new I(`activeEditorIsDirty`,!1,C(3876,`Whether the active editor has unsaved changes`)),new I(`activeEditorIsNotPreview`,!1,C(3877,`Whether the active editor is not in preview mode`)),new I(`activeEditorIsFirstInGroup`,!1,C(3878,`Whether the active editor is the first one in its group`)),new I(`activeEditorIsLastInGroup`,!1,C(3879,`Whether the active editor is the last one in its group`)),new I(`activeEditorIsPinned`,!1,C(3880,`Whether the active editor is pinned`)),new I(`activeEditorIsReadonly`,!1,C(3881,`Whether the active editor is read-only`)),new I(`activeCompareEditorCanSwap`,!1,C(3882,`Whether the active compare editor can swap sides`)),new I(`activeEditorCanToggleReadonly`,!0,C(3883,`Whether the active editor can toggle between being read-only or writeable`)),new I(`activeEditorCanRevert`,!1,C(3884,`Whether the active editor can revert`)),new I(`activeEditorCanSplitInGroup`,!0),new I(`activeEditor`,null,{type:`string`,description:C(3885,`The identifier of the active editor`)}),new I(`activeEditorAvailableEditorIds`,``,C(3886,`The available editor identifiers that are usable for the active editor`)),new I(`textCompareEditorVisible`,!1,C(3887,`Whether a text compare editor is visible`)),new I(`textCompareEditorActive`,!1,C(3888,`Whether a text compare editor is active`)),new I(`sideBySideEditorActive`,!1,C(3889,`Whether a side by side editor is active`)),new I(`groupEditorsCount`,0,C(3890,`The number of opened editor groups`)),new I(`activeEditorGroupEmpty`,!1,C(3891,`Whether the active editor group is empty`)),new I(`activeEditorGroupIndex`,0,C(3892,`The index of the active editor group`)),new I(`activeEditorGroupLast`,!1,C(3893,`Whether the active editor group is the last group`)),new I(`activeEditorGroupLocked`,!1,C(3894,`Whether the active editor group is locked`)),new I(`multipleEditorGroups`,!1,C(3895,`Whether there are multiple editor groups opened`)),new I(`multipleEditorsSelectedInGroup`,!1,C(3896,`Whether multiple editors have been selected in an editor group`)),new I(`twoEditorsSelectedInGroup`,!1,C(3897,`Whether exactly two editors have been selected in an editor group`)),new I(`SelectedEditorsInGroupFileOrUntitledResourceContextKey`,!0,C(3898,`Whether all selected editors in a group have a file or untitled resource associated`)),new I(`editorPartMultipleEditorGroups`,!1,C(3899,`Whether there are multiple editor groups opened in an editor part`)),new I(`editorPartMaximizedEditorGroup`,!1,C(3900,`Editor Part has a maximized group`)),new I(`editorIsOpen`,!1,C(3901,`Whether an editor is open`)),new I(`inZenMode`,!1,C(3902,`Whether Zen mode is enabled`)),new I(`isCenteredLayout`,!1,C(3903,`Whether centered layout is enabled for the main editor`)),new I(`splitEditorsVertically`,!1,C(3904,`Whether editors split vertically`)),new I(`mainEditorAreaVisible`,!0,C(3905,`Whether the editor area in the main window is visible`)),new I(`editorTabsVisible`,!0,C(3906,`Whether editor tabs are visible`)),new I(`sideBarVisible`,!1,C(3907,`Whether the sidebar is visible`)),new I(`sideBarFocus`,!1,C(3908,`Whether the sidebar has keyboard focus`)),new I(`activeViewlet`,``,C(3909,`The identifier of the active viewlet`)),new I(`statusBarFocused`,!1,C(3910,`Whether the status bar has keyboard focus`)),new I(`titleBarStyle`,`custom`,C(3911,`Style of the window title bar`)),new I(`titleBarVisible`,!1,C(3912,`Whether the title bar is visible`)),new I(`isCompactTitleBar`,!1,C(3913,`Title bar is in compact mode`)),new I(`bannerFocused`,!1,C(3914,`Whether the banner has keyboard focus`)),new I(`notificationFocus`,!0,C(3915,`Whether a notification has keyboard focus`)),new I(`notificationCenterVisible`,!1,C(3916,`Whether the notifications center is visible`)),new I(`notificationToastsVisible`,!1,C(3917,`Whether a notification toast is visible`)),new I(`activeAuxiliary`,``,C(3918,`The identifier of the active auxiliary panel`)),new I(`auxiliaryBarFocus`,!1,C(3919,`Whether the auxiliary bar has keyboard focus`)),new I(`auxiliaryBarVisible`,!1,C(3920,`Whether the auxiliary bar is visible`)),new I(`auxiliaryBarMaximized`,!1,C(3921,`Whether the auxiliary bar is maximized`)),new I(`activePanel`,``,C(3922,`The identifier of the active panel`)),new I(`panelFocus`,!1,C(3923,`Whether the panel has keyboard focus`)),new I(`panelPosition`,`bottom`,C(3924,`The position of the panel, always 'bottom'`)),new I(`panelAlignment`,`center`,C(3925,`The alignment of the panel, either 'center', 'left', 'right' or 'justify'`)),new I(`panelVisible`,!1,C(3926,`Whether the panel is visible`)),new I(`panelMaximized`,!1,C(3927,`Whether the panel is maximized`)),new I(`focusedView`,``,C(3928,`The identifier of the view that has keyboard focus`));let F_=class{static{N_=this}static{this.Scheme=new I(`resourceScheme`,void 0,{type:`string`,description:C(3929,`The scheme of the resource`)})}static{this.Filename=new I(`resourceFilename`,void 0,{type:`string`,description:C(3930,`The file name of the resource`)})}static{this.Dirname=new I(`resourceDirname`,void 0,{type:`string`,description:C(3931,`The folder name the resource is contained in`)})}static{this.Path=new I(`resourcePath`,void 0,{type:`string`,description:C(3932,`The full path of the resource`)})}static{this.LangId=new I(`resourceLangId`,void 0,{type:`string`,description:C(3933,`The language identifier of the resource`)})}static{this.Resource=new I(`resource`,void 0,{type:`URI`,description:C(3934,`The full value of the resource including scheme and path`)})}static{this.Extension=new I(`resourceExtname`,void 0,{type:`string`,description:C(3935,`The extension name of the resource`)})}static{this.HasResource=new I(`resourceSet`,void 0,{type:`boolean`,description:C(3936,`Whether a resource is present or not`)})}static{this.IsFileSystemResource=new I(`isFileSystemResource`,void 0,{type:`boolean`,description:C(3937,`Whether the resource is backed by a file system provider`)})}constructor(e,t,n,r){this._contextKeyService=e,this._fileService=t,this._languageService=n,this._modelService=r,this._disposables=new v,this._schemeKey=N_.Scheme.bindTo(this._contextKeyService),this._filenameKey=N_.Filename.bindTo(this._contextKeyService),this._dirnameKey=N_.Dirname.bindTo(this._contextKeyService),this._pathKey=N_.Path.bindTo(this._contextKeyService),this._langIdKey=N_.LangId.bindTo(this._contextKeyService),this._resourceKey=N_.Resource.bindTo(this._contextKeyService),this._extensionKey=N_.Extension.bindTo(this._contextKeyService),this._hasResource=N_.HasResource.bindTo(this._contextKeyService),this._isFileSystemResource=N_.IsFileSystemResource.bindTo(this._contextKeyService),this._disposables.add(t.onDidChangeFileSystemProviderRegistrations(()=>{let e=this.get();this._isFileSystemResource.set(!!(e&&t.hasProvider(e)))})),this._disposables.add(r.onModelAdded(e=>{Ja(e.uri,this.get())&&this._setLangId()})),this._disposables.add(r.onModelLanguageChanged(e=>{Ja(e.model.uri,this.get())&&this._setLangId()}))}dispose(){this._disposables.dispose()}_setLangId(){let e=this.get();if(!e){this._langIdKey.set(null);return}let t=this._modelService.getModel(e)?.getLanguageId()??this._languageService.guessLanguageIdByFilepathOrFirstLine(e);this._langIdKey.set(t)}set(e){e??=void 0,!Ja(this._value,e)&&(this._value=e,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.set(e?e.toString():null),this._schemeKey.set(e?e.scheme:null),this._filenameKey.set(e?Xa(e):null),this._dirnameKey.set(e?this.uriToPath(Qa(e)):null),this._pathKey.set(e?this.uriToPath(e):null),this._setLangId(),this._extensionKey.set(e?Za(e):null),this._hasResource.set(!!e),this._isFileSystemResource.set(e?this._fileService.hasProvider(e):!1)}))}uriToPath(e){return e.scheme===O.file?e.fsPath:e.path}reset(){this._value=void 0,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.reset(),this._schemeKey.reset(),this._filenameKey.reset(),this._dirnameKey.reset(),this._pathKey.reset(),this._langIdKey.reset(),this._extensionKey.reset(),this._hasResource.reset(),this._isFileSystemResource.reset()})}get(){return this._value}};F_=N_=A([j(0,sh),j(1,xh),j(2,r_),j(3,i_)],F_);var I_;(function(e){e.UseFileStorage=`chat.useFileStorage`,e.AgentEnabled=`chat.agent.enabled`,e.Edits2Enabled=`chat.edits2.enabled`,e.ExtensionToolsEnabled=`chat.extensionTools.enabled`,e.EditRequests=`chat.editRequests`,e.EnableMath=`chat.math.enabled`,e.CheckpointsEnabled=`chat.checkpoints.enabled`,e.AgentSessionsViewLocation=`chat.agentSessionsViewLocation`})(I_||={});var L_;(function(e){e.Ask=`ask`,e.Edit=`edit`,e.Agent=`agent`})(L_||={});var R_;(function(e){e.Panel=`panel`,e.Terminal=`terminal`,e.Notebook=`notebook`,e.Editor=`editor`})(R_||={}),(function(e){function t(t){switch(t){case`panel`:return e.Panel;case`terminal`:return e.Terminal;case`notebook`:return e.Notebook;case`editor`:return e.Editor}return e.Panel}e.fromRaw=t})(R_||={});var z_;(function(e){e.responseVote=new I(`chatSessionResponseVote`,``,{type:`string`,description:C(5354,`When the response has been voted up, is set to 'up'. When voted down, is set to 'down'. Otherwise an empty string.`)}),e.responseDetectedAgentCommand=new I(`chatSessionResponseDetectedAgentOrCommand`,!1,{type:`boolean`,description:C(5355,`When the agent or command was automatically detected`)}),e.responseSupportsIssueReporting=new I(`chatResponseSupportsIssueReporting`,!1,{type:`boolean`,description:C(5356,`True when the current chat response supports issue reporting.`)}),e.responseIsFiltered=new I(`chatSessionResponseFiltered`,!1,{type:`boolean`,description:C(5357,`True when the chat response was filtered out by the server.`)}),e.responseHasError=new I(`chatSessionResponseError`,!1,{type:`boolean`,description:C(5358,`True when the chat response resulted in an error.`)}),e.requestInProgress=new I(`chatSessionRequestInProgress`,!1,{type:`boolean`,description:C(5359,`True when the current request is still in progress.`)}),e.currentlyEditing=new I(`chatSessionCurrentlyEditing`,!1,{type:`boolean`,description:C(5360,`True when the current request is being edited.`)}),e.currentlyEditingInput=new I(`chatSessionCurrentlyEditingInput`,!1,{type:`boolean`,description:C(5361,`True when the current request input at the bottom is being edited.`)}),e.isRequestPaused=new I(`chatRequestIsPaused`,!1,{type:`boolean`,description:C(5362,`True when the current request is paused.`)}),e.canRequestBePaused=new I(`chatCanRequestBePaused`,!1,{type:`boolean`,description:C(5363,`True when the current request can be paused.`)}),e.isResponse=new I(`chatResponse`,!1,{type:`boolean`,description:C(5364,`The chat item is a response.`)}),e.isRequest=new I(`chatRequest`,!1,{type:`boolean`,description:C(5365,`The chat item is a request`)}),e.itemId=new I(`chatItemId`,``,{type:`string`,description:C(5366,`The id of the chat item.`)}),e.lastItemId=new I(`chatLastItemId`,[],{type:`string`,description:C(5367,`The id of the last chat item.`)}),e.editApplied=new I(`chatEditApplied`,!1,{type:`boolean`,description:C(5368,`True when the chat text edits have been applied.`)}),e.inputHasText=new I(`chatInputHasText`,!1,{type:`boolean`,description:C(5369,`True when the chat input has text.`)}),e.inputHasFocus=new I(`chatInputHasFocus`,!1,{type:`boolean`,description:C(5370,`True when the chat input has focus.`)}),e.inChatInput=new I(`inChatInput`,!1,{type:`boolean`,description:C(5371,`True when focus is in the chat input, false otherwise.`)}),e.inChatSession=new I(`inChat`,!1,{type:`boolean`,description:C(5372,`True when focus is in the chat widget, false otherwise.`)}),e.inChatEditor=new I(`inChatEditor`,!1,{type:`boolean`,description:C(5373,`Whether focus is in a chat editor.`)}),e.hasPromptFile=new I(`chatPromptFileAttached`,!1,{type:`boolean`,description:C(5374,`True when the chat has a prompt file attached.`)}),e.chatModeKind=new I(`chatMode`,L_.Ask,{type:`string`,description:C(5375,`The 'kind' of the current chat mode- Agent for custom modes.`)}),e.chatToolCount=new I(`chatToolCount`,0,{type:`number`,description:C(5376,`The number of tools available in the current chat mode.`)}),e.chatToolGroupingThreshold=new I(`chat.toolGroupingThreshold`,0,{type:`number`,description:C(5377,`The number of tools at which we start doing virtual grouping.`)}),e.supported=Td.or(n_.negate(),P_.notEqualsTo(``),Td.has(`config.chat.experimental.serverlessWebEnabled`)),e.enabled=new I(`chatIsEnabled`,!1,{type:`boolean`,description:C(5378,`True when chat is enabled because a default chat participant is activated with an implementation.`)}),e.lockedToCodingAgent=new I(`lockedToCodingAgent`,!1,{type:`boolean`,description:C(5379,`True when the chat widget is locked to the coding agent session.`)}),e.extensionParticipantRegistered=new I(`chatPanelExtensionParticipantRegistered`,!1,{type:`boolean`,description:C(5380,`True when a default chat participant is registered for the panel from an extension.`)}),e.panelParticipantRegistered=new I(`chatPanelParticipantRegistered`,!1,{type:`boolean`,description:C(5381,`True when a default chat participant is registered for the panel.`)}),e.chatEditingCanUndo=new I(`chatEditingCanUndo`,!1,{type:`boolean`,description:C(5382,`True when it is possible to undo an interaction in the editing panel.`)}),e.chatEditingCanRedo=new I(`chatEditingCanRedo`,!1,{type:`boolean`,description:C(5383,`True when it is possible to redo an interaction in the editing panel.`)}),e.languageModelsAreUserSelectable=new I(`chatModelsAreUserSelectable`,!1,{type:`boolean`,description:C(5384,`True when the chat model can be selected manually by the user.`)}),e.extensionInvalid=new I(`chatExtensionInvalid`,!1,{type:`boolean`,description:C(5385,`True when the installed chat extension is invalid and needs to be updated.`)}),e.inputCursorAtTop=new I(`chatCursorAtTop`,!1),e.inputHasAgent=new I(`chatInputHasAgent`,!1),e.location=new I(`chatLocation`,void 0),e.inQuickChat=new I(`quickChatHasFocus`,!1,{type:`boolean`,description:C(5386,`True when the quick chat UI has focus, false otherwise.`)}),e.hasFileAttachments=new I(`chatHasFileAttachments`,!1,{type:`boolean`,description:C(5387,`True when the chat has file attachments.`)}),e.remoteJobCreating=new I(`chatRemoteJobCreating`,!1,{type:`boolean`,description:C(5388,`True when a remote coding agent job is being created.`)}),e.hasRemoteCodingAgent=new I(`hasRemoteCodingAgent`,!1,C(5389,`Whether any remote coding agent is available`)),e.enableRemoteCodingAgentPromptFileOverlay=new I(`enableRemoteCodingAgentPromptFileOverlay`,!1,C(5390,`Whether the remote coding agent prompt file overlay feature is enabled`)),e.skipChatRequestInProgressMessage=new I(`chatSkipRequestInProgressMessage`,!1,{type:`boolean`,description:C(5391,`True when the chat request in progress message should be skipped.`)}),e.Setup={hidden:new I(`chatSetupHidden`,!1,!0),installed:new I(`chatSetupInstalled`,!1,!0),disabled:new I(`chatSetupDisabled`,!1,!0),untrusted:new I(`chatSetupUntrusted`,!1,!0),later:new I(`chatSetupLater`,!1,!0)},e.Entitlement={signedOut:new I(`chatEntitlementSignedOut`,!1,!0),canSignUp:new I(`chatPlanCanSignUp`,!1,!0),free:new I(`chatPlanFree`,!1,!0),pro:new I(`chatPlanPro`,!1,!0),proPlus:new I(`chatPlanProPlus`,!1,!0),business:new I(`chatPlanBusiness`,!1,!0),enterprise:new I(`chatPlanEnterprise`,!1,!0)},e.chatQuotaExceeded=new I(`chatQuotaExceeded`,!1,!0),e.completionsQuotaExceeded=new I(`completionsQuotaExceeded`,!1,!0),e.Editing={hasToolConfirmation:new I(`chatHasToolConfirmation`,!1,{type:`boolean`,description:C(5392,`True when a tool confirmation is present.`)})},e.Tools={toolsCount:new I(`toolsCount`,0,{type:`number`,description:C(5393,`The count of tools available in the chat.`)})},e.Modes={hasCustomChatModes:new I(`chatHasCustomChatModes`,!1,{type:`boolean`,description:C(5394,`True when the chat has custom chat modes available.`)})},e.panelLocation=new I(`chatPanelLocation`,void 0,{type:`number`,description:C(5395,`The location of the chat panel.`)})})(z_||={});var B_;(function(e){e.inEditingMode=Td.or(z_.chatModeKind.isEqualTo(L_.Edit),z_.chatModeKind.isEqualTo(L_.Agent))})(B_||={});var V_;(function(e){e[e.System=0]=`System`,e[e.User=1]=`User`,e[e.Assistant=2]=`Assistant`})(V_||={});var H_;(function(e){e[e.Assistant=0]=`Assistant`,e[e.User=1]=`User`})(H_||={});var U_;(function(e){e.PNG=`image/png`,e.JPEG=`image/jpeg`,e.GIF=`image/gif`,e.WEBP=`image/webp`,e.BMP=`image/bmp`})(U_||={});var W_;(function(e){e.Low=`low`,e.High=`high`})(W_||={});var G_;(function(e){function t(e){let t=e.capabilities?.agentMode===void 0||e.capabilities.agentMode;return t&&!!e.capabilities?.toolCalling}e.suitableForAgentMode=t;function n(e){return e.modelPickerCategory===void 0?`${e.name} (${e.family})`:e.name}e.asQualifiedName=n})(G_||={});const K_={type:`object`,properties:{vendor:{type:`string`,description:C(5429,`A globally unique vendor of language models.`)},displayName:{type:`string`,description:C(5430,`The display name of the language model vendor.`)},managementCommand:{type:`string`,description:C(5431,`A command to manage the language model vendor, e.g. 'Manage Copilot models'. This is used in the chat model picker. If not provided, a gear icon is not rendered during vendor selection.`)}}},q_=t_.registerExtensionPoint({extensionPoint:`languageModels`,jsonSchema:{description:C(5432,`Contribute language models of a specific vendor.`),oneOf:[K_,{type:`array`,items:K_}]},activationEventsGenerator:(e,t)=>{for(let n of e)t.push(`onLanguageModelChat:${n.vendor}`)}});let J_=class{constructor(e,t,n,r){this._extensionService=e,this._logService=t,this._storageService=n,this._store=new v,this._providers=new Map,this._modelCache=new Map,this._vendors=new Map,this._modelPickerUserPreferences={},this._onLanguageModelChange=this._store.add(new x),this.onDidChangeLanguageModels=this._onLanguageModelChange.event,this._hasUserSelectableModels=z_.languageModelsAreUserSelectable.bindTo(r),this._modelPickerUserPreferences=this._storageService.getObject(`chatModelPickerPreferences`,kh.PROFILE,this._modelPickerUserPreferences),this._store.add(this.onDidChangeLanguageModels(()=>{this._hasUserSelectableModels.set(this._modelCache.size>0&&Array.from(this._modelCache.values()).some(e=>e.isUserSelectable))})),this._store.add(q_.setHandler(e=>{this._vendors.clear();for(let t of e){if(!Hg(t.description,`chatProvider`)){t.collector.error(C(5433,`This contribution point requires the 'chatProvider' proposal.`));continue}for(let e of pt.wrap(t.value)){if(this._vendors.has(e.vendor)){t.collector.error(C(5434,`The vendor '{0}' is already registered and cannot be registered twice`,e.vendor));continue}if(Ii(e.vendor)){t.collector.error(C(5435,`The vendor field cannot be empty.`));continue}if(e.vendor.trim()!==e.vendor){t.collector.error(C(5436,`The vendor field cannot start or end with whitespace.`));continue}this._vendors.set(e.vendor,e)}}for(let[e,t]of this._providers)this._vendors.has(e)||this._providers.delete(e)}))}dispose(){this._store.dispose(),this._providers.clear()}updateModelPickerPreference(e,t){let n=this._modelCache.get(e);if(!n){this._logService.warn(`[LM] Cannot update model picker preference for unknown model ${e}`);return}this._modelPickerUserPreferences[e]=t,t===n.isUserSelectable?(delete this._modelPickerUserPreferences[e],this._storageService.store(`chatModelPickerPreferences`,this._modelPickerUserPreferences,kh.PROFILE,Ah.USER)):n.isUserSelectable!==t&&this._storageService.store(`chatModelPickerPreferences`,this._modelPickerUserPreferences,kh.PROFILE,Ah.USER),this._onLanguageModelChange.fire(),this._logService.trace(`[LM] Updated model picker preference for ${e} to ${t}`)}getVendors(){return Array.from(this._vendors.values())}getLanguageModelIds(){return Array.from(this._modelCache.keys())}lookupLanguageModel(e){let t=this._modelCache.get(e);return t&&this._modelPickerUserPreferences[e]!==void 0?{...t,isUserSelectable:this._modelPickerUserPreferences[e]}:t}_clearModelCache(e){typeof e==`string`&&(e=[e]);for(let t of e)for(let[e,n]of this._modelCache.entries())n.vendor===t&&this._modelCache.delete(e)}async resolveLanguageModels(e,t){typeof e==`string`&&(e=[e]),this._clearModelCache(e);for(let n of e){let e=this._providers.get(n);if(!e){this._logService.warn(`[LM] No provider registered for vendor ${n}`);continue}try{let r=await e.prepareLanguageModelChat({silent:t},Oi.None);for(let e of r){if(this._modelCache.has(e.identifier)){this._logService.warn(`[LM] Model ${e.identifier} is already registered. Skipping.`);continue}this._modelCache.set(e.identifier,e.metadata)}this._logService.trace(`[LM] Resolved language models for vendor ${n}`,r)}catch(e){this._logService.error(`[LM] Error resolving language models for vendor ${n}:`,e)}}this._onLanguageModelChange.fire()}async selectLanguageModels(e,t){if(e.vendor)await this._extensionService.activateByEvent(`onLanguageModelChat:${e.vendor}}`),await this.resolveLanguageModels([e.vendor],!t);else{let e=Array.from(this._vendors.keys()),n=e.map(e=>this._extensionService.activateByEvent(`onLanguageModelChat:${e}`));await Promise.all(n),await this.resolveLanguageModels(e,!t)}let n=[];for(let[t,r]of this._modelCache)(e.vendor===void 0||r.vendor===e.vendor)&&(e.family===void 0||r.family===e.family)&&(e.version===void 0||r.version===e.version)&&(e.id===void 0||r.id===e.id)&&n.push(t);return this._logService.trace(`[LM] selected language models`,e,n),n}registerLanguageModelProvider(e,t){if(this._logService.trace(`[LM] registering language model provider`,e,t),!this._vendors.has(e))throw Error(`Chat model provider uses UNKNOWN vendor ${e}.`);if(this._providers.has(e))throw Error(`Chat model provider for vendor ${e} is already registered.`);return this._providers.set(e,t),this.resolveLanguageModels(e,!0).then(()=>{this._onLanguageModelChange.fire()}),_(()=>{this._logService.trace(`[LM] UNregistered language model provider`,e),this._clearModelCache(e),this._providers.delete(e)})}async sendChatRequest(e,t,n,r,i){let a=this._providers.get(this._modelCache.get(e)?.vendor||``);if(!a)throw Error(`Chat provider for model ${e} is not registered.`);return a.sendChatRequest(e,n,t,r,i)}computeTokenLength(e,t,n){let r=this._modelCache.get(e);if(!r)throw Error(`Chat model ${e} could not be found.`);let i=this._providers.get(r.vendor);if(!i)throw Error(`Chat provider for model ${e} is not registered.`);return i.provideTokenCount(e,t,n)}};J_=A([j(0,Wg),j(1,xs),j(2,Ph),j(3,sh)],J_),new I(`debugType`,void 0,{type:`string`,description:C(6392,`Debug type of the active debug session. For example 'python'.`)}),new I(`debugConfigurationType`,void 0,{type:`string`,description:C(6393,`Debug type of the selected launch configuration. For example 'python'.`)}),new I(`debugState`,`inactive`,{type:`string`,description:C(6394,`State that the focused debug session is in. One of the following: 'inactive', 'initializing', 'stopped' or 'running'.`)}),new I(`debugUx`,`default`,{type:`string`,description:C(6395,`Debug UX state. When there are no debug configurations it is 'simple', otherwise 'default'. Used to decide when to show welcome views in the debug viewlet.`)}),new I(`hasDebugged`,!1,{type:`boolean`,description:C(6396,`True when a debug session has been started at least once, false otherwise.`)}),new I(`inDebugMode`,!1,{type:`boolean`,description:C(6397,`True when debugging, false otherwise.`)}),new I(`inDebugRepl`,!1,{type:`boolean`,description:C(6398,`True when focus is in the debug console, false otherwise.`)}),new I(`breakpointWidgetVisible`,!1,{type:`boolean`,description:C(6399,`True when breakpoint editor zone widget is visible, false otherwise.`)}),new I(`inBreakpointWidget`,!1,{type:`boolean`,description:C(6400,`True when focus is in the breakpoint editor zone widget, false otherwise.`)}),new I(`breakpointsFocused`,!0,{type:`boolean`,description:C(6401,`True when the BREAKPOINTS view is focused, false otherwise.`)}),new I(`watchExpressionsFocused`,!0,{type:`boolean`,description:C(6402,`True when the WATCH view is focused, false otherwise.`)}),new I(`watchExpressionsExist`,!1,{type:`boolean`,description:C(6403,`True when at least one watch expression exists, false otherwise.`)}),new I(`variablesFocused`,!0,{type:`boolean`,description:C(6404,`True when the VARIABLES views is focused, false otherwise`)}),new I(`expressionSelected`,!1,{type:`boolean`,description:C(6405,`True when an expression input box is open in either the WATCH or the VARIABLES view, false otherwise.`)}),new I(`breakpointInputFocused`,!1,{type:`boolean`,description:C(6406,`True when the input box has focus in the BREAKPOINTS view.`)}),new I(`callStackItemType`,void 0,{type:`string`,description:C(6407,`Represents the item type of the focused element in the CALL STACK view. For example: 'session', 'thread', 'stackFrame'`)}),new I(`callStackSessionIsAttach`,!1,{type:`boolean`,description:C(6408,`True when the session in the CALL STACK view is attach, false otherwise. Used internally for inline menus in the CALL STACK view.`)}),new I(`callStackItemStopped`,!1,{type:`boolean`,description:C(6409,`True when the focused item in the CALL STACK is stopped. Used internaly for inline menus in the CALL STACK view.`)}),new I(`callStackSessionHasOneThread`,!1,{type:`boolean`,description:C(6410,`True when the focused session in the CALL STACK view has exactly one thread. Used internally for inline menus in the CALL STACK view.`)}),new I(`callStackFocused`,!0,{type:`boolean`,description:C(6411,`True when the CALLSTACK view is focused, false otherwise.`)}),new I(`watchItemType`,void 0,{type:`string`,description:C(6412,`Represents the item type of the focused element in the WATCH view. For example: 'expression', 'variable'`)}),new I(`canViewMemory`,void 0,{type:`boolean`,description:C(6413,`Indicates whether the item in the view has an associated memory refrence.`)}),new I(`breakpointItemType`,void 0,{type:`string`,description:C(6414,`Represents the item type of the focused element in the BREAKPOINTS view. For example: 'breakpoint', 'exceptionBreakppint', 'functionBreakpoint', 'dataBreakpoint'`)}),new I(`breakpointItemBytes`,void 0,{type:`boolean`,description:C(6415,`Whether the breakpoint item is a data breakpoint on a byte range.`)}),new I(`breakpointHasModes`,!1,{type:`boolean`,description:C(6416,`Whether the breakpoint has multiple modes it can switch to.`)}),new I(`breakpointSupportsCondition`,!1,{type:`boolean`,description:C(6417,`True when the focused breakpoint supports conditions.`)}),new I(`loadedScriptsSupported`,!1,{type:`boolean`,description:C(6418,`True when the focused sessions supports the LOADED SCRIPTS view`)}),new I(`loadedScriptsItemType`,void 0,{type:`string`,description:C(6419,`Represents the item type of the focused element in the LOADED SCRIPTS view.`)}),new I(`focusedSessionIsAttach`,!1,{type:`boolean`,description:C(6420,`True when the focused session is 'attach'.`)}),new I(`focusedSessionIsNoDebug`,!1,{type:`boolean`,description:C(6421,`True when the focused session is run without debugging.`)}),new I(`stepBackSupported`,!1,{type:`boolean`,description:C(6422,`True when the focused session supports 'stepBack' requests.`)}),new I(`restartFrameSupported`,!1,{type:`boolean`,description:C(6423,`True when the focused session supports 'restartFrame' requests.`)}),new I(`stackFrameSupportsRestart`,!1,{type:`boolean`,description:C(6424,`True when the focused stack frame supports 'restartFrame'.`)}),new I(`jumpToCursorSupported`,!1,{type:`boolean`,description:C(6425,`True when the focused session supports 'jumpToCursor' request.`)}),new I(`stepIntoTargetsSupported`,!1,{type:`boolean`,description:C(6426,`True when the focused session supports 'stepIntoTargets' request.`)}),new I(`breakpointsExist`,!1,{type:`boolean`,description:C(6427,`True when at least one breakpoint exists.`)}),new I(`debuggersAvailable`,!1,{type:`boolean`,description:C(6428,`True when there is at least one debug extensions active.`)}),new I(`debugExtensionAvailable`,!0,{type:`boolean`,description:C(6429,`True when there is at least one debug extension installed and enabled.`)}),new I(`debugProtocolVariableMenuContext`,void 0,{type:`string`,description:C(6430,`Represents the context the debug adapter sets on the focused variable in the VARIABLES view.`)}),new I(`debugSetVariableSupported`,!1,{type:`boolean`,description:C(6431,`True when the focused session supports 'setVariable' request.`)}),new I(`debugSetDataBreakpointAddressSupported`,!1,{type:`boolean`,description:C(6432,`True when the focused session supports 'getBreakpointInfo' request on an address.`)}),new I(`debugSetExpressionSupported`,!1,{type:`boolean`,description:C(6433,`True when the focused session supports 'setExpression' request.`)}),new I(`breakWhenValueChangesSupported`,!1,{type:`boolean`,description:C(6434,`True when the focused session supports to break when value changes.`)}),new I(`breakWhenValueIsAccessedSupported`,!1,{type:`boolean`,description:C(6435,`True when the focused breakpoint supports to break when value is accessed.`)}),new I(`breakWhenValueIsReadSupported`,!1,{type:`boolean`,description:C(6436,`True when the focused breakpoint supports to break when value is read.`)}),new I(`terminateDebuggeeSupported`,!1,{type:`boolean`,description:C(6437,`True when the focused session supports the terminate debuggee capability.`)}),new I(`suspendDebuggeeSupported`,!1,{type:`boolean`,description:C(6438,`True when the focused session supports the suspend debuggee capability.`)}),new I(`terminateThreadsSupported`,!1,{type:`boolean`,description:C(6439,`True when the focused session supports the terminate threads capability.`)}),new I(`variableEvaluateNamePresent`,!1,{type:`boolean`,description:C(6440,`True when the focused variable has an 'evalauteName' field set.`)}),new I(`variableIsReadonly`,!1,{type:`boolean`,description:C(6441,`True when the focused variable is read-only.`)}),new I(`variableValue`,!1,{type:`string`,description:C(6442,`Value of the variable, present for debug visualization clauses.`)}),new I(`variableType`,!1,{type:`string`,description:C(6443,`Type of the variable, present for debug visualization clauses.`)}),new I(`variableInterfaces`,!1,{type:`array`,description:C(6444,`Any interfaces or contracts that the variable satisfies, present for debug visualization clauses.`)}),new I(`variableName`,!1,{type:`string`,description:C(6445,`Name of the variable, present for debug visualization clauses.`)}),new I(`variableLanguage`,!1,{type:`string`,description:C(6446,`Language of the variable source, present for debug visualization clauses.`)}),new I(`variableExtensionId`,!1,{type:`string`,description:C(6447,`Extension ID of the variable source, present for debug visualization clauses.`)}),new I(`exceptionWidgetVisible`,!1,{type:`boolean`,description:C(6448,`True when the exception widget is visible.`)}),new I(`multiSessionRepl`,!1,{type:`boolean`,description:C(6449,`True when there is more than 1 debug console.`)}),new I(`multiSessionDebug`,!1,{type:`boolean`,description:C(6450,`True when there is more than 1 active debug session.`)}),new I(`disassembleRequestSupported`,!1,{type:`boolean`,description:C(6451,`True when the focused sessions supports disassemble request.`)}),new I(`disassemblyViewFocus`,!1,{type:`boolean`,description:C(6452,`True when the Disassembly View is focused.`)}),new I(`languageSupportsDisassembleRequest`,!1,{type:`boolean`,description:C(6453,`True when the language in the current editor supports disassemble request.`)}),new I(`focusedStackFrameHasInstructionReference`,!1,{type:`boolean`,description:C(6454,`True when the focused stack frame has instruction pointer reference.`)}),C(6456,`Controls when the internal Debug Console should open.`);var Y_;(function(e){e[e.Inactive=0]=`Inactive`,e[e.Initializing=1]=`Initializing`,e[e.Stopped=2]=`Stopped`,e[e.Running=3]=`Running`})(Y_||={});var X_;(function(e){e[e.Valid=0]=`Valid`,e[e.Unreadable=1]=`Unreadable`,e[e.Error=2]=`Error`})(X_||={});var Z_;(function(e){e[e.Variable=0]=`Variable`,e[e.Address=1]=`Address`})(Z_||={});var Q_;(function(e){e[e.Initial=1]=`Initial`,e[e.Dynamic=2]=`Dynamic`})(Q_||={});var $_;(function(e){e.UnverifiedBreakpoints=`unverifiedBreakpoints`})($_||={});var ev;(function(e){e[e.CONDITION=0]=`CONDITION`,e[e.HIT_COUNT=1]=`HIT_COUNT`,e[e.LOG_MESSAGE=2]=`LOG_MESSAGE`,e[e.TRIGGER_POINT=3]=`TRIGGER_POINT`})(ev||={});var tv;(function(e){e[e.Command=0]=`Command`,e[e.Tree=1]=`Tree`})(tv||={});var nv;(function(e){e[e.None=0]=`None`,e[e.Collapsed=1]=`Collapsed`,e[e.Expanded=2]=`Expanded`})(nv||={});var rv;(function(e){e.deserialize=e=>e,e.serialize=e=>e})(rv||={});var iv;(function(e){e.deserialize=e=>({id:e.id,name:e.name,iconPath:e.iconPath&&{light:w.revive(e.iconPath.light),dark:w.revive(e.iconPath.dark)},iconClass:e.iconClass,visualization:e.visualization}),e.serialize=e=>e})(iv||={});const av=`[/\\\\]`,ov=`[^/\\\\]`,sv=/\//g;function cv(e,t){switch(e){case 0:return``;case 1:return`${ov}*?`;default:return`(?:${av}|${ov}+${av}${t?`|${av}${ov}+`:``})*?`}}function lv(e,t){if(!e)return[];let n=[],r=!1,i=!1,a=``;for(let o of e){switch(o){case t:if(!r&&!i){n.push(a),a=``;continue}break;case`{`:r=!0;break;case`}`:r=!1;break;case`[`:i=!0;break;case`]`:i=!1;break}a+=o}return a&&n.push(a),n}function uv(e){if(!e)return``;let t=``,n=lv(e,`/`);if(n.every(e=>e===`**`))t=`.*`;else{let e=!1;n.forEach((r,i)=>{if(r===`**`){if(e)return;t+=cv(2,i===n.length-1)}else{let e=!1,a=``,o=!1,s=``;for(let n of r){if(n!==`}`&&e){a+=n;continue}if(o&&(n!==`]`||!s)){let e;e=n===`-`?n:(n===`^`||n===`!`)&&!s?`^`:n===`/`?``:zi(n),s+=e;continue}switch(n){case`{`:e=!0;continue;case`[`:o=!0;continue;case`}`:{let n=lv(a,`,`),r=`(?:${n.map(e=>uv(e)).join(`|`)})`;t+=r,e=!1,a=``;break}case`]`:t+=`[`+s+`]`,o=!1,s=``;break;case`?`:t+=ov;continue;case`*`:t+=cv(1);continue;default:t+=zi(n)}}i<n.length-1&&(n[i+1]!==`**`||i+2<n.length)&&(t+=av)}e=r===`**`})}return t}const dv=/^\*\*\/\*\.[\w\.-]+$/,fv=/^\*\*\/([\w\.-]+)\/?$/,pv=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,mv=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,hv=/^\*\*((\/[\w\.-]+)+)\/?$/,gv=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,_v=new We(1e4),vv=function(){return!1},yv=function(){return null};function bv(e,t){if(!e)return yv;let n;n=typeof e==`string`?e:e.pattern,n=n.trim();let r=`${n}_${!!t.trimForExclusions}`,i=_v.get(r);if(i)return xv(i,e);let a;return i=dv.test(n)?Cv(n.substr(4),n):(a=fv.exec(Sv(n,t)))?wv(a[1],n):(t.trimForExclusions?mv:pv).test(n)?Tv(n,t):(a=hv.exec(Sv(n,t)))?Ev(a[1].substr(1),n,!0):(a=gv.exec(Sv(n,t)))?Ev(a[1],n,!1):Dv(n),_v.set(r,i),xv(i,e)}function xv(e,t){if(typeof t==`string`)return e;let n=function(n,r){return Na(n,t.base,!Qn)?e(Vi(n.substr(t.base.length),Kr),r):null};return n.allBasenames=e.allBasenames,n.allPaths=e.allPaths,n.basenames=e.basenames,n.patterns=e.patterns,n}function Sv(e,t){return t.trimForExclusions&&e.endsWith(`/**`)?e.substr(0,e.length-2):e}function Cv(e,t){return function(n,r){return typeof n==`string`&&n.endsWith(e)?t:null}}function wv(e,t){let n=`/${e}`,r=`\\${e}`,i=function(i,a){return typeof i==`string`?a?a===e?t:null:i===e||i.endsWith(n)||i.endsWith(r)?t:null:null},a=[e];return i.basenames=a,i.patterns=[t],i.allBasenames=a,i}function Tv(e,t){let n=Nv(e.slice(1,-1).split(`,`).map(e=>bv(e,t)).filter(e=>e!==yv),e),r=n.length;if(!r)return yv;if(r===1)return n[0];let i=function(t,r){for(let i=0,a=n.length;i<a;i++)if(n[i](t,r))return e;return null},a=n.find(e=>!!e.allBasenames);a&&(i.allBasenames=a.allBasenames);let o=n.reduce((e,t)=>t.allPaths?e.concat(t.allPaths):e,[]);return o.length&&(i.allPaths=o),i}function Ev(e,t,n){let r=Kr===Lr.sep,i=r?e:e.replace(sv,Kr),a=Kr+i,o=Lr.sep+e,s;return s=n?function(n,s){return typeof n==`string`&&(n===i||n.endsWith(a)||!r&&(n===e||n.endsWith(o)))?t:null}:function(n,a){return typeof n==`string`&&(n===i||!r&&n===e)?t:null},s.allPaths=[(n?`*/`:`./`)+e],s}function Dv(e){try{let t=RegExp(`^${uv(e)}$`);return function(n){return t.lastIndex=0,typeof n==`string`&&t.test(n)?e:null}}catch{return yv}}function Ov(e,t,n){return!e||typeof t!=`string`?!1:kv(e)(t,void 0,n)}function kv(e,t={}){if(!e)return vv;if(typeof e==`string`||Av(e)){let n=bv(e,t);if(n===yv)return vv;let r=function(e,t){return!!n(e,t)};return n.allBasenames&&(r.allBasenames=n.allBasenames),n.allPaths&&(r.allPaths=n.allPaths),r}return jv(e,t)}function Av(e){let t=e;return t?typeof t.base==`string`&&typeof t.pattern==`string`:!1}function jv(e,t){let n=Nv(Object.getOwnPropertyNames(e).map(n=>Mv(n,e[n],t)).filter(e=>e!==yv)),r=n.length;if(!r)return yv;if(!n.some(e=>!!e.requiresSiblings)){if(r===1)return n[0];let e=function(e,t){let r;for(let i=0,a=n.length;i<a;i++){let a=n[i](e,t);if(typeof a==`string`)return a;oo(a)&&(r||=[],r.push(a))}return r?(async()=>{for(let e of r){let t=await e;if(typeof t==`string`)return t}return null})():null},t=n.find(e=>!!e.allBasenames);t&&(e.allBasenames=t.allBasenames);let i=n.reduce((e,t)=>t.allPaths?e.concat(t.allPaths):e,[]);return i.length&&(e.allPaths=i),e}let i=function(e,t,r){let i,a;for(let o=0,s=n.length;o<s;o++){let s=n[o];s.requiresSiblings&&r&&(t||=Wr(e),i||=t.substr(0,t.length-Gr(e).length));let c=s(e,t,i,r);if(typeof c==`string`)return c;oo(c)&&(a||=[],a.push(c))}return a?(async()=>{for(let e of a){let t=await e;if(typeof t==`string`)return t}return null})():null},a=n.find(e=>!!e.allBasenames);a&&(i.allBasenames=a.allBasenames);let o=n.reduce((e,t)=>t.allPaths?e.concat(t.allPaths):e,[]);return o.length&&(i.allPaths=o),i}function Mv(e,t,n){if(t===!1)return yv;let r=bv(e,n);if(r===yv)return yv;if(typeof t==`boolean`)return r;if(t){let n=t.when;if(typeof n==`string`){let t=(t,i,a,o)=>{if(!o||!r(t,i))return null;let s=n.replace(`$(basename)`,()=>a),c=o(s);return oo(c)?c.then(t=>t?e:null):c?e:null};return t.requiresSiblings=!0,t}}return r}function Nv(e,t){let n=e.filter(e=>!!e.basenames);if(n.length<2)return e;let r=n.reduce((e,t)=>{let n=t.basenames;return n?e.concat(n):e},[]),i;if(t){i=[];for(let e=0,n=r.length;e<n;e++)i.push(t)}else i=n.reduce((e,t)=>{let n=t.patterns;return n?e.concat(n):e},[]);let a=function(e,t){if(typeof e!=`string`)return null;if(!t){let n;for(n=e.length;n>0;n--){let t=e.charCodeAt(n-1);if(t===S.Slash||t===S.Backslash)break}t=e.substr(n)}let n=r.indexOf(t);return n===-1?null:i[n]};a.basenames=r,a.patterns=i,a.allBasenames=r;let o=e.filter(e=>!e.basenames);return o.push(a),o}const Pv=[`W`,`X`,`Y`,`Z`,`a`,`b`,`c`,`d`,`e`,`f`],Fv=RegExp(`^[${Pv.join(``)}]+`);function Iv(e){if(e.scheme!==O.vscodeNotebookCell)return;let t=e.fragment.indexOf(`s`);if(t<0)return;let n=parseInt(e.fragment.substring(0,t).replace(Fv,``),7),r=Wt(e.fragment.substring(t+1)).toString();if(!isNaN(n))return{handle:n,notebook:e.with({scheme:r,fragment:null})}}function Lv(e,t){let n=t.toString(7),r=n.length<Pv.length?Pv[n.length-1]:`z`,i=`${r}${n}s${Gt(b.fromString(e.scheme),!0,!0)}`;return e.with({scheme:O.vscodeNotebookCell,fragment:i})}function Rv(e){if(e.scheme!==O.vscodeNotebookMetadata)return;let t=Wt(e.fragment).toString();return e.with({scheme:t,fragment:null})}function zv(e){let t=`${Gt(b.fromString(e.scheme),!0,!0)}`;return e.with({scheme:O.vscodeNotebookMetadata,fragment:t})}function Bv(e){if(e.scheme!==O.vscodeNotebookCellOutput)return;let t=new URLSearchParams(e.query),n=t.get(`openIn`);if(!n)return;let r=t.get(`outputId`)??void 0,i=Iv(e.with({scheme:O.vscodeNotebookCell,query:null})),a=t.get(`outputIndex`)?parseInt(t.get(`outputIndex`)||``,10):void 0,o=i?i.notebook:e.with({scheme:t.get(`notebookScheme`)||O.file,fragment:null,query:null}),s=t.get(`cellIndex`)?parseInt(t.get(`cellIndex`)||``,10):void 0;return{notebook:o,openIn:n,outputId:r,outputIndex:a,cellHandle:i?.handle,cellFragment:e.fragment,cellIndex:s}}var Vv;(function(e){e[e.Markup=1]=`Markup`,e[e.Code=2]=`Code`})(Vv||={}),Ku.latex,Ku.markdown,Ku.text,Ku.latex,Ku.markdown,Ku.text;var Hv;(function(e){e[e.Running=1]=`Running`,e[e.Idle=2]=`Idle`})(Hv||={});var Uv;(function(e){e[e.Unconfirmed=1]=`Unconfirmed`,e[e.Pending=2]=`Pending`,e[e.Executing=3]=`Executing`})(Uv||={});var Wv;(function(e){e[e.Unconfirmed=1]=`Unconfirmed`,e[e.Pending=2]=`Pending`,e[e.Executing=3]=`Executing`})(Wv||={});var Gv;(function(e){e[e.WithHardKernelDependency=0]=`WithHardKernelDependency`,e[e.WithOptionalKernelDependency=1]=`WithOptionalKernelDependency`,e[e.Pure=2]=`Pure`,e[e.Never=3]=`Never`})(Gv||={});var Kv;(function(e){e.Always=`always`,e.Never=`never`,e.Optional=`optional`})(Kv||={});var qv;(function(e){e[e.ModelChange=1]=`ModelChange`,e[e.Move=2]=`Move`,e[e.ChangeCellLanguage=5]=`ChangeCellLanguage`,e[e.Initialize=6]=`Initialize`,e[e.ChangeCellMetadata=7]=`ChangeCellMetadata`,e[e.Output=8]=`Output`,e[e.OutputItem=9]=`OutputItem`,e[e.ChangeCellContent=10]=`ChangeCellContent`,e[e.ChangeDocumentMetadata=11]=`ChangeDocumentMetadata`,e[e.ChangeCellInternalMetadata=12]=`ChangeCellInternalMetadata`,e[e.ChangeCellMime=13]=`ChangeCellMime`,e[e.Unknown=100]=`Unknown`})(qv||={});var Jv;(function(e){e[e.Handle=0]=`Handle`,e[e.Index=1]=`Index`})(Jv||={});var Yv;(function(e){e[e.Replace=1]=`Replace`,e[e.Output=2]=`Output`,e[e.Metadata=3]=`Metadata`,e[e.CellLanguage=4]=`CellLanguage`,e[e.DocumentMetadata=5]=`DocumentMetadata`,e[e.Move=6]=`Move`,e[e.OutputItems=7]=`OutputItems`,e[e.PartialMetadata=8]=`PartialMetadata`,e[e.PartialInternalMetadata=9]=`PartialInternalMetadata`})(Yv||={});var Xv;(function(e){e.scheme=O.vscodeNotebookMetadata;function t(e){return zv(e)}e.generate=t;function n(e){return Rv(e)}e.parse=n})(Xv||={});var Zv;(function(e){e.scheme=O.vscodeNotebookCell;function t(e,t){return Lv(e,t)}e.generate=t;function n(e){return Iv(e)}e.parse=n;function r(e,t){return e.with({scheme:O.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:`editor`,outputId:t??``,notebookScheme:e.scheme===O.file?``:e.scheme}).toString()})}e.generateCellOutputUriWithId=r;function i(e,t,n){return e.with({scheme:O.vscodeNotebookCellOutput,fragment:t.fragment,query:new URLSearchParams({openIn:`notebook`,outputIndex:String(n)}).toString()})}e.generateCellOutputUriWithIndex=i;function a(e,t,n,r,i){return e.with({scheme:O.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:`notebookOutputEditor`,notebook:e.toString(),cellIndex:String(n),outputId:r,outputIndex:String(i)}).toString()})}e.generateOutputEditorUri=a;function o(e){return Bv(e)}e.parseCellOutputUri=o;function s(t,n,r){return e.generate(t,n).with({scheme:r})}e.generateCellPropertyUri=s;function c(t,n){if(t.scheme===n)return e.parse(t.with({scheme:e.scheme}))}e.parseCellPropertyUri=c})(Zv||={}),new I(`notebookEditorCursorAtBoundary`,`none`),new I(`notebookEditorCursorAtLineBoundary`,`none`);var Qv;(function(e){e.default=`default`,e.option=`option`})(Qv||={});var $v;(function(e){e.Cells=`cells`,e.Text=`text`,e.None=`none`})($v||={});var ey;(function(e){e[e.Left=1]=`Left`,e[e.Right=2]=`Right`})(ey||={}),class e{static{this._prefix=`notebook/`}static create(t,n){return`${e._prefix}${t}/${n??t}`}static parse(t){if(t.startsWith(e._prefix)){let n=t.substring(e._prefix.length).split(`/`);if(n.length===2)return{notebookType:n[0],viewType:n[1]}}}};function ty(e){return[`application/vnd.code.notebook.stdout`,`application/vnd.code.notebook.stderr`].includes(e)}const ny=new TextDecoder;function ry(e){let t=[],n=!1;for(let r of e)(t.length===0||n)&&(t.push(r),n=!0);let r=ay(t),i=b.concat(t.map(e=>b.wrap(e))),a=cy(i);return r||=a.byteLength!==i.byteLength,{data:a,didCompression:r}}const iy=`\x1B[A`.split(``).map(e=>e.charCodeAt(0));function ay(e){let t=!1;return e.forEach((n,r)=>{if(r===0||n.length<3)return;let i=e[r-1],a=n.subarray(0,3);if(a[0]===iy[0]&&a[1]===iy[1]&&a[2]===iy[2]){let a=i.lastIndexOf(10);if(a===-1)return;t=!0,e[r-1]=i.subarray(0,a),e[r]=n.subarray(3)}}),t}function oy(e){let t=e;do e=t,t=e.replace(/[^\n]\x08/gm,``);while(t.length<e.length);return e}function sy(e){for(e=e.replace(/\r+\n/gm,`
`);e.search(/\r[^$]/g)>-1;){let t=e.match(/^(.*)\r+/m)[1],n=e.match(/\r+(.*)$/m)[1];n+=t.slice(n.length,t.length),e=e.replace(/\r+.*$/m,`\r`).replace(/^.*\r/m,n)}return e}function cy(e){return!e.buffer.includes(8)&&!e.buffer.includes(13)?e:b.fromString(sy(oy(ny.decode(e.buffer))))}var ly;(function(e){e.Delimiter=`\0`})(ly||={});var uy;(function(e){e[e.IsSame=0]=`IsSame`,e[e.Disconnected=1]=`Disconnected`,e[e.IsChild=2]=`IsChild`,e[e.IsParent=3]=`IsParent`})(uy||={});var dy=class e{static fromExtHostTestItem(t,n,r=t.parent){if(t._isRoot)return new e([n]);let i=[t.id];for(let e=r;e&&e.id!==n;e=e.parent)i.push(e.id);return i.push(n),new e(i.reverse())}static isRoot(e){return!e.includes(ly.Delimiter)}static root(e){let t=e.indexOf(ly.Delimiter);return t===-1?e:e.slice(0,t)}static fromString(t){return new e(t.split(ly.Delimiter))}static join(t,n){return new e([...t.path,n])}static split(e){return e.split(ly.Delimiter)}static joinToString(e,t){return e.toString()+ly.Delimiter+t}static parentId(e){let t=e.lastIndexOf(ly.Delimiter);return t===-1?void 0:e.slice(0,t)}static localId(e){let t=e.lastIndexOf(ly.Delimiter);return t===-1?e:e.slice(t+ly.Delimiter.length)}static isChild(e,t){return t[e.length]===ly.Delimiter&&t.startsWith(e)}static compare(t,n){return t===n?uy.IsSame:e.isChild(t,n)?uy.IsChild:e.isChild(n,t)?uy.IsParent:uy.Disconnected}static getLengthOfCommonPrefix(e,t){if(e===0)return 0;let n=0;for(;n<e-1;){for(let r=1;r<e;r++){let e=t(r-1),i=t(r);if(e.path[n]!==i.path[n])return n}n++}return n}constructor(e,t=e.length){if(this.path=e,this.viewEnd=t,e.length===0||t<1)throw Error(`cannot create test with empty path`)}get rootId(){return new e(this.path,1)}get parentId(){return this.viewEnd>1?new e(this.path,this.viewEnd-1):void 0}get localId(){return this.path[this.viewEnd-1]}get controllerId(){return this.path[0]}get isRoot(){return this.viewEnd===1}*idsFromRoot(){for(let t=1;t<=this.viewEnd;t++)yield new e(this.path,t)}*idsToRoot(){for(let t=this.viewEnd;t>0;t--)yield new e(this.path,t)}compare(t){if(typeof t==`string`)return e.compare(this.toString(),t);for(let e=0;e<t.viewEnd&&e<this.viewEnd;e++)if(t.path[e]!==this.path[e])return uy.Disconnected;return t.viewEnd>this.viewEnd?uy.IsChild:t.viewEnd<this.viewEnd?uy.IsParent:uy.IsSame}toJSON(){return this.toString()}toString(){if(!this.stringifed){this.stringifed=this.path[0];for(let e=1;e<this.viewEnd;e++)this.stringifed+=ly.Delimiter,this.stringifed+=this.path[e]}return this.stringifed}},fy;(function(e){e[e.Unset=0]=`Unset`,e[e.Queued=1]=`Queued`,e[e.Running=2]=`Running`,e[e.Passed=3]=`Passed`,e[e.Failed=4]=`Failed`,e[e.Skipped=5]=`Skipped`,e[e.Errored=6]=`Errored`})(fy||={}),fy.Unset,fy.Queued,fy.Running,fy.Passed,fy.Failed,fy.Skipped,fy.Errored;var py;(function(e){e[e.Run=1]=`Run`,e[e.Debug=2]=`Debug`,e[e.Coverage=3]=`Coverage`})(py||={});var my;(function(e){e[e.Refresh=2]=`Refresh`,e[e.CodeRelatedToTest=4]=`CodeRelatedToTest`,e[e.TestRelatedToCode=8]=`TestRelatedToCode`})(my||={});var hy;(function(e){e[e.Run=2]=`Run`,e[e.Debug=4]=`Debug`,e[e.Coverage=8]=`Coverage`,e[e.HasNonDefaultProfile=16]=`HasNonDefaultProfile`,e[e.HasConfigurable=32]=`HasConfigurable`,e[e.SupportsContinuousRun=64]=`SupportsContinuousRun`})(hy||={}),hy.Run,C(11849,`Run`),hy.Debug,C(11850,`Debug`),hy.Coverage,C(11851,`Coverage`),hy.Run,hy.Debug,hy.Coverage,hy.HasNonDefaultProfile,hy.HasConfigurable,hy.SupportsContinuousRun;const gy=e=>`runId`in e;var _y;(function(e){e.serialize=e=>({range:e.range.toJSON(),uri:e.uri.toJSON()}),e.deserialize=(e,t)=>({range:vp.lift(t.range),uri:e.asCanonicalUri(w.revive(t.uri))})})(_y||={});var vy;(function(e){e[e.Error=0]=`Error`,e[e.Output=1]=`Output`})(vy||={});var yy;(function(e){e.serialize=e=>({label:e.label,uri:e.uri?.toJSON(),position:e.position?.toJSON()}),e.deserialize=(e,t)=>({label:t.label,uri:t.uri?e.asCanonicalUri(w.revive(t.uri)):void 0,position:t.position?_p.lift(t.position):void 0})})(yy||={});var by;(function(e){e.serialize=e=>({message:e.message,type:vy.Error,expected:e.expected,actual:e.actual,contextValue:e.contextValue,location:e.location&&_y.serialize(e.location),stackTrace:e.stackTrace?.map(yy.serialize)}),e.deserialize=(e,t)=>({message:t.message,type:vy.Error,expected:t.expected,actual:t.actual,contextValue:t.contextValue,location:t.location&&_y.deserialize(e,t.location),stackTrace:t.stackTrace&&t.stackTrace.map(t=>yy.deserialize(e,t))})})(by||={});var xy;(function(e){e.serialize=e=>({message:e.message,type:vy.Output,offset:e.offset,length:e.length,location:e.location&&_y.serialize(e.location)}),e.deserialize=(e,t)=>({message:t.message,type:vy.Output,offset:t.offset,length:t.length,location:t.location&&_y.deserialize(e,t.location)})})(xy||={});var Sy;(function(e){e.serialize=e=>e.type===vy.Error?by.serialize(e):xy.serialize(e),e.deserialize=(e,t)=>t.type===vy.Error?by.deserialize(e,t):xy.deserialize(e,t),e.isDiffable=e=>e.type===vy.Error&&e.actual!==void 0&&e.expected!==void 0})(Sy||={});var Cy;(function(e){e.serializeWithoutMessages=e=>({state:e.state,duration:e.duration,messages:[]}),e.serialize=e=>({state:e.state,duration:e.duration,messages:e.messages.map(Sy.serialize)}),e.deserialize=(e,t)=>({state:t.state,duration:t.duration,messages:t.messages.map(t=>Sy.deserialize(e,t))})})(Cy||={});const wy=(e,t)=>e+`\0`+t,Ty=e=>{let t=e.indexOf(`\0`);return{ctrlId:e.slice(0,t),tagId:e.slice(t+1)}};var Ey;(function(e){e.serialize=e=>({extId:e.extId,label:e.label,tags:e.tags,busy:e.busy,children:void 0,uri:e.uri?.toJSON(),range:e.range?.toJSON()||null,description:e.description,error:e.error,sortText:e.sortText}),e.deserialize=(e,t)=>({extId:t.extId,label:t.label,tags:t.tags,busy:t.busy,children:void 0,uri:t.uri?e.asCanonicalUri(w.revive(t.uri)):void 0,range:t.range?vp.lift(t.range):null,description:t.description,error:t.error,sortText:t.sortText})})(Ey||={});var Dy;(function(e){e[e.NotExpandable=0]=`NotExpandable`,e[e.Expandable=1]=`Expandable`,e[e.BusyExpanding=2]=`BusyExpanding`,e[e.Expanded=3]=`Expanded`})(Dy||={});var Oy;(function(e){e.serialize=e=>({expand:e.expand,item:Ey.serialize(e.item)}),e.deserialize=(e,t)=>({controllerId:dy.root(t.item.extId),expand:t.expand,item:Ey.deserialize(e,t.item)})})(Oy||={});var ky;(function(e){e.serialize=e=>{let t;return e.item&&(t={},e.item.label!==void 0&&(t.label=e.item.label),e.item.tags!==void 0&&(t.tags=e.item.tags),e.item.busy!==void 0&&(t.busy=e.item.busy),e.item.uri!==void 0&&(t.uri=e.item.uri?.toJSON()),e.item.range!==void 0&&(t.range=e.item.range?.toJSON()),e.item.description!==void 0&&(t.description=e.item.description),e.item.error!==void 0&&(t.error=e.item.error),e.item.sortText!==void 0&&(t.sortText=e.item.sortText)),{extId:e.extId,expand:e.expand,item:t}},e.deserialize=e=>{let t;return e.item&&(t={},e.item.label!==void 0&&(t.label=e.item.label),e.item.tags!==void 0&&(t.tags=e.item.tags),e.item.busy!==void 0&&(t.busy=e.item.busy),e.item.range!==void 0&&(t.range=e.item.range?vp.lift(e.item.range):null),e.item.description!==void 0&&(t.description=e.item.description),e.item.error!==void 0&&(t.error=e.item.error),e.item.sortText!==void 0&&(t.sortText=e.item.sortText)),{extId:e.extId,expand:e.expand,item:t}}})(ky||={});const Ay=(e,t)=>{t.expand!==void 0&&(e.expand=t.expand),t.item!==void 0&&(e.item=e.item?Object.assign(e.item,t.item):t.item)};var jy;(function(e){e.serializeWithoutMessages=e=>({...Oy.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(Cy.serializeWithoutMessages)}),e.serialize=e=>({...Oy.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(Cy.serialize)}),e.deserialize=(e,t)=>({...Oy.deserialize(e,t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(t=>Cy.deserialize(e,t)),retired:!0})})(jy||={});var My;(function(e){e.empty=()=>({covered:0,total:0}),e.sum=(e,t)=>{e.covered+=t.covered,e.total+=t.total}})(My||={});var Ny;(function(e){e.serialize=e=>({id:e.id,statement:e.statement,branch:e.branch,declaration:e.declaration,testIds:e.testIds,uri:e.uri.toJSON()}),e.deserialize=(e,t)=>({id:t.id,statement:t.statement,branch:t.branch,declaration:t.declaration,testIds:t.testIds,uri:e.asCanonicalUri(w.revive(t.uri))}),e.empty=(e,t)=>({id:e,uri:t,statement:My.empty()})})(Ny||={});function Py(e){return{...e,location:e.location?.toJSON()}}function Fy(e){return e.location=e.location?_p.isIPosition(e.location)?_p.lift(e.location):vp.lift(e.location):void 0,e}var Iy;(function(e){e[e.Declaration=0]=`Declaration`,e[e.Statement=1]=`Statement`,e[e.Branch=2]=`Branch`})(Iy||={});var Ly;(function(e){e.serialize=e=>e.type===Iy.Declaration?zy.serialize(e):By.serialize(e),e.deserialize=e=>e.type===Iy.Declaration?zy.deserialize(e):By.deserialize(e)})(Ly||={});var Ry;(function(e){e.serialize=Py,e.deserialize=Fy})(Ry||={});var zy;(function(e){e.serialize=Py,e.deserialize=Fy})(zy||={});var By;(function(e){e.serialize=e=>({...Py(e),branches:e.branches?.map(Ry.serialize)}),e.deserialize=e=>({...Fy(e),branches:e.branches?.map(Ry.deserialize)})})(By||={});var Vy;(function(e){e[e.Add=0]=`Add`,e[e.Update=1]=`Update`,e[e.DocumentSynced=2]=`DocumentSynced`,e[e.Remove=3]=`Remove`,e[e.IncrementPendingExtHosts=4]=`IncrementPendingExtHosts`,e[e.Retire=5]=`Retire`,e[e.AddTag=6]=`AddTag`,e[e.RemoveTag=7]=`RemoveTag`})(Vy||={});var Hy;(function(e){e.deserialize=(e,t)=>t.op===Vy.Add?{op:t.op,item:Oy.deserialize(e,t.item)}:t.op===Vy.Update?{op:t.op,item:ky.deserialize(t.item)}:t.op===Vy.DocumentSynced?{op:t.op,uri:e.asCanonicalUri(w.revive(t.uri)),docv:t.docv}:t,e.serialize=e=>e.op===Vy.Add?{op:e.op,item:Oy.serialize(e.item)}:e.op===Vy.Update?{op:e.op,item:ky.serialize(e.item)}:e})(Hy||={});var Uy=class{constructor(e){this.uriIdentity=e,this._tags=new Map,this.items=new Map,this.roots=new Set,this.busyControllerCount=0,this.pendingRootCount=0,this.tags=this._tags}apply(e){let t=this.createChangeCollector();for(let n of e)switch(n.op){case Vy.Add:this.add(Oy.deserialize(this.uriIdentity,n.item),t);break;case Vy.Update:this.update(ky.deserialize(n.item),t);break;case Vy.Remove:this.remove(n.itemId,t);break;case Vy.Retire:this.retireTest(n.itemId);break;case Vy.IncrementPendingExtHosts:this.updatePendingRoots(n.amount);break;case Vy.AddTag:this._tags.set(n.tag.id,n.tag);break;case Vy.RemoveTag:this._tags.delete(n.id);break}t.complete?.()}add(e,t){let n=dy.parentId(e.item.extId)?.toString(),r;if(!n)r=this.createItem(e),this.roots.add(r),this.items.set(e.item.extId,r);else if(this.items.has(n)){let t=this.items.get(n);t.children.add(e.item.extId),r=this.createItem(e,t),this.items.set(e.item.extId,r)}else{console.error(`Test with unknown parent ID: ${JSON.stringify(e)}`);return}return t.add?.(r),e.expand===Dy.BusyExpanding&&this.busyControllerCount++,r}update(e,t){let n=this.items.get(e.extId);if(n)return e.expand!==void 0&&(n.expand===Dy.BusyExpanding&&this.busyControllerCount--,e.expand===Dy.BusyExpanding&&this.busyControllerCount++),Ay(n,e),t.update?.(n),n}remove(e,t){let n=this.items.get(e);if(!n)return;let r=dy.parentId(n.item.extId)?.toString();if(r){let e=this.items.get(r);e.children.delete(n.item.extId)}else this.roots.delete(n);let i=[[e]];for(;i.length;)for(let e of i.pop()){let r=this.items.get(e);r&&(i.push(r.children),this.items.delete(e),t.remove?.(r,r!==n),r.expand===Dy.BusyExpanding&&this.busyControllerCount--)}}retireTest(e){}updatePendingRoots(e){this.pendingRootCount+=e}createChangeCollector(){return{}}},Wy;(function(e){e[e.UP=0]=`UP`,e[e.DOWN=1]=`DOWN`,e[e.LEFT=2]=`LEFT`,e[e.RIGHT=3]=`RIGHT`})(Wy||={});var Gy;(function(e){e[e.HORIZONTAL=0]=`HORIZONTAL`,e[e.VERTICAL=1]=`VERTICAL`})(Gy||={});var Ky;(function(e){e[e.FIRST=0]=`FIRST`,e[e.LAST=1]=`LAST`,e[e.NEXT=2]=`NEXT`,e[e.PREVIOUS=3]=`PREVIOUS`})(Ky||={});var qy;(function(e){e[e.MAXIMIZE=0]=`MAXIMIZE`,e[e.EXPAND=1]=`EXPAND`,e[e.EVEN=2]=`EVEN`})(qy||={});var Jy;(function(e){e[e.COPY_EDITORS=0]=`COPY_EDITORS`,e[e.MOVE_EDITORS=1]=`MOVE_EDITORS`})(Jy||={});var Yy;(function(e){e[e.CREATION_TIME=0]=`CREATION_TIME`,e[e.MOST_RECENTLY_ACTIVE=1]=`MOST_RECENTLY_ACTIVE`,e[e.GRID_APPEARANCE=2]=`GRID_APPEARANCE`})(Yy||={});var Xy;(function(e){e[e.NEW_EDITOR=1]=`NEW_EDITOR`,e[e.MOVE_EDITOR=2]=`MOVE_EDITOR`,e[e.COPY_EDITOR=3]=`COPY_EDITOR`})(Xy||={});var Zy;(function(e){e[e.Upsert=0]=`Upsert`,e[e.SetTags=1]=`SetTags`,e[e.UpdateCanResolveChildren=2]=`UpdateCanResolveChildren`,e[e.RemoveChild=3]=`RemoveChild`,e[e.SetProp=4]=`SetProp`,e[e.Bulk=5]=`Bulk`,e[e.DocumentSynced=6]=`DocumentSynced`})(Zy||={});const Qy=(e,t)=>e===t,$y={range:(e,t)=>e===t?!0:!e||!t?!1:e.equalsRange(t),busy:Qy,label:Qy,description:Qy,error:Qy,sortText:Qy,tags:(e,t)=>!(e.length!==t.length||e.some(e=>!t.includes(e)))},eb=Object.entries($y),tb=(e,t)=>{let n;for(let[r,i]of eb)i(e[r],t[r])||(n?n[r]=t[r]:n={[r]:t[r]});return n};var nb=class extends y{get root(){return this.options.root}constructor(e){super(),this.options=e,this.debounceSendDiff=this._register(new Do(()=>this.flushDiff(),200)),this.diffOpEmitter=this._register(new x),this.tree=new Map,this.tags=new Map,this.diff=[],this.onDidGenerateDiff=this.diffOpEmitter.event,this.root.canResolveChildren=!0,this.upsertItem(this.root,void 0)}set resolveHandler(e){this._resolveHandler=e;for(let e of this.tree.values())this.updateExpandability(e)}get resolveHandler(){return this._resolveHandler}collectDiff(){let e=this.diff;return this.diff=[],e}pushDiff(e){switch(e.op){case Vy.DocumentSynced:for(let t of this.diff)if(t.op===Vy.DocumentSynced&&t.uri===e.uri){t.docv=e.docv;return}break;case Vy.Update:{let t=this.diff[this.diff.length-1];if(t){if(t.op===Vy.Update&&t.item.extId===e.item.extId){Ay(t.item,e.item);return}if(t.op===Vy.Add&&t.item.item.extId===e.item.extId){Ay(t.item,e.item);return}}break}}this.diff.push(e),this.debounceSendDiff.isScheduled()||this.debounceSendDiff.schedule()}expand(e,t){let n=this.tree.get(e);if(n){if((n.expandLevels===void 0||t>n.expandLevels)&&(n.expandLevels=t),n.expand===Dy.Expandable){let e=this.resolveChildren(n);return e.isOpen()?this.expandChildren(n,t-1):e.wait().then(()=>this.expandChildren(n,t-1))}else if(n.expand===Dy.Expanded)return n.resolveBarrier?.isOpen()===!1?n.resolveBarrier.wait().then(()=>this.expandChildren(n,t-1)):this.expandChildren(n,t-1)}}dispose(){for(let e of this.tree.values())this.options.getApiFor(e.actual).listener=void 0;this.tree.clear(),this.diff=[],super.dispose()}onTestItemEvent(e,t){switch(t.op){case Zy.RemoveChild:this.removeItem(dy.joinToString(e.fullId,t.id));break;case Zy.Upsert:this.upsertItem(t.item,e);break;case Zy.Bulk:for(let n of t.ops)this.onTestItemEvent(e,n);break;case Zy.SetTags:this.diffTagRefs(t.new,t.old,e.fullId.toString());break;case Zy.UpdateCanResolveChildren:this.updateExpandability(e);break;case Zy.SetProp:this.pushDiff({op:Vy.Update,item:{extId:e.fullId.toString(),item:t.update}});break;case Zy.DocumentSynced:this.documentSynced(e.actual.uri);break;default:Je()}}documentSynced(e){e&&this.pushDiff({op:Vy.DocumentSynced,uri:e,docv:this.options.getDocumentVersion(e)})}upsertItem(e,t){let n=dy.fromExtHostTestItem(e,this.root.id,t?.actual),r=this.options.getApiFor(e);r.parent&&r.parent!==t?.actual&&this.options.getChildren(r.parent).delete(e.id);let i=this.tree.get(n.toString());if(!i){i={fullId:n,actual:e,expandLevels:t?.expandLevels?t.expandLevels-1:void 0,expand:Dy.NotExpandable},e.tags.forEach(this.incrementTagRefs,this),this.tree.set(i.fullId.toString(),i),this.setItemParent(e,t),this.pushDiff({op:Vy.Add,item:{controllerId:this.options.controllerId,expand:i.expand,item:this.options.toITestItem(e)}}),this.connectItemAndChildren(e,i,t);return}if(i.actual===e){this.connectItem(e,i,t);return}if(i.actual.uri?.toString()!==e.uri?.toString())return this.removeItem(n.toString()),this.upsertItem(e,t);let a=this.options.getChildren(i.actual),o=i.actual,s=tb(this.options.toITestItem(o),this.options.toITestItem(e));this.options.getApiFor(o).listener=void 0,i.actual=e,i.resolveBarrier=void 0,i.expand=Dy.NotExpandable,s&&(s.hasOwnProperty(`tags`)&&(this.diffTagRefs(e.tags,o.tags,n.toString()),delete s.tags),this.onTestItemEvent(i,{op:Zy.SetProp,update:s})),this.connectItemAndChildren(e,i,t);for(let[t,r]of a)this.options.getChildren(e).get(r.id)||this.removeItem(dy.joinToString(n,r.id));let c=i.expandLevels;c!==void 0&&queueMicrotask(()=>{i.expand===Dy.Expandable&&(i.expandLevels=void 0,this.expand(n.toString(),c))}),this.documentSynced(i.actual.uri)}diffTagRefs(e,t,n){let r=new Set(t.map(e=>e.id));for(let t of e)r.delete(t.id)||this.incrementTagRefs(t);this.pushDiff({op:Vy.Update,item:{extId:n,item:{tags:e.map(e=>wy(this.options.controllerId,e.id))}}}),r.forEach(this.decrementTagRefs,this)}incrementTagRefs(e){let t=this.tags.get(e.id);t?t.refCount++:(this.tags.set(e.id,{refCount:1}),this.pushDiff({op:Vy.AddTag,tag:{id:wy(this.options.controllerId,e.id)}}))}decrementTagRefs(e){let t=this.tags.get(e);t&&!--t.refCount&&(this.tags.delete(e),this.pushDiff({op:Vy.RemoveTag,id:wy(this.options.controllerId,e)}))}setItemParent(e,t){this.options.getApiFor(e).parent=t&&t.actual!==this.root?t.actual:void 0}connectItem(e,t,n){this.setItemParent(e,n);let r=this.options.getApiFor(e);r.parent=n?.actual,r.listener=e=>this.onTestItemEvent(t,e),this.updateExpandability(t)}connectItemAndChildren(e,t,n){this.connectItem(e,t,n);for(let[n,r]of this.options.getChildren(e))this.upsertItem(r,t)}updateExpandability(e){let t;t=this._resolveHandler?e.resolveBarrier?e.resolveBarrier.isOpen()?Dy.Expanded:Dy.BusyExpanding:e.actual.canResolveChildren?Dy.Expandable:Dy.NotExpandable:Dy.NotExpandable,t!==e.expand&&(e.expand=t,this.pushDiff({op:Vy.Update,item:{extId:e.fullId.toString(),expand:t}}),t===Dy.Expandable&&e.expandLevels!==void 0&&this.resolveChildren(e))}expandChildren(e,t){if(t<0)return;let n=[];for(let[r,i]of this.options.getChildren(e.actual)){let r=this.expand(dy.joinToString(e.fullId,i.id),t);oo(r)&&n.push(r)}if(n.length)return Promise.all(n).then(()=>{})}resolveChildren(e){if(e.resolveBarrier)return e.resolveBarrier;if(!this._resolveHandler){let e=new bo;return e.open(),e}e.expand=Dy.BusyExpanding,this.pushExpandStateUpdate(e);let t=e.resolveBarrier=new bo,n=e=>{console.error(`Unhandled error in resolveHandler of test controller "${this.options.controllerId}"`,e)},r;try{r=this._resolveHandler(e.actual===this.root?void 0:e.actual)}catch(e){n(e)}return oo(r)?r.catch(n).then(()=>{t.open(),this.updateExpandability(e)}):(t.open(),this.updateExpandability(e)),e.resolveBarrier}pushExpandStateUpdate(e){this.pushDiff({op:Vy.Update,item:{extId:e.fullId.toString(),expand:e.expand}})}removeItem(e){let t=this.tree.get(e);if(!t)throw Error(`attempting to remove non-existent child`);this.pushDiff({op:Vy.Remove,itemId:e});let n=[t];for(;n.length;){let e=n.pop();if(e){this.options.getApiFor(e.actual).listener=void 0;for(let t of e.actual.tags)this.decrementTagRefs(t.id);this.tree.delete(e.fullId.toString());for(let[t,r]of this.options.getChildren(e.actual))n.push(this.tree.get(dy.joinToString(e.fullId,r.id)))}}}flushDiff(){let e=this.collectDiff();e.length&&this.diffOpEmitter.fire(e)}},rb=class extends Error{constructor(e){super(`Attempted to insert a duplicate test item ID ${e}`)}},ib=class extends Error{constructor(e){super(`TestItem with ID "${e}" is invalid. Make sure to create it from the createTestItem method.`)}},ab=class extends Error{constructor(e,t,n){super(`TestItem with ID "${e}" is from controller "${t}" and cannot be added as a child of an item from controller "${n}".`)}};const ob=(e,t,n)=>{let r=new Map;return{get size(){return r.size},forEach(e,t){for(let n of r.values())e.call(t,n,this)},[Symbol.iterator](){return r.entries()},replace(i){let a=new Map,o=new Set(r.keys()),s={op:Zy.Bulk,ops:[]};for(let r of i){if(!(r instanceof n))throw new ib(r.id);let i=t(r).controllerId;if(i!==e.controllerId)throw new ab(r.id,i,e.controllerId);if(a.has(r.id))throw new rb(r.id);a.set(r.id,r),o.delete(r.id),s.ops.push({op:Zy.Upsert,item:r})}for(let e of o.keys())s.ops.push({op:Zy.RemoveChild,id:e});e.listener?.(s),r=a},add(t){if(!(t instanceof n))throw new ib(t.id);r.set(t.id,t),e.listener?.({op:Zy.Upsert,item:t})},delete(t){r.delete(t)&&e.listener?.({op:Zy.RemoveChild,id:t})},get(e){return r.get(e)},toJSON(){return Array.from(r.values())}}},sb=new WeakMap,cb=(e,t)=>{let n={controllerId:t};return sb.set(e,n),n},lb=e=>{let t=sb.get(e);if(!t)throw new ib(e?.id||`<unknown>`);return t};var ub;(function(e){e[e.WebSocket=0]=`WebSocket`,e[e.Managed=1]=`Managed`})(ub||={});var db=class{constructor(e){this.id=e,this.type=ub.Managed}toString(){return`Managed(${this.id})`}},fb=class{constructor(e,t){this.host=e,this.port=t,this.type=ub.WebSocket}toString(){return`WebSocket(${this.host}:${this.port})`}},pb;(function(e){e.Unknown=`Unknown`,e.NotAvailable=`NotAvailable`,e.TemporarilyNotAvailable=`TemporarilyNotAvailable`,e.NoResolverFound=`NoResolverFound`,e.InvalidAuthority=`InvalidAuthority`})(pb||={});function mb(e){let t=e.indexOf(`+`);return t===-1?e:e.substring(0,t)}var hb,gb,_b,vb,yb,bb,xb,Sb,Cb,wb,Tb,Eb,Db,Ob,kb,Ab,jb;function W(e){let t={apply:function(...t){if(t.length===0)return Reflect.construct(e,[]);{let n=t.length===1?[]:t[1];return Reflect.construct(e,n,t[0].constructor)}},call:function(...t){if(t.length===0)return Reflect.construct(e,[]);{let[n,...r]=t;return Reflect.construct(e,r,n.constructor)}}};return Object.assign(e,t)}var Mb;(function(e){e[e.Top=0]=`Top`,e[e.Bottom=1]=`Bottom`})(Mb||={});var Nb;(function(e){e[e.TerminalCommand=0]=`TerminalCommand`,e[e.Opener=1]=`Opener`,e[e.Command=3]=`Command`})(Nb||={});let Pb=hb=class{static from(...e){let t=e;return new hb(function(){if(t){for(let e of t)e&&typeof e.dispose==`function`&&e.dispose();t=void 0}})}#callOnDispose;constructor(e){this.#callOnDispose=e}dispose(){typeof this.#callOnDispose==`function`&&(this.#callOnDispose(),this.#callOnDispose=void 0)}};Pb=hb=A([W],Pb);let Fb=gb=class{static Min(...e){if(e.length===0)throw TypeError();let t=e[0];for(let n=1;n<e.length;n++){let r=e[n];r.isBefore(t)&&(t=r)}return t}static Max(...e){if(e.length===0)throw TypeError();let t=e[0];for(let n=1;n<e.length;n++){let r=e[n];r.isAfter(t)&&(t=r)}return t}static isPosition(e){if(!e)return!1;if(e instanceof gb)return!0;let{line:t,character:n}=e;return typeof t==`number`&&typeof n==`number`}static of(e){if(e instanceof gb)return e;if(this.isPosition(e))return new gb(e.line,e.character);throw Error(`Invalid argument, is NOT a position-like object`)}get line(){return this._line}get character(){return this._character}constructor(e,t){if(e<0)throw h(`line must be non-negative`);if(t<0)throw h(`character must be non-negative`);this._line=e,this._character=t}isBefore(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<e._character}isBeforeOrEqual(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<=e._character}isAfter(e){return!this.isBeforeOrEqual(e)}isAfterOrEqual(e){return!this.isBefore(e)}isEqual(e){return this._line===e._line&&this._character===e._character}compareTo(e){return this._line<e._line?-1:this._line>e.line?1:this._character<e._character?-1:this._character>e._character?1:0}translate(e,t=0){if(e===null||t===null)throw h();let n;return e===void 0?n=0:typeof e==`number`?n=e:(n=typeof e.lineDelta==`number`?e.lineDelta:0,t=typeof e.characterDelta==`number`?e.characterDelta:0),n===0&&t===0?this:new gb(this.line+n,this.character+t)}with(e,t=this.character){if(e===null||t===null)throw h();let n;return e===void 0?n=this.line:typeof e==`number`?n=e:(n=typeof e.line==`number`?e.line:this.line,t=typeof e.character==`number`?e.character:this.character),n===this.line&&t===this.character?this:new gb(n,t)}toJSON(){return{line:this.line,character:this.character}}[Symbol.for(`debug.description`)](){return`(${this.line}:${this.character})`}};Fb=gb=A([W],Fb);let Ib=_b=class{static isRange(e){return e instanceof _b?!0:e?Fb.isPosition(e.start)&&Fb.isPosition(e.end):!1}static of(e){if(e instanceof _b)return e;if(this.isRange(e))return new _b(e.start,e.end);throw Error(`Invalid argument, is NOT a range-like object`)}get start(){return this._start}get end(){return this._end}constructor(e,t,n,r){let i,a;if(typeof e==`number`&&typeof t==`number`&&typeof n==`number`&&typeof r==`number`?(i=new Fb(e,t),a=new Fb(n,r)):Fb.isPosition(e)&&Fb.isPosition(t)&&(i=Fb.of(e),a=Fb.of(t)),!i||!a)throw Error(`Invalid arguments`);i.isBefore(a)?(this._start=i,this._end=a):(this._start=a,this._end=i)}contains(e){return _b.isRange(e)?this.contains(e.start)&&this.contains(e.end):Fb.isPosition(e)?!(Fb.of(e).isBefore(this._start)||this._end.isBefore(e)):!1}isEqual(e){return this._start.isEqual(e._start)&&this._end.isEqual(e._end)}intersection(e){let t=Fb.Max(e.start,this._start),n=Fb.Min(e.end,this._end);if(!t.isAfter(n))return new _b(t,n)}union(e){if(this.contains(e))return this;if(e.contains(this))return e;let t=Fb.Min(e.start,this._start),n=Fb.Max(e.end,this.end);return new _b(t,n)}get isEmpty(){return this._start.isEqual(this._end)}get isSingleLine(){return this._start.line===this._end.line}with(e,t=this.end){if(e===null||t===null)throw h();let n;return e?Fb.isPosition(e)?n=e:(n=e.start||this.start,t=e.end||this.end):n=this.start,n.isEqual(this._start)&&t.isEqual(this.end)?this:new _b(n,t)}toJSON(){return[this.start,this.end]}[Symbol.for(`debug.description`)](){return Rb(this)}};Ib=_b=A([W],Ib);let Lb=vb=class extends Ib{static isSelection(e){return e instanceof vb?!0:e?Ib.isRange(e)&&Fb.isPosition(e.anchor)&&Fb.isPosition(e.active)&&typeof e.isReversed==`boolean`:!1}get anchor(){return this._anchor}get active(){return this._active}constructor(e,t,n,r){let i,a;if(typeof e==`number`&&typeof t==`number`&&typeof n==`number`&&typeof r==`number`?(i=new Fb(e,t),a=new Fb(n,r)):Fb.isPosition(e)&&Fb.isPosition(t)&&(i=Fb.of(e),a=Fb.of(t)),!i||!a)throw Error(`Invalid arguments`);super(i,a),this._anchor=i,this._active=a}get isReversed(){return this._anchor===this._end}toJSON(){return{start:this.start,end:this.end,active:this.active,anchor:this.anchor}}[Symbol.for(`debug.description`)](){return zb(this)}};Lb=vb=A([W],Lb);function Rb(e){return e.isEmpty?`[${e.start.line}:${e.start.character})`:`[${e.start.line}:${e.start.character} -> ${e.end.line}:${e.end.character})`}function zb(e){let t=Rb(e);return e.isEmpty||(t=e.active.isEqual(e.start)?`|${t}`:`${t}|`),t}const Bb=e=>{if(typeof e!=`string`||e.length===0||!/^[0-9A-Za-z_\-]+$/.test(e))throw h(`connectionToken`)};var Vb=class{static isResolvedAuthority(e){return e&&typeof e==`object`&&typeof e.host==`string`&&typeof e.port==`number`&&(e.connectionToken===void 0||typeof e.connectionToken==`string`)}constructor(e,t,n){if(typeof e!=`string`||e.length===0)throw h(`host`);if(typeof t!=`number`||t===0||Math.round(t)!==t)throw h(`port`);n!==void 0&&Bb(n),this.host=e,this.port=Math.round(t),this.connectionToken=n}},Hb=class{static isManagedResolvedAuthority(e){return e&&typeof e==`object`&&typeof e.makeConnection==`function`&&(e.connectionToken===void 0||typeof e.connectionToken==`string`)}constructor(e,t){this.makeConnection=e,this.connectionToken=t,t!==void 0&&Bb(t)}},Ub=class e extends Error{static NotAvailable(t,n){return new e(t,pb.NotAvailable,n)}static TemporarilyNotAvailable(t){return new e(t,pb.TemporarilyNotAvailable)}constructor(t,n=pb.Unknown,r){super(t),this._message=t,this._code=n,this._detail=r,Object.setPrototypeOf(this,e.prototype)}},Wb;(function(e){e[e.LF=1]=`LF`,e[e.CRLF=2]=`CRLF`})(Wb||={});var Gb;(function(e){e[e.Replace=1]=`Replace`,e[e.Append=2]=`Append`,e[e.Prepend=3]=`Prepend`})(Gb||={});let Kb=yb=class{static isTextEdit(e){return e instanceof yb?!0:e?Ib.isRange(e)&&typeof e.newText==`string`:!1}static replace(e,t){return new yb(e,t)}static insert(e,t){return yb.replace(new Ib(e,e),t)}static delete(e){return yb.replace(e,``)}static setEndOfLine(e){let t=new yb(new Ib(new Fb(0,0),new Fb(0,0)),``);return t.newEol=e,t}get range(){return this._range}set range(e){if(e&&!Ib.isRange(e))throw h(`range`);this._range=e}get newText(){return this._newText||``}set newText(e){if(e&&typeof e!=`string`)throw h(`newText`);this._newText=e}get newEol(){return this._newEol}set newEol(e){if(e&&typeof e!=`number`)throw h(`newEol`);this._newEol=e}constructor(e,t){this._range=e,this._newText=t}toJSON(){return{range:this.range,newText:this.newText,newEol:this._newEol}}};Kb=yb=A([W],Kb);let qb=bb=class{static isNotebookCellEdit(e){return e instanceof bb?!0:e?FC.isNotebookRange(e)&&Array.isArray(e.newCells):!1}static replaceCells(e,t){return new bb(e,t)}static insertCells(e,t){return new bb(new FC(e,e),t)}static deleteCells(e){return new bb(e,[])}static updateCellMetadata(e,t){let n=new bb(new FC(e,e),[]);return n.newCellMetadata=t,n}static updateNotebookMetadata(e){let t=new bb(new FC(0,0),[]);return t.newNotebookMetadata=e,t}constructor(e,t){this.range=e,this.newCells=t}};qb=bb=A([W],qb);var Jb=class e{static isSnippetTextEdit(t){return t instanceof e?!0:t?Ib.isRange(t.range)&&Zb.isSnippetString(t.snippet):!1}static replace(t,n){return new e(t,n)}static insert(t,n){return e.replace(new Ib(t,t),n)}constructor(e,t){this.range=e,this.snippet=t}},Yb;(function(e){e[e.File=1]=`File`,e[e.Text=2]=`Text`,e[e.Cell=3]=`Cell`,e[e.CellReplace=5]=`CellReplace`,e[e.Snippet=6]=`Snippet`})(Yb||={});let Xb=class{constructor(){this._edits=[]}_allEntries(){return this._edits}renameFile(e,t,n,r){this._edits.push({_type:Yb.File,from:e,to:t,options:n,metadata:r})}createFile(e,t,n){this._edits.push({_type:Yb.File,from:void 0,to:e,options:t,metadata:n})}deleteFile(e,t,n){this._edits.push({_type:Yb.File,from:e,to:void 0,options:t,metadata:n})}replaceNotebookMetadata(e,t,n){this._edits.push({_type:Yb.Cell,metadata:n,uri:e,edit:{editType:Yv.DocumentMetadata,metadata:t}})}replaceNotebookCells(e,t,n,r){let i=t.start,a=t.end;(i!==a||n.length>0)&&this._edits.push({_type:Yb.CellReplace,uri:e,index:i,count:a-i,cells:n,metadata:r})}replaceNotebookCellMetadata(e,t,n,r){this._edits.push({_type:Yb.Cell,metadata:r,uri:e,edit:{editType:Yv.Metadata,index:t,metadata:n}})}replace(e,t,n,r){this._edits.push({_type:Yb.Text,uri:e,edit:new Kb(t,n),metadata:r})}insert(e,t,n,r){this.replace(e,new Ib(t,t),n,r)}delete(e,t,n){this.replace(e,t,``,n)}has(e){return this._edits.some(t=>t._type===Yb.Text&&t.uri.toString()===e.toString())}set(e,t){if(t)for(let n of t){if(!n)continue;let t,r;Array.isArray(n)?(t=n[0],r=n[1]):t=n,qb.isNotebookCellEdit(t)?t.newCellMetadata?this.replaceNotebookCellMetadata(e,t.range.start,t.newCellMetadata,r):t.newNotebookMetadata?this.replaceNotebookMetadata(e,t.newNotebookMetadata,r):this.replaceNotebookCells(e,t.range,t.newCells,r):Jb.isSnippetTextEdit(t)?this._edits.push({_type:Yb.Snippet,uri:e,range:t.range,edit:t.snippet,metadata:r,keepWhitespace:t.keepWhitespace}):this._edits.push({_type:Yb.Text,uri:e,edit:t,metadata:r})}else{for(let t=0;t<this._edits.length;t++){let n=this._edits[t];switch(n._type){case Yb.Text:case Yb.Snippet:case Yb.Cell:case Yb.CellReplace:n.uri.toString()===e.toString()&&(this._edits[t]=void 0);break}}xe(this._edits)}}get(e){let t=[];for(let n of this._edits)n._type===Yb.Text&&n.uri.toString()===e.toString()&&t.push(n.edit);return t}entries(){let e=new ze;for(let t of this._edits)if(t._type===Yb.Text){let n=e.get(t.uri);n||(n=[t.uri,[]],e.set(t.uri,n)),n[1].push(t.edit)}return[...e.values()]}get size(){return this.entries().length}toJSON(){return this.entries()}};Xb=A([W],Xb);let Zb=xb=class{static isSnippetString(e){return e instanceof xb?!0:e?typeof e.value==`string`:!1}static _escape(e){return e.replace(/\$|}|\\/g,`\\$&`)}constructor(e){this._tabstop=1,this.value=e||``}appendText(e){return this.value+=xb._escape(e),this}appendTabstop(e=this._tabstop++){return this.value+=`$`,this.value+=e,this}appendPlaceholder(e,t=this._tabstop++){if(typeof e==`function`){let t=new xb;t._tabstop=this._tabstop,e(t),this._tabstop=t._tabstop,e=t.value}else e=xb._escape(e);return this.value+="${",this.value+=t,this.value+=`:`,this.value+=e,this.value+=`}`,this}appendChoice(e,t=this._tabstop++){let n=e.map(e=>e.replaceAll(/[|\\,]/g,`\\$&`)).join(`,`);return this.value+="${",this.value+=t,this.value+=`|`,this.value+=n,this.value+=`|}`,this}appendVariable(e,t){if(typeof t==`function`){let e=new xb;e._tabstop=this._tabstop,t(e),this._tabstop=e._tabstop,t=e.value}else typeof t==`string`&&(t=t.replace(/\$|}/g,`\\$&`));return this.value+="${",this.value+=e,t&&(this.value+=`:`,this.value+=t),this.value+=`}`,this}};Zb=xb=A([W],Zb);var Qb;(function(e){e[e.Unnecessary=1]=`Unnecessary`,e[e.Deprecated=2]=`Deprecated`})(Qb||={});var $b;(function(e){e[e.Hint=3]=`Hint`,e[e.Information=2]=`Information`,e[e.Warning=1]=`Warning`,e[e.Error=0]=`Error`})($b||={});let ex=Sb=class{static isLocation(e){return e instanceof Sb?!0:e?Ib.isRange(e.range)&&w.isUri(e.uri):!1}constructor(e,t){if(this.uri=e,t)if(Ib.isRange(t))this.range=Ib.of(t);else if(Fb.isPosition(t))this.range=new Ib(t,t);else throw Error(`Illegal argument`)}toJSON(){return{uri:this.uri,range:this.range}}};ex=Sb=A([W],ex);let tx=class{static is(e){return e?typeof e.message==`string`&&e.location&&Ib.isRange(e.location.range)&&w.isUri(e.location.uri):!1}constructor(e,t){this.location=e,this.message=t}static isEqual(e,t){return e===t?!0:!e||!t?!1:e.message===t.message&&e.location.range.isEqual(t.location.range)&&e.location.uri.toString()===t.location.uri.toString()}};tx=A([W],tx);let nx=class{constructor(e,t,n=$b.Error){if(!Ib.isRange(e))throw TypeError(`range must be set`);if(!t)throw TypeError(`message must be set`);this.range=e,this.message=t,this.severity=n}toJSON(){return{severity:$b[this.severity],message:this.message,range:this.range,source:this.source,code:this.code}}static isEqual(e,t){return e===t?!0:!e||!t?!1:e.message===t.message&&e.severity===t.severity&&e.code===t.code&&e.severity===t.severity&&e.source===t.source&&e.range.isEqual(t.range)&&ge(e.tags,t.tags)&&ge(e.relatedInformation,t.relatedInformation,tx.isEqual)}};nx=A([W],nx);let rx=class{constructor(e,t){if(!e)throw Error(`Illegal argument, contents must be defined`);Array.isArray(e)?this.contents=e:this.contents=[e],this.range=t}};rx=A([W],rx);let ix=class extends rx{constructor(e,t,n,r){super(e,t),this.canIncreaseVerbosity=n,this.canDecreaseVerbosity=r}};ix=A([W],ix);var ax;(function(e){e[e.Increase=0]=`Increase`,e[e.Decrease=1]=`Decrease`})(ax||={});var ox;(function(e){e[e.Text=0]=`Text`,e[e.Read=1]=`Read`,e[e.Write=2]=`Write`})(ox||={});let sx=class{constructor(e,t=ox.Text){this.range=e,this.kind=t}toJSON(){return{range:this.range,kind:ox[this.kind]}}};sx=A([W],sx);let cx=class{constructor(e,t){this.uri=e,this.highlights=t}toJSON(){return{uri:this.uri,highlights:this.highlights.map(e=>e.toJSON())}}};cx=A([W],cx);var lx;(function(e){e[e.File=0]=`File`,e[e.Module=1]=`Module`,e[e.Namespace=2]=`Namespace`,e[e.Package=3]=`Package`,e[e.Class=4]=`Class`,e[e.Method=5]=`Method`,e[e.Property=6]=`Property`,e[e.Field=7]=`Field`,e[e.Constructor=8]=`Constructor`,e[e.Enum=9]=`Enum`,e[e.Interface=10]=`Interface`,e[e.Function=11]=`Function`,e[e.Variable=12]=`Variable`,e[e.Constant=13]=`Constant`,e[e.String=14]=`String`,e[e.Number=15]=`Number`,e[e.Boolean=16]=`Boolean`,e[e.Array=17]=`Array`,e[e.Object=18]=`Object`,e[e.Key=19]=`Key`,e[e.Null=20]=`Null`,e[e.EnumMember=21]=`EnumMember`,e[e.Struct=22]=`Struct`,e[e.Event=23]=`Event`,e[e.Operator=24]=`Operator`,e[e.TypeParameter=25]=`TypeParameter`})(lx||={});var ux;(function(e){e[e.Deprecated=1]=`Deprecated`})(ux||={});let dx=Cb=class{static validate(e){if(!e.name)throw Error(`name must not be falsy`)}constructor(e,t,n,r,i){this.name=e,this.kind=t,this.containerName=i,typeof n==`string`&&(this.containerName=n),r instanceof ex?this.location=r:n instanceof Ib&&(this.location=new ex(r,n)),Cb.validate(this)}toJSON(){return{name:this.name,kind:lx[this.kind],location:this.location,containerName:this.containerName}}};dx=Cb=A([W],dx);let fx=wb=class{static validate(e){if(!e.name)throw Error(`name must not be falsy`);if(!e.range.contains(e.selectionRange))throw Error(`selectionRange must be contained in fullRange`);e.children?.forEach(wb.validate)}constructor(e,t,n,r,i){this.name=e,this.detail=t,this.kind=n,this.range=r,this.selectionRange=i,this.children=[],wb.validate(this)}};fx=wb=A([W],fx);var px;(function(e){e[e.Invoke=1]=`Invoke`,e[e.Automatic=2]=`Automatic`})(px||={});let mx=class{constructor(e,t){this.title=e,this.kind=t}};mx=A([W],mx);let hx=class{static{Tb=this}static{this.sep=`.`}constructor(e){this.value=e}append(e){return new Tb(this.value?this.value+Tb.sep+e:e)}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+Tb.sep)}};hx=Tb=A([W],hx),hx.Empty=new hx(``),hx.QuickFix=hx.Empty.append(`quickfix`),hx.Refactor=hx.Empty.append(`refactor`),hx.RefactorExtract=hx.Refactor.append(`extract`),hx.RefactorInline=hx.Refactor.append(`inline`),hx.RefactorMove=hx.Refactor.append(`move`),hx.RefactorRewrite=hx.Refactor.append(`rewrite`),hx.Source=hx.Empty.append(`source`),hx.SourceOrganizeImports=hx.Source.append(`organizeImports`),hx.SourceFixAll=hx.Source.append(`fixAll`),hx.Notebook=hx.Empty.append(`notebook`);let gx=class{constructor(e,t){if(this.range=e,this.parent=t,t&&!t.range.contains(this.range))throw Error(`Invalid argument: parent must contain this range`)}};gx=A([W],gx);var _x=class{constructor(e,t,n,r,i,a){this.kind=e,this.name=t,this.detail=n,this.uri=r,this.range=i,this.selectionRange=a}},vx=class{constructor(e,t){this.fromRanges=t,this.from=e}},yx=class{constructor(e,t){this.fromRanges=t,this.to=e}},bx;(function(e){e[e.Information=0]=`Information`,e[e.Warning=1]=`Warning`,e[e.Error=2]=`Error`})(bx||={});let xx=class{constructor(e,t){this.range=e,this.command=t}get isResolved(){return!!this.command}};xx=A([W],xx);let Sx=Eb=class{#delegate;static isMarkdownString(e){return e instanceof Eb?!0:e&&e.appendCodeblock&&e.appendMarkdown&&e.appendText&&e.value!==void 0}constructor(e,t=!1){this.#delegate=new _l(e,{supportThemeIcons:t})}get value(){return this.#delegate.value}set value(e){this.#delegate.value=e}get isTrusted(){return this.#delegate.isTrusted}set isTrusted(e){this.#delegate.isTrusted=e}get supportThemeIcons(){return this.#delegate.supportThemeIcons}set supportThemeIcons(e){this.#delegate.supportThemeIcons=e}get supportHtml(){return this.#delegate.supportHtml}set supportHtml(e){this.#delegate.supportHtml=e}get baseUri(){return this.#delegate.baseUri}set baseUri(e){this.#delegate.baseUri=e}appendText(e){return this.#delegate.appendText(e),this}appendMarkdown(e){return this.#delegate.appendMarkdown(e),this}appendCodeblock(e,t){return this.#delegate.appendCodeblock(t??``,e),this}};Sx=Eb=A([W],Sx);let Cx=class{constructor(e,t){this.label=e,this.documentation=t}};Cx=A([W],Cx);let wx=class{constructor(e,t){this.label=e,this.documentation=t,this.parameters=[]}};wx=A([W],wx);let Tx=class{constructor(){this.activeSignature=0,this.activeParameter=0,this.signatures=[]}};Tx=A([W],Tx);var Ex;(function(e){e[e.Invoke=1]=`Invoke`,e[e.TriggerCharacter=2]=`TriggerCharacter`,e[e.ContentChange=3]=`ContentChange`})(Ex||={});var Dx;(function(e){e[e.Type=1]=`Type`,e[e.Parameter=2]=`Parameter`})(Dx||={});let Ox=class{constructor(e){this.value=e}};Ox=A([W],Ox);let kx=class{constructor(e,t,n){this.position=e,this.label=t,this.kind=n}};kx=A([W],kx);var Ax;(function(e){e[e.Invoke=0]=`Invoke`,e[e.TriggerCharacter=1]=`TriggerCharacter`,e[e.TriggerForIncompleteCompletions=2]=`TriggerForIncompleteCompletions`})(Ax||={});var G;(function(e){e[e.Text=0]=`Text`,e[e.Method=1]=`Method`,e[e.Function=2]=`Function`,e[e.Constructor=3]=`Constructor`,e[e.Field=4]=`Field`,e[e.Variable=5]=`Variable`,e[e.Class=6]=`Class`,e[e.Interface=7]=`Interface`,e[e.Module=8]=`Module`,e[e.Property=9]=`Property`,e[e.Unit=10]=`Unit`,e[e.Value=11]=`Value`,e[e.Enum=12]=`Enum`,e[e.Keyword=13]=`Keyword`,e[e.Snippet=14]=`Snippet`,e[e.Color=15]=`Color`,e[e.File=16]=`File`,e[e.Reference=17]=`Reference`,e[e.Folder=18]=`Folder`,e[e.EnumMember=19]=`EnumMember`,e[e.Constant=20]=`Constant`,e[e.Struct=21]=`Struct`,e[e.Event=22]=`Event`,e[e.Operator=23]=`Operator`,e[e.TypeParameter=24]=`TypeParameter`,e[e.User=25]=`User`,e[e.Issue=26]=`Issue`})(G||={});var jx;(function(e){e[e.Deprecated=1]=`Deprecated`})(jx||={});let Mx=class{constructor(e,t){this.label=e,this.kind=t}toJSON(){return{label:this.label,kind:this.kind&&G[this.kind],detail:this.detail,documentation:this.documentation,sortText:this.sortText,filterText:this.filterText,preselect:this.preselect,insertText:this.insertText,textEdit:this.textEdit}}};Mx=A([W],Mx);let Nx=class{constructor(e=[],t=!1){this.items=e,this.isIncomplete=t}};Nx=A([W],Nx);let Px=class{constructor(e,t,n){this.insertText=e,this.range=t,this.command=n}};Px=A([W],Px);let Fx=class{constructor(e){this.commands=void 0,this.suppressSuggestions=void 0,this.items=e}};Fx=A([W],Fx);var Ix;(function(e){e[e.Unknown=0]=`Unknown`,e[e.Word=1]=`Word`,e[e.Line=2]=`Line`,e[e.Suggest=3]=`Suggest`})(Ix||={});var Lx;(function(e){e[e.Accepted=0]=`Accepted`,e[e.Rejected=1]=`Rejected`,e[e.Ignored=2]=`Ignored`})(Lx||={});var Rx;(function(e){e[e.Active=-1]=`Active`,e[e.Beside=-2]=`Beside`,e[e.One=1]=`One`,e[e.Two=2]=`Two`,e[e.Three=3]=`Three`,e[e.Four=4]=`Four`,e[e.Five=5]=`Five`,e[e.Six=6]=`Six`,e[e.Seven=7]=`Seven`,e[e.Eight=8]=`Eight`,e[e.Nine=9]=`Nine`})(Rx||={});var zx;(function(e){e[e.Left=1]=`Left`,e[e.Right=2]=`Right`})(zx||={});function Bx(e,t){return`${ms.toKey(e)}.${t}`}var Vx;(function(e){e[e.Off=0]=`Off`,e[e.On=1]=`On`,e[e.Relative=2]=`Relative`,e[e.Interval=3]=`Interval`})(Vx||={});var Hx;(function(e){e[e.Manual=1]=`Manual`,e[e.AfterDelay=2]=`AfterDelay`,e[e.FocusOut=3]=`FocusOut`})(Hx||={});var Ux;(function(e){e[e.Default=0]=`Default`,e[e.InCenter=1]=`InCenter`,e[e.InCenterIfOutsideViewport=2]=`InCenterIfOutsideViewport`,e[e.AtTop=3]=`AtTop`})(Ux||={});var Wx;(function(e){e[e.Keyboard=1]=`Keyboard`,e[e.Mouse=2]=`Mouse`,e[e.Command=3]=`Command`})(Wx||={});var Gx;(function(e){e[e.Addition=1]=`Addition`,e[e.Deletion=2]=`Deletion`,e[e.Modification=3]=`Modification`})(Gx||={});var Kx;(function(e){e[e.Undo=1]=`Undo`,e[e.Redo=2]=`Redo`})(Kx||={});var qx;(function(e){e[e.OpenOpen=0]=`OpenOpen`,e[e.ClosedClosed=1]=`ClosedClosed`,e[e.OpenClosed=2]=`OpenClosed`,e[e.ClosedOpen=3]=`ClosedOpen`})(qx||={}),(function(e){function t(t){switch(t){case`keyboard`:return e.Keyboard;case`mouse`:return e.Mouse;case A_.PROGRAMMATIC:case A_.JUMP:case A_.NAVIGATION:return e.Command}}e.fromValue=t})(Wx||={});var Jx;(function(e){e[e.Other=0]=`Other`,e[e.Comment=1]=`Comment`,e[e.String=2]=`String`,e[e.RegEx=3]=`RegEx`})(Jx||={}),(function(e){function t(t){switch(t){case e.Other:return`other`;case e.Comment:return`comment`;case e.String:return`string`;case e.RegEx:return`regex`}return`other`}e.toString=t})(Jx||={});let Yx=class{constructor(e,t){if(t&&!w.isUri(t))throw h(`target`);if(!Ib.isRange(e)||e.isEmpty)throw h(`range`);this.range=e,this.target=t}};Yx=A([W],Yx);let Xx=class{constructor(e,t,n,r){this.red=e,this.green=t,this.blue=n,this.alpha=r}};Xx=A([W],Xx);let Zx=class{constructor(e,t){if(t&&!(t instanceof Xx))throw h(`color`);if(!Ib.isRange(e)||e.isEmpty)throw h(`range`);this.range=e,this.color=t}};Zx=A([W],Zx);let Qx=class{constructor(e){if(!e||typeof e!=`string`)throw h(`label`);this.label=e}};Qx=A([W],Qx);var $x;(function(e){e[e.RGB=0]=`RGB`,e[e.HEX=1]=`HEX`,e[e.HSL=2]=`HSL`})($x||={});var eS;(function(e){e[e.Error=0]=`Error`,e[e.Warning=1]=`Warning`,e[e.Information=2]=`Information`})(eS||={});var tS;(function(e){e[e.Unknown=0]=`Unknown`,e[e.Shutdown=1]=`Shutdown`,e[e.Process=2]=`Process`,e[e.User=3]=`User`,e[e.Extension=4]=`Extension`})(tS||={});var nS;(function(e){e[e.Low=0]=`Low`,e[e.Medium=1]=`Medium`,e[e.High=2]=`High`})(nS||={});var rS;(function(e){e[e.Sh=1]=`Sh`,e[e.Bash=2]=`Bash`,e[e.Fish=3]=`Fish`,e[e.Csh=4]=`Csh`,e[e.Ksh=5]=`Ksh`,e[e.Zsh=6]=`Zsh`,e[e.CommandPrompt=7]=`CommandPrompt`,e[e.GitBash=8]=`GitBash`,e[e.PowerShell=9]=`PowerShell`,e[e.Python=10]=`Python`,e[e.Julia=11]=`Julia`,e[e.NuShell=12]=`NuShell`,e[e.Node=13]=`Node`})(rS||={});var iS=class{constructor(e,t,n){if(this.startIndex=e,this.length=t,this.tooltip=n,typeof e!=`number`||e<0)throw h(`startIndex`);if(typeof t!=`number`||t<1)throw h(`length`);if(n!==void 0&&typeof n!=`string`)throw h(`tooltip`)}},aS=class{constructor(e){this.uri=e}},oS=class{constructor(e){this.terminalCommand=e}},sS;(function(e){e[e.Panel=1]=`Panel`,e[e.Editor=2]=`Editor`})(sS||={});var cS=class{constructor(e){if(this.options=e,typeof e!=`object`)throw h(`options`)}},lS;(function(e){e[e.File=0]=`File`,e[e.Folder=1]=`Folder`,e[e.Method=2]=`Method`,e[e.Alias=3]=`Alias`,e[e.Argument=4]=`Argument`,e[e.Option=5]=`Option`,e[e.OptionValue=6]=`OptionValue`,e[e.Flag=7]=`Flag`,e[e.SymbolicLinkFile=8]=`SymbolicLinkFile`,e[e.SymbolicLinkFolder=9]=`SymbolicLinkFolder`})(lS||={});var uS=class{constructor(e,t,n,r,i,a,o,s,c){this.label=e,this.icon=t,this.detail=n,this.documentation=r,this.isFile=i,this.isDirectory=a,this.isKeyword=o,this.replacementIndex=s??0,this.replacementLength=c??0}},dS=class{constructor(e,t){this.items=e??[],this.resourceRequestConfig=t}},fS;(function(e){e[e.Always=1]=`Always`,e[e.Silent=2]=`Silent`,e[e.Never=3]=`Never`})(fS||={});var pS;(function(e){e.Changed=`changed`,e.ProcessStarted=`processStarted`,e.ProcessEnded=`processEnded`,e.Terminated=`terminated`,e.Start=`start`,e.AcquiredInput=`acquiredInput`,e.DependsOnStarted=`dependsOnStarted`,e.Active=`active`,e.Inactive=`inactive`,e.End=`end`,e.ProblemMatcherStarted=`problemMatcherStarted`,e.ProblemMatcherEnded=`problemMatcherEnded`,e.ProblemMatcherFoundErrors=`problemMatcherFoundErrors`})(pS||={});var mS;(function(e){e[e.Shared=1]=`Shared`,e[e.Dedicated=2]=`Dedicated`,e[e.New=3]=`New`})(mS||={});let hS=class{static{Db=this}static{this.Clean=new Db(`clean`,`Clean`)}static{this.Build=new Db(`build`,`Build`)}static{this.Rebuild=new Db(`rebuild`,`Rebuild`)}static{this.Test=new Db(`test`,`Test`)}static from(e){switch(e){case`clean`:return Db.Clean;case`build`:return Db.Build;case`rebuild`:return Db.Rebuild;case`test`:return Db.Test;default:return}}constructor(e,t){if(this.label=t,typeof e!=`string`||typeof t!=`string`)throw h(`name`);this._id=e}get id(){return this._id}};hS=Db=A([W],hS);function gS(e){let t=``;for(let n=0;n<e.length;n++)t+=e[n].replace(/,/g,`,,`)+`,`;return t}let _S=class{constructor(e,t,n){if(typeof e!=`string`)throw h(`process`);this._args=[],this._process=e,t!==void 0&&(Array.isArray(t)?(this._args=t,this._options=n):this._options=t)}get process(){return this._process}set process(e){if(typeof e!=`string`)throw h(`process`);this._process=e}get args(){return this._args}set args(e){Array.isArray(e)||(e=[]),this._args=e}get options(){return this._options}set options(e){this._options=e}computeId(){let e=[];if(e.push(`process`),this._process!==void 0&&e.push(this._process),this._args&&this._args.length>0)for(let t of this._args)e.push(t);return gS(e)}};_S=A([W],_S);let vS=class{constructor(e,t,n){if(this._args=[],Array.isArray(t)){if(!e)throw h(`command can't be undefined or null`);if(typeof e!=`string`&&typeof e.value!=`string`)throw h(`command`);this._command=e,t&&(this._args=t),this._options=n}else{if(typeof e!=`string`)throw h(`commandLine`);this._commandLine=e,this._options=t}}get commandLine(){return this._commandLine}set commandLine(e){if(typeof e!=`string`)throw h(`commandLine`);this._commandLine=e}get command(){return this._command?this._command:``}set command(e){if(typeof e!=`string`&&typeof e.value!=`string`)throw h(`command`);this._command=e}get args(){return this._args}set args(e){this._args=e||[]}get options(){return this._options}set options(e){this._options=e}computeId(){let e=[];if(e.push(`shell`),this._commandLine!==void 0&&e.push(this._commandLine),this._command!==void 0&&e.push(typeof this._command==`string`?this._command:this._command.value),this._args&&this._args.length>0)for(let t of this._args)e.push(typeof t==`string`?t:t.value);return gS(e)}};vS=A([W],vS);var yS;(function(e){e[e.Escape=1]=`Escape`,e[e.Strong=2]=`Strong`,e[e.Weak=3]=`Weak`})(yS||={});var bS;(function(e){e[e.Global=1]=`Global`,e[e.Workspace=2]=`Workspace`})(bS||={});var xS=class{constructor(e){this._callback=e}computeId(){return`customExecution`+Nc()}set callback(e){this._callback=e}get callback(){return this._callback}};let SS=class{static{Ob=this}static{this.ExtensionCallbackType=`customExecution`}static{this.ProcessType=`process`}static{this.ShellType=`shell`}static{this.EmptyType=`$empty`}constructor(e,t,n,r,i,a){this.__deprecated=!1,this._definition=this.definition=e;let o;typeof t==`string`?(this._name=this.name=t,this._source=this.source=n,this.execution=r,o=i,this.__deprecated=!0):(t===bS.Global||bS.Workspace,this.target=t,this._name=this.name=n,this._source=this.source=r,this.execution=i,o=a),typeof o==`string`?(this._problemMatchers=[o],this._hasDefinedMatchers=!0):Array.isArray(o)?(this._problemMatchers=o,this._hasDefinedMatchers=!0):(this._problemMatchers=[],this._hasDefinedMatchers=!1),this._isBackground=!1,this._presentationOptions=Object.create(null),this._runOptions=Object.create(null)}get _id(){return this.__id}set _id(e){this.__id=e}get _deprecated(){return this.__deprecated}clear(){this.__id!==void 0&&(this.__id=void 0,this._scope=void 0,this.computeDefinitionBasedOnExecution())}computeDefinitionBasedOnExecution(){this._execution instanceof _S?this._definition={type:Ob.ProcessType,id:this._execution.computeId()}:this._execution instanceof vS?this._definition={type:Ob.ShellType,id:this._execution.computeId()}:this._execution instanceof xS?this._definition={type:Ob.ExtensionCallbackType,id:this._execution.computeId()}:this._definition={type:Ob.EmptyType,id:Nc()}}get definition(){return this._definition}set definition(e){if(e==null)throw h(`Kind can't be undefined or null`);this.clear(),this._definition=e}get scope(){return this._scope}set target(e){this.clear(),this._scope=e}get name(){return this._name}set name(e){if(typeof e!=`string`)throw h(`name`);this.clear(),this._name=e}get execution(){return this._execution}set execution(e){e===null&&(e=void 0),this.clear(),this._execution=e;let t=this._definition.type;(Ob.EmptyType===t||Ob.ProcessType===t||Ob.ShellType===t||Ob.ExtensionCallbackType===t)&&this.computeDefinitionBasedOnExecution()}get problemMatchers(){return this._problemMatchers}set problemMatchers(e){if(Array.isArray(e))this.clear(),this._problemMatchers=e,this._hasDefinedMatchers=!0;else{this.clear(),this._problemMatchers=[],this._hasDefinedMatchers=!1;return}}get hasDefinedMatchers(){return this._hasDefinedMatchers}get isBackground(){return this._isBackground}set isBackground(e){e!==!0&&e!==!1&&(e=!1),this.clear(),this._isBackground=e}get source(){return this._source}set source(e){if(typeof e!=`string`||e.length===0)throw h(`source must be a string of length > 0`);this.clear(),this._source=e}get group(){return this._group}set group(e){e===null&&(e=void 0),this.clear(),this._group=e}get detail(){return this._detail}set detail(e){e===null&&(e=void 0),this._detail=e}get presentationOptions(){return this._presentationOptions}set presentationOptions(e){e??=Object.create(null),this.clear(),this._presentationOptions=e}get runOptions(){return this._runOptions}set runOptions(e){e??=Object.create(null),this.clear(),this._runOptions=e}};SS=Ob=A([W],SS);var CS;(function(e){e[e.SourceControl=1]=`SourceControl`,e[e.Window=10]=`Window`,e[e.Notification=15]=`Notification`})(CS||={});var wS;(function(e){function t(e){let t=e;return tt(t.value)?t.tooltip&&!Ze(t.tooltip)?(console.log(`INVALID view badge, invalid tooltip`,t.tooltip),!1):!0:(console.log(`INVALID view badge, invalid value`,t.value),!1)}e.isViewBadge=t})(wS||={});let TS=kb=class{static isTreeItem(e,t){let n=e;if(n.checkboxState!==void 0){let e=tt(n.checkboxState)?n.checkboxState:$e(n.checkboxState)&&tt(n.checkboxState.state)?n.checkboxState.state:void 0,t=!tt(n.checkboxState)&&$e(n.checkboxState)?n.checkboxState.tooltip:void 0;if(e===void 0||e!==DS.Checked&&e!==DS.Unchecked||t!==void 0&&!Ze(t))return console.log(`INVALID tree item, invalid checkboxState`,n.checkboxState),!1}if(e instanceof kb)return!0;if(n.label!==void 0&&!Ze(n.label)&&!n.label?.label)return console.log(`INVALID tree item, invalid label`,n.label),!1;if(n.id!==void 0&&!Ze(n.id))return console.log(`INVALID tree item, invalid id`,n.id),!1;if(n.iconPath!==void 0&&!Ze(n.iconPath)&&!w.isUri(n.iconPath)&&(!n.iconPath||!Ze(n.iconPath.id))){let e=n.iconPath;if(!e||!Ze(e.light)&&!w.isUri(e.light)&&!Ze(e.dark)&&!w.isUri(e.dark))return console.log(`INVALID tree item, invalid iconPath`,n.iconPath),!1}return n.description!==void 0&&!Ze(n.description)&&typeof n.description!=`boolean`?(console.log(`INVALID tree item, invalid description`,n.description),!1):n.resourceUri!==void 0&&!w.isUri(n.resourceUri)?(console.log(`INVALID tree item, invalid resourceUri`,n.resourceUri),!1):n.tooltip!==void 0&&!Ze(n.tooltip)&&!(n.tooltip instanceof Sx)?(console.log(`INVALID tree item, invalid tooltip`,n.tooltip),!1):n.command!==void 0&&!n.command.command?(console.log(`INVALID tree item, invalid command`,n.command),!1):n.collapsibleState!==void 0&&n.collapsibleState<ES.None&&n.collapsibleState>ES.Expanded?(console.log(`INVALID tree item, invalid collapsibleState`,n.collapsibleState),!1):n.contextValue!==void 0&&!Ze(n.contextValue)?(console.log(`INVALID tree item, invalid contextValue`,n.contextValue),!1):n.accessibilityInformation!==void 0&&!n.accessibilityInformation?.label?(console.log(`INVALID tree item, invalid accessibilityInformation`,n.accessibilityInformation),!1):!0}constructor(e,t=ES.None){this.collapsibleState=t,w.isUri(e)?this.resourceUri=e:this.label=e}};TS=kb=A([W],TS);var ES;(function(e){e[e.None=0]=`None`,e[e.Collapsed=1]=`Collapsed`,e[e.Expanded=2]=`Expanded`})(ES||={});var DS;(function(e){e[e.Unchecked=0]=`Unchecked`,e[e.Checked=1]=`Checked`})(DS||={});let OS=class{async asString(){return typeof this.value==`string`?this.value:JSON.stringify(this.value)}asFile(){}constructor(e){this.value=e}};OS=A([W],OS);var kS=class extends OS{},AS=class extends kS{#file;constructor(e){super(``),this.#file=e}asFile(){return this.#file}},jS=class{constructor(e,t,n,r){this.name=e,this.uri=t,this._itemId=n,this._getData=r}data(){return this._getData()}};let MS=class{#items=new Map;constructor(e){for(let[t,n]of e??[]){let e=this.#items.get(this.#normalizeMime(t));e?e.push(n):this.#items.set(this.#normalizeMime(t),[n])}}get(e){return this.#items.get(this.#normalizeMime(e))?.[0]}set(e,t){this.#items.set(this.#normalizeMime(e),[t])}forEach(e,t){for(let[n,r]of this.#items)for(let i of r)e.call(t,i,n,this)}*[Symbol.iterator](){for(let[e,t]of this.#items)for(let n of t)yield[e,n]}#normalizeMime(e){return e.toLowerCase()}};MS=A([W],MS);let NS=class{constructor(e,t,n){this.insertText=e,this.title=t,this.kind=n}};NS=A([W],NS);var PS;(function(e){e[e.Automatic=0]=`Automatic`,e[e.PasteAs=1]=`PasteAs`})(PS||={});var FS=class e{static{this.sep=`.`}constructor(e){this.value=e}append(...t){return new e((this.value?[this.value,...t]:t).join(e.sep))}intersects(e){return this.contains(e)||e.contains(this)}contains(t){return this.value===t.value||t.value.startsWith(this.value+e.sep)}};FS.Empty=new FS(``),FS.Text=new FS(`text`),FS.TextUpdateImports=FS.Text.append(`updateImports`);var IS=class{constructor(e,t,n){this.title=t,this.insertText=e,this.kind=n}};let LS=class{constructor(e,t){this.id=e,this.color=t}static isThemeIcon(e){return typeof e.id==`string`?!0:(console.log(`INVALID ThemeIcon, invalid id`,e.id),!1)}};LS=A([W],LS),LS.File=new LS(`file`),LS.Folder=new LS(`folder`);let RS=class{constructor(e){this.id=e}};RS=A([W],RS);var zS;(function(e){e[e.Global=1]=`Global`,e[e.Workspace=2]=`Workspace`,e[e.WorkspaceFolder=3]=`WorkspaceFolder`})(zS||={});let BS=class{get base(){return this._base}set base(e){this._base=e,this._baseUri=w.file(e)}get baseUri(){return this._baseUri}set baseUri(e){this._baseUri=e,this._base=e.fsPath}constructor(e,t){if(typeof e!=`string`&&(!e||!w.isUri(e)&&!w.isUri(e.uri)))throw h(`base`);if(typeof t!=`string`)throw h(`pattern`);typeof e==`string`?this.baseUri=w.file(e):w.isUri(e)?this.baseUri=e:this.baseUri=e.uri,this.pattern=t}toJSON(){return{pattern:this.pattern,base:this.base,baseUri:this.baseUri.toJSON()}}};BS=A([W],BS);const VS=new WeakMap;function HS(e,t){VS.set(e,t)}let US=class{constructor(e,t,n,r,i){this.enabled=typeof e==`boolean`?e:!0,typeof t==`string`&&(this.condition=t),typeof n==`string`&&(this.hitCondition=n),typeof r==`string`&&(this.logMessage=r),typeof i==`string`&&(this.mode=i)}get id(){return this._id||=VS.get(this)??Nc(),this._id}};US=A([W],US);let WS=class extends US{constructor(e,t,n,r,i,a){if(super(t,n,r,i,a),e===null)throw h(`location`);this.location=e}};WS=A([W],WS);let GS=class extends US{constructor(e,t,n,r,i,a){super(t,n,r,i,a),this.functionName=e}};GS=A([W],GS);let KS=class extends US{constructor(e,t,n,r,i,a,o,s){if(super(r,i,a,o,s),!t)throw h(`dataId`);this.label=e,this.dataId=t,this.canPersist=n}};KS=A([W],KS);let qS=class{constructor(e,t,n){this.command=e,this.args=t||[],this.options=n}};qS=A([W],qS);let JS=class{constructor(e,t){this.port=e,this.host=t}};JS=A([W],JS);let YS=class{constructor(e){this.path=e}};YS=A([W],YS);let XS=class{constructor(e){this.implementation=e}};XS=A([W],XS);var ZS=class{constructor(e,t,n){this.session=e,this.threadId=t,this.frameId=n}},QS=class{constructor(e,t){this.session=e,this.threadId=t}};let $S=class{constructor(e,t){this.range=e,this.expression=t}};$S=A([W],$S);var eC;(function(e){e[e.Invoke=0]=`Invoke`,e[e.Automatic=1]=`Automatic`})(eC||={});var tC;(function(e){e[e.Other=0]=`Other`,e[e.Empty=1]=`Empty`,e[e.TokenCancellation=2]=`TokenCancellation`,e[e.LostRace=3]=`LostRace`,e[e.NotTaken=4]=`NotTaken`})(tC||={});let nC=class{constructor(e,t){this.range=e,this.text=t}};nC=A([W],nC);let rC=class{constructor(e,t,n=!0){this.range=e,this.variableName=t,this.caseSensitiveLookup=n}};rC=A([W],rC);let iC=class{constructor(e,t){this.range=e,this.expression=t}};iC=A([W],iC);let aC=class{constructor(e,t){this.frameId=e,this.stoppedLocation=t}};aC=A([W],aC);var oC;(function(e){e[e.AIGenerated=1]=`AIGenerated`})(oC||={});var sC;(function(e){e[e.Invoke=0]=`Invoke`,e[e.Automatic=1]=`Automatic`})(sC||={});var cC=class{constructor(e,t){this.newSymbolName=e,this.tags=t}},lC;(function(e){e[e.Changed=1]=`Changed`,e[e.Created=2]=`Created`,e[e.Deleted=3]=`Deleted`})(lC||={});let uC=Ab=class extends Error{static FileExists(e){return new Ab(e,lc.FileExists,Ab.FileExists)}static FileNotFound(e){return new Ab(e,lc.FileNotFound,Ab.FileNotFound)}static FileNotADirectory(e){return new Ab(e,lc.FileNotADirectory,Ab.FileNotADirectory)}static FileIsADirectory(e){return new Ab(e,lc.FileIsADirectory,Ab.FileIsADirectory)}static NoPermissions(e){return new Ab(e,lc.NoPermissions,Ab.NoPermissions)}static Unavailable(e){return new Ab(e,lc.Unavailable,Ab.Unavailable)}constructor(e,t=lc.Unknown,n){super(w.isUri(e)?e.toString(!0):e),this.code=n?.name??`Unknown`,dc(this,t),Object.setPrototypeOf(this,Ab.prototype),typeof Error.captureStackTrace==`function`&&typeof n==`function`&&Error.captureStackTrace(this,n)}};uC=Ab=A([W],uC);let dC=class{constructor(e,t,n){this.start=e,this.end=t,this.kind=n}};dC=A([W],dC);var fC;(function(e){e[e.Comment=1]=`Comment`,e[e.Imports=2]=`Imports`,e[e.Region=3]=`Region`})(fC||={});var pC;(function(e){e[e.Collapsed=0]=`Collapsed`,e[e.Expanded=1]=`Expanded`})(pC||={});var mC;(function(e){e[e.Editing=0]=`Editing`,e[e.Preview=1]=`Preview`})(mC||={});var hC;(function(e){e[e.Published=0]=`Published`,e[e.Draft=1]=`Draft`})(hC||={});var gC;(function(e){e[e.Unresolved=0]=`Unresolved`,e[e.Resolved=1]=`Resolved`})(gC||={});var _C;(function(e){e[e.Current=0]=`Current`,e[e.Outdated=1]=`Outdated`})(_C||={});var vC;(function(e){e[e.Reply=1]=`Reply`,e[e.Comment=2]=`Comment`})(vC||={});var yC=class{constructor(e,t=[]){this.tokenTypes=e,this.tokenModifiers=t}};function bC(e){return e===void 0||Qe(e)}var xC=class e{constructor(e){if(this._prevLine=0,this._prevChar=0,this._dataIsSortedAndDeltaEncoded=!0,this._data=[],this._dataLen=0,this._tokenTypeStrToInt=new Map,this._tokenModifierStrToInt=new Map,this._hasLegend=!1,e){this._hasLegend=!0;for(let t=0,n=e.tokenTypes.length;t<n;t++)this._tokenTypeStrToInt.set(e.tokenTypes[t],t);for(let t=0,n=e.tokenModifiers.length;t<n;t++)this._tokenModifierStrToInt.set(e.tokenModifiers[t],t)}}push(e,t,n,r,i){if(typeof e==`number`&&typeof t==`number`&&typeof n==`number`&&typeof r==`number`&&(typeof i==`number`||i===void 0))return i===void 0&&(i=0),this._pushEncoded(e,t,n,r,i);if(Ib.isRange(e)&&typeof t==`string`&&bC(n))return this._push(e,t,n);throw h()}_push(e,t,n){if(!this._hasLegend)throw Error(`Legend must be provided in constructor`);if(e.start.line!==e.end.line)throw Error("`range` cannot span multiple lines");if(!this._tokenTypeStrToInt.has(t))throw Error("`tokenType` is not in the provided legend");let r=e.start.line,i=e.start.character,a=e.end.character-e.start.character,o=this._tokenTypeStrToInt.get(t),s=0;if(n)for(let e of n){if(!this._tokenModifierStrToInt.has(e))throw Error("`tokenModifier` is not in the provided legend");let t=this._tokenModifierStrToInt.get(e);s|=1<<t>>>0}this._pushEncoded(r,i,a,o,s)}_pushEncoded(e,t,n,r,i){if(this._dataIsSortedAndDeltaEncoded&&(e<this._prevLine||e===this._prevLine&&t<this._prevChar)){this._dataIsSortedAndDeltaEncoded=!1;let e=this._data.length/5|0,t=0,n=0;for(let r=0;r<e;r++){let e=this._data[5*r],i=this._data[5*r+1];e===0?(e=t,i+=n):e+=t,this._data[5*r]=e,this._data[5*r+1]=i,t=e,n=i}}let a=e,o=t;this._dataIsSortedAndDeltaEncoded&&this._dataLen>0&&(a-=this._prevLine,a===0&&(o-=this._prevChar)),this._data[this._dataLen++]=a,this._data[this._dataLen++]=o,this._data[this._dataLen++]=n,this._data[this._dataLen++]=r,this._data[this._dataLen++]=i,this._prevLine=e,this._prevChar=t}static _sortAndDeltaEncode(e){let t=[],n=e.length/5|0;for(let e=0;e<n;e++)t[e]=e;t.sort((t,n)=>{let r=e[5*t],i=e[5*n];if(r===i){let r=e[5*t+1],i=e[5*n+1];return r-i}return r-i});let r=new Uint32Array(e.length),i=0,a=0;for(let o=0;o<n;o++){let n=5*t[o],s=e[n+0],c=e[n+1],l=e[n+2],u=e[n+3],d=e[n+4],f=s-i,p=f===0?c-a:c,ee=5*o;r[ee+0]=f,r[ee+1]=p,r[ee+2]=l,r[ee+3]=u,r[ee+4]=d,i=s,a=c}return r}build(t){return this._dataIsSortedAndDeltaEncoded?new SC(new Uint32Array(this._data),t):new SC(e._sortAndDeltaEncode(this._data),t)}},SC=class{constructor(e,t){this.resultId=t,this.data=e}},CC=class{constructor(e,t,n){this.start=e,this.deleteCount=t,this.data=n}},wC=class{constructor(e,t){this.resultId=t,this.edits=e}},TC;(function(e){e[e.Separate=0]=`Separate`,e[e.MergeWithParent=1]=`MergeWithParent`})(TC||={});var EC=class{constructor(e){this.name=e}},DC;(function(e){e[e.Title=1]=`Title`,e[e.Inline=2]=`Inline`})(DC||={});let OC=class{static{this.Back={iconPath:new LS(`arrow-left`)}}constructor(){}};OC=A([W],OC);var kC;(function(e){e[e.Separator=-1]=`Separator`,e[e.Default=0]=`Default`})(kC||={});var AC;(function(e){e[e.Info=1]=`Info`,e[e.Warning=2]=`Warning`,e[e.Error=3]=`Error`})(AC||={});var jC;(function(e){e[e.UI=1]=`UI`,e[e.Workspace=2]=`Workspace`})(jC||={});var MC=class{static validate(e){if(typeof e.badge==`string`){let t=la(e.badge,0);if(t<e.badge.length&&(t+=la(e.badge,t)),e.badge.length>t)throw Error(`The 'badge'-property must be undefined or a short character`)}else if(e.badge&&!LS.isThemeIcon(e.badge))throw Error(`The 'badge'-property is not a valid ThemeIcon`);if(!e.color&&!e.badge&&!e.tooltip)throw Error(`The decoration is empty`);return!0}constructor(e,t,n){this.badge=e,this.tooltip=t,this.color=n}};let NC=class{constructor(e){this.kind=e}};NC=A([W],NC);var PC;(function(e){e[e.Light=1]=`Light`,e[e.Dark=2]=`Dark`,e[e.HighContrast=3]=`HighContrast`,e[e.HighContrastLight=4]=`HighContrastLight`})(PC||={});var FC=class e{static isNotebookRange(t){return t instanceof e?!0:t?typeof t.start==`number`&&typeof t.end==`number`:!1}get start(){return this._start}get end(){return this._end}get isEmpty(){return this._start===this._end}constructor(e,t){if(e<0)throw h(`start must be positive`);if(t<0)throw h(`end must be positive`);e<=t?(this._start=e,this._end=t):(this._start=t,this._end=e)}with(t){let n=this._start,r=this._end;return t.start!==void 0&&(n=t.start),t.end!==void 0&&(r=t.end),n===this._start&&r===this._end?this:new e(n,r)}},IC=class e{static validate(e){if(typeof e.kind!=`number`)throw Error(`NotebookCellData MUST have 'kind' property`);if(typeof e.value!=`string`)throw Error(`NotebookCellData MUST have 'value' property`);if(typeof e.languageId!=`string`)throw Error(`NotebookCellData MUST have 'languageId' property`)}static isNotebookCellDataArray(t){return Array.isArray(t)&&t.every(t=>e.isNotebookCellData(t))}static isNotebookCellData(e){return!0}constructor(t,n,r,i,a,o,s){this.kind=t,this.value=n,this.languageId=r,this.mime=i,this.outputs=a??[],this.metadata=o,this.executionSummary=s,e.validate(this)}},LC=class{constructor(e){this.cells=e}},RC=class e{static isNotebookCellOutputItem(t){return t instanceof e?!0:t?typeof t.mime==`string`&&t.data instanceof Uint8Array:!1}static error(t){let n={name:t.name,message:t.message,stack:t.stack};return e.json(n,`application/vnd.code.notebook.error`)}static stdout(t){return e.text(t,`application/vnd.code.notebook.stdout`)}static stderr(t){return e.text(t,`application/vnd.code.notebook.stderr`)}static bytes(t,n=`application/octet-stream`){return new e(t,n)}static#encoder=new TextEncoder;static text(t,n=Ku.text){let r=e.#encoder.encode(String(t));return new e(r,n)}static json(t,n=`text/x-json`){let r=JSON.stringify(t,void 0,`	`);return e.text(r,n)}constructor(e,t){this.data=e,this.mime=t;let n=Ju(t,!0);if(!n)throw Error(`INVALID mime type: ${t}. Must be in the format "type/subtype[;optionalparameter]"`);this.mime=n}},zC=class e{static isNotebookCellOutput(t){return t instanceof e?!0:!t||typeof t!=`object`?!1:typeof t.id==`string`&&Array.isArray(t.items)}static ensureUniqueMimeTypes(e,t=!1){let n=new Set,r=new Set;for(let i=0;i<e.length;i++){let a=e[i],o=Ju(a.mime);if(!n.has(o)||ty(o)){n.add(o);continue}r.add(i),t&&console.warn(`DUPLICATED mime type '${a.mime}' will be dropped`)}return r.size===0?e:e.filter((e,t)=>!r.has(t))}constructor(t,n,r){this.items=e.ensureUniqueMimeTypes(t,!0),typeof n==`string`?(this.id=n,this.metadata=r):(this.id=Nc(),this.metadata=n??r)}},BC=class{constructor(e,t,n){this.label=e,this.uri=t,this.position=n}},VC;(function(e){e[e.Markup=1]=`Markup`,e[e.Code=2]=`Code`})(VC||={});var HC;(function(e){e[e.Idle=1]=`Idle`,e[e.Pending=2]=`Pending`,e[e.Executing=3]=`Executing`})(HC||={});var UC;(function(e){e[e.Left=1]=`Left`,e[e.Right=2]=`Right`})(UC||={});var WC;(function(e){e[e.Default=0]=`Default`,e[e.InCenter=1]=`InCenter`,e[e.InCenterIfOutsideViewport=2]=`InCenterIfOutsideViewport`,e[e.AtTop=3]=`AtTop`})(WC||={});var GC=class{constructor(e,t){this.text=e,this.alignment=t}},KC;(function(e){e[e.Default=1]=`Default`,e[e.Preferred=2]=`Preferred`})(KC||={});var qC;(function(e){e[e.Default=1]=`Default`,e[e.Preferred=2]=`Preferred`,e[e.Hidden=-1]=`Hidden`})(qC||={});var JC=class{constructor(e,t=[]){this.uri=e,this.provides=De(t)}},YC=class{constructor(e){this.label=e}},XC;(function(e){e[e.Named=1]=`Named`,e[e.Indexed=2]=`Indexed`})(XC||={});let ZC=class{constructor(e,t){this.label=e,this.timestamp=t}};ZC=A([W],ZC);var QC;(function(e){e[e.Production=1]=`Production`,e[e.Development=2]=`Development`,e[e.Test=3]=`Test`})(QC||={});var $C;(function(e){e[e.Node=1]=`Node`,e[e.Webworker=2]=`Webworker`})($C||={});var ew;(function(e){e[e.Other=0]=`Other`,e[e.Comment=1]=`Comment`,e[e.String=2]=`String`,e[e.RegEx=3]=`RegEx`})(ew||={});var tw=class{constructor(e,t){this.ranges=e,this.wordPattern=t}},nw=class{constructor(e){this._autoForwardAction=e}get autoForwardAction(){return this._autoForwardAction}},rw;(function(e){e[e.Queued=1]=`Queued`,e[e.Running=2]=`Running`,e[e.Passed=3]=`Passed`,e[e.Failed=4]=`Failed`,e[e.Skipped=5]=`Skipped`,e[e.Errored=6]=`Errored`})(rw||={});var iw;(function(e){e[e.Run=1]=`Run`,e[e.Debug=2]=`Debug`,e[e.Coverage=3]=`Coverage`})(iw||={});var aw=class{constructor(e,t,n){this.controllerId=e,this.profileId=t,this.kind=n}};let ow=class{constructor(e=void 0,t=void 0,n=void 0,r=!1,i=!0){this.include=e,this.exclude=t,this.profile=n,this.continuous=r,this.preserveFocus=i}};ow=A([W],ow);let sw=jb=class{static diff(e,t,n){let r=new jb(e);return r.expectedOutput=t,r.actualOutput=n,r}constructor(e){this.message=e}};sw=jb=A([W],sw);let cw=class{constructor(e){this.id=e}};cw=A([W],cw);var lw=class{constructor(e,t,n){this.label=e,this.uri=t,this.position=n}},uw=class{constructor(e,t){this.covered=e,this.total=t,dw(this)}};function dw(e){if(e){if(e.covered>e.total)throw Error(`The total number of covered items (${e.covered}) cannot be greater than the total (${e.total})`);if(e.total<0)throw Error(`The number of covered items (${e.total}) cannot be negative`)}}var fw=class e{static fromDetails(t,n){let r=new uw(0,0),i=new uw(0,0),a=new uw(0,0);for(let e of n)if(`branches`in e){r.total+=1,r.covered+=e.executed?1:0;for(let t of e.branches)i.total+=1,i.covered+=t.executed?1:0}else a.total+=1,a.covered+=e.executed?1:0;let o=new e(t,r,i.total>0?i:void 0,a.total>0?a:void 0);return o.detailedCoverage=n,o}constructor(e,t,n,r,i=[]){this.uri=e,this.statementCoverage=t,this.branchCoverage=n,this.declarationCoverage=r,this.includesTests=i}},pw=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,n=[]){this.executed=e,this.location=t,this.branches=n}},mw=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,n){this.executed=e,this.location=t,this.label=n}},hw=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,n){this.name=e,this.executed=t,this.location=n}},gw;(function(e){e[e.None=0]=`None`,e[e.Option=1]=`Option`,e[e.Default=2]=`Default`,e[e.Preferred=3]=`Preferred`})(gw||={});var _w;(function(e){e[e.Untrusted=0]=`Untrusted`,e[e.Trusted=1]=`Trusted`,e[e.Unspecified=2]=`Unspecified`})(_w||={});var vw;(function(e){e[e.Notify=1]=`Notify`,e[e.OpenBrowser=2]=`OpenBrowser`,e[e.OpenPreview=3]=`OpenPreview`,e[e.Silent=4]=`Silent`,e[e.Ignore=5]=`Ignore`,e[e.OpenBrowserOnce=6]=`OpenBrowserOnce`})(vw||={});var yw=class{constructor(e,t,n,r,i,a){this.kind=e,this.name=t,this.detail=n,this.uri=r,this.range=i,this.selectionRange=a}},bw=class{constructor(e){this.uri=e}},xw=class{constructor(e,t){this.original=e,this.modified=t}},Sw=class{constructor(e,t,n,r){this.base=e,this.input1=t,this.input2=n,this.result=r}},Cw=class{constructor(e,t){this.uri=e,this.viewType=t}},ww=class{constructor(e){this.viewType=e}},Tw=class{constructor(e,t){this.uri=e,this.notebookType=t}},Ew=class{constructor(e,t,n){this.original=e,this.modified=t,this.notebookType=n}},Dw=class{constructor(){}},Ow=class{constructor(e,t){this.uri=e,this.inputBoxUri=t}},kw=class{constructor(){}},Aw=class{constructor(e){this.textDiffs=e}},jw;(function(e){e[e.Down=0]=`Down`,e[e.Up=1]=`Up`})(jw||={});var Mw;(function(e){e[e.Action=1]=`Action`,e[e.Toolbar=2]=`Toolbar`})(Mw||={});var Nw;(function(e){e[e.Short=1]=`Short`,e[e.Medium=2]=`Medium`,e[e.Full=3]=`Full`})(Nw||={});var Pw=class{constructor(e,t,n){this.id=e,this.label=t,this.values=n}},Fw;(function(e){e[e.Accepted=1]=`Accepted`,e[e.Rejected=2]=`Rejected`,e[e.Saved=3]=`Saved`})(Fw||={});var Iw;(function(e){e[e.Keep=1]=`Keep`,e[e.Undo=2]=`Undo`,e[e.UserModification=3]=`UserModification`})(Iw||={});var Lw;(function(e){e[e.Unhelpful=0]=`Unhelpful`,e[e.Helpful=1]=`Helpful`,e[e.Undone=2]=`Undone`,e[e.Accepted=3]=`Accepted`,e[e.Bug=4]=`Bug`})(Lw||={});var Rw;(function(e){e[e.Unhelpful=0]=`Unhelpful`,e[e.Helpful=1]=`Helpful`})(Rw||={});var zw=class{constructor(e){if(typeof e!=`string`&&e.isTrusted===!0)throw Error(`The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.`);this.value=typeof e==`string`?new Sx(e):e}},Bw=class{constructor(e,t){if(typeof e!=`string`&&e.isTrusted===!0)throw Error(`The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.`);this.value=typeof e==`string`?new Sx(e):e,this.vulnerabilities=t}},Vw=class{constructor(e,t,n,r){this.title=e,this.message=t,this.data=n,this.buttons=r}},Hw=class{constructor(e,t){this.value=e,this.baseUri=t}},Uw=class{constructor(e,t){this.value=e,this.title=t}},Ww=class{constructor(e,t){this.value=e,this.value2=e,this.title=t}},Gw=class{constructor(e){this.value=e}},Kw=class{constructor(e,t){this.value=e,this.task=t}},qw=class{constructor(e){if(typeof e!=`string`&&e.isTrusted===!0)throw Error(`The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.`);this.value=typeof e==`string`?new Sx(e):e}},Jw=class{constructor(e){this.value=e}},Yw=class{constructor(e,t,n){this.value=e,this.iconPath=t,this.options=n}},Xw=class{constructor(e,t){this.value=e,this.isEdit=t}},Zw=class{constructor(e,t,n){this.value=e,this.license=t,this.snippet=n}},Qw=class{constructor(e,t){this.uri=e,this.range=t}},$w=class{constructor(e){this.extensions=e}},eT=class{constructor(e,t,n,r,i){this.uri=e,this.title=t,this.description=n,this.author=r,this.linkTag=i}toJSON(){return{$mid:Dn.ChatResponsePullRequestPart,uri:this.uri,title:this.title,description:this.description,author:this.author}}},tT=class{constructor(e,t){this.uri=e,t===!0?(this.isDone=!0,this.edits=[]):this.edits=Array.isArray(t)?t:[t]}},nT=class{constructor(e,t){this.uri=e,t===!0?(this.isDone=!0,this.edits=[]):this.edits=Array.isArray(t)?t:[t]}},rT=class{constructor(e){this.toolName=e}},iT=class{constructor(e,t,n){this.toolName=e,this.toolCallId=t,this.isError=n}},aT=class{constructor(e,t,n,r,i,a){this.prompt=e,this.command=t,this.references=n,this.participant=r,this.toolReferences=i,this.editedFileEvents=a}},oT=class{constructor(e,t,n,r){this.response=e,this.result=t,this.participant=n,this.command=r}},sT=class{constructor(e,t,n,r){this.response=e,this.result=t,this.participant=n,this.command=r}},cT;(function(e){e[e.Panel=1]=`Panel`,e[e.Terminal=2]=`Terminal`,e[e.Notebook=3]=`Notebook`,e[e.Editor=4]=`Editor`})(cT||={});var lT;(function(e){e[e.Complete=1]=`Complete`,e[e.Partial=2]=`Partial`,e[e.Omitted=3]=`Omitted`})(lT||={});var uT;(function(e){e[e.NoReason=0]=`NoReason`,e[e.FilteredContentRetry=1]=`FilteredContentRetry`,e[e.CopyrightContentRetry=2]=`CopyrightContentRetry`})(uT||={});var dT=class{constructor(e,t,n){this.document=e,this.selection=t,this.wholeRange=n}},fT=class{constructor(e){this.cell=e}},pT=class{constructor(e,t,n){this.mimeType=e,this.data=t,this.reference=n}},mT=class{constructor(e){this.diagnostics=e}},hT;(function(e){e[e.User=1]=`User`,e[e.Assistant=2]=`Assistant`,e[e.System=3]=`System`})(hT||={});var gT=class{constructor(e,t,n){this.callId=e,this.content=t,this.isError=n??!1}},_T=class{constructor(e,t,n){this.callId=e,this.content=t,this.isError=n??!1}},vT;(function(e){e[e.Info=0]=`Info`,e[e.Warning=1]=`Warning`,e[e.Error=2]=`Error`})(vT||={});var yT=class e{static User(t,n){return new e(hT.User,t,n)}static Assistant(t,n){return new e(hT.Assistant,t,n)}set content(e){typeof e==`string`?this._content=[new CT(e)]:this._content=e}get content(){return this._content}constructor(e,t,n){this._content=[],this.role=e,this.content=t,this.name=n}},bT=class e{static User(t,n){return new e(hT.User,t,n)}static Assistant(t,n){return new e(hT.Assistant,t,n)}set content(e){typeof e==`string`?this._content=[new CT(e)]:this._content=e}get content(){return this._content}set content2(e){e&&(this.content=e.map(e=>typeof e==`string`?new CT(e):e))}get content2(){return this.content.map(e=>e instanceof CT?e.value:e)}constructor(e,t,n){this._content=[],this.role=e,this.content=t,this.name=n}},xT=class{constructor(e,t,n){this.callId=e,this.name=t,this.input=n}},ST;(function(e){e[e.Assistant=0]=`Assistant`,e[e.User=1]=`User`})(ST||={});var CT=class{constructor(e,t){this.value=e}toJSON(){return{$mid:Dn.LanguageModelTextPart,value:this.value,audience:this.audience}}},wT=class e{constructor(e,t,n){this.mimeType=t,this.data=e,this.audience=n}static image(t,n){return new e(t,n)}static json(t,n=`text/x-json`){let r=JSON.stringify(t,void 0,`	`);return new e(b.fromString(r).buffer,n)}static text(t,n=Ku.text){return new e(b.fromString(t).buffer,n)}toJSON(){return{$mid:Dn.LanguageModelDataPart,mimeType:this.mimeType,data:this.data,audience:this.audience}}},TT;(function(e){e.PNG=`image/png`,e.JPEG=`image/jpeg`,e.GIF=`image/gif`,e.WEBP=`image/webp`,e.BMP=`image/bmp`})(TT||={});var ET=class{constructor(e){this.value=e}toJSON(){return{$mid:Dn.LanguageModelPromptTsxPart,value:this.value}}},DT=class e extends Error{static#name=`LanguageModelError`;static NotFound(t){return new e(t,e.NotFound.name)}static NoPermissions(t){return new e(t,e.NoPermissions.name)}static Blocked(t){return new e(t,e.Blocked.name)}static tryDeserialize(t){if(t.name===e.#name)return new e(t.message,t.code,t.cause)}constructor(t,n,r){super(t,{cause:r}),this.name=e.#name,this.code=n??``}},OT=class{constructor(e){this.content=e}toJSON(){return{$mid:Dn.LanguageModelToolResult,content:this.content}}},kT=class{constructor(e){this.content=e}toJSON(){return{$mid:Dn.LanguageModelToolResult,content:this.content}}},AT=class extends OT{},jT;(function(e){e[e.Auto=1]=`Auto`,e[e.Required=2]=`Required`})(jT||={});var MT=class{constructor(e,t){this.id=e,this.label=t}},NT=class{constructor(e,t,n){this.label=e,this.name=t,this.instructions=n}},PT;(function(e){e[e.SymbolInformation=1]=`SymbolInformation`,e[e.CommandInformation=2]=`CommandInformation`,e[e.SearchInformation=3]=`SearchInformation`,e[e.SettingInformation=4]=`SettingInformation`})(PT||={});var FT;(function(e){e[e.EMBEDDED=1]=`EMBEDDED`,e[e.LLM_RANKED=2]=`LLM_RANKED`,e[e.CANCELED=3]=`CANCELED`})(FT||={});var IT;(function(e){e[e.Started=1]=`Started`,e[e.Recognizing=2]=`Recognizing`,e[e.Recognized=3]=`Recognized`,e[e.Stopped=4]=`Stopped`,e[e.Error=5]=`Error`})(IT||={});var LT;(function(e){e[e.Started=1]=`Started`,e[e.Stopped=2]=`Stopped`,e[e.Error=3]=`Error`})(LT||={});var RT;(function(e){e[e.Recognized=1]=`Recognized`,e[e.Stopped=2]=`Stopped`})(RT||={});var zT=class{constructor(e,t,n,r={},i){this.label=e,this.command=t,this.args=n,this.env=r,this.version=i}},BT=class{constructor(e,t,n={},r){this.label=e,this.uri=t,this.headers=n,this.version=r}},VT;(function(e){e[e.EMBEDDED=1]=`EMBEDDED`,e[e.LLM_RANKED=2]=`LLM_RANKED`,e[e.CANCELED=3]=`CANCELED`})(VT||={});let HT;function UT(e){HT?HT instanceof JT?HT.loggers.push(e):HT=new JT([HT,e]):HT=e}function WT(){return HT}let GT;function KT(e){GT=e}function qT(e){GT&&GT(e)}var JT=class{constructor(e){this.loggers=e}handleObservableCreated(e){for(let t of this.loggers)t.handleObservableCreated(e)}handleOnListenerCountChanged(e,t){for(let n of this.loggers)n.handleOnListenerCountChanged(e,t)}handleObservableUpdated(e,t){for(let n of this.loggers)n.handleObservableUpdated(e,t)}handleAutorunCreated(e){for(let t of this.loggers)t.handleAutorunCreated(e)}handleAutorunDisposed(e){for(let t of this.loggers)t.handleAutorunDisposed(e)}handleAutorunDependencyChanged(e,t,n){for(let r of this.loggers)r.handleAutorunDependencyChanged(e,t,n)}handleAutorunStarted(e){for(let t of this.loggers)t.handleAutorunStarted(e)}handleAutorunFinished(e){for(let t of this.loggers)t.handleAutorunFinished(e)}handleDerivedDependencyChanged(e,t,n){for(let r of this.loggers)r.handleDerivedDependencyChanged(e,t,n)}handleDerivedCleared(e){for(let t of this.loggers)t.handleDerivedCleared(e)}handleBeginTransaction(e){for(let t of this.loggers)t.handleBeginTransaction(e)}handleEndTransaction(e){for(let t of this.loggers)t.handleEndTransaction(e)}},YT;(function(e){e[e.dependenciesMightHaveChanged=1]=`dependenciesMightHaveChanged`,e[e.stale=2]=`stale`,e[e.upToDate=3]=`upToDate`})(YT||={});var XT=class{get debugName(){return this._debugNameData.getDebugName(this)??`(anonymous)`}constructor(e,t,n){this._debugNameData=e,this._runFn=t,this._changeTracker=n,this._state=YT.stale,this._updateCount=0,this._disposed=!1,this._dependencies=new Set,this._dependenciesToBeRemoved=new Set,this._isRunning=!1,this._store=void 0,this._delayedStore=void 0,this._changeSummary=this._changeTracker?.createChangeSummary(void 0),WT()?.handleAutorunCreated(this),this._run(),mt(this)}dispose(){if(!this._disposed){this._disposed=!0;for(let e of this._dependencies)e.removeObserver(this);this._dependencies.clear(),this._store!==void 0&&this._store.dispose(),this._delayedStore!==void 0&&this._delayedStore.dispose(),WT()?.handleAutorunDisposed(this),ht(this)}}_run(){let e=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies,this._dependencies=e,this._state=YT.upToDate;try{if(!this._disposed){WT()?.handleAutorunStarted(this);let e=this._changeSummary,t=this._delayedStore;t!==void 0&&(this._delayedStore=void 0);try{this._isRunning=!0,this._changeTracker&&(this._changeTracker.beforeUpdate?.(this,e),this._changeSummary=this._changeTracker.createChangeSummary(e)),this._store!==void 0&&(this._store.dispose(),this._store=void 0),this._runFn(this,e)}catch(e){ee(e)}finally{this._isRunning=!1,t!==void 0&&t.dispose()}}}finally{this._disposed||WT()?.handleAutorunFinished(this);for(let e of this._dependenciesToBeRemoved)e.removeObserver(this);this._dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(e){this._state===YT.upToDate&&(this._state=YT.dependenciesMightHaveChanged),this._updateCount++}endUpdate(e){try{if(this._updateCount===1)do{if(this._state===YT.dependenciesMightHaveChanged){this._state=YT.upToDate;for(let e of this._dependencies)if(e.reportChanges(),this._state===YT.stale)break}this._state!==YT.upToDate&&this._run()}while(this._state!==YT.upToDate)}finally{this._updateCount--}Xe(()=>this._updateCount>=0)}handlePossibleChange(e){this._state===YT.upToDate&&this._isDependency(e)&&(this._state=YT.dependenciesMightHaveChanged)}handleChange(e,t){if(this._isDependency(e)){WT()?.handleAutorunDependencyChanged(this,e,t);try{let n=this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:t,didChange:t=>t===e},this._changeSummary):!0;n&&(this._state=YT.stale)}catch(e){ee(e)}}}_isDependency(e){return this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)}_ensureNoRunning(){if(!this._isRunning)throw new me(`The reader object cannot be used outside its compute function!`)}readObservable(e){if(this._ensureNoRunning(),this._disposed)return e.get();e.addObserver(this);let t=e.get();return this._dependencies.add(e),this._dependenciesToBeRemoved.delete(e),t}get store(){if(this._ensureNoRunning(),this._disposed)throw new me(`Cannot access store after dispose`);return this._store===void 0&&(this._store=new v),this._store}get delayedStore(){if(this._ensureNoRunning(),this._disposed)throw new me(`Cannot access store after dispose`);return this._delayedStore===void 0&&(this._delayedStore=new v),this._delayedStore}debugGetState(){return{isRunning:this._isRunning,updateCount:this._updateCount,dependencies:this._dependencies,state:this._state}}debugRerun(){this._isRunning?this._state=YT.stale:this._run()}};const ZT=(e,t)=>e===t;function QT(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!QT(e[n],t[n]))return!1;return!0}if(e&&typeof e==`object`&&t&&typeof t==`object`&&Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(t)===Object.prototype){let n=e,r=t,i=Object.keys(n),a=Object.keys(r),o=new Set(a);if(i.length!==a.length)return!1;for(let e of i)if(!o.has(e)||!QT(n[e],r[e]))return!1;return!0}return!1}var $T=class{constructor(e,t,n){this.owner=e,this.debugNameSource=t,this.referenceFn=n}getDebugName(e){return nE(e,this)}};const eE=new Map,tE=new WeakMap;function nE(e,t){let n=tE.get(e);if(n)return n;let r=rE(e,t);if(r){let t=eE.get(r)??0;t++,eE.set(r,t);let n=t===1?r:`${r}#${t}`;return tE.set(e,n),n}}function rE(e,t){let n=tE.get(e);if(n)return n;let r=t.owner?sE(t.owner)+`.`:``,i,a=t.debugNameSource;if(a!==void 0)if(typeof a==`function`){if(i=a(),i!==void 0)return r+i}else return r+a;let o=t.referenceFn;if(o!==void 0&&(i=lE(o),i!==void 0))return r+i;if(t.owner!==void 0){let n=iE(t.owner,e);if(n!==void 0)return r+n}}function iE(e,t){for(let n in e)if(e[n]===t)return n}const aE=new Map,oE=new WeakMap;function sE(e){let t=oE.get(e);if(t)return t;let n=cE(e)??`Object`,r=aE.get(n)??0;r++,aE.set(n,r);let i=r===1?n:`${n}#${r}`;return oE.set(e,i),i}function cE(e){let t=e.constructor;if(t)return t.name===`Object`?void 0:t.name}function lE(e){let t=e.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//,r=n.exec(t),i=r?r[1]:void 0;return i?.trim()}let uE;function dE(e){uE=e}let fE;function pE(e){fE=e}let mE;function hE(e){mE=e}var gE=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){let n=t===void 0?void 0:e,r=t===void 0?e:t;return uE({owner:n,debugName:()=>{let e=lE(r);if(e!==void 0)return e;let t=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/,i=t.exec(r.toString());if(i)return`${this.debugName}.${i[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:r},e=>r(this.read(e),e))}flatten(){return uE({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(fE(this,t)),this}keepObserved(e){return e.add(mE(this)),this}get debugValue(){return this.get()}},_E=class extends gE{constructor(){super(),this._observers=new Set,WT()?.handleObservableCreated(this)}addObserver(e){let t=this._observers.size;this._observers.add(e),t===0&&this.onFirstObserverAdded(),t!==this._observers.size&&WT()?.handleOnListenerCountChanged(this,this._observers.size)}removeObserver(e){let t=this._observers.delete(e);t&&this._observers.size===0&&this.onLastObserverRemoved(),t&&WT()?.handleOnListenerCountChanged(this,this._observers.size)}onFirstObserverAdded(){}onLastObserverRemoved(){}log(){let e=!!WT();return qT(this),e||WT()?.handleObservableCreated(this),this}debugGetObservers(){return this._observers}},vE;(function(e){e[e.initial=0]=`initial`,e[e.dependenciesMightHaveChanged=1]=`dependenciesMightHaveChanged`,e[e.stale=2]=`stale`,e[e.upToDate=3]=`upToDate`})(vE||={});var yE=class extends _E{get debugName(){return this._debugNameData.getDebugName(this)??`(anonymous)`}constructor(e,t,n,r=void 0,i){super(),this._debugNameData=e,this._computeFn=t,this._changeTracker=n,this._handleLastObserverRemoved=r,this._equalityComparator=i,this._state=vE.initial,this._value=void 0,this._updateCount=0,this._dependencies=new Set,this._dependenciesToBeRemoved=new Set,this._changeSummary=void 0,this._isUpdating=!1,this._isComputing=!1,this._didReportChange=!1,this._isInBeforeUpdate=!1,this._isReaderValid=!1,this._store=void 0,this._delayedStore=void 0,this._removedObserverToCallEndUpdateOn=null,this._changeSummary=this._changeTracker?.createChangeSummary(void 0)}onLastObserverRemoved(){this._state=vE.initial,this._value=void 0,WT()?.handleDerivedCleared(this);for(let e of this._dependencies)e.removeObserver(this);this._dependencies.clear(),this._store!==void 0&&(this._store.dispose(),this._store=void 0),this._delayedStore!==void 0&&(this._delayedStore.dispose(),this._delayedStore=void 0),this._handleLastObserverRemoved?.()}get(){if(this._observers.size===0){let e;try{this._isReaderValid=!0;let t;this._changeTracker&&(t=this._changeTracker.createChangeSummary(void 0),this._changeTracker.beforeUpdate?.(this,t)),e=this._computeFn(this,t)}finally{this._isReaderValid=!1}return this.onLastObserverRemoved(),e}else{do{if(this._state===vE.dependenciesMightHaveChanged){for(let e of this._dependencies)if(e.reportChanges(),this._state===vE.stale)break}this._state===vE.dependenciesMightHaveChanged&&(this._state=vE.upToDate),this._state!==vE.upToDate&&this._recompute()}while(this._state!==vE.upToDate);return this._value}}_recompute(){let e=!1;this._isComputing=!0,this._didReportChange=!1;let t=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies,this._dependencies=t;try{let t=this._changeSummary;this._isReaderValid=!0,this._changeTracker&&(this._isInBeforeUpdate=!0,this._changeTracker.beforeUpdate?.(this,t),this._isInBeforeUpdate=!1,this._changeSummary=this._changeTracker?.createChangeSummary(t));let n=this._state!==vE.initial,r=this._value;this._state=vE.upToDate;let i=this._delayedStore;i!==void 0&&(this._delayedStore=void 0);try{this._store!==void 0&&(this._store.dispose(),this._store=void 0),this._value=this._computeFn(this,t)}finally{this._isReaderValid=!1;for(let e of this._dependenciesToBeRemoved)e.removeObserver(this);this._dependenciesToBeRemoved.clear(),i!==void 0&&i.dispose()}e=this._didReportChange||n&&!this._equalityComparator(r,this._value),WT()?.handleObservableUpdated(this,{oldValue:r,newValue:this._value,change:void 0,didChange:e,hadValue:n})}catch(e){ee(e)}if(this._isComputing=!1,!this._didReportChange&&e)for(let e of this._observers)e.handleChange(this,void 0);else this._didReportChange=!1}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){if(this._isUpdating)throw new me(`Cyclic deriveds are not supported yet!`);this._updateCount++,this._isUpdating=!0;try{let e=this._updateCount===1;if(this._state===vE.upToDate&&(this._state=vE.dependenciesMightHaveChanged,!e))for(let e of this._observers)e.handlePossibleChange(this);if(e)for(let e of this._observers)e.beginUpdate(this)}finally{this._isUpdating=!1}}endUpdate(e){if(this._updateCount--,this._updateCount===0){let e=[...this._observers];for(let t of e)t.endUpdate(this);if(this._removedObserverToCallEndUpdateOn){let e=[...this._removedObserverToCallEndUpdateOn];this._removedObserverToCallEndUpdateOn=null;for(let t of e)t.endUpdate(this)}}Xe(()=>this._updateCount>=0)}handlePossibleChange(e){if(this._state===vE.upToDate&&this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)){this._state=vE.dependenciesMightHaveChanged;for(let e of this._observers)e.handlePossibleChange(this)}}handleChange(e,t){if(this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)||this._isInBeforeUpdate){WT()?.handleDerivedDependencyChanged(this,e,t);let n=!1;try{n=this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:t,didChange:t=>t===e},this._changeSummary):!0}catch(e){ee(e)}let r=this._state===vE.upToDate;if(n&&(this._state===vE.dependenciesMightHaveChanged||r)&&(this._state=vE.stale,r))for(let e of this._observers)e.handlePossibleChange(this)}}_ensureReaderValid(){if(!this._isReaderValid)throw new me(`The reader object cannot be used outside its compute function!`)}readObservable(e){this._ensureReaderValid(),e.addObserver(this);let t=e.get();return this._dependencies.add(e),this._dependenciesToBeRemoved.delete(e),t}reportChange(e){this._ensureReaderValid(),this._didReportChange=!0;for(let t of this._observers)t.handleChange(this,e)}get store(){return this._ensureReaderValid(),this._store===void 0&&(this._store=new v),this._store}get delayedStore(){return this._ensureReaderValid(),this._delayedStore===void 0&&(this._delayedStore=new v),this._delayedStore}addObserver(e){let t=!this._observers.has(e)&&this._updateCount>0;super.addObserver(e),t&&(this._removedObserverToCallEndUpdateOn&&this._removedObserverToCallEndUpdateOn.has(e)?this._removedObserverToCallEndUpdateOn.delete(e):e.beginUpdate(this))}removeObserver(e){this._observers.has(e)&&this._updateCount>0&&(this._removedObserverToCallEndUpdateOn||=new Set,this._removedObserverToCallEndUpdateOn.add(e)),super.removeObserver(e)}debugGetState(){return{state:this._state,updateCount:this._updateCount,isComputing:this._isComputing,dependencies:this._dependencies,value:this._value}}debugSetValue(e){this._value=e}debugRecompute(){this._isComputing?this._state=vE.stale:this._recompute()}setValue(e,t,n){this._value=e;let r=this._observers;t.updateObserver(this,this);for(let e of r)e.handleChange(this,n)}};function bE(e,t){return new yE(new $T(e.owner,e.debugName,e.debugReferenceFn),t,void 0,e.onLastObserverRemoved,e.equalsFn??ZT)}dE(bE);function xE(e){return new XT(new $T(void 0,void 0,e),e,void 0)}function SE(e){let t=Error(`BugIndicatingErrorRecovery: `+e);m(t),console.error(`recovered from an error that indicates a bug`,t)}function CE(e,t){let n=new TE(e,t);try{e(n)}finally{n.finish()}}function wE(e,t,n){e?t(e):CE(t,n)}var TE=class{constructor(e,t){this._fn=e,this._getDebugName=t,this._updatingObservers=[],WT()?.handleBeginTransaction(this)}getDebugName(){return this._getDebugName?this._getDebugName():lE(this._fn)}updateObserver(e,t){if(!this._updatingObservers){SE(`Transaction already finished!`),CE(n=>{n.updateObserver(e,t)});return}this._updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){let e=this._updatingObservers;if(!e){SE(`transaction.finish() has already been called!`);return}for(let t=0;t<e.length;t++){let{observer:n,observable:r}=e[t];n.endUpdate(r)}this._updatingObservers=null,WT()?.handleEndTransaction(this)}debugGetUpdatingObservers(){return this._updatingObservers}};function EE(e,t){let n;return n=typeof e==`string`?new $T(void 0,e,void 0):new $T(e,void 0,void 0),new DE(n,t,ZT)}var DE=class extends _E{get debugName(){return this._debugNameData.getDebugName(this)??`ObservableValue`}constructor(e,t,n){super(),this._debugNameData=e,this._equalityComparator=n,this._value=t,WT()?.handleObservableUpdated(this,{hadValue:!1,newValue:t,change:void 0,didChange:!0,oldValue:void 0})}get(){return this._value}set(e,t,n){if(n===void 0&&this._equalityComparator(this._value,e))return;let r;t||=r=new TE(()=>{},()=>`Setting ${this.debugName}`);try{let r=this._value;this._setValue(e),WT()?.handleObservableUpdated(this,{oldValue:r,newValue:e,change:n,didChange:!0,hadValue:!0});for(let e of this._observers)t.updateObserver(e,this),e.handleChange(this,n)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}debugGetState(){return{value:this._value}}debugSetValue(e){this._value=e}};function OE(...e){let t,n,r;return e.length===3?[t,n,r]=e:[n,r]=e,new kE(new $T(t,void 0,r),n,r,()=>kE.globalTransaction,ZT)}var kE=class extends _E{constructor(e,t,n,r,i){super(),this._debugNameData=e,this.event=t,this._getValue=n,this._getTransaction=r,this._equalityComparator=i,this._hasValue=!1,this.handleEvent=e=>{let t=this._getValue(e),n=this._value,r=!this._hasValue||!this._equalityComparator(n,t),i=!1;r&&(this._value=t,this._hasValue&&(i=!0,wE(this._getTransaction(),e=>{WT()?.handleObservableUpdated(this,{oldValue:n,newValue:t,change:void 0,didChange:r,hadValue:this._hasValue});for(let t of this._observers)e.updateObserver(t,this),t.handleChange(this,void 0)},()=>{let e=this.getDebugName();return`Event fired`+(e?`: ${e}`:``)})),this._hasValue=!0),i||WT()?.handleObservableUpdated(this,{oldValue:n,newValue:t,change:void 0,didChange:r,hadValue:this._hasValue})}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let e=this.getDebugName();return`From Event`+(e?`: ${e}`:``)}onFirstObserverAdded(){this._subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this._subscription.dispose(),this._subscription=void 0,this._hasValue=!1,this._value=void 0}get(){if(this._subscription)return this._hasValue||this.handleEvent(void 0),this._value;{let e=this._getValue(void 0);return e}}debugSetValue(e){this._value=e}};(function(e){e.Observer=kE;function t(e,t){let n=!1;kE.globalTransaction===void 0&&(kE.globalTransaction=e,n=!0);try{t()}finally{n&&(kE.globalTransaction=void 0)}}e.batchEventsGlobally=t})(OE||={});function AE(e){let t=new ME(!1,void 0);return e.addObserver(t),_(()=>{e.removeObserver(t)})}hE(AE);function jE(e,t){let n=new ME(!0,t);e.addObserver(n);try{n.beginUpdate(e)}finally{n.endUpdate(e)}return _(()=>{e.removeObserver(n)})}pE(jE);var ME=class{constructor(e,t){this._forceRecompute=e,this._handleValue=t,this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){this._counter===1&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges()),this._counter--}handlePossibleChange(e){}handleChange(e,t){}};let NE;function PE(e){NE||(NE=new FE,UT(NE)),NE.addFilteredObj(e)}var FE=class{constructor(){this.indentation=0,this.changedObservablesSets=new WeakMap}addFilteredObj(e){this._filteredObjects||=new Set,this._filteredObjects.add(e)}_isIncluded(e){return this._filteredObjects?.has(e)??!0}textToConsoleArgs(e){return IE([LE(UE(`|  `,this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[LE(` `),zE(BE(e.oldValue,70),{color:`red`,strikeThrough:!0}),LE(` `),zE(BE(e.newValue,60),{color:`green`})]:[LE(` (unchanged)`)]:[LE(` `),zE(BE(e.newValue,60),{color:`green`}),LE(` (initial)`)]}handleObservableCreated(e){if(e instanceof yE){let t=e;this.changedObservablesSets.set(t,new Set)}}handleOnListenerCountChanged(e,t){}handleObservableUpdated(e,t){if(this._isIncluded(e)){if(e instanceof yE){this._handleDerivedRecomputed(e,t);return}console.log(...this.textToConsoleArgs([RE(`observable value changed`),zE(e.debugName,{color:`BlueViolet`}),...this.formatInfo(t)]))}}formatChanges(e){if(e.size!==0)return zE(` (changed deps: `+[...e].map(e=>e.debugName).join(`, `)+`)`,{color:`gray`})}handleDerivedDependencyChanged(e,t,n){this._isIncluded(e)&&this.changedObservablesSets.get(e)?.add(t)}_handleDerivedRecomputed(e,t){if(!this._isIncluded(e))return;let n=this.changedObservablesSets.get(e);n&&(console.log(...this.textToConsoleArgs([RE(`derived recomputed`),zE(e.debugName,{color:`BlueViolet`}),...this.formatInfo(t),this.formatChanges(n),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),n.clear())}handleDerivedCleared(e){this._isIncluded(e)&&console.log(...this.textToConsoleArgs([RE(`derived cleared`),zE(e.debugName,{color:`BlueViolet`})]))}handleFromEventObservableTriggered(e,t){this._isIncluded(e)&&console.log(...this.textToConsoleArgs([RE(`observable from event triggered`),zE(e.debugName,{color:`BlueViolet`}),...this.formatInfo(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){this._isIncluded(e)&&this.changedObservablesSets.set(e,new Set)}handleAutorunDisposed(e){}handleAutorunDependencyChanged(e,t,n){this._isIncluded(e)&&this.changedObservablesSets.get(e).add(t)}handleAutorunStarted(e){let t=this.changedObservablesSets.get(e);t&&(this._isIncluded(e)&&console.log(...this.textToConsoleArgs([RE(`autorun`),zE(e.debugName,{color:`BlueViolet`}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.indentation++)}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=``),this._isIncluded(e)&&console.log(...this.textToConsoleArgs([RE(`transaction`),zE(t,{color:`BlueViolet`}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function IE(e){let t=[],n=[],r=``;function i(e){if(`length`in e)for(let t of e)t&&i(t);else `text`in e?(r+=`%c${e.text}`,t.push(e.style),e.data&&n.push(...e.data)):`data`in e&&n.push(...e.data)}i(e);let a=[r,...t];return a.push(...n),a}function LE(e){return zE(e,{color:`black`})}function RE(e){return zE(WE(`${e}: `,10),{color:`black`,bold:!0})}function zE(e,t={color:`black`}){function n(e){return Object.entries(e).reduce((e,[t,n])=>`${e}${t}:${n};`,``)}let r={color:t.color};return t.strikeThrough&&(r[`text-decoration`]=`line-through`),t.bold&&(r[`font-weight`]=`bold`),{text:e,style:n(r)}}function BE(e,t){switch(typeof e){case`number`:return``+e;case`string`:return e.length+2<=t?`"${e}"`:`"${e.substr(0,t-7)}"+...`;case`boolean`:return e?`true`:`false`;case`undefined`:return`undefined`;case`object`:return e===null?`null`:Array.isArray(e)?VE(e,t):HE(e,t);case`symbol`:return e.toString();case`function`:return`[[Function${e.name?` `+e.name:``}]]`;default:return``+e}}function VE(e,t){let n=`[ `,r=!0;for(let i of e){if(r||(n+=`, `),n.length-5>t){n+=`...`;break}r=!1,n+=`${BE(i,t-n.length)}`}return n+=` ]`,n}function HE(e,t){if(typeof e.toString==`function`&&e.toString!==Object.prototype.toString){let n=e.toString();return n.length<=t?n:n.substring(0,t-3)+`...`}let n=cE(e),r=n?n+`(`:`{ `,i=!0;for(let[n,a]of Object.entries(e)){if(i||(r+=`, `),r.length-5>t){r+=`...`;break}i=!1,r+=`${n}: ${BE(a,t-r.length)}`}return r+=n?`)`:` }`,r}function UE(e,t){let n=``;for(let r=1;r<=t;r++)n+=e;return n}function WE(e,t){for(;e.length<t;)e+=` `;return e}var GE=class e{static createHost(t,n){return new e(t,n)}static createClient(t,n){return new e(t,n)}constructor(e,t){this._channelFactory=e,this._getHandler=t,this._channel=this._channelFactory({handleNotification:e=>{let t=e,n=this._getHandler().notifications[t[0]];if(!n)throw Error(`Unknown notification "${t[0]}"!`);n(...t[1])},handleRequest:e=>{let t=e;try{let e=this._getHandler().requests[t[0]](...t[1]);return{type:`result`,value:e}}catch(e){return{type:`error`,value:e}}}});let n=new Proxy({},{get:(e,t)=>async(...e)=>{let n=await this._channel.sendRequest([t,e]);if(n.type===`error`)throw n.value;return n.value}}),r=new Proxy({},{get:(e,t)=>(...e)=>{this._channel.sendNotification([t,e])}});this.api={notifications:r,requests:n}}};function KE(e,t){let n=globalThis,r=[],i,{channel:a,handler:o}=qE({sendNotification:e=>{i?i.sendNotification(e):r.push(e)}}),s;return(n.$$debugValueEditor_debugChannels??={})[e]=e=>{s=t(),i=e;for(let t of r)e.sendNotification(t);return r=[],o},GE.createClient(a,()=>{if(!s)throw Error(`Not supported`);return s})}function qE(e){let t,n=n=>(t=n,{sendNotification:t=>{e.sendNotification(t)},sendRequest:e=>{throw Error(`not supported`)}});return{channel:n,handler:{handleRequest:e=>e.type===`notification`?t?.handleNotification(e.data):t?.handleRequest(e.data)}}}function JE(e,t){let n=e.split(`
`);for(let e=1;e<n.length;e++){let r=n[e];if(t&&t.test(r))continue;let i=r.match(/\$show(\d+)FramesUp/);if(i){let t=parseInt(i[1],10);e+=t-1;continue}let a=YE(r);if(a)return a}}function YE(e){let t=e.match(/\((.*):(\d+):(\d+)\)/);if(t)return{fileName:t[1],line:parseInt(t[2]),column:parseInt(t[3]),id:e};let n=e.match(/at ([^\(\)]*):(\d+):(\d+)/);if(n)return{fileName:n[1],line:parseInt(n[2]),column:parseInt(n[3]),id:e}}var XE=class{constructor(){this._timeout=void 0}throttle(e,t){this._timeout===void 0&&(this._timeout=setTimeout(()=>{this._timeout=void 0,e()},t))}dispose(){this._timeout!==void 0&&clearTimeout(this._timeout)}};function ZE(e,t){for(let n in t)e[n]&&typeof e[n]==`object`&&t[n]&&typeof t[n]==`object`?ZE(e[n],t[n]):e[n]=t[n]}function QE(e,t){for(let n in t)t[n]===null?delete e[n]:e[n]&&typeof e[n]==`object`&&t[n]&&typeof t[n]==`object`?QE(e[n],t[n]):e[n]=t[n]}var $E=class e{static{this._instance=void 0}static getInstance(){return e._instance===void 0&&(e._instance=new e),e._instance}getTransactionState(){let e=[],t=[...this._activeTransactions];if(t.length===0)return;let n=t.flatMap(e=>e.debugGetUpdatingObservers()??[]).map(e=>e.observer),r=new Set;for(;n.length>0;){let t=n.shift();if(r.has(t))continue;r.add(t);let i=this._getInfo(t,e=>{r.has(e)||n.push(e)});i&&e.push(i)}return{names:t.map(e=>e.getDebugName()??`tx`),affected:e}}_getObservableInfo(e){let t=this._instanceInfos.get(e);if(!t){m(new me(`No info found`));return}return t}_getAutorunInfo(e){let t=this._instanceInfos.get(e);if(!t){m(new me(`No info found`));return}return t}_getInfo(e,t){if(e instanceof yE){let n=[...e.debugGetObservers()];for(let e of n)t(e);let r=this._getObservableInfo(e);if(!r)return;let i=e.debugGetState(),a={name:e.debugName,instanceId:r.instanceId,updateCount:i.updateCount},o=[...r.changedObservables].map(e=>this._instanceInfos.get(e)?.instanceId).filter(it);if(i.isComputing)return{...a,type:`observable/derived`,state:`updating`,changedDependencies:o,initialComputation:!1};switch(i.state){case vE.initial:return{...a,type:`observable/derived`,state:`noValue`};case vE.upToDate:return{...a,type:`observable/derived`,state:`upToDate`};case vE.stale:return{...a,type:`observable/derived`,state:`stale`,changedDependencies:o};case vE.dependenciesMightHaveChanged:return{...a,type:`observable/derived`,state:`possiblyStale`}}}else if(e instanceof XT){let t=this._getAutorunInfo(e);if(!t)return;let n={name:e.debugName,instanceId:t.instanceId,updateCount:t.updateCount},r=[...t.changedObservables].map(e=>this._instanceInfos.get(e).instanceId);if(e.debugGetState().isRunning)return{...n,type:`autorun`,state:`updating`,changedDependencies:r};switch(e.debugGetState().state){case YT.upToDate:return{...n,type:`autorun`,state:`upToDate`};case YT.stale:return{...n,type:`autorun`,state:`stale`,changedDependencies:r};case YT.dependenciesMightHaveChanged:return{...n,type:`autorun`,state:`possiblyStale`}}}}_formatObservable(e){let t=this._getObservableInfo(e);if(t)return{name:e.debugName,instanceId:t.instanceId}}_formatObserver(e){if(e instanceof yE)return{name:e.toString(),instanceId:this._getObservableInfo(e)?.instanceId};let t=this._getAutorunInfo(e);if(t)return{name:e.toString(),instanceId:t.instanceId}}constructor(){this._declarationId=0,this._instanceId=0,this._declarations=new Map,this._instanceInfos=new WeakMap,this._aliveInstances=new Map,this._activeTransactions=new Set,this._channel=KE(`observableDevTools`,()=>({notifications:{setDeclarationIdFilter:e=>{},logObservableValue:e=>{console.log(`logObservableValue`,e)},flushUpdates:()=>{this._flushUpdates()},resetUpdates:()=>{this._pendingChanges=null,this._channel.api.notifications.handleChange(this._fullState,!0)}},requests:{getDeclarations:()=>{let e={};for(let t of this._declarations.values())e[t.id]=t;return{decls:e}},getSummarizedInstances:()=>null,getObservableValueInfo:e=>{let t=this._aliveInstances.get(e);return{observers:[...t.debugGetObservers()].map(e=>this._formatObserver(e)).filter(it)}},getDerivedInfo:e=>{let t=this._aliveInstances.get(e);return{dependencies:[...t.debugGetState().dependencies].map(e=>this._formatObservable(e)).filter(it),observers:[...t.debugGetObservers()].map(e=>this._formatObserver(e)).filter(it)}},getAutorunInfo:e=>{let t=this._aliveInstances.get(e);return{dependencies:[...t.debugGetState().dependencies].map(e=>this._formatObservable(e)).filter(it)}},getTransactionState:()=>this.getTransactionState(),setValue:(e,t)=>{let n=this._aliveInstances.get(e);if(n instanceof yE)n.debugSetValue(t);else if(n instanceof DE)n.debugSetValue(t);else if(n instanceof kE)n.debugSetValue(t);else throw new me(`Observable is not supported`);let r=[...n.debugGetObservers()];for(let e of r)e.beginUpdate(n);for(let e of r)e.handleChange(n,void 0);for(let e of r)e.endUpdate(n)},getValue:e=>{let t=this._aliveInstances.get(e);if(t instanceof yE||t instanceof DE)return BE(t.debugGetState().value,200)},logValue:e=>{let t=this._aliveInstances.get(e);if(t&&`get`in t)console.log(`Logged Value:`,t.get());else throw new me(`Observable is not supported`)},rerun:e=>{let t=this._aliveInstances.get(e);if(t instanceof yE)t.debugRecompute();else if(t instanceof XT)t.debugRerun();else throw new me(`Observable is not supported`)}}})),this._pendingChanges=null,this._changeThrottler=new XE,this._fullState={},this._flushUpdates=()=>{this._pendingChanges!==null&&(this._channel.api.notifications.handleChange(this._pendingChanges,!1),this._pendingChanges=null)}}_handleChange(e){QE(this._fullState,e),this._pendingChanges===null?this._pendingChanges=e:ZE(this._pendingChanges,e),this._changeThrottler.throttle(this._flushUpdates,10)}_getDeclarationId(e){let t=!0,n,r=Error;for(;;){let e=r.stackTraceLimit;r.stackTraceLimit=t?6:20;let i=Error().stack;r.stackTraceLimit=e;let a=JE(i,/[/\\]observableInternal[/\\]|\.observe|[/\\]util(s)?\./);if(!t&&!a&&(a=JE(i,/[/\\]observableInternal[/\\]|\.observe/)),a){n=a;break}if(!t){console.error(`Could not find location for declaration`,Error().stack),n={fileName:`unknown`,line:0,column:0,id:`unknown`};break}t=!1}let i=this._declarations.get(n.id);return i===void 0&&(i={id:this._declarationId++,type:e,url:n.fileName,line:n.line,column:n.column},this._declarations.set(n.id,i),this._handleChange({decls:{[i.id]:i}})),i.id}handleObservableCreated(e){let t=this._getDeclarationId(`observable/value`),n={declarationId:t,instanceId:this._instanceId++,listenerCount:0,lastValue:void 0,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,n)}handleOnListenerCountChanged(e,t){let n=this._getObservableInfo(e);if(n){if(n.listenerCount===0&&t>0){let t=e instanceof yE?`observable/derived`:`observable/value`;this._aliveInstances.set(n.instanceId,e),this._handleChange({instances:{[n.instanceId]:{instanceId:n.instanceId,declarationId:n.declarationId,formattedValue:n.lastValue,type:t,name:e.debugName}}})}else n.listenerCount>0&&t===0&&(this._handleChange({instances:{[n.instanceId]:null}}),this._aliveInstances.delete(n.instanceId));n.listenerCount=t}}handleObservableUpdated(e,t){if(e instanceof yE){this._handleDerivedRecomputed(e,t);return}let n=this._getObservableInfo(e);n&&t.didChange&&(n.lastValue=BE(t.newValue,30),n.listenerCount>0&&this._handleChange({instances:{[n.instanceId]:{formattedValue:n.lastValue}}}))}handleAutorunCreated(e){let t=this._getDeclarationId(`autorun`),n={declarationId:t,instanceId:this._instanceId++,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,n),this._aliveInstances.set(n.instanceId,e),n&&this._handleChange({instances:{[n.instanceId]:{instanceId:n.instanceId,declarationId:n.declarationId,runCount:0,type:`autorun`,name:e.debugName}}})}handleAutorunDisposed(e){let t=this._getAutorunInfo(e);t&&(this._handleChange({instances:{[t.instanceId]:null}}),this._instanceInfos.delete(e),this._aliveInstances.delete(t.instanceId))}handleAutorunDependencyChanged(e,t,n){let r=this._getAutorunInfo(e);r&&r.changedObservables.add(t)}handleAutorunStarted(e){}handleAutorunFinished(e){let t=this._getAutorunInfo(e);t&&(t.changedObservables.clear(),t.updateCount++,this._handleChange({instances:{[t.instanceId]:{runCount:t.updateCount}}}))}handleDerivedDependencyChanged(e,t,n){let r=this._getObservableInfo(e);r&&r.changedObservables.add(t)}_handleDerivedRecomputed(e,t){let n=this._getObservableInfo(e);if(!n)return;let r=BE(t.newValue,30);n.updateCount++,n.changedObservables.clear(),n.lastValue=r,n.listenerCount>0&&this._handleChange({instances:{[n.instanceId]:{formattedValue:r,recomputationCount:n.updateCount}}})}handleDerivedCleared(e){let t=this._getObservableInfo(e);t&&(t.lastValue=void 0,t.changedObservables.clear(),t.listenerCount>0&&this._handleChange({instances:{[t.instanceId]:{formattedValue:void 0}}}))}handleBeginTransaction(e){this._activeTransactions.add(e)}handleEndTransaction(e){this._activeTransactions.delete(e)}};KT(PE),Cr&&Cr.VSCODE_DEV_DEBUG&&UT($E.getInstance()),k(`IMcpService`);const eD=k(`IMcpWorkbenchService`);k(`IMcpServerSampling`),k(`IMcpElicitationService`);var tD;(function(e){e.LATEST_PROTOCOL_VERSION=`2025-06-18`,e.JSONRPC_VERSION=`2.0`,e.PARSE_ERROR=-32700,e.INVALID_REQUEST=-32600,e.METHOD_NOT_FOUND=-32601,e.INVALID_PARAMS=-32602,e.INTERNAL_ERROR=-32603})(tD||={}),Symbol.iterator,Symbol.toStringTag;function nD(e,t){return ms.toKey(e)+`/`+t}var rD;(function(e){e[e.WorkspaceFolder=0]=`WorkspaceFolder`,e[e.Workspace=100]=`Workspace`,e[e.User=200]=`User`,e[e.Extension=300]=`Extension`,e[e.Filesystem=400]=`Filesystem`,e[e.RemoteBoost=-50]=`RemoteBoost`})(rD||={});var iD;(function(e){function t(e,t){return e.id===t.id&&e.remoteAuthority===t.remoteAuthority&&e.label===t.label&&e.trustBehavior===t.trustBehavior}e.equals=t})(iD||={});var aD;(function(e){function t(e){return e}e.toSerialized=t;function n(e){return{id:e.id,label:e.label,cacheNonce:e.cacheNonce,launch:dD.fromSerialized(e.launch),variableReplacement:e.variableReplacement?oD.fromSerialized(e.variableReplacement):void 0}}e.fromSerialized=n;function r(e,t){return e.id===t.id&&e.label===t.label&&ge(e.roots,t.roots,(e,t)=>e.toString()===t.toString())&&tc(e.launch,t.launch)&&tc(e.presentation,t.presentation)&&tc(e.variableReplacement,t.variableReplacement)&&tc(e.devMode,t.devMode)}e.equals=r})(aD||={});var oD;(function(e){function t(e){return e}e.toSerialized=t;function n(e){return{section:e.section,folder:e.folder?{...e.folder,uri:w.revive(e.folder.uri)}:void 0,target:e.target}}e.fromSerialized=n})(oD||={});var sD;(function(e){e[e.HasUnknown=0]=`HasUnknown`,e[e.LoadingUnknown=1]=`LoadingUnknown`,e[e.AllKnown=2]=`AllKnown`})(sD||={});var cD;(function(e){(function(e){e[e.Trusted=0]=`Trusted`,e[e.TrustedOnNonce=1]=`TrustedOnNonce`,e[e.Untrusted=2]=`Untrusted`,e[e.Unknown=3]=`Unknown`})(e.Kind||={})})(cD||={});var lD;(function(e){e[e.Unknown=0]=`Unknown`,e[e.Cached=1]=`Cached`,e[e.Outdated=2]=`Outdated`,e[e.RefreshingFromUnknown=3]=`RefreshingFromUnknown`,e[e.RefreshingFromCached=4]=`RefreshingFromCached`,e[e.Live=5]=`Live`})(lD||={});var uD;(function(e){e[e.Stdio=1]=`Stdio`,e[e.HTTP=2]=`HTTP`})(uD||={});var dD;(function(e){function t(e){return e}e.toSerialized=t;function n(e){switch(e.type){case uD.HTTP:return{type:e.type,uri:w.revive(e.uri),headers:e.headers};case uD.Stdio:return{type:e.type,cwd:e.cwd,command:e.command,args:e.args,env:e.env,envFile:e.envFile}}}e.fromSerialized=n;async function r(e){let t=await crypto.subtle.digest(`SHA-256`,new TextEncoder().encode(JSON.stringify(e)));return qt(b.wrap(new Uint8Array(t)))}e.hash=r})(dD||={});var fD;(function(e){let t;(function(e){e[e.Stopped=0]=`Stopped`,e[e.Starting=1]=`Starting`,e[e.Running=2]=`Running`,e[e.Error=3]=`Error`})(t=e.Kind||={}),e.toString=e=>{switch(e.state){case t.Stopped:return C(8370,`Stopped`);case t.Starting:return C(8371,`Starting`);case t.Running:return C(8372,`Running`);case t.Error:return C(8373,`Error {0}`,e.message);default:Je()}},e.toKindString=e=>{switch(e){case t.Stopped:return`stopped`;case t.Starting:return`starting`;case t.Running:return`running`;case t.Error:return`error`;default:Je()}},e.canBeStarted=e=>e===t.Error||e===t.Stopped,e.isRunning=t=>!e.canBeStarted(t.state)})(fD||={});var pD;(function(e){e[e.Installing=0]=`Installing`,e[e.Installed=1]=`Installed`,e[e.Uninstalling=2]=`Uninstalling`,e[e.Uninstalled=3]=`Uninstalled`})(pD||={});var mD;(function(e){e.Readme=`readme`,e.Manifest=`manifest`,e.Configuration=`configuration`})(mD||={});let hD=class extends y{constructor(e,t){super(),this.containers=e,this._register(t.onChange(this.update,this))}set mcpServer(e){this.containers.forEach(t=>t.mcpServer=e)}update(e){for(let t of this.containers)e&&t.mcpServer?e.id===t.mcpServer.id&&(t.mcpServer=e):t.update()}};hD=A([j(1,eD)],hD),new I(`mcpServersGalleryEnabled`,!1),new I(`hasInstalledMcpServers`,!0);var gD;(function(e){e.scheme=`mcp-resource`;let t=`dylo78gyp`;function n(n,r){return typeof r==`string`&&(r=w.parse(r)),r.with({scheme:e.scheme,authority:qt(b.fromString(n.id)),path:[``,r.scheme,r.authority||t].join(`/`)+r.path})}e.fromServer=n;function r(n){if(typeof n==`string`&&(n=w.parse(n)),n.scheme!==e.scheme)throw Error(`Invalid MCP resource URI: ${n.toString()}`);let r=n.path.split(`/`);if(r.length<3)throw Error(`Invalid MCP resource URI: ${n.toString()}`);let[,i,a,...o]=r,s=new URL(`${i}://${a.toLowerCase()===t?``:a}`);return s.pathname=o.length?`/`+o.join(`/`):``,s.search=n.query,s.hash=n.fragment,{definitionId:Jt(n.authority).toString(),resourceURL:s}}e.toServer=r})(gD||={});var _D;(function(e){e[e.Logging=1]=`Logging`,e[e.Completions=2]=`Completions`,e[e.Prompts=4]=`Prompts`,e[e.PromptsListChanged=8]=`PromptsListChanged`,e[e.Resources=16]=`Resources`,e[e.ResourcesSubscribe=32]=`ResourcesSubscribe`,e[e.ResourcesListChanged=64]=`ResourcesListChanged`,e[e.Tools=128]=`Tools`,e[e.ToolsListChanged=256]=`ToolsListChanged`})(_D||={});var vD;(function(e){e.Prefix=`mcp_`,e[e.MaxPrefixLen=18]=`MaxPrefixLen`,e[e.MaxLength=64]=`MaxLength`})(vD||={});var yD;(function(e){function t(e){let{selectionStartLineNumber:t,selectionStartColumn:n,positionLineNumber:r,positionColumn:i}=e,a=new Fb(t-1,n-1),o=new Fb(r-1,i-1);return new Lb(a,o)}e.to=t;function n(e){let{anchor:t,active:n}=e;return{selectionStartLineNumber:t.line+1,selectionStartColumn:t.character+1,positionLineNumber:n.line+1,positionColumn:n.character+1}}e.from=n})(yD||={});var K;(function(e){function t(e){if(!e)return;let{start:t,end:n}=e;return{startLineNumber:t.line+1,startColumn:t.character+1,endLineNumber:n.line+1,endColumn:n.character+1}}e.from=t;function n(e){if(!e)return;let{startLineNumber:t,startColumn:n,endLineNumber:r,endColumn:i}=e;return new Ib(t-1,n-1,r-1,i-1)}e.to=n})(K||={});var bD;(function(e){function t(e){return{uri:e.uri,range:K.from(e.range)}}e.from=t;function n(e){return new ex(w.revive(e.uri),K.to(e.range))}e.to=n})(bD||={});var xD;(function(e){function t(e){switch(e){case Sp.Comment:return ew.Comment;case Sp.Other:return ew.Other;case Sp.RegEx:return ew.RegEx;case Sp.String:return ew.String}}e.to=t})(xD||={});var SD;(function(e){function t(e){return new Fb(e.lineNumber-1,e.column-1)}e.to=t;function n(e){return{lineNumber:e.line+1,column:e.character+1}}e.from=n})(SD||={});var CD;(function(e){function t(e,t,r){return be(De(e).map(e=>n(e,t,r)))}e.from=t;function n(e,t,n){if(typeof e==`string`)return{$serialized:!0,language:e,isBuiltin:n?.isBuiltin};if(e)return{$serialized:!0,language:e.language,scheme:r(e.scheme,t),pattern:wO.from(e.pattern)??void 0,exclusive:e.exclusive,notebookType:e.notebookType,isBuiltin:n?.isBuiltin}}function r(e,t){return t&&typeof e==`string`?t.transformOutgoingScheme(e):e}})(CD||={});var wD;(function(e){function t(e){switch(e){case Qb.Unnecessary:return mm.Unnecessary;case Qb.Deprecated:return mm.Deprecated}}e.from=t;function n(e){switch(e){case mm.Unnecessary:return Qb.Unnecessary;case mm.Deprecated:return Qb.Deprecated;default:return}}e.to=n})(wD||={});var TD;(function(e){function t(e){let t;return e.code&&(t=Ze(e.code)||tt(e.code)?String(e.code):{value:String(e.code.value),target:e.code.target}),{...K.from(e.range),message:e.message,source:e.source,code:t,severity:DD.from(e.severity),relatedInformation:e.relatedInformation&&e.relatedInformation.map(ED.from),tags:Array.isArray(e.tags)?be(e.tags.map(wD.from)):void 0}}e.from=t;function n(e){let t=new nx(K.to(e),e.message,DD.to(e.severity));return t.source=e.source,t.code=Ze(e.code)?e.code:e.code?.value,t.relatedInformation=e.relatedInformation&&e.relatedInformation.map(ED.to),t.tags=e.tags&&be(e.tags.map(wD.to)),t}e.to=n})(TD||={});var ED;(function(e){function t(e){return{...K.from(e.location.range),message:e.message,resource:e.location.uri}}e.from=t;function n(e){return new tx(new ex(e.resource,K.to(e)),e.message)}e.to=n})(ED||={});var DD;(function(e){function t(e){switch(e){case $b.Error:return hm.Error;case $b.Warning:return hm.Warning;case $b.Information:return hm.Info;case $b.Hint:return hm.Hint}return hm.Error}e.from=t;function n(e){switch(e){case hm.Info:return $b.Information;case hm.Warning:return $b.Warning;case hm.Error:return $b.Error;case hm.Hint:return $b.Hint;default:return $b.Error}}e.to=n})(DD||={});var OD;(function(e){function t(e){return typeof e==`number`&&e>=Rx.One?e-1:e===Rx.Beside?-2:-1}e.from=t;function n(e){if(typeof e==`number`&&e>=0)return e+1;throw Error(`invalid 'EditorGroupColumn'`)}e.to=n})(OD||={});function kD(e){return e.range!==void 0}function AD(e){return e.length===0?!0:!!kD(e[0])}var jD;(function(e){function t(t){return t.map(e.from)}e.fromMany=t;function n(e){return e&&typeof e==`object`&&typeof e.language==`string`&&typeof e.value==`string`}function r(e){let t;if(n(e)){let{language:n,value:r}=e;t={value:"```"+n+`
`+r+"\n```\n"}}else t=Sx.isMarkdownString(e)?{value:e.value,isTrusted:e.isTrusted,supportThemeIcons:e.supportThemeIcons,supportHtml:e.supportHtml,baseUri:e.baseUri}:typeof e==`string`?{value:e}:{value:``};let r=Object.create(null);t.uris=r;let a=({href:e})=>{try{let t=w.parse(e,!0);t=t.with({query:i(t.query,r)}),r[e]=t}catch{}return``};return Vu.walkTokens(Vu.lexer(t.value),e=>{e.type===`link`?a({href:e.href}):e.type===`image`&&typeof e.href==`string`&&a(xl(e.href))}),t}e.from=r;function i(e,t){if(!e)return e;let n;try{n=Uu(e)}catch{}if(!n)return e;let r=!1;return n=Qs(n,e=>{if(w.isUri(e)){let n=`__uri_${Math.random().toString(16).slice(2,8)}`;return t[n]=e,r=!0,n}else return}),r?JSON.stringify(n):e}function a(e){let t=new Sx(e.value,e.supportThemeIcons);return t.isTrusted=e.isTrusted,t.supportHtml=e.supportHtml,t.baseUri=e.baseUri?w.from(e.baseUri):void 0,t}e.to=a;function o(t){if(t)return typeof t==`string`?t:e.from(t)}e.fromStrict=o})(jD||={});function MD(e){return AD(e)?e.map(e=>({range:K.from(e.range),hoverMessage:Array.isArray(e.hoverMessage)?jD.fromMany(e.hoverMessage):e.hoverMessage?jD.from(e.hoverMessage):void 0,renderOptions:e.renderOptions})):e.map(e=>({range:K.from(e)}))}function ND(e){return e===void 0?e:typeof e==`string`?w.file(e):e}var PD;(function(e){function t(e){return e===void 0?e:{contentText:e.contentText,contentIconPath:e.contentIconPath?ND(e.contentIconPath):void 0,border:e.border,borderColor:e.borderColor,fontStyle:e.fontStyle,fontWeight:e.fontWeight,textDecoration:e.textDecoration,color:e.color,backgroundColor:e.backgroundColor,margin:e.margin,width:e.width,height:e.height}}e.from=t})(PD||={});var FD;(function(e){function t(e){return e===void 0?e:{backgroundColor:e.backgroundColor,outline:e.outline,outlineColor:e.outlineColor,outlineStyle:e.outlineStyle,outlineWidth:e.outlineWidth,border:e.border,borderColor:e.borderColor,borderRadius:e.borderRadius,borderSpacing:e.borderSpacing,borderStyle:e.borderStyle,borderWidth:e.borderWidth,fontStyle:e.fontStyle,fontWeight:e.fontWeight,textDecoration:e.textDecoration,cursor:e.cursor,color:e.color,opacity:e.opacity,letterSpacing:e.letterSpacing,gutterIconPath:e.gutterIconPath?ND(e.gutterIconPath):void 0,gutterIconSize:e.gutterIconSize,overviewRulerColor:e.overviewRulerColor,before:e.before?PD.from(e.before):void 0,after:e.after?PD.from(e.after):void 0}}e.from=t})(FD||={});var ID;(function(e){function t(e){if(e===void 0)return e;switch(e){case qx.OpenOpen:return lm.AlwaysGrowsWhenTypingAtEdges;case qx.ClosedClosed:return lm.NeverGrowsWhenTypingAtEdges;case qx.OpenClosed:return lm.GrowsOnlyWhenTypingBefore;case qx.ClosedOpen:return lm.GrowsOnlyWhenTypingAfter}}e.from=t})(ID||={});var LD;(function(e){function t(e){return{isWholeLine:e.isWholeLine,rangeBehavior:e.rangeBehavior?ID.from(e.rangeBehavior):void 0,overviewRulerLane:e.overviewRulerLane,light:e.light?FD.from(e.light):void 0,dark:e.dark?FD.from(e.dark):void 0,backgroundColor:e.backgroundColor,outline:e.outline,outlineColor:e.outlineColor,outlineStyle:e.outlineStyle,outlineWidth:e.outlineWidth,border:e.border,borderColor:e.borderColor,borderRadius:e.borderRadius,borderSpacing:e.borderSpacing,borderStyle:e.borderStyle,borderWidth:e.borderWidth,fontStyle:e.fontStyle,fontWeight:e.fontWeight,textDecoration:e.textDecoration,cursor:e.cursor,color:e.color,opacity:e.opacity,letterSpacing:e.letterSpacing,gutterIconPath:e.gutterIconPath?ND(e.gutterIconPath):void 0,gutterIconSize:e.gutterIconSize,overviewRulerColor:e.overviewRulerColor,before:e.before?PD.from(e.before):void 0,after:e.after?PD.from(e.after):void 0}}e.from=t})(LD||={});var RD;(function(e){function t(e){return{text:e.newText,eol:e.newEol&&yO.from(e.newEol),range:K.from(e.range)}}e.from=t;function n(e){let t=new Kb(K.to(e.range),e.text);return t.newEol=e.eol===void 0?void 0:yO.to(e.eol),t}e.to=n})(RD||={});var zD;(function(e){function t(e,t){let n={edits:[]};if(e instanceof Xb){let r=new Be;for(let t of e._allEntries())t._type===Yb.File&&w.isUri(t.to)&&t.from===void 0&&r.add(t.to);for(let i of e._allEntries())if(i._type===Yb.File){let e;i.options?.contents&&(e=ArrayBuffer.isView(i.options.contents)?{type:`base64`,value:Gt(b.wrap(i.options.contents))}:{type:`dataTransferItem`,id:i.options.contents._itemId}),n.edits.push({oldResource:i.from,newResource:i.to,options:{...i.options,contents:e},metadata:i.metadata})}else i._type===Yb.Text?n.edits.push({resource:i.uri,textEdit:RD.from(i.edit),versionId:r.has(i.uri)?void 0:t?.getTextDocumentVersion(i.uri),metadata:i.metadata}):i._type===Yb.Snippet?n.edits.push({resource:i.uri,textEdit:{range:K.from(i.range),text:i.edit.value,insertAsSnippet:!0,keepWhitespace:i.keepWhitespace},versionId:r.has(i.uri)?void 0:t?.getTextDocumentVersion(i.uri),metadata:i.metadata}):i._type===Yb.Cell?n.edits.push({metadata:i.metadata,resource:i.uri,cellEdit:i.edit,notebookVersionId:t?.getNotebookDocumentVersion(i.uri)}):i._type===Yb.CellReplace&&n.edits.push({metadata:i.metadata,resource:i.uri,notebookVersionId:t?.getNotebookDocumentVersion(i.uri),cellEdit:{editType:Yv.Replace,index:i.index,count:i.count,cells:i.cells.map(AO.from)}})}return n}e.from=t;function n(e){let t=new Xb,n=new ze;for(let r of e.edits)if(r.textEdit){let e=r,t=w.revive(e.resource),i=K.to(e.textEdit.range),a=e.textEdit.text,o=e.textEdit.insertAsSnippet,s;s=o?Jb.replace(i,new Zb(a)):Kb.replace(i,a);let c=n.get(t);c?c.push(s):n.set(t,[s])}else t.renameFile(w.revive(r.oldResource),w.revive(r.newResource),r.options);for(let[e,r]of n)t.set(e,r);return t}e.to=n})(zD||={});var BD;(function(e){let t=Object.create(null);t[lx.File]=H.File,t[lx.Module]=H.Module,t[lx.Namespace]=H.Namespace,t[lx.Package]=H.Package,t[lx.Class]=H.Class,t[lx.Method]=H.Method,t[lx.Property]=H.Property,t[lx.Field]=H.Field,t[lx.Constructor]=H.Constructor,t[lx.Enum]=H.Enum,t[lx.Interface]=H.Interface,t[lx.Function]=H.Function,t[lx.Variable]=H.Variable,t[lx.Constant]=H.Constant,t[lx.String]=H.String,t[lx.Number]=H.Number,t[lx.Boolean]=H.Boolean,t[lx.Array]=H.Array,t[lx.Object]=H.Object,t[lx.Key]=H.Key,t[lx.Null]=H.Null,t[lx.EnumMember]=H.EnumMember,t[lx.Struct]=H.Struct,t[lx.Event]=H.Event,t[lx.Operator]=H.Operator,t[lx.TypeParameter]=H.TypeParameter;function n(e){return typeof t[e]==`number`?t[e]:H.Property}e.from=n;function r(e){for(let n in t)if(t[n]===e)return Number(n);return lx.Property}e.to=r})(BD||={});var VD;(function(e){function t(e){switch(e){case ux.Deprecated:return Bp.Deprecated}}e.from=t;function n(e){switch(e){case Bp.Deprecated:return ux.Deprecated}}e.to=n})(VD||={});var HD;(function(e){function t(e){return{name:e.name,kind:BD.from(e.kind),tags:e.tags&&e.tags.map(VD.from),containerName:e.containerName,location:qD.from(e.location)}}e.from=t;function n(e){let t=new dx(e.name,BD.to(e.kind),e.containerName,qD.to(e.location));return t.tags=e.tags&&e.tags.map(VD.to),t}e.to=n})(HD||={});var UD;(function(e){function t(e){let n={name:e.name||`!!MISSING: name!!`,detail:e.detail,range:K.from(e.range),selectionRange:K.from(e.selectionRange),kind:BD.from(e.kind),tags:e.tags?.map(VD.from)??[]};return e.children&&(n.children=e.children.map(t)),n}e.from=t;function n(e){let t=new fx(e.name,e.detail,BD.to(e.kind),K.to(e.range),K.to(e.selectionRange));return Ce(e.tags)&&(t.tags=e.tags.map(VD.to)),e.children&&(t.children=e.children.map(n)),t}e.to=n})(UD||={});var WD;(function(e){function t(e){let t=new _x(BD.to(e.kind),e.name,e.detail||``,w.revive(e.uri),K.to(e.range),K.to(e.selectionRange));return t._sessionId=e._sessionId,t._itemId=e._itemId,t}e.to=t;function n(e,t,n){if(t??=e._sessionId,n??=e._itemId,t===void 0||n===void 0)throw Error(`invalid item`);return{_sessionId:t,_itemId:n,name:e.name,detail:e.detail,kind:BD.from(e.kind),uri:e.uri,range:K.from(e.range),selectionRange:K.from(e.selectionRange),tags:e.tags?.map(VD.from)}}e.from=n})(WD||={});var GD;(function(e){function t(e){return new vx(WD.to(e.from),e.fromRanges.map(e=>K.to(e)))}e.to=t})(GD||={});var KD;(function(e){function t(e){return new yx(WD.to(e.to),e.fromRanges.map(e=>K.to(e)))}e.to=t})(KD||={});var qD;(function(e){function t(e){return{range:e.range&&K.from(e.range),uri:e.uri}}e.from=t;function n(e){return new ex(w.revive(e.uri),K.to(e.range))}e.to=n})(qD||={});var JD;(function(e){function t(e){let t=e,n=e;return{originSelectionRange:t.originSelectionRange?K.from(t.originSelectionRange):void 0,uri:t.targetUri?t.targetUri:n.uri,range:K.from(t.targetRange?t.targetRange:n.range),targetSelectionRange:t.targetSelectionRange?K.from(t.targetSelectionRange):void 0}}e.from=t;function n(e){return{targetUri:w.revive(e.uri),targetRange:K.to(e.range),targetSelectionRange:e.targetSelectionRange?K.to(e.targetSelectionRange):void 0,originSelectionRange:e.originSelectionRange?K.to(e.originSelectionRange):void 0}}e.to=n})(JD||={});var YD;(function(e){function t(e){let t={range:K.from(e.range),contents:jD.fromMany(e.contents),canIncreaseVerbosity:e.canIncreaseVerbosity,canDecreaseVerbosity:e.canDecreaseVerbosity};return t}e.from=t;function n(e){let t=e.contents.map(jD.to),n=K.to(e.range),r=e.canIncreaseVerbosity,i=e.canDecreaseVerbosity;return new ix(t,n,r,i)}e.to=n})(YD||={});var XD;(function(e){function t(e){return{range:K.from(e.range),expression:e.expression}}e.from=t;function n(e){return new $S(K.to(e.range),e.expression)}e.to=n})(XD||={});var ZD;(function(e){function t(e){if(e instanceof nC)return{type:`text`,range:K.from(e.range),text:e.text};if(e instanceof rC)return{type:`variable`,range:K.from(e.range),variableName:e.variableName,caseSensitiveLookup:e.caseSensitiveLookup};if(e instanceof iC)return{type:`expression`,range:K.from(e.range),expression:e.expression};throw Error(`Unknown 'InlineValue' type`)}e.from=t;function n(e){switch(e.type){case`text`:return{range:K.to(e.range),text:e.text};case`variable`:return{range:K.to(e.range),variableName:e.variableName,caseSensitiveLookup:e.caseSensitiveLookup};case`expression`:return{range:K.to(e.range),expression:e.expression}}}e.to=n})(ZD||={});var QD;(function(e){function t(e){return{frameId:e.frameId,stoppedLocation:K.from(e.stoppedLocation)}}e.from=t;function n(e){return new aC(e.frameId,K.to(e.stoppedLocation))}e.to=n})(QD||={});var $D;(function(e){function t(e){return{range:K.from(e.range),kind:e.kind}}e.from=t;function n(e){return new sx(K.to(e.range),e.kind)}e.to=n})($D||={});var eO;(function(e){function t(e){return{uri:e.uri,highlights:e.highlights.map($D.from)}}e.from=t;function n(e){return new cx(w.revive(e.uri),e.highlights.map($D.to))}e.to=n})(eO||={});var tO;(function(e){function t(e){switch(e){case jp.TriggerCharacter:return Ax.TriggerCharacter;case jp.TriggerForIncompleteCompletions:return Ax.TriggerForIncompleteCompletions;case jp.Invoke:default:return Ax.Invoke}}e.to=t})(tO||={});var nO;(function(e){function t(e){return{triggerKind:tO.to(e.triggerKind),triggerCharacter:e.triggerCharacter}}e.to=t})(nO||={});var rO;(function(e){function t(e){switch(e){case jx.Deprecated:return Op.Deprecated}}e.from=t;function n(e){switch(e){case Op.Deprecated:return jx.Deprecated}}e.to=n})(rO||={});var iO;(function(e){function t(e,t,n){return`icon`in e&&`command`in e?{command:t.toInternal(e.command,n),icon:Uk.fromThemeIcon(e.icon)}:{command:t.toInternal(e,n)}}e.from=t})(iO||={});var aO;(function(e){let t=new Map([[G.Method,V.Method],[G.Function,V.Function],[G.Constructor,V.Constructor],[G.Field,V.Field],[G.Variable,V.Variable],[G.Class,V.Class],[G.Interface,V.Interface],[G.Struct,V.Struct],[G.Module,V.Module],[G.Property,V.Property],[G.Unit,V.Unit],[G.Value,V.Value],[G.Constant,V.Constant],[G.Enum,V.Enum],[G.EnumMember,V.EnumMember],[G.Keyword,V.Keyword],[G.Snippet,V.Snippet],[G.Text,V.Text],[G.Color,V.Color],[G.File,V.File],[G.Reference,V.Reference],[G.Folder,V.Folder],[G.Event,V.Event],[G.Operator,V.Operator],[G.TypeParameter,V.TypeParameter],[G.Issue,V.Issue],[G.User,V.User]]);function n(e){return t.get(e)??V.Property}e.from=n;let r=new Map([[V.Method,G.Method],[V.Function,G.Function],[V.Constructor,G.Constructor],[V.Field,G.Field],[V.Variable,G.Variable],[V.Class,G.Class],[V.Interface,G.Interface],[V.Struct,G.Struct],[V.Module,G.Module],[V.Property,G.Property],[V.Unit,G.Unit],[V.Value,G.Value],[V.Constant,G.Constant],[V.Enum,G.Enum],[V.EnumMember,G.EnumMember],[V.Keyword,G.Keyword],[V.Snippet,G.Snippet],[V.Text,G.Text],[V.Color,G.Color],[V.File,G.File],[V.Reference,G.Reference],[V.Folder,G.Folder],[V.Event,G.Event],[V.Operator,G.Operator],[V.TypeParameter,G.TypeParameter],[V.User,G.User],[V.Issue,G.Issue]]);function i(e){return r.get(e)??G.Property}e.to=i})(aO||={});var oO;(function(e){function t(e,t){let n=new Mx(e.label);return n.insertText=e.insertText,n.kind=aO.to(e.kind),n.tags=e.tags?.map(rO.to),n.detail=e.detail,n.documentation=vl(e.documentation)?jD.to(e.documentation):e.documentation,n.sortText=e.sortText,n.filterText=e.filterText,n.preselect=e.preselect,n.commitCharacters=e.commitCharacters,vp.isIRange(e.range)?n.range=K.to(e.range):typeof e.range==`object`&&(n.range={inserting:K.to(e.range.insert),replacing:K.to(e.range.replace)}),n.keepWhitespace=e.insertTextRules===void 0?!1:!!(e.insertTextRules&kp.KeepWhitespace),e.insertTextRules!==void 0&&e.insertTextRules&kp.InsertAsSnippet?n.insertText=new Zb(e.insertText):(n.insertText=e.insertText,n.textEdit=n.range instanceof Ib?new Kb(n.range,n.insertText):void 0),e.additionalTextEdits&&e.additionalTextEdits.length>0&&(n.additionalTextEdits=e.additionalTextEdits.map(e=>RD.to(e))),n.command=t&&e.command?t.fromInternal(e.command):void 0,n}e.to=t})(oO||={});var sO;(function(e){function t(e){if(typeof e.label!=`string`&&!Array.isArray(e.label))throw TypeError(`Invalid label`);return{label:e.label,documentation:jD.fromStrict(e.documentation)}}e.from=t;function n(e){return{label:e.label,documentation:vl(e.documentation)?jD.to(e.documentation):e.documentation}}e.to=n})(sO||={});var cO;(function(e){function t(e){return{label:e.label,documentation:jD.fromStrict(e.documentation),parameters:Array.isArray(e.parameters)?e.parameters.map(sO.from):[],activeParameter:e.activeParameter}}e.from=t;function n(e){return{label:e.label,documentation:vl(e.documentation)?jD.to(e.documentation):e.documentation,parameters:Array.isArray(e.parameters)?e.parameters.map(sO.to):[],activeParameter:e.activeParameter}}e.to=n})(cO||={});var lO;(function(e){function t(e){return{activeSignature:e.activeSignature,activeParameter:e.activeParameter,signatures:Array.isArray(e.signatures)?e.signatures.map(cO.from):[]}}e.from=t;function n(e){return{activeSignature:e.activeSignature,activeParameter:e.activeParameter,signatures:Array.isArray(e.signatures)?e.signatures.map(cO.to):[]}}e.to=n})(lO||={});var uO;(function(e){function t(e,t){let n=new kx(SD.to(t.position),typeof t.label==`string`?t.label:t.label.map(dO.to.bind(void 0,e)),t.kind&&fO.to(t.kind));return n.textEdits=t.textEdits&&t.textEdits.map(RD.to),n.tooltip=vl(t.tooltip)?jD.to(t.tooltip):t.tooltip,n.paddingLeft=t.paddingLeft,n.paddingRight=t.paddingRight,n}e.to=t})(uO||={});var dO;(function(e){function t(e,t){let n=new Ox(t.label);return n.tooltip=vl(t.tooltip)?jD.to(t.tooltip):t.tooltip,Gp.is(t.command)&&(n.command=e.fromInternal(t.command)),t.location&&(n.location=qD.to(t.location)),n}e.to=t})(dO||={});var fO;(function(e){function t(e){return e}e.from=t;function n(e){return e}e.to=n})(fO||={});var pO;(function(e){function t(e){return{range:K.from(e.range),url:e.target,tooltip:e.tooltip}}e.from=t;function n(e){let t;if(e.url)try{t=typeof e.url==`string`?w.parse(e.url,!0):w.revive(e.url)}catch{}let n=new Yx(K.to(e.range),t);return n.tooltip=e.tooltip,n}e.to=n})(pO||={});var mO;(function(e){function t(e){let t=new Qx(e.label);return e.textEdit&&(t.textEdit=RD.to(e.textEdit)),e.additionalTextEdits&&(t.additionalTextEdits=e.additionalTextEdits.map(e=>RD.to(e))),t}e.to=t;function n(e){return{label:e.label,textEdit:e.textEdit?RD.from(e.textEdit):void 0,additionalTextEdits:e.additionalTextEdits?e.additionalTextEdits.map(e=>RD.from(e)):void 0}}e.from=n})(mO||={});var hO;(function(e){function t(e){return new Xx(e[0],e[1],e[2],e[3])}e.to=t;function n(e){return[e.red,e.green,e.blue,e.alpha]}e.from=n})(hO||={});var gO;(function(e){function t(e){return{range:K.from(e.range)}}e.from=t;function n(e){return new gx(K.to(e.range))}e.to=n})(gO||={});var _O;(function(e){function t(e){switch(e){case zm.AUTO:return Hx.AfterDelay;case zm.EXPLICIT:return Hx.Manual;case zm.FOCUS_CHANGE:case zm.WINDOW_CHANGE:return Hx.FocusOut}}e.to=t})(_O||={});var vO;(function(e){function t(e){switch(e){case Vx.Off:return Jf.Off;case Vx.Relative:return Jf.Relative;case Vx.Interval:return Jf.Interval;case Vx.On:default:return Jf.On}}e.from=t;function n(e){switch(e){case Jf.Off:return Vx.Off;case Jf.Relative:return Vx.Relative;case Jf.Interval:return Vx.Interval;case Jf.On:default:return Vx.On}}e.to=n})(vO||={});var yO;(function(e){function t(e){if(e===Wb.CRLF)return sm.CRLF;if(e===Wb.LF)return sm.LF}e.from=t;function n(e){if(e===sm.CRLF)return Wb.CRLF;if(e===sm.LF)return Wb.LF}e.to=n})(yO||={});var bO;(function(e){function t(e){if(typeof e==`object`)return e.viewId;switch(e){case CS.SourceControl:return vm.Scm;case CS.Window:return vm.Window;case CS.Notification:return vm.Notification}throw Error(`Unknown 'ProgressLocation'`)}e.from=t})(bO||={});var xO;(function(e){function t(e){let t={start:e.start+1,end:e.end+1};return e.kind&&(t.kind=SO.from(e.kind)),t}e.from=t;function n(e){let t={start:e.start-1,end:e.end-1};return e.kind&&(t.kind=SO.to(e.kind)),t}e.to=n})(xO||={});var SO;(function(e){function t(e){if(e)switch(e){case fC.Comment:return Hp.Comment;case fC.Imports:return Hp.Imports;case fC.Region:return Hp.Region}}e.from=t;function n(e){if(e)switch(e.value){case Hp.Comment.value:return fC.Comment;case Hp.Imports.value:return fC.Imports;case Hp.Region.value:return fC.Region}}e.to=n})(SO||={});var CO;(function(e){function t(e){if(e)return{pinned:typeof e.preview==`boolean`?!e.preview:void 0,inactive:e.background,preserveFocus:e.preserveFocus,selection:typeof e.selection==`object`?K.from(e.selection):void 0,override:typeof e.override==`boolean`?km.id:void 0}}e.from=t})(CO||={});var wO;(function(e){function t(e){return e instanceof BS?e.toJSON():typeof e==`string`?e:n(e)||r(e)?new BS(e.baseUri??e.base,e.pattern).toJSON():e}e.from=t;function n(e){let t=e;return t?w.isUri(t.baseUri)&&typeof t.pattern==`string`:!1}function r(e){let t=e;return t?typeof t.base==`string`&&typeof t.pattern==`string`:!1}function i(e){return typeof e==`string`?e:new BS(w.revive(e.baseUri),e.pattern)}e.to=i})(wO||={});var TO;(function(e){function t(e){if(e){if(Array.isArray(e))return e.map(t);if(typeof e==`string`)return e;{let t=e;return{language:t.language,scheme:t.scheme,pattern:wO.from(t.pattern)??void 0,exclusive:t.exclusive,notebookType:t.notebookType}}}else return}e.from=t})(TO||={});var EO;(function(e){function t(e){return{start:e.start,end:e.end}}e.from=t;function n(e){return new FC(e.start,e.end)}e.to=n})(EO||={});var DO;(function(e){function t(e){return{timing:typeof e.runStartTime==`number`&&typeof e.runEndTime==`number`?{startTime:e.runStartTime,endTime:e.runEndTime}:void 0,executionOrder:e.executionOrder,success:e.lastRunSuccess}}e.to=t;function n(e){return{lastRunSuccess:e.success,runStartTime:e.timing?.startTime,runEndTime:e.timing?.endTime,executionOrder:e.executionOrder}}e.from=n})(DO||={});var OO;(function(e){function t(e){switch(e){case VC.Markup:return Vv.Markup;case VC.Code:default:return Vv.Code}}e.from=t;function n(e){switch(e){case Vv.Markup:return VC.Markup;case Vv.Code:default:return VC.Code}}e.to=n})(OO||={});var kO;(function(e){function t(e){let t={metadata:e.metadata??Object.create(null),cells:[]};for(let n of e.cells)IC.validate(n),t.cells.push(AO.from(n));return t}e.from=t;function n(e){let t=new LC(e.cells.map(AO.to));return lt(e.metadata)||(t.metadata=e.metadata),t}e.to=n})(kO||={});var AO;(function(e){function t(e){return{cellKind:OO.from(e.kind),language:e.languageId,mime:e.mime,source:e.value,metadata:e.metadata,internalMetadata:DO.from(e.executionSummary??{}),outputs:e.outputs?e.outputs.map(MO.from):[]}}e.from=t;function n(e){return new IC(OO.to(e.cellKind),e.source,e.language,e.mime,e.outputs?e.outputs.map(MO.to):void 0,e.metadata,e.internalMetadata?DO.to(e.internalMetadata):void 0)}e.to=n})(AO||={});var jO;(function(e){function t(e){return{mime:e.mime,valueBytes:b.wrap(e.data)}}e.from=t;function n(e){return new RC(e.valueBytes.buffer,e.mime)}e.to=n})(jO||={});var MO;(function(e){function t(e){return{outputId:e.id,items:e.items.map(jO.from),metadata:e.metadata}}e.from=t;function n(e){let t=e.items.map(jO.to);return new zC(t,e.outputId,e.metadata)}e.to=n})(MO||={});var NO;(function(e){function t(e){return r(e)?{include:wO.from(e.include)??void 0,exclude:wO.from(e.exclude)??void 0}:wO.from(e)??void 0}e.from=t;function n(e){return r(e)?{include:wO.to(e.include),exclude:wO.to(e.exclude)}:wO.to(e)}e.to=n;function r(e){let t=e;return t?!at(t.include)&&!at(t.exclude):!1}})(NO||={});var PO;(function(e){function t(e,t,n){let r=typeof e.command==`string`?{title:``,command:e.command}:e.command;return{alignment:e.alignment===UC.Left?ey.Left:ey.Right,command:t.toInternal(r,n),text:e.text,tooltip:e.tooltip,accessibilityInformation:e.accessibilityInformation,priority:e.priority}}e.from=t})(PO||={});var FO;(function(e){function t(e,t,n){let r=typeof e.command==`string`?{title:``,command:e.command}:e.command;return{command:t.toInternal(r,n),label:e.label,description:e.description,detail:e.detail,documentation:e.documentation}}e.from=t})(FO||={});var IO;(function(e){function t(e){return{transientOutputs:e?.transientOutputs??!1,transientCellMetadata:e?.transientCellMetadata??{},transientDocumentMetadata:e?.transientDocumentMetadata??{},cellContentMetadata:e?.cellContentMetadata??{}}}e.from=t})(IO||={});var LO;(function(e){function t(e){return{uri:e.uri,provides:e.provides}}e.from=t;function n(e){return new JC(w.revive(e.uri),e.provides)}e.to=n})(LO||={});var RO;(function(e){function t(e){return{message:jD.fromStrict(e.message)||``,type:vy.Error,expected:e.expectedOutput,actual:e.actualOutput,contextValue:e.contextValue,location:e.location&&{range:K.from(e.location.range),uri:e.location.uri},stackTrace:e.stackTrace?.map(e=>({label:e.label,position:e.position&&SD.from(e.position),uri:e.uri&&w.revive(e.uri).toJSON()}))}}e.from=t;function n(e){let t=new sw(typeof e.message==`string`?e.message:jD.to(e.message));return t.actualOutput=e.actual,t.expectedOutput=e.expected,t.contextValue=e.contextValue,t.location=e.location?qD.to(e.location):void 0,t}e.to=n})(RO||={});var zO;(function(e){e.namespace=wy,e.denamespace=Ty})(zO||={});var BO;(function(e){function t(e){return{controllerId:e.controllerId,profileId:e.profileId,group:VO.from(e.kind)}}e.from=t})(BO||={});var VO;(function(e){let t={[iw.Coverage]:hy.Coverage,[iw.Debug]:hy.Debug,[iw.Run]:hy.Run};function n(e){return t.hasOwnProperty(e)?t[e]:hy.Run}e.from=n})(VO||={});var HO;(function(e){function t(e){let t=lb(e).controllerId;return{extId:dy.fromExtHostTestItem(e,t).toString(),label:e.label,uri:w.revive(e.uri),busy:e.busy,tags:e.tags.map(e=>zO.namespace(t,e.id)),range:vp.lift(K.from(e.range)),description:e.description||null,sortText:e.sortText||null,error:e.error&&jD.fromStrict(e.error)||null}}e.from=t;function n(e){return{parent:void 0,error:void 0,id:dy.fromString(e.extId).localId,label:e.label,uri:w.revive(e.uri),tags:(e.tags||[]).map(e=>{let{tagId:t}=zO.denamespace(e);return new cw(t)}),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>void 0,replace:()=>{},size:0},range:K.to(e.range||void 0),canResolveChildren:!1,busy:e.busy,description:e.description||void 0,sortText:e.sortText||void 0}}e.toPlain=n})(HO||={}),(function(e){function t(e){return{id:e.id}}e.from=t;function n(e){return new cw(e.id)}e.to=n})(zO||={});var UO;(function(e){let t=(e,n)=>{let r=e.value;if(!r)return;let i={...HO.toPlain(r.item),parent:n,taskStates:r.tasks.map(e=>({state:e.state,duration:e.duration,messages:e.messages.filter(e=>e.type===vy.Error).map(RO.to)})),children:[]};if(e.children)for(let n of e.children.values()){let e=t(n,i);e&&i.children.push(e)}return i};function n(e){let n=new Xu;for(let t of e.items)n.insert(dy.fromString(t.item.extId).path,t);let r=[n.nodes],i=[];for(;r.length;)for(let e of r.pop())e.value?i.push(e):e.children&&r.push(e.children.values());return{completedAt:e.completedAt,results:i.map(e=>t(e)).filter(it)}}e.to=n})(UO||={});var WO;(function(e){function t(e){return{covered:e.covered,total:e.total}}function n(e){return`line`in e?SD.from(e):K.from(e)}function r(e){if(e)return`endLineNumber`in e?K.to(e):SD.to(e)}function i(e){if(e.type===Iy.Statement){let t=[];if(e.branches)for(let n of e.branches)t.push({executed:n.count,location:r(n.location),label:n.label});return new pw(e.count,r(e.location),e.branches?.map(e=>new mw(e.count,r(e.location),e.label)))}else return new hw(e.name,e.count,r(e.location))}e.to=i;function a(e){if(typeof e.executed==`number`&&e.executed<0)throw Error(`Invalid coverage count ${e.executed}`);return`branches`in e?{count:e.executed,location:n(e.location),type:Iy.Statement,branches:e.branches.length?e.branches.map(e=>({count:e.executed,location:e.location&&n(e.location),label:e.label})):void 0}:{type:Iy.Declaration,name:e.name,count:e.executed,location:n(e.location)}}e.fromDetails=a;function o(e,n,r){return dw(r.statementCoverage),dw(r.branchCoverage),dw(r.declarationCoverage),{id:n,uri:r.uri,statement:t(r.statementCoverage),branch:r.branchCoverage&&t(r.branchCoverage),declaration:r.declarationCoverage&&t(r.declarationCoverage),testIds:r instanceof fw&&r.includesTests.length?r.includesTests.map(t=>dy.fromExtHostTestItem(t,e).toString()):void 0}}e.fromFile=o})(WO||={});var GO;(function(e){function t(e){switch(e){case Pp.Invoke:return px.Invoke;case Pp.Auto:return px.Automatic}}e.to=t})(GO||={});var KO;(function(e){function t(e){let t=new yw(BD.to(e.kind),e.name,e.detail||``,w.revive(e.uri),K.to(e.range),K.to(e.selectionRange));return t._sessionId=e._sessionId,t._itemId=e._itemId,t}e.to=t;function n(e,t,n){if(t??=e._sessionId,n??=e._itemId,t===void 0||n===void 0)throw Error(`invalid item`);return{_sessionId:t,_itemId:n,kind:BD.from(e.kind),name:e.name,detail:e.detail??``,uri:e.uri,range:K.from(e.range),selectionRange:K.from(e.selectionRange),tags:e.tags?.map(VD.from)}}e.from=n})(KO||={});var qO;(function(e){function t(e){if(e)return{value:e.value,tooltip:e.tooltip}}e.from=t})(qO||={});var JO;(function(e){function t(e,t,n){let r=t.fileData;return r?new AS(new jS(r.name,w.revive(r.uri),r.id,Ke(()=>n(r.id)))):e===Ku.uriList&&t.uriListData?new kS(i(t.uriListData)):new kS(t.asString)}e.to=t;async function n(e,t,n=Nc()){let i=await t.asString();if(e===Ku.uriList)return{id:n,asString:i,fileData:void 0,uriListData:r(i)};let a=t.asFile();return{id:n,asString:i,fileData:a?{name:a.name,uri:a.uri,id:a._itemId??a.id}:void 0}}e.from=n;function r(e){return Pc.split(e).map(e=>{if(e.startsWith(`#`))return e;try{return w.parse(e)}catch{}return e})}function i(e){return Pc.create(e.map(e=>typeof e==`string`?e:w.revive(e)))}})(JO||={});var YO;(function(e){function t(e,t){let n=e.items.map(([e,n])=>[e,JO.to(e,n,t)]);return new MS(n)}e.toDataTransfer=t;async function n(e){let t=await Promise.all(Array.from(e,async([e,t])=>[e,await JO.from(e,t)]));return{items:t}}e.from=n;async function r(e){let t=await Promise.all(Array.from(e,async([e,t])=>[e,await JO.from(e,t,t.id)]));return{items:t}}e.fromList=r})(YO||={});var XO;(function(e){function t(e,t){return{kind:`reply`,agentId:e.participant??t?.agentId??``,subCommand:e.command??t?.command,message:e.prompt,title:e.label}}e.from=t;function n(e){return{prompt:e.message,label:e.title,participant:e.agentId,command:e.subCommand}}e.to=n})(XO||={});var ZO;(function(e){function t(e){switch(e){case V_.System:return hT.System;case V_.User:return hT.User;case V_.Assistant:return hT.Assistant}}e.to=t;function n(e){switch(e){case hT.System:return V_.System;case hT.User:return V_.User;case hT.Assistant:return V_.Assistant}return V_.User}e.from=n})(ZO||={});var QO;(function(e){function t(e){let t=e.content.map(e=>{if(e.type===`text`)return new CT(e.value,e.audience);if(e.type===`tool_result`){let t=e.value.map(e=>e.type===`text`?new CT(e.value,e.audience):new ET(e.value));return new gT(e.toolCallId,t,e.isError)}else if(e.type===`image_url`)return;else if(e.type===`tool_use`)return new xT(e.toolCallId,e.name,e.parameters)}).filter(e=>e!==void 0),n=ZO.to(e.role),r=new yT(n,t,e.name);return r}e.to=t;function n(e){let t=ZO.from(e.role),n=e.name,r=e.content;typeof r==`string`&&(r=[new CT(r)]);let i=r.map(e=>{if(e instanceof gT)return{type:`tool_result`,toolCallId:e.callId,value:be(e.content.map(e=>{if(e instanceof CT)return{type:`text`,value:e.value,audience:e.audience};if(e instanceof ET)return{type:`prompt_tsx`,value:e.value}})),isError:e.isError};if(e instanceof xT)return{type:`tool_use`,toolCallId:e.callId,name:e.name,parameters:e.input};if(e instanceof CT)return{type:`text`,value:e.value};if(typeof e!=`string`)throw Error(`Unexpected chat message content type`);return{type:`text`,value:e}});return{role:t,name:n,content:i}}e.from=n})(QO||={});var $O;(function(e){function t(e){let t=e.content.map(e=>{if(e.type===`text`)return new CT(e.value,e.audience);if(e.type===`tool_result`){let t=e.value.map(e=>e.type===`text`?new CT(e.value,e.audience):e.type===`data`?new wT(e.value.data.buffer,e.value.mimeType):new ET(e.value));return new _T(e.toolCallId,t,e.isError)}else if(e.type===`image_url`)return new wT(e.value.data.buffer,e.value.mimeType);else if(e.type===`data`)return new wT(e.data.buffer,e.mimeType);else return new xT(e.toolCallId,e.name,e.parameters)}),n=ZO.to(e.role),r=new bT(n,t,e.name);return r}e.to=t;function n(e){let t=ZO.from(e.role),n=e.name,r=e.content;typeof r==`string`&&(r=[new CT(r)]);let i=r.map(e=>{if(e instanceof _T||e instanceof gT)return{type:`tool_result`,toolCallId:e.callId,value:be(e.content.map(e=>{if(e instanceof CT)return{type:`text`,value:e.value,audience:e.audience};if(e instanceof ET)return{type:`prompt_tsx`,value:e.value};if(e instanceof wT)return{type:`data`,value:{mimeType:e.mimeType,data:b.wrap(e.data)},audience:e.audience}})),isError:e.isError};if(e instanceof wT)if(ek(e)){let t={mimeType:e.mimeType,data:b.wrap(e.data)};return{type:`image_url`,value:t}}else return{type:`data`,mimeType:e.mimeType,data:b.wrap(e.data),audience:e.audience};else if(e instanceof xT)return{type:`tool_use`,toolCallId:e.callId,name:e.name,parameters:e.input};else if(e instanceof CT)return{type:`text`,value:e.value};else{if(typeof e!=`string`)throw Error(`Unexpected chat message content type llm 2`);return{type:`text`,value:e}}});return{role:t,name:n,content:i}}e.from=n})($O||={});function ek(e){switch(e.mimeType){case TT.PNG:case TT.JPEG:case TT.GIF:case TT.WEBP:case TT.BMP:return!0;default:return!1}}var tk;(function(e){function t(e){return{kind:`markdownContent`,content:jD.from(e.value)}}e.from=t;function n(e){return new zw(jD.to(e.content))}e.to=n})(tk||={});var nk;(function(e){function t(e){return{kind:`codeblockUri`,uri:e.value,isEdit:e.isEdit}}e.from=t;function n(e){return new Xw(w.revive(e.uri),e.isEdit)}e.to=n})(nk||={});var rk;(function(e){function t(e){return{kind:`markdownVuln`,content:jD.from(e.value),vulnerabilities:e.vulnerabilities}}e.from=t;function n(e){return new Bw(jD.to(e.content),e.vulnerabilities)}e.to=n})(rk||={});var ik;(function(e){function t(e){return{kind:`confirmation`,title:e.title,message:jD.from(e.message),data:e.data,buttons:e.buttons}}e.from=t})(ik||={});var ak;(function(e){function t(e){let{value:t,baseUri:n}=e;function r(e,t){return e.map(e=>{let n=w.joinPath(t,e.name);return{label:e.name,uri:n,children:e.children&&r(e.children,n)}})}return{kind:`treeData`,treeData:{label:Xa(n),uri:n,children:r(t,n)}}}e.from=t;function n(e){let t=Gu(e.treeData);function n(e){return e.map(e=>({name:e.label,children:e.children&&n(e.children)}))}let r=t.uri,i=t.children?n(t.children):[];return new Hw(i,r)}e.to=n})(ak||={});var ok;(function(e){function t(e){return{kind:`multiDiffData`,multiDiffData:{title:e.title,resources:e.value.map(e=>({originalUri:e.originalUri,modifiedUri:e.modifiedUri,goToFileUri:e.goToFileUri}))}}}e.from=t;function n(e){let t=e.multiDiffData.resources.map(e=>({originalUri:e.originalUri?w.revive(e.originalUri):void 0,modifiedUri:e.modifiedUri?w.revive(e.modifiedUri):void 0,goToFileUri:e.goToFileUri?w.revive(e.goToFileUri):void 0}));return new Uw(t,e.multiDiffData.title)}e.to=n})(ok||={});var sk;(function(e){function t(e){let t=e=>w.isUri(e),n=e=>`name`in e;return{kind:`inlineReference`,name:e.title,inlineReference:t(e.value)?e.value:n(e.value)?HD.from(e.value):bD.from(e.value)}}e.from=t;function n(e){let t=Gu(e);return new Ww(w.isUri(t.inlineReference)?t.inlineReference:`location`in t.inlineReference?HD.to(t.inlineReference):bD.to(t.inlineReference),e.name)}e.to=n})(sk||={});var ck;(function(e){function t(e){return{kind:`progressMessage`,content:jD.from(e.value)}}e.from=t;function n(e){return new Gw(e.content.value)}e.to=n})(ck||={});var lk;(function(e){function t(e){return{kind:`warning`,content:jD.from(e.value)}}e.from=t;function n(e){return new qw(e.content.value)}e.to=n})(lk||={});var uk;(function(e){function t(e){return{kind:`extensions`,extensions:e.extensions}}e.from=t})(uk||={});var dk;(function(e){function t(e){return{kind:`pullRequest`,author:e.author,title:e.title,description:e.description,uri:e.uri,linkTag:e.linkTag}}e.from=t})(dk||={});var fk;(function(e){function t(e){return{kind:`move`,uri:e.uri,range:K.from(e.range)}}e.from=t;function n(e){return new Qw(w.revive(e.uri),K.to(e.range))}e.to=n})(fk||={});var pk;(function(e){function t(e){return{kind:`prepareToolInvocation`,toolName:e.toolName}}e.from=t;function n(e){return new rT(e.toolName)}e.to=n})(pk||={});var mk;(function(e){function t(e){return{kind:`toolInvocationSerialized`,toolCallId:e.toolCallId,toolId:e.toolName,invocationMessage:e.invocationMessage?jD.from(e.invocationMessage):e.toolName,originMessage:e.originMessage?jD.from(e.originMessage):void 0,pastTenseMessage:e.pastTenseMessage?jD.from(e.pastTenseMessage):void 0,isConfirmed:e.isConfirmed,isComplete:e.isComplete??!0,isError:e.isError??!1,resultDetails:void 0,toolSpecificData:e.toolSpecificData?n(e.toolSpecificData):void 0,presentation:void 0}}e.from=t;function n(e){return`command`in e&&`language`in e?{kind:`terminal`,command:e.command,language:e.language}:`commandLine`in e&&`language`in e?{kind:`terminal`,commandLine:e.commandLine,language:e.language}:e}function r(e){let t=new iT(e.toolId||e.toolName,e.toolCallId,e.isError);return e.invocationMessage&&(t.invocationMessage=e.invocationMessage),e.originMessage&&(t.originMessage=e.originMessage),e.pastTenseMessage&&(t.pastTenseMessage=e.pastTenseMessage),e.isConfirmed!==void 0&&(t.isConfirmed=e.isConfirmed),e.isComplete!==void 0&&(t.isComplete=e.isComplete),e.toolSpecificData&&(t.toolSpecificData=i(e.toolSpecificData)),t}e.to=r;function i(e){return e.kind===`terminal`?{command:e.command,language:e.language}:e.kind===`terminal2`?{commandLine:e.commandLine,language:e.language}:e}})(mk||={});var hk;(function(e){function t(e){return{kind:`progressTask`,content:jD.from(e.value)}}e.from=t})(hk||={});var gk;(function(e){function t(e){return{kind:`progressTaskResult`,content:typeof e==`string`?jD.from(e):void 0}}e.from=t})(gk||={});var _k;(function(e){function t(e,t,n){let r=t.toInternal(e.value,n)??{command:e.value.command,title:e.value.title};return{kind:`command`,command:r}}e.from=t;function n(e,t){return new Jw(t.fromInternal(e.command)??{command:e.command.id,title:e.command.title})}e.to=n})(_k||={});var vk;(function(e){function t(e){return{kind:`textEdit`,uri:e.uri,edits:e.edits.map(e=>RD.from(e)),done:e.isDone}}e.from=t;function n(e){let t=new tT(w.revive(e.uri),e.edits.map(e=>RD.to(e)));return t.isDone=e.done,t}e.to=n})(vk||={});var yk;(function(e){function t(e){return e.newCellMetadata?{editType:Yv.Metadata,index:e.range.start,metadata:e.newCellMetadata}:e.newNotebookMetadata?{editType:Yv.DocumentMetadata,metadata:e.newNotebookMetadata}:{editType:Yv.Replace,index:e.range.start,count:e.range.end-e.range.start,cells:e.newCells.map(AO.from)}}e.from=t})(yk||={});var bk;(function(e){function t(e){return{kind:`notebookEdit`,uri:e.uri,edits:e.edits.map(yk.from),done:e.isDone}}e.from=t})(bk||={});var xk;(function(e){function t(e){let t=fl.isThemeIcon(e.iconPath)?e.iconPath:w.isUri(e.iconPath)?{light:w.revive(e.iconPath)}:e.iconPath&&`light`in e.iconPath&&`dark`in e.iconPath&&w.isUri(e.iconPath.light)&&w.isUri(e.iconPath.dark)?{light:w.revive(e.iconPath.light),dark:w.revive(e.iconPath.dark)}:void 0;return typeof e.value==`object`&&`variableName`in e.value?{kind:`reference`,reference:{variableName:e.value.variableName,value:w.isUri(e.value.value)||!e.value.value?e.value.value:bD.from(e.value.value)},iconPath:t,options:e.options}:{kind:`reference`,reference:w.isUri(e.value)||typeof e.value==`string`?e.value:bD.from(e.value),iconPath:t,options:e.options}}e.from=t;function n(e){let t=Gu(e),n=e=>w.isUri(e)?e:bD.to(e);return new Yw(typeof t.reference==`string`?t.reference:`variableName`in t.reference?{variableName:t.reference.variableName,value:t.reference.value&&n(t.reference.value)}:n(t.reference))}e.to=n})(xk||={});var Sk;(function(e){function t(e){return{kind:`codeCitation`,value:e.value,license:e.license,snippet:e.snippet}}e.from=t})(Sk||={});var Ck;(function(e){function t(e,t,n){return e instanceof zw?tk.from(e):e instanceof Ww?sk.from(e):e instanceof Yw?xk.from(e):e instanceof Gw?ck.from(e):e instanceof Hw?ak.from(e):e instanceof Uw?ok.from(e):e instanceof Jw?_k.from(e,t,n):e instanceof tT?vk.from(e):e instanceof nT?bk.from(e):e instanceof Bw?rk.from(e):e instanceof Xw?nk.from(e):e instanceof qw?lk.from(e):e instanceof Vw?ik.from(e):e instanceof Zw?Sk.from(e):e instanceof Qw?fk.from(e):e instanceof $w?uk.from(e):e instanceof rT?pk.from(e):e instanceof eT?dk.from(e):e instanceof iT?mk.from(e):{kind:`markdownContent`,content:jD.from(``)}}e.from=t;function n(e,t){switch(e.kind){case`reference`:return xk.to(e);case`markdownContent`:case`inlineReference`:case`progressMessage`:case`treeData`:case`command`:return r(e,t)}}e.to=n;function r(e,t){switch(e.kind){case`markdownContent`:return tk.to(e);case`inlineReference`:return sk.to(e);case`progressMessage`:return;case`treeData`:return ak.to(e);case`command`:return _k.to(e,t)}}e.toContent=r})(Ck||={});var wk;(function(e){function t(e,t,n,r,i,a,o){let s=[],c=[];for(let t of e.variables.variables)t.kind===`tool`?s.push(t):t.kind===`toolset`?s.push(...t.value):c.push(t);let l={id:e.requestId,prompt:e.message,command:e.command,attempt:e.attempt??0,enableCommandDetection:e.enableCommandDetection??!0,isParticipantDetected:e.isParticipantDetected??!1,references:c.map(e=>Dk.to(e,r,o)).filter(it),toolReferences:s.map(Ok.to),location:Ek.to(e.location),acceptedConfirmationData:e.acceptedConfirmationData,rejectedConfirmationData:e.rejectedConfirmationData,location2:t,toolInvocationToken:Object.freeze({sessionId:e.sessionId}),tools:i,model:n,editedFileEvents:e.editedFileEvents,modeInstructions:e.modeInstructions};return Hg(a,`chatParticipantPrivate`)||(delete l.id,delete l.attempt,delete l.enableCommandDetection,delete l.isParticipantDetected,delete l.location,delete l.location2,delete l.editedFileEvents),Hg(a,`chatParticipantAdditions`)||(delete l.acceptedConfirmationData,delete l.rejectedConfirmationData,delete l.tools),l}e.to=t})(wk||={});var Tk;(function(e){function t(e){return{prompt:e.prompt,files:e.files.map(e=>w.revive(e))}}e.to=t})(Tk||={});var Ek;(function(e){function t(e){switch(e){case R_.Notebook:return cT.Notebook;case R_.Terminal:return cT.Terminal;case R_.Panel:return cT.Panel;case R_.Editor:return cT.Editor}}e.to=t;function n(e){switch(e){case cT.Notebook:return R_.Notebook;case cT.Terminal:return R_.Terminal;case cT.Panel:return R_.Panel;case cT.Editor:return R_.Editor}}e.from=n})(Ek||={});var Dk;(function(e){function t(e,t,n){let r=e.value;if(!r){let t;try{t=JSON.stringify(e)}catch{t=`kind=${e.kind}, id=${e.id}, name=${e.name}`}n.error(`[ChatPromptReference] Ignoring invalid reference in variable: ${t}`);return}if(ti(r))r=w.revive(r);else if(r&&typeof r==`object`&&`uri`in r&&`range`in r&&ti(r.uri))r=bD.to(Gu(r));else if(ah(e)){let t=e.references?.[0]?.reference;r=new pT(e.mimeType??`image/png`,()=>Promise.resolve(new Uint8Array(Object.values(e.value))),t&&w.isUri(t)?t:void 0)}else if(e.kind===`diagnostic`){let n=e.filterSeverity&&DD.to(e.filterSeverity),i=e.filterUri&&w.revive(e.filterUri).toString();r=new mT(t.map(([t,r])=>e.filterUri&&t.toString()!==i?[t,[]]:[t,r.filter(t=>!(n&&t.severity>n||e.filterRange&&!vp.areIntersectingOrTouching(e.filterRange,K.from(t.range))))]).filter(([,e])=>e.length>0))}return{id:e.id,name:e.name,range:e.range&&[e.range.start,e.range.endExclusive],value:r,modelDescription:e.modelDescription}}e.to=t})(Dk||={});var Ok;(function(e){function t(e){let t=e.value;if(t)throw Error(`Invalid tool reference`);return{name:e.id,range:e.range&&[e.range.start,e.range.endExclusive]}}e.to=t})(Ok||={});var kk;(function(e){function t(e,t,n){return{id:e.id,label:e.label,fullName:e.fullName,icon:e.icon?.id,value:e.values[0].value,insertText:e.insertText,detail:e.detail,documentation:e.documentation,command:t.toInternal(e.command,n)}}e.from=t})(kk||={});var Ak;(function(e){function t(e){return{errorDetails:e.errorDetails,metadata:r(e.metadata),nextQuestion:e.nextQuestion,details:e.details}}e.to=t;function n(e){return{errorDetails:e.errorDetails,metadata:e.metadata,nextQuestion:e.nextQuestion,details:e.details}}e.from=n;function r(e){return Qs(e,e=>{if(e.$mid===Dn.LanguageModelToolResult)return new OT(Qs(e.content,r));if(e.$mid===Dn.LanguageModelTextPart)return new CT(e.value,e.audience);if(e.$mid===Dn.LanguageModelPromptTsxPart)return new ET(e.value)})}})(Ak||={});var jk;(function(e){function t(e,t,n){if(t.action.kind===`vote`)return;let r=Ak.to(e);if(t.action.kind===`command`){let e=t.action.commandButton.command,i={command:n.fromInternal(e)??{command:e.id,title:e.title}},a={kind:`command`,commandButton:i};return{action:a,result:r}}else if(t.action.kind===`followUp`){let e={kind:`followUp`,followup:XO.to(t.action.followup)};return{action:e,result:r}}else if(t.action.kind===`inlineChat`)return{action:{kind:`editor`,accepted:t.action.action===`accepted`},result:r};else if(t.action.kind===`chatEditingSessionAction`){let e=new Map([[`accepted`,Fw.Accepted],[`rejected`,Fw.Rejected],[`saved`,Fw.Saved]]);return{action:{kind:`chatEditingSessionAction`,outcome:e.get(t.action.outcome)??Fw.Rejected,uri:w.revive(t.action.uri),hasRemainingEdits:t.action.hasRemainingEdits},result:r}}else if(t.action.kind===`chatEditingHunkAction`){let e=new Map([[`accepted`,Fw.Accepted],[`rejected`,Fw.Rejected]]);return{action:{kind:`chatEditingHunkAction`,outcome:e.get(t.action.outcome)??Fw.Rejected,uri:w.revive(t.action.uri),hasRemainingEdits:t.action.hasRemainingEdits,lineCount:t.action.lineCount},result:r}}else return{action:t.action,result:r}}e.to=t})(jk||={});var Mk;(function(e){function t(e,t,n){return`terminalCommand`in e?{terminalCommand:e.terminalCommand,shouldExecute:e.shouldExecute}:`uri`in e?{uri:e.uri}:t.toInternal(e,n)}e.from=t})(Mk||={});var Nk;(function(e){function t(e){return{...e,documentation:jD.fromStrict(e.documentation)}}e.from=t})(Nk||={});var Pk;(function(e){function t(e,t){return Array.isArray(e)?{items:e.map(e=>Nk.from(e))}:{items:e.items.map(e=>Nk.from(e)),resourceRequestConfig:e.resourceRequestConfig?Fk.from(e.resourceRequestConfig,t):void 0}}e.from=t})(Pk||={});var Fk;(function(e){function t(e,t){return{...e,pathSeparator:t,cwd:e.cwd}}e.from=t})(Fk||={});var Ik;(function(e){function t(e){return{kind:Lk.to(e.kind),acceptedLength:e.acceptedLength}}e.to=t})(Ik||={});var Lk;(function(e){function t(e){switch(e){case Ap.Word:return Ix.Word;case Ap.Line:return Ix.Line;case Ap.Suggest:return Ix.Suggest;default:return Ix.Unknown}}e.to=t})(Lk||={});var Rk;(function(e){function t(e,t){if(e.kind===Np.Ignored){let n=e.supersededBy?t(e.supersededBy):void 0;return{kind:Lx.Ignored,supersededBy:n,userTypingDisagreed:e.userTypingDisagreed}}else if(e.kind===Np.Accepted)return{kind:Lx.Accepted};return{kind:Lx.Rejected}}e.to=t})(Rk||={});var zk;(function(e){function t(e,t){return{id:t,label:e.label,description:e.description,canEdit:e.canEdit,collapsibleState:e.collapsibleState||nv.None,contextValue:e.contextValue}}e.from=t})(zk||={});var Bk;(function(e){function t(e){if(e.type===`mcp`)return new NT(e.label,e.serverLabel||e.label,e.instructions);if(e.type===`extension`)return new MT(e.extensionId.value,e.label)}e.to=t})(Bk||={});var Vk;(function(e){function t(e){return new OT(e.content.map(e=>e.kind===`text`?new CT(e.value,e.audience):new ET(e.value)))}e.to=t;function n(e,t){e.toolResultMessage&&U(t,`chatParticipantPrivate`);let n=e=>{e.audience&&U(t,`languageModelToolResultAudience`)};return{content:e.content.map(e=>{if(e instanceof CT)return n(e),{kind:`text`,value:e.value,audience:e.audience};if(e instanceof ET)return{kind:`promptTsx`,value:e.value};throw Error(`Unknown LanguageModelToolResult part type`)}),toolResultMessage:jD.fromStrict(e.toolResultMessage),toolResultDetails:e.toolResultDetails?.map(e=>w.isUri(e)?e:bD.from(e))}}e.from=n})(Vk||={});var Hk;(function(e){function t(e){return new kT(e.content.map(e=>e.kind===`text`?new CT(e.value,e.audience):e.kind===`data`?new wT(e.value.data.buffer,e.value.mimeType,e.audience):new ET(e.value)))}e.to=t;function n(e,t){e.toolResultMessage&&U(t,`chatParticipantPrivate`);let n=e=>{e.audience&&U(t,`languageModelToolResultAudience`)},r=!1,i;Array.isArray(e.toolResultDetails)?i=e.toolResultDetails?.map(e=>w.isUri(e)?e:bD.from(e)):e.toolResultDetails2&&(i={output:{type:`data`,mimeType:e.toolResultDetails2.mime,value:b.wrap(e.toolResultDetails2.value)}},r=!0);let a={content:e.content.map(e=>{if(e instanceof CT)return n(e),{kind:`text`,value:e.value,audience:e.audience};if(e instanceof ET)return{kind:`promptTsx`,value:e.value};if(e instanceof wT)return n(e),r=!0,{kind:`data`,value:{mimeType:e.mimeType,data:b.wrap(e.data)},audience:e.audience};throw Error(`Unknown LanguageModelToolResult part type`)}),toolResultMessage:jD.fromStrict(e.toolResultMessage),toolResultDetails:i};return r?new hi(a):a}e.from=n})(Hk||={});var Uk;(function(e){function t(e){return e}e.fromThemeIcon=t})(Uk||={});var Wk;(function(e){function t(e){return{query:e.query,kind:n(e.kind),settings:e.settings}}e.fromSettingsSearchResult=t;function n(e){switch(e){case VT.EMBEDDED:return VT.EMBEDDED;case VT.LLM_RANKED:return VT.LLM_RANKED;case VT.CANCELED:return VT.CANCELED;default:throw Error(`Unknown AiSettingsSearchResultKind`)}}})(Wk||={});var Gk;(function(e){function t(e){return!!e.uri}function n(e){return dD.toSerialized(t(e)?{type:uD.HTTP,uri:e.uri,headers:Object.entries(e.headers)}:{type:uD.Stdio,cwd:e.cwd?.fsPath,args:e.args,command:e.command,env:e.env,envFile:void 0})}e.from=n})(Gk||={});var Kk=class{constructor(e,t,n){this.uri=e,this.ranges=t,this.previewText=n}},qk=class{constructor(e,t,n){this.uri=e,this.text=t,this.lineNumber=n}},Jk=class{constructor(e){this.keyword=e}},Yk;(function(e){e[e.None=1]=`None`,e[e.FilesExclude=2]=`FilesExclude`,e[e.SearchAndFilesExclude=3]=`SearchAndFilesExclude`})(Yk||={});var Xk;(function(e){e[e.Information=1]=`Information`,e[e.Warning=2]=`Warning`})(Xk||={});const Zk=2e4;var Qk;(function(e){e[e.file=0]=`file`,e[e.text=1]=`text`,e[e.aiText=2]=`aiText`})(Qk||={});var $k;(function(e){e[e.File=1]=`File`,e[e.Text=2]=`Text`,e[e.aiText=3]=`aiText`})($k||={});function eA(e){return!!e.rangeLocations&&!!e.previewText}var tA;(function(e){e[e.Normal=0]=`Normal`,e[e.NewSearchStarted=1]=`NewSearchStarted`})(tA||={});var nA=class{constructor(e,t,n,r){this.rangeLocations=[],this.webviewIndex=r;let i=Array.isArray(t)?t:[t];if(n&&n.matchLines===1&&rA(i)){e=Ca(e,n.matchLines);let t=``,r=0,a=0,o=Math.floor(n.charsPerLine/5);for(let s of i){let i=Math.max(s.startColumn-o,0),c=s.startColumn+n.charsPerLine;if(i>a+o+56){let n=`⟪ `+(i-a)+` characters skipped ⟫`;t+=n+e.slice(i,c),r+=i-(a+n.length)}else t+=e.slice(a,c);a=c,this.rangeLocations.push({source:s,preview:new aA(0,s.startColumn-r,s.endColumn-r)})}this.previewText=t}else{let n=Array.isArray(t)?t[0].startLineNumber:t.startLineNumber,r=Ee(t,e=>({preview:new iA(e.startLineNumber-n,e.startColumn,e.endLineNumber-n,e.endColumn),source:e}));this.rangeLocations=Array.isArray(r)?r:[r],this.previewText=e}}};function rA(e){let t=e[0].startLineNumber;for(let n of e)if(n.startLineNumber!==t||n.endLineNumber!==t)return!1;return!0}var iA=class{constructor(e,t,n,r){this.startLineNumber=e,this.startColumn=t,this.endLineNumber=n,this.endColumn=r}},aA=class extends iA{constructor(e,t,n){super(e,t,e,n)}},oA;(function(e){e.List=`list`,e.Tree=`tree`})(oA||={});var sA;(function(e){e.Default=`default`,e.FileNames=`fileNames`,e.Type=`type`,e.Modified=`modified`,e.CountDescending=`countDescending`,e.CountAscending=`countAscending`})(sA||={});var cA;(function(e){e.Auto=`auto`,e.Manual=`manual`,e.RunOnEmpty=`runOnEmpty`})(cA||={});function lA(e,t=!0){let n=e&&e.files&&e.files.exclude,r=t&&e&&e.search&&e.search.exclude;if(!n&&!r)return;if(!n||!r)return n||r||void 0;let i=Object.create(null);return i=ec(i,Ys(n)),i=ec(i,Ys(r),!0),i}function uA(e,t){return e.excludePattern&&Ov(e.excludePattern,t)?!1:e.includePattern||e.usingSearchPaths?e.includePattern&&Ov(e.includePattern,t)?!0:e.usingSearchPaths?!!e.folderQueries&&e.folderQueries.some(e=>{let n=e.folder.fsPath;if(Na(t,n)){let r=Hr(n,t);return!e.includePattern||!!Ov(e.includePattern,r)}else return!1}):!1:!0}var dA;(function(e){e[e.unknownEncoding=1]=`unknownEncoding`,e[e.regexParseError=2]=`regexParseError`,e[e.globParseError=3]=`globParseError`,e[e.invalidLiteral=4]=`invalidLiteral`,e[e.rgProcessError=5]=`rgProcessError`,e[e.other=6]=`other`,e[e.canceled=7]=`canceled`})(dA||={});function fA(e,t){let n={...e||{},...t||{}};return Object.keys(n).filter(e=>{let t=n[e];return typeof t==`boolean`&&t})}var pA=class{constructor(e,t){this._parsedIncludeExpression=null,this._excludeExpression=t.excludePattern?.map(t=>({...e.excludePattern||{},...t.pattern||{}}))??[],this._excludeExpression.length===0&&(this._excludeExpression=[e.excludePattern||{}]),this._parsedExcludeExpression=this._excludeExpression.map(e=>kv(e));let n=e.includePattern;t.includePattern&&(n=n?{...n,...t.includePattern}:t.includePattern),n&&(this._parsedIncludeExpression=kv(n))}_evalParsedExcludeExpression(e,t,n){let r=null;for(let i of this._parsedExcludeExpression){let a=i(e,t,n);if(typeof a==`string`){r=a;break}}return r}matchesExcludesSync(e,t,n){return!!(this._parsedExcludeExpression&&this._evalParsedExcludeExpression(e,t,n))}includedInQuerySync(e,t,n){return!(this._parsedExcludeExpression&&this._evalParsedExcludeExpression(e,t,n)||this._parsedIncludeExpression&&!this._parsedIncludeExpression(e,t,n))}includedInQuery(e,t,n){let r=()=>this._parsedIncludeExpression?!!this._parsedIncludeExpression(e,t,n):!0;return Promise.all(this._parsedExcludeExpression.map(i=>{let a=i(e,t,n);return oo(a)?a.then(e=>e?!1:r()):r()})).then(e=>e.some(e=>!!e))}hasSiblingExcludeClauses(){return this._excludeExpression.reduce((e,t)=>mA(t)||e,!1)}};function mA(e){for(let t in e)if(typeof e[t]!=`boolean`)return!0;return!1}function hA(e){if(!e)return;let t;return n=>(t||=(e()||Promise.resolve([])).then(e=>e?_A(e):{}),t.then(e=>!!e[n]))}function gA(e){if(!e)return;let t;return n=>{if(!t){let n=e();t=n?_A(n):{}}return!!t[n]}}function _A(e){let t={};for(let n of e)t[n]=!0;return t}function vA(e){return e.flatMap(e=>e.patterns.map(t=>e.baseUri?{baseUri:e.baseUri,pattern:t}:t))}const yA={matchLines:100,charsPerLine:1e4},bA=`utf8`,xA=`utf8bom`,SA=`utf16be`,CA=`utf16le`,wA=[254,255],TA=[255,254],EA=[239,187,191];var DA;(function(e){e[e.STREAM_IS_BINARY=1]=`STREAM_IS_BINARY`})(DA||={});var OA=class extends Error{constructor(e,t){super(e),this.decodeStreamErrorKind=t}},kA=class e{static async create(t){let n;if(t!==bA){let e=await import(`./iconv-lite-umd-DVeEqu4U.js`).then(l()).then(e=>e.default??e);n=e.getDecoder(MA(t))}else{let e=new TextDecoder;n={write(t){return e.decode(t,{stream:!0})},end(){return e.decode()}}}return new e(n)}constructor(e){this.iconvLiteDecoder=e}write(e){return this.iconvLiteDecoder.write(e)}end(){return this.iconvLiteDecoder.end()}};function AA(e,t){let n=t.minBytesRequiredForDetection??t.guessEncoding?4096:512;return new Promise((r,i)=>{let a=Ct(e=>e.join(``)),o=[],s=0,c,l=new Ai,u=async()=>{try{let e=await VA({buffer:b.concat(o),bytesRead:s},t.guessEncoding,t.candidateGuessEncodings);if(e.seemsBinary&&t.acceptTextOnly)throw new OA(`Stream is binary but only text is accepted for decoding`,DA.STREAM_IS_BINARY);e.encoding=await t.overwriteEncoding(e.encoding),c=await kA.create(e.encoding);let n=c.write(b.concat(o).buffer);a.write(n),o.length=0,s=0,r({stream:a,detected:e})}catch(e){l.cancel(),a.destroy(),i(e)}};Dt(e,{onData:async t=>{c?a.write(c.write(t.buffer)):(o.push(t),s+=t.byteLength,s>=n&&(e.pause(),await u(),setTimeout(()=>e.resume())))},onError:e=>a.error(e),onEnd:async()=>{c||await u(),a.end(c?.end())}},l.token)})}async function jA(e,t,n){let r=await import(`./iconv-lite-umd-DVeEqu4U.js`).then(l()).then(e=>e.default??e),i=r.getEncoder(MA(t),n),a=!1,o=!1;return{read(){if(o)return null;let r=e.read();if(typeof r!=`string`){if(o=!0,!a&&n?.addBOM)switch(t){case bA:case xA:return b.wrap(Uint8Array.from(EA));case SA:return b.wrap(Uint8Array.from(wA));case CA:return b.wrap(Uint8Array.from(TA))}let e=i.end();return e&&e.length>0?(a=!0,b.wrap(e)):null}return a=!0,b.wrap(i.write(r))}}}function MA(e){return e===xA||e===null?bA:e}function NA(e,t){if(!e||t<wA.length)return null;let n=e.readUInt8(0),r=e.readUInt8(1);if(n===wA[0]&&r===wA[1])return SA;if(n===TA[0]&&r===TA[1])return CA;if(t<EA.length)return null;let i=e.readUInt8(2);return n===EA[0]&&r===EA[1]&&i===EA[2]?xA:null}const PA=[`ascii`,`utf-16`,`utf-32`];async function FA(e,t){let n=await import(`./jschardet-Bcgz3I2o.js`).then(l()).then(e=>e.default??e),r=e.slice(0,65536),i=BA(r.buffer);t&&(t=be(t.map(e=>zA(e))),t.length===0&&(t=void 0));let a;try{a=n.detect(i,t?{detectEncodings:t}:void 0)}catch{return null}if(!a||!a.encoding)return null;let o=a.encoding.toLowerCase();return 0<=PA.indexOf(o)?null:RA(a.encoding)}const IA={ibm866:`cp866`,big5:`cp950`};function LA(e){return e.replace(/[^a-zA-Z0-9]/g,``).toLowerCase()}function RA(e){let t=LA(e),n=IA[t];return n||t}function zA(e){let t=LA(e),n=UA[t];return n?n.guessableName:void 0}function BA(e){let t=``;for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}function VA({buffer:e,bytesRead:t},n,r){let i=NA(e,t),a=!1;if(i!==SA&&i!==CA&&e){let n=!0,r=!0,o=!1;for(let i=0;i<t&&i<512;i++){let t=i%2==1,a=e.readUInt8(i)===0;if(a&&(o=!0),n&&(t&&!a||!t&&a)&&(n=!1),r&&(t&&a||!t&&!a)&&(r=!1),a&&!n&&!r)break}o&&(n?i=CA:r?i=SA:a=!0)}return n&&!a&&!i&&e?FA(e.slice(0,t),r).then(e=>({seemsBinary:!1,encoding:e})):{seemsBinary:a,encoding:i}}const HA={utf8:{labelLong:`UTF-8`,labelShort:`UTF-8`,order:1,alias:`utf8bom`,guessableName:`UTF-8`},utf8bom:{labelLong:`UTF-8 with BOM`,labelShort:`UTF-8 with BOM`,encodeOnly:!0,order:2,alias:`utf8`},utf16le:{labelLong:`UTF-16 LE`,labelShort:`UTF-16 LE`,order:3,guessableName:`UTF-16LE`},utf16be:{labelLong:`UTF-16 BE`,labelShort:`UTF-16 BE`,order:4,guessableName:`UTF-16BE`},windows1252:{labelLong:`Western (Windows 1252)`,labelShort:`Windows 1252`,order:5,guessableName:`windows-1252`},iso88591:{labelLong:`Western (ISO 8859-1)`,labelShort:`ISO 8859-1`,order:6},iso88593:{labelLong:`Western (ISO 8859-3)`,labelShort:`ISO 8859-3`,order:7},iso885915:{labelLong:`Western (ISO 8859-15)`,labelShort:`ISO 8859-15`,order:8},macroman:{labelLong:`Western (Mac Roman)`,labelShort:`Mac Roman`,order:9},cp437:{labelLong:`DOS (CP 437)`,labelShort:`CP437`,order:10},windows1256:{labelLong:`Arabic (Windows 1256)`,labelShort:`Windows 1256`,order:11},iso88596:{labelLong:`Arabic (ISO 8859-6)`,labelShort:`ISO 8859-6`,order:12},windows1257:{labelLong:`Baltic (Windows 1257)`,labelShort:`Windows 1257`,order:13},iso88594:{labelLong:`Baltic (ISO 8859-4)`,labelShort:`ISO 8859-4`,order:14},iso885914:{labelLong:`Celtic (ISO 8859-14)`,labelShort:`ISO 8859-14`,order:15},windows1250:{labelLong:`Central European (Windows 1250)`,labelShort:`Windows 1250`,order:16,guessableName:`windows-1250`},iso88592:{labelLong:`Central European (ISO 8859-2)`,labelShort:`ISO 8859-2`,order:17,guessableName:`ISO-8859-2`},cp852:{labelLong:`Central European (CP 852)`,labelShort:`CP 852`,order:18},windows1251:{labelLong:`Cyrillic (Windows 1251)`,labelShort:`Windows 1251`,order:19,guessableName:`windows-1251`},cp866:{labelLong:`Cyrillic (CP 866)`,labelShort:`CP 866`,order:20,guessableName:`IBM866`},cp1125:{labelLong:`Cyrillic (CP 1125)`,labelShort:`CP 1125`,order:21,guessableName:`IBM1125`},iso88595:{labelLong:`Cyrillic (ISO 8859-5)`,labelShort:`ISO 8859-5`,order:22,guessableName:`ISO-8859-5`},koi8r:{labelLong:`Cyrillic (KOI8-R)`,labelShort:`KOI8-R`,order:23,guessableName:`KOI8-R`},koi8u:{labelLong:`Cyrillic (KOI8-U)`,labelShort:`KOI8-U`,order:24},iso885913:{labelLong:`Estonian (ISO 8859-13)`,labelShort:`ISO 8859-13`,order:25},windows1253:{labelLong:`Greek (Windows 1253)`,labelShort:`Windows 1253`,order:26,guessableName:`windows-1253`},iso88597:{labelLong:`Greek (ISO 8859-7)`,labelShort:`ISO 8859-7`,order:27,guessableName:`ISO-8859-7`},windows1255:{labelLong:`Hebrew (Windows 1255)`,labelShort:`Windows 1255`,order:28,guessableName:`windows-1255`},iso88598:{labelLong:`Hebrew (ISO 8859-8)`,labelShort:`ISO 8859-8`,order:29,guessableName:`ISO-8859-8`},iso885910:{labelLong:`Nordic (ISO 8859-10)`,labelShort:`ISO 8859-10`,order:30},iso885916:{labelLong:`Romanian (ISO 8859-16)`,labelShort:`ISO 8859-16`,order:31},windows1254:{labelLong:`Turkish (Windows 1254)`,labelShort:`Windows 1254`,order:32},iso88599:{labelLong:`Turkish (ISO 8859-9)`,labelShort:`ISO 8859-9`,order:33},windows1258:{labelLong:`Vietnamese (Windows 1258)`,labelShort:`Windows 1258`,order:34},gbk:{labelLong:`Simplified Chinese (GBK)`,labelShort:`GBK`,order:35},gb18030:{labelLong:`Simplified Chinese (GB18030)`,labelShort:`GB18030`,order:36},cp950:{labelLong:`Traditional Chinese (Big5)`,labelShort:`Big5`,order:37,guessableName:`Big5`},big5hkscs:{labelLong:`Traditional Chinese (Big5-HKSCS)`,labelShort:`Big5-HKSCS`,order:38},shiftjis:{labelLong:`Japanese (Shift JIS)`,labelShort:`Shift JIS`,order:39,guessableName:`SHIFT_JIS`},eucjp:{labelLong:`Japanese (EUC-JP)`,labelShort:`EUC-JP`,order:40,guessableName:`EUC-JP`},euckr:{labelLong:`Korean (EUC-KR)`,labelShort:`EUC-KR`,order:41,guessableName:`EUC-KR`},windows874:{labelLong:`Thai (Windows 874)`,labelShort:`Windows 874`,order:42},iso885911:{labelLong:`Latin/Thai (ISO 8859-11)`,labelShort:`ISO 8859-11`,order:43},koi8ru:{labelLong:`Cyrillic (KOI8-RU)`,labelShort:`KOI8-RU`,order:44},koi8t:{labelLong:`Tajik (KOI8-T)`,labelShort:`KOI8-T`,order:45},gb2312:{labelLong:`Simplified Chinese (GB 2312)`,labelShort:`GB 2312`,order:46,guessableName:`GB2312`},cp865:{labelLong:`Nordic DOS (CP 865)`,labelShort:`CP 865`,order:47},cp850:{labelLong:`Western European DOS (CP 850)`,labelShort:`CP 850`,order:48}},UA=(()=>{let e={};for(let t in HA)HA[t].guessableName&&(e[t]=HA[t]);return e})();var WA;(function(e){e[e.FILE_IS_BINARY=0]=`FILE_IS_BINARY`})(WA||={});var GA;(function(e){e[e.SAVED=0]=`SAVED`,e[e.DIRTY=1]=`DIRTY`,e[e.PENDING_SAVE=2]=`PENDING_SAVE`,e[e.CONFLICT=3]=`CONFLICT`,e[e.ORPHAN=4]=`ORPHAN`,e[e.ERROR=5]=`ERROR`})(GA||={});var KA;(function(e){e[e.EDITOR=1]=`EDITOR`,e[e.REFERENCE=2]=`REFERENCE`,e[e.OTHER=3]=`OTHER`})(KA||={});var qA;(function(e){e[e.Encode=0]=`Encode`,e[e.Decode=1]=`Decode`})(qA||={});function JA(e){let t=!1;return{read(){return t?null:(t=!0,e)}}}function YA(e,t,n){return new Wa(e=>$A(e,n)).isEqual(e,t)}function XA(e,t,n){return YA(e.uri,t.uri,n)?0:Ji(e.uri.toString(),t.uri.toString())}function ZA(e,t,n){return e.index===t.index?YA(e.uri,t.uri,n)?Ji(e.name,t.name):Ji(e.uri.toString(),t.uri.toString()):e.index<t.index?-1:1}function QA(e,t,n,r){let i=e.slice(0).sort((e,t)=>n(e,t,r)),a=t.slice(0).sort((e,t)=>n(e,t,r));return ye(i,a,(e,t)=>n(e,t,r))}function $A(e,t){let n=t.getCapabilities(e.scheme);return!(n&&n&cc.PathCaseSensitive)}var ej=class e extends Oc{static toExtHostWorkspace(t,n,r,i){if(!t)return{workspace:null,added:[],removed:[]};let{id:a,name:o,folders:s,configuration:c,transient:l,isUntitled:u}=t,d=[],f=n;n?s.forEach((t,a)=>{let o=w.revive(t.uri),s=e._findFolder(r||n,o,i);s?(s.name=t.name,s.index=t.index,d.push(s)):d.push({uri:o,name:t.name,index:a})}):d.push(...s.map(({uri:e,name:t,index:n})=>({uri:w.revive(e),name:t,index:n}))),d.sort((e,t)=>e.index<t.index?-1:1);let p=new e(a,o,d,!!l,c?w.revive(c):null,!!u,e=>$A(e,i)),{added:ee,removed:m}=QA(f?f.workspaceFolders:[],p.workspaceFolders,XA,i);return{workspace:p,added:ee,removed:m}}static _findFolder(e,t,n){for(let r=0;r<e.folders.length;r++){let i=e.workspaceFolders[r];if(YA(i.uri,t,n))return i}}constructor(e,t,n,r,i,a,o){super(e,n.map(e=>new kc(e)),r,i,o),this._name=t,this._isUntitled=a,this._workspaceFolders=[],this._structure=Js.forUris(o,()=>!0),n.forEach(e=>{this._workspaceFolders.push(e),this._structure.set(e.uri,e)})}get name(){return this._name}get isUntitled(){return this._isUntitled}get workspaceFolders(){return this._workspaceFolders.slice(0)}getWorkspaceFolder(e,t){return t&&this._structure.get(e)&&(e=Qa(e)),this._structure.findSubstr(e)}resolveWorkspaceFolder(e){return this._structure.get(e)}};let tj=class{constructor(e,t,n,r,i){this._onDidChangeWorkspace=new x,this.onDidChangeWorkspace=this._onDidChangeWorkspace.event,this._onDidGrantWorkspaceTrust=new x,this.onDidGrantWorkspaceTrust=this._onDidGrantWorkspaceTrust.event,this._activeSearchCallbacks=[],this._trusted=!1,this._editSessionIdentityProviders=new Map,this._providerHandlePool=0,this._onWillCreateEditSessionIdentityEvent=new dn,this._canonicalUriProviders=new Map,this._logService=r,this._extHostFileSystemInfo=n,this._uriTransformerService=i,this._requestIdProvider=new ic,this._barrier=new bo,this._proxy=e.getProxy(E.MainThreadWorkspace),this._messageService=e.getProxy(E.MainThreadMessageService);let a=t.workspace;this._confirmedWorkspace=a?new ej(a.id,a.name,[],!!a.transient,a.configuration?w.revive(a.configuration):null,!!a.isUntitled,e=>$A(e,n)):void 0}$initializeWorkspace(e,t){this._trusted=t,this.$acceptWorkspaceData(e),this._barrier.open()}waitForInitializeCall(){return this._barrier.wait()}get workspace(){return this._actualWorkspace}get name(){return this._actualWorkspace?this._actualWorkspace.name:void 0}get workspaceFile(){if(this._actualWorkspace&&this._actualWorkspace.configuration)return this._actualWorkspace.isUntitled?w.from({scheme:O.untitled,path:Xa(Qa(this._actualWorkspace.configuration))}):this._actualWorkspace.configuration}get _actualWorkspace(){return this._unconfirmedWorkspace||this._confirmedWorkspace}getWorkspaceFolders(){if(this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}async getWorkspaceFolders2(){if(await this._barrier.wait(),this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}updateWorkspaceFolders(e,t,n,...r){let i=[];if(Array.isArray(r)&&r.forEach(e=>{w.isUri(e.uri)&&!i.some(t=>YA(t.uri,e.uri,this._extHostFileSystemInfo))&&i.push({uri:e.uri,name:e.name||Ya(e.uri)})}),this._unconfirmedWorkspace||[t,n].some(e=>typeof e!=`number`||e<0)||n===0&&i.length===0)return!1;let a=this._actualWorkspace?this._actualWorkspace.workspaceFolders:[];if(t+n>a.length)return!1;let o=a.slice(0);o.splice(t,n,...i.map(e=>({uri:e.uri,name:e.name||Ya(e.uri),index:void 0})));for(let e=0;e<o.length;e++){let t=o[e];if(o.some((n,r)=>r!==e&&YA(t.uri,n.uri,this._extHostFileSystemInfo)))return!1}o.forEach((e,t)=>e.index=t);let{added:s,removed:c}=QA(a,o,ZA,this._extHostFileSystemInfo);if(s.length===0&&c.length===0)return!1;if(this._proxy){let r=e.displayName||e.name;this._proxy.$updateWorkspaceFolders(r,t,n,i).then(void 0,t=>{this._unconfirmedWorkspace=void 0;let n={source:{identifier:e.identifier,label:e.displayName||e.name}};this._messageService.$showMessage(xc.Error,C(2640,`Extension '{0}' failed to update workspace folders: {1}`,r,t.toString()),n,[])})}return this.trySetWorkspaceFolders(o),!0}getWorkspaceFolder(e,t){if(this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async getWorkspaceFolder2(e,t){if(await this._barrier.wait(),this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async resolveWorkspaceFolder(e){if(await this._barrier.wait(),this._actualWorkspace)return this._actualWorkspace.resolveWorkspaceFolder(e)}getPath(){if(!this._actualWorkspace)return;let{folders:e}=this._actualWorkspace;if(e.length!==0)return e[0].uri.fsPath}getRelativePath(e,t){let n,r=``;if(typeof e==`string`?(n=w.file(e),r=e):e!==void 0&&(n=e,r=e.fsPath),!n)return r;let i=this.getWorkspaceFolder(n,!0);if(!i)return r;t===void 0&&this._actualWorkspace&&(t=this._actualWorkspace.folders.length>1);let a=eo(i.uri,n);return t&&i.name&&(a=`${i.name}/${a}`),a}trySetWorkspaceFolders(e){this._actualWorkspace&&(this._unconfirmedWorkspace=ej.toExtHostWorkspace({id:this._actualWorkspace.id,name:this._actualWorkspace.name,configuration:this._actualWorkspace.configuration,folders:e,isUntitled:this._actualWorkspace.isUntitled},this._actualWorkspace,void 0,this._extHostFileSystemInfo).workspace||void 0)}$acceptWorkspaceData(e){let{workspace:t,added:n,removed:r}=ej.toExtHostWorkspace(e,this._confirmedWorkspace,this._unconfirmedWorkspace,this._extHostFileSystemInfo);this._confirmedWorkspace=t||void 0,this._unconfirmedWorkspace=void 0,this._onDidChangeWorkspace.fire(Object.freeze({added:n,removed:r}))}findFiles(e,t,n,r,i=Oi.None){this._logService.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${r.value}, entryPoint: findFiles`);let a=``,o=!0;return t===null?o=!1:t!==void 0&&(a=typeof t==`string`?t:t.pattern),this._findFilesImpl({type:`include`,value:e},{exclude:[a],maxResults:n,useExcludeSettings:o?Yk.FilesExclude:Yk.None,useIgnoreFiles:{local:!1}},i)}findFiles2(e,t={},n,r=Oi.None){return this._logService.trace(`extHostWorkspace#findFiles2New: fileSearch, extension: ${n.value}, entryPoint: findFiles2New`),this._findFilesImpl({type:`filePatterns`,value:e},t,r)}async _findFilesImpl(e,t,n){if(n.isCancellationRequested)return Promise.resolve([]);let r=e.type===`include`?[e.value]:e.value??[];if(!Array.isArray(r))throw console.error(`Invalid file pattern provided`,r),Error(`Invalid file pattern provided ${JSON.stringify(r)}`);let i=r.map(n=>{let r=ij(t.exclude),i={ignoreSymlinks:typeof t.followSymlinks==`boolean`?!t.followSymlinks:void 0,disregardIgnoreFiles:typeof t.useIgnoreFiles?.local==`boolean`?!t.useIgnoreFiles.local:void 0,disregardGlobalIgnoreFiles:typeof t.useIgnoreFiles?.global==`boolean`?!t.useIgnoreFiles.global:void 0,disregardParentIgnoreFiles:typeof t.useIgnoreFiles?.parent==`boolean`?!t.useIgnoreFiles.parent:void 0,disregardExcludeSettings:t.useExcludeSettings!==void 0&&t.useExcludeSettings===Yk.None,disregardSearchExcludeSettings:t.useExcludeSettings!==void 0&&t.useExcludeSettings!==Yk.SearchAndFilesExclude,maxResults:t.maxResults,excludePattern:r.length>0?r:void 0,_reason:`startFileSearch`,shouldGlobSearch:e.type===`include`?void 0:!0},a=rj(wO.from(n)),o=a?.folder;return e.type===`include`?i.includePattern=a?.pattern:i.filePattern=a?.pattern,{folder:o,options:i}});return this._findFilesBase(i,n)}async _findFilesBase(e,t){let n=await Promise.all(e?.map(e=>this._proxy.$startFileSearch(e.folder??null,e.options,t).then(e=>Array.isArray(e)?e.map(e=>w.revive(e)):[]))??[]);return n.flat()}findTextInFiles2(e,t,n,r=Oi.None){this._logService.trace(`extHostWorkspace#findTextInFiles2: textSearch, extension: ${n.value}, entryPoint: findTextInFiles2`);let i=e=>{if(!t)return{folder:void 0,options:{}};let n=e?rj(wO.from(e)):void 0,r=t.exclude?ij(t.exclude):void 0;return{options:{ignoreSymlinks:typeof t.followSymlinks==`boolean`?!t.followSymlinks:void 0,disregardIgnoreFiles:typeof t.useIgnoreFiles==`boolean`?!t.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof t.useIgnoreFiles?.global==`boolean`?!t.useIgnoreFiles?.global:void 0,disregardParentIgnoreFiles:typeof t.useIgnoreFiles?.parent==`boolean`?!t.useIgnoreFiles?.parent:void 0,disregardExcludeSettings:t.useExcludeSettings!==void 0&&t.useExcludeSettings===Yk.None,disregardSearchExcludeSettings:t.useExcludeSettings!==void 0&&t.useExcludeSettings!==Yk.SearchAndFilesExclude,fileEncoding:t.encoding,maxResults:t.maxResults,previewOptions:t.previewOptions?{matchLines:t.previewOptions?.numMatchLines??100,charsPerLine:t.previewOptions?.charsPerLine??1e4}:void 0,surroundingContext:t.surroundingContext,includePattern:n?.pattern,excludePattern:r},folder:n?.folder}},a=t?.include?.map(e=>i(e))??[i(void 0)],o=a.filter(e=>!!e),s=new v,c=s.add(new x),l=this.findTextInFilesBase(e,o,(e,t)=>c.fire({result:e,uri:t}),r),u=new Io(async e=>{s.add(c.event(t=>{let n=t.result,r=t.uri;eA(n)?e.emitOne(new Kk(r,n.rangeLocations.map(e=>({previewRange:new Ib(e.preview.startLineNumber,e.preview.startColumn,e.preview.endLineNumber,e.preview.endColumn),sourceRange:new Ib(e.source.startLineNumber,e.source.startColumn,e.source.endLineNumber,e.source.endColumn)})),n.previewText)):e.emitOne(new qk(r,n.text,n.lineNumber))})),await l});return{results:u,complete:l.then(e=>(s.dispose(),{limitHit:e?.limitHit??!1}))}}async findTextInFilesBase(e,t,n,r=Oi.None){let i=this._requestIdProvider.getNext(),a=!1;if(r.onCancellationRequested(e=>{a=!0}),this._activeSearchCallbacks[i]=e=>{if(a)return;let t=w.revive(e.resource);e.results.forEach(e=>{let r=Gu(e);n(r,t)})},r.isCancellationRequested)return{};try{let n=await Promise.all(t?.map(t=>this._proxy.$startTextSearch(e,t.folder??null,t.options,i,r)||{})??[]);return delete this._activeSearchCallbacks[i],n.reduce((e,t)=>({limitHit:e?.limitHit||(t?.limitHit??!1),message:[e?.message??[],t?.message??[]].flat()}),{})??{limitHit:!1}}catch(e){throw delete this._activeSearchCallbacks[i],e}}async findTextInFiles(e,t,n,r,i=Oi.None){this._logService.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${r.value}, entryPoint: findTextInFiles`);let a=t.previewOptions===void 0?{matchLines:100,charsPerLine:1e4}:t.previewOptions,o=rj(wO.from(t.include)),s=typeof t.exclude==`string`?t.exclude:t.exclude?t.exclude.pattern:void 0,c={ignoreSymlinks:typeof t.followSymlinks==`boolean`?!t.followSymlinks:void 0,disregardIgnoreFiles:typeof t.useIgnoreFiles==`boolean`?!t.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof t.useGlobalIgnoreFiles==`boolean`?!t.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof t.useParentIgnoreFiles==`boolean`?!t.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof t.useDefaultExcludes==`boolean`?!t.useDefaultExcludes:!0,disregardSearchExcludeSettings:typeof t.useSearchExclude==`boolean`?!t.useSearchExclude:!0,fileEncoding:t.encoding,maxResults:t.maxResults,previewOptions:a,surroundingContext:t.afterContext,includePattern:o?.pattern,excludePattern:s?[{pattern:s}]:void 0},l=(e,t)=>{eA(e)?n({uri:t,preview:{text:e.previewText,matches:Ee(e.rangeLocations,e=>new Ib(e.preview.startLineNumber,e.preview.startColumn,e.preview.endLineNumber,e.preview.endColumn))},ranges:Ee(e.rangeLocations,e=>new Ib(e.source.startLineNumber,e.source.startColumn,e.source.endLineNumber,e.source.endColumn))}):n({uri:t,text:e.text,lineNumber:e.lineNumber})};return this.findTextInFilesBase(e,[{options:c,folder:o?.folder}],l,i)}$handleTextSearchResult(e,t){this._activeSearchCallbacks[t]?.(e)}async save(e){let t=await this._proxy.$save(e,{saveAs:!1});return w.revive(t)}async saveAs(e){let t=await this._proxy.$save(e,{saveAs:!0});return w.revive(t)}saveAll(e){return this._proxy.$saveAll(e)}resolveProxy(e){return this._proxy.$resolveProxy(e)}lookupAuthorization(e){return this._proxy.$lookupAuthorization(e)}lookupKerberosAuthorization(e){return this._proxy.$lookupKerberosAuthorization(e)}loadCertificates(){return this._proxy.$loadCertificates()}get trusted(){return this._trusted}requestWorkspaceTrust(e){return this._proxy.$requestWorkspaceTrust(e)}$onDidGrantWorkspaceTrust(){this._trusted||(this._trusted=!0,this._onDidGrantWorkspaceTrust.fire())}registerEditSessionIdentityProvider(e,t){if(this._editSessionIdentityProviders.has(e))throw Error(`A provider has already been registered for scheme ${e}`);this._editSessionIdentityProviders.set(e,t);let n=this._uriTransformerService.transformOutgoingScheme(e),r=this._providerHandlePool++;return this._proxy.$registerEditSessionIdentityProvider(r,n),_(()=>{this._editSessionIdentityProviders.delete(e),this._proxy.$unregisterEditSessionIdentityProvider(r)})}async $getEditSessionIdentifier(e,t){this._logService.info(`Getting edit session identifier for workspaceFolder`,e);let n=await this.resolveWorkspaceFolder(w.revive(e));if(!n){this._logService.warn(`Unable to resolve workspace folder`);return}this._logService.info(`Invoking #provideEditSessionIdentity for workspaceFolder`,n);let r=this._editSessionIdentityProviders.get(n.uri.scheme);if(this._logService.info(`Provider for scheme ${n.uri.scheme} is defined: `,!!r),!r)return;let i=await r.provideEditSessionIdentity(n,t);if(this._logService.info(`Provider returned edit session identifier: `,i),i)return i}async $provideEditSessionIdentityMatch(e,t,n,r){this._logService.info(`Getting edit session identifier for workspaceFolder`,e);let i=await this.resolveWorkspaceFolder(w.revive(e));if(!i){this._logService.warn(`Unable to resolve workspace folder`);return}this._logService.info(`Invoking #provideEditSessionIdentity for workspaceFolder`,i);let a=this._editSessionIdentityProviders.get(i.uri.scheme);if(this._logService.info(`Provider for scheme ${i.uri.scheme} is defined: `,!!a),!a)return;let o=await a.provideEditSessionIdentityMatch?.(t,n,r);if(this._logService.info(`Provider returned edit session identifier match result: `,o),o)return o}getOnWillCreateEditSessionIdentityEvent(e){return(t,n,r)=>{let i=function(e){t.call(n,e)};return i.extension=e,this._onWillCreateEditSessionIdentityEvent.event(i,void 0,r)}}async $onWillCreateEditSessionIdentity(e,t,n){let r=await this.resolveWorkspaceFolder(w.revive(e));if(r===void 0)throw Error(`Unable to resolve workspace folder`);await this._onWillCreateEditSessionIdentityEvent.fireAsync({workspaceFolder:r},t,async(e,t)=>{let r=Date.now();await Promise.resolve(e),Date.now()-r>n&&this._logService.warn(`SLOW edit session create-participant`,t.extension.identifier)}),t.isCancellationRequested}registerCanonicalUriProvider(e,t){if(this._canonicalUriProviders.has(e))throw Error(`A provider has already been registered for scheme ${e}`);this._canonicalUriProviders.set(e,t);let n=this._uriTransformerService.transformOutgoingScheme(e),r=this._providerHandlePool++;return this._proxy.$registerCanonicalUriProvider(r,n),_(()=>{this._canonicalUriProviders.delete(e),this._proxy.$unregisterCanonicalUriProvider(r)})}async provideCanonicalUri(e,t,n){let r=this._canonicalUriProviders.get(e.scheme);if(!r)return;let i=await r.provideCanonicalUri?.(w.revive(e),t,n);if(i)return i}async $provideCanonicalUri(e,t,n){return this.provideCanonicalUri(w.revive(e),{targetScheme:t},n)}async decode(e,t){let[n,r]=this.toEncodeDecodeParameters(t),i=await this._proxy.$resolveDecoding(n,r),a=(await AA(Ut(b.wrap(e)),{...i,acceptTextOnly:!0,overwriteEncoding:e=>e===null||e===i.preferredEncoding?Promise.resolve(i.preferredEncoding):this._proxy.$validateDetectedEncoding(n,e,r)})).stream;return Et(a,e=>e.join(``))}async encode(e,t){let[n,r]=this.toEncodeDecodeParameters(t),{encoding:i,addBOM:a}=await this._proxy.$resolveEncoding(n,r);if(i===bA&&!a)return b.fromString(e).buffer;let o=await jA(JA(e),i,{addBOM:a});return Ht(o).buffer}toEncodeDecodeParameters(e){let t=ti(e?.uri)?e.uri:void 0,n=typeof e?.encoding==`string`?e.encoding:void 0;return[t,n?{encoding:n}:void 0]}};tj=A([j(0,Is),j(1,ks),j(2,Mc),j(3,xs),j(4,Rs)],tj);const nj=k(`IExtHostWorkspace`);function rj(e){let t,n;if(e)return typeof e==`string`?t=e:(t=e.pattern,n=w.revive(e.baseUri)),{pattern:t,folder:n}}function ij(e){return(e?.map(e=>{if(typeof e==`string`)return e===``?void 0:{pattern:e,uri:void 0};{let t=rj(e);return t?{pattern:t.pattern,uri:t.folder}:void 0}})??[]).filter(e=>!!e)}var aj;(function(e){e[e.None=0]=`None`,e[e.UnexpectedEndOfComment=1]=`UnexpectedEndOfComment`,e[e.UnexpectedEndOfString=2]=`UnexpectedEndOfString`,e[e.UnexpectedEndOfNumber=3]=`UnexpectedEndOfNumber`,e[e.InvalidUnicode=4]=`InvalidUnicode`,e[e.InvalidEscapeCharacter=5]=`InvalidEscapeCharacter`,e[e.InvalidCharacter=6]=`InvalidCharacter`})(aj||={});var q;(function(e){e[e.OpenBraceToken=1]=`OpenBraceToken`,e[e.CloseBraceToken=2]=`CloseBraceToken`,e[e.OpenBracketToken=3]=`OpenBracketToken`,e[e.CloseBracketToken=4]=`CloseBracketToken`,e[e.CommaToken=5]=`CommaToken`,e[e.ColonToken=6]=`ColonToken`,e[e.NullKeyword=7]=`NullKeyword`,e[e.TrueKeyword=8]=`TrueKeyword`,e[e.FalseKeyword=9]=`FalseKeyword`,e[e.StringLiteral=10]=`StringLiteral`,e[e.NumericLiteral=11]=`NumericLiteral`,e[e.LineCommentTrivia=12]=`LineCommentTrivia`,e[e.BlockCommentTrivia=13]=`BlockCommentTrivia`,e[e.LineBreakTrivia=14]=`LineBreakTrivia`,e[e.Trivia=15]=`Trivia`,e[e.Unknown=16]=`Unknown`,e[e.EOF=17]=`EOF`})(q||={});var oj;(function(e){e[e.InvalidSymbol=1]=`InvalidSymbol`,e[e.InvalidNumberFormat=2]=`InvalidNumberFormat`,e[e.PropertyNameExpected=3]=`PropertyNameExpected`,e[e.ValueExpected=4]=`ValueExpected`,e[e.ColonExpected=5]=`ColonExpected`,e[e.CommaExpected=6]=`CommaExpected`,e[e.CloseBraceExpected=7]=`CloseBraceExpected`,e[e.CloseBracketExpected=8]=`CloseBracketExpected`,e[e.EndOfFileExpected=9]=`EndOfFileExpected`,e[e.InvalidCommentToken=10]=`InvalidCommentToken`,e[e.UnexpectedEndOfComment=11]=`UnexpectedEndOfComment`,e[e.UnexpectedEndOfString=12]=`UnexpectedEndOfString`,e[e.UnexpectedEndOfNumber=13]=`UnexpectedEndOfNumber`,e[e.InvalidUnicode=14]=`InvalidUnicode`,e[e.InvalidEscapeCharacter=15]=`InvalidEscapeCharacter`,e[e.InvalidCharacter=16]=`InvalidCharacter`})(oj||={});var sj;(function(e){e.DEFAULT={allowTrailingComma:!0}})(sj||={});function cj(e,t=!1){let n=0,r=e.length,i=``,a=0,o=q.Unknown,s=aj.None;function c(t){let r=0,i=0;for(;r<t;){let t=e.charCodeAt(n);if(t>=J._0&&t<=J._9)i=i*16+t-J._0;else if(t>=J.A&&t<=J.F)i=i*16+t-J.A+10;else if(t>=J.a&&t<=J.f)i=i*16+t-J.a+10;else break;n++,r++}return r<t&&(i=-1),i}function l(e){n=e,i=``,a=0,o=q.Unknown,s=aj.None}function u(){let t=n;if(e.charCodeAt(n)===J._0)n++;else for(n++;n<e.length&&dj(e.charCodeAt(n));)n++;if(n<e.length&&e.charCodeAt(n)===J.dot)if(n++,n<e.length&&dj(e.charCodeAt(n)))for(n++;n<e.length&&dj(e.charCodeAt(n));)n++;else return s=aj.UnexpectedEndOfNumber,e.substring(t,n);let r=n;if(n<e.length&&(e.charCodeAt(n)===J.E||e.charCodeAt(n)===J.e))if(n++,(n<e.length&&e.charCodeAt(n)===J.plus||e.charCodeAt(n)===J.minus)&&n++,n<e.length&&dj(e.charCodeAt(n))){for(n++;n<e.length&&dj(e.charCodeAt(n));)n++;r=n}else s=aj.UnexpectedEndOfNumber;return e.substring(t,r)}function d(){let t=``,i=n;for(;;){if(n>=r){t+=e.substring(i,n),s=aj.UnexpectedEndOfString;break}let a=e.charCodeAt(n);if(a===J.doubleQuote){t+=e.substring(i,n),n++;break}if(a===J.backslash){if(t+=e.substring(i,n),n++,n>=r){s=aj.UnexpectedEndOfString;break}let a=e.charCodeAt(n++);switch(a){case J.doubleQuote:t+=`"`;break;case J.backslash:t+=`\\`;break;case J.slash:t+=`/`;break;case J.b:t+=`\b`;break;case J.f:t+=`\f`;break;case J.n:t+=`
`;break;case J.r:t+=`\r`;break;case J.t:t+=`	`;break;case J.u:{let e=c(4);e>=0?t+=String.fromCharCode(e):s=aj.InvalidUnicode;break}default:s=aj.InvalidEscapeCharacter}i=n;continue}if(a>=0&&a<=31)if(uj(a)){t+=e.substring(i,n),s=aj.UnexpectedEndOfString;break}else s=aj.InvalidCharacter;n++}return t}function f(){if(i=``,s=aj.None,a=n,n>=r)return a=r,o=q.EOF;let t=e.charCodeAt(n);if(lj(t)){do n++,i+=String.fromCharCode(t),t=e.charCodeAt(n);while(lj(t));return o=q.Trivia}if(uj(t))return n++,i+=String.fromCharCode(t),t===J.carriageReturn&&e.charCodeAt(n)===J.lineFeed&&(n++,i+=`
`),o=q.LineBreakTrivia;switch(t){case J.openBrace:return n++,o=q.OpenBraceToken;case J.closeBrace:return n++,o=q.CloseBraceToken;case J.openBracket:return n++,o=q.OpenBracketToken;case J.closeBracket:return n++,o=q.CloseBracketToken;case J.colon:return n++,o=q.ColonToken;case J.comma:return n++,o=q.CommaToken;case J.doubleQuote:return n++,i=d(),o=q.StringLiteral;case J.slash:{let a=n-1;if(e.charCodeAt(n+1)===J.slash){for(n+=2;n<r&&!uj(e.charCodeAt(n));)n++;return i=e.substring(a,n),o=q.LineCommentTrivia}if(e.charCodeAt(n+1)===J.asterisk){n+=2;let t=r-1,c=!1;for(;n<t;){let t=e.charCodeAt(n);if(t===J.asterisk&&e.charCodeAt(n+1)===J.slash){n+=2,c=!0;break}n++}return c||(n++,s=aj.UnexpectedEndOfComment),i=e.substring(a,n),o=q.BlockCommentTrivia}return i+=String.fromCharCode(t),n++,o=q.Unknown}case J.minus:if(i+=String.fromCharCode(t),n++,n===r||!dj(e.charCodeAt(n)))return o=q.Unknown;case J._0:case J._1:case J._2:case J._3:case J._4:case J._5:case J._6:case J._7:case J._8:case J._9:return i+=u(),o=q.NumericLiteral;default:for(;n<r&&p(t);)n++,t=e.charCodeAt(n);if(a!==n){switch(i=e.substring(a,n),i){case`true`:return o=q.TrueKeyword;case`false`:return o=q.FalseKeyword;case`null`:return o=q.NullKeyword}return o=q.Unknown}return i+=String.fromCharCode(t),n++,o=q.Unknown}}function p(e){if(lj(e)||uj(e))return!1;switch(e){case J.closeBrace:case J.closeBracket:case J.openBrace:case J.openBracket:case J.doubleQuote:case J.colon:case J.comma:case J.slash:return!1}return!0}function ee(){let e;do e=f();while(e>=q.LineCommentTrivia&&e<=q.Trivia);return e}return{setPosition:l,getPosition:()=>n,scan:t?ee:f,getToken:()=>o,getTokenValue:()=>i,getTokenOffset:()=>a,getTokenLength:()=>n-a,getTokenError:()=>s}}function lj(e){return e===J.space||e===J.tab||e===J.verticalTab||e===J.formFeed||e===J.nonBreakingSpace||e===J.ogham||e>=J.enQuad&&e<=J.zeroWidthSpace||e===J.narrowNoBreakSpace||e===J.mathematicalSpace||e===J.ideographicSpace||e===J.byteOrderMark}function uj(e){return e===J.lineFeed||e===J.carriageReturn||e===J.lineSeparator||e===J.paragraphSeparator}function dj(e){return e>=J._0&&e<=J._9}var J;(function(e){e[e.nullCharacter=0]=`nullCharacter`,e[e.maxAsciiCharacter=127]=`maxAsciiCharacter`,e[e.lineFeed=10]=`lineFeed`,e[e.carriageReturn=13]=`carriageReturn`,e[e.lineSeparator=8232]=`lineSeparator`,e[e.paragraphSeparator=8233]=`paragraphSeparator`,e[e.nextLine=133]=`nextLine`,e[e.space=32]=`space`,e[e.nonBreakingSpace=160]=`nonBreakingSpace`,e[e.enQuad=8192]=`enQuad`,e[e.emQuad=8193]=`emQuad`,e[e.enSpace=8194]=`enSpace`,e[e.emSpace=8195]=`emSpace`,e[e.threePerEmSpace=8196]=`threePerEmSpace`,e[e.fourPerEmSpace=8197]=`fourPerEmSpace`,e[e.sixPerEmSpace=8198]=`sixPerEmSpace`,e[e.figureSpace=8199]=`figureSpace`,e[e.punctuationSpace=8200]=`punctuationSpace`,e[e.thinSpace=8201]=`thinSpace`,e[e.hairSpace=8202]=`hairSpace`,e[e.zeroWidthSpace=8203]=`zeroWidthSpace`,e[e.narrowNoBreakSpace=8239]=`narrowNoBreakSpace`,e[e.ideographicSpace=12288]=`ideographicSpace`,e[e.mathematicalSpace=8287]=`mathematicalSpace`,e[e.ogham=5760]=`ogham`,e[e._=95]=`_`,e[e.$=36]=`$`,e[e._0=48]=`_0`,e[e._1=49]=`_1`,e[e._2=50]=`_2`,e[e._3=51]=`_3`,e[e._4=52]=`_4`,e[e._5=53]=`_5`,e[e._6=54]=`_6`,e[e._7=55]=`_7`,e[e._8=56]=`_8`,e[e._9=57]=`_9`,e[e.a=97]=`a`,e[e.b=98]=`b`,e[e.c=99]=`c`,e[e.d=100]=`d`,e[e.e=101]=`e`,e[e.f=102]=`f`,e[e.g=103]=`g`,e[e.h=104]=`h`,e[e.i=105]=`i`,e[e.j=106]=`j`,e[e.k=107]=`k`,e[e.l=108]=`l`,e[e.m=109]=`m`,e[e.n=110]=`n`,e[e.o=111]=`o`,e[e.p=112]=`p`,e[e.q=113]=`q`,e[e.r=114]=`r`,e[e.s=115]=`s`,e[e.t=116]=`t`,e[e.u=117]=`u`,e[e.v=118]=`v`,e[e.w=119]=`w`,e[e.x=120]=`x`,e[e.y=121]=`y`,e[e.z=122]=`z`,e[e.A=65]=`A`,e[e.B=66]=`B`,e[e.C=67]=`C`,e[e.D=68]=`D`,e[e.E=69]=`E`,e[e.F=70]=`F`,e[e.G=71]=`G`,e[e.H=72]=`H`,e[e.I=73]=`I`,e[e.J=74]=`J`,e[e.K=75]=`K`,e[e.L=76]=`L`,e[e.M=77]=`M`,e[e.N=78]=`N`,e[e.O=79]=`O`,e[e.P=80]=`P`,e[e.Q=81]=`Q`,e[e.R=82]=`R`,e[e.S=83]=`S`,e[e.T=84]=`T`,e[e.U=85]=`U`,e[e.V=86]=`V`,e[e.W=87]=`W`,e[e.X=88]=`X`,e[e.Y=89]=`Y`,e[e.Z=90]=`Z`,e[e.ampersand=38]=`ampersand`,e[e.asterisk=42]=`asterisk`,e[e.at=64]=`at`,e[e.backslash=92]=`backslash`,e[e.bar=124]=`bar`,e[e.caret=94]=`caret`,e[e.closeBrace=125]=`closeBrace`,e[e.closeBracket=93]=`closeBracket`,e[e.closeParen=41]=`closeParen`,e[e.colon=58]=`colon`,e[e.comma=44]=`comma`,e[e.dot=46]=`dot`,e[e.doubleQuote=34]=`doubleQuote`,e[e.equals=61]=`equals`,e[e.exclamation=33]=`exclamation`,e[e.greaterThan=62]=`greaterThan`,e[e.lessThan=60]=`lessThan`,e[e.minus=45]=`minus`,e[e.openBrace=123]=`openBrace`,e[e.openBracket=91]=`openBracket`,e[e.openParen=40]=`openParen`,e[e.percent=37]=`percent`,e[e.plus=43]=`plus`,e[e.question=63]=`question`,e[e.semicolon=59]=`semicolon`,e[e.singleQuote=39]=`singleQuote`,e[e.slash=47]=`slash`,e[e.tilde=126]=`tilde`,e[e.backspace=8]=`backspace`,e[e.formFeed=12]=`formFeed`,e[e.byteOrderMark=65279]=`byteOrderMark`,e[e.tab=9]=`tab`,e[e.verticalTab=11]=`verticalTab`})(J||={});function fj(e,t,n=sj.DEFAULT){let r=cj(e,!1);function i(e){return e?()=>e(r.getTokenOffset(),r.getTokenLength()):()=>!0}function a(e){return e?t=>e(t,r.getTokenOffset(),r.getTokenLength()):()=>!0}let o=i(t.onObjectBegin),s=a(t.onObjectProperty),c=i(t.onObjectEnd),l=i(t.onArrayBegin),u=i(t.onArrayEnd),d=a(t.onLiteralValue),f=a(t.onSeparator),p=i(t.onComment),ee=a(t.onError),m=n&&n.disallowComments,te=n&&n.allowTrailingComma;function ne(){for(;;){let e=r.scan();switch(r.getTokenError()){case aj.InvalidUnicode:re(oj.InvalidUnicode);break;case aj.InvalidEscapeCharacter:re(oj.InvalidEscapeCharacter);break;case aj.UnexpectedEndOfNumber:re(oj.UnexpectedEndOfNumber);break;case aj.UnexpectedEndOfComment:m||re(oj.UnexpectedEndOfComment);break;case aj.UnexpectedEndOfString:re(oj.UnexpectedEndOfString);break;case aj.InvalidCharacter:re(oj.InvalidCharacter);break}switch(e){case q.LineCommentTrivia:case q.BlockCommentTrivia:m?re(oj.InvalidCommentToken):p();break;case q.Unknown:re(oj.InvalidSymbol);break;case q.Trivia:case q.LineBreakTrivia:break;default:return e}}}function re(e,t=[],n=[]){if(ee(e),t.length+n.length>0){let e=r.getToken();for(;e!==q.EOF;){if(t.indexOf(e)!==-1){ne();break}else if(n.indexOf(e)!==-1)break;e=ne()}}}function ie(e){let t=r.getTokenValue();return e?d(t):s(t),ne(),!0}function ae(){switch(r.getToken()){case q.NumericLiteral:{let e=0;try{e=JSON.parse(r.getTokenValue()),typeof e!=`number`&&(re(oj.InvalidNumberFormat),e=0)}catch{re(oj.InvalidNumberFormat)}d(e);break}case q.NullKeyword:d(null);break;case q.TrueKeyword:d(!0);break;case q.FalseKeyword:d(!1);break;default:return!1}return ne(),!0}function oe(){return r.getToken()===q.StringLiteral?(ie(!1),r.getToken()===q.ColonToken?(f(`:`),ne(),h()||re(oj.ValueExpected,[],[q.CloseBraceToken,q.CommaToken])):re(oj.ColonExpected,[],[q.CloseBraceToken,q.CommaToken]),!0):(re(oj.PropertyNameExpected,[],[q.CloseBraceToken,q.CommaToken]),!1)}function se(){o(),ne();let e=!1;for(;r.getToken()!==q.CloseBraceToken&&r.getToken()!==q.EOF;){if(r.getToken()===q.CommaToken){if(e||re(oj.ValueExpected,[],[]),f(`,`),ne(),r.getToken()===q.CloseBraceToken&&te)break}else e&&re(oj.CommaExpected,[],[]);oe()||re(oj.ValueExpected,[],[q.CloseBraceToken,q.CommaToken]),e=!0}return c(),r.getToken()===q.CloseBraceToken?ne():re(oj.CloseBraceExpected,[q.CloseBraceToken],[]),!0}function ce(){l(),ne();let e=!1;for(;r.getToken()!==q.CloseBracketToken&&r.getToken()!==q.EOF;){if(r.getToken()===q.CommaToken){if(e||re(oj.ValueExpected,[],[]),f(`,`),ne(),r.getToken()===q.CloseBracketToken&&te)break}else e&&re(oj.CommaExpected,[],[]);h()||re(oj.ValueExpected,[],[q.CloseBracketToken,q.CommaToken]),e=!0}return u(),r.getToken()===q.CloseBracketToken?ne():re(oj.CloseBracketExpected,[q.CloseBracketToken],[]),!0}function h(){switch(r.getToken()){case q.OpenBracketToken:return ce();case q.OpenBraceToken:return se();case q.StringLiteral:return ie(!0);default:return ae()}}return ne(),r.getToken()===q.EOF?n.allowEmptyContent?!0:(re(oj.ValueExpected,[],[]),!1):h()?(r.getToken()!==q.EOF&&re(oj.EndOfFileExpected,[],[]),!0):(re(oj.ValueExpected,[],[]),!1)}function pj(e){return Object.isFrozen(e)?e:Xs(e)}var mj=class e{static createEmptyModel(t){return new e({},[],[],void 0,t)}constructor(e,t,n,r,i){this._contents=e,this._keys=t,this._overrides=n,this.raw=r,this.logService=i,this.overrideConfigurations=new Map}get rawConfiguration(){if(!this._rawConfiguration)if(this.raw){let t=(Array.isArray(this.raw)?this.raw:[this.raw]).map(t=>{if(t instanceof e)return t;let n=new hj(``,this.logService);return n.parseRaw(t),n.configurationModel});this._rawConfiguration=t.reduce((e,t)=>t===e?t:e.merge(t),t[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?Bh(this.contents,e):this.contents}inspect(t,n){let r=this;return{get value(){return pj(r.rawConfiguration.getValue(t))},get override(){return n?pj(r.rawConfiguration.getOverrideValue(t,n)):void 0},get merged(){return pj(n?r.rawConfiguration.override(n).getValue(t):r.rawConfiguration.getValue(t))},get overrides(){let n=[];for(let{contents:i,identifiers:a,keys:o}of r.rawConfiguration.overrides){let s=new e(i,o,[],void 0,r.logService).getValue(t);s!==void 0&&n.push({identifiers:a,value:s})}return n.length?pj(n):void 0}}}getOverrideValue(e,t){let n=this.getContentsForOverrideIdentifer(t);return n?e?Bh(n,e):n:void 0}getKeysForOverrideIdentifier(e){let t=[];for(let n of this.overrides)n.identifiers.includes(e)&&t.push(...n.keys);return we(t)}getAllOverrideIdentifiers(){let e=[];for(let t of this.overrides)e.push(...t.identifiers);return we(e)}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...t){let n=Ys(this.contents),r=Ys(this.overrides),i=[...this.keys],a=this.raw?Array.isArray(this.raw)?[...this.raw]:[this.raw]:[this];for(let e of t){if(a.push(...e.raw?Array.isArray(e.raw)?e.raw:[e.raw]:[e]),e.isEmpty())continue;this.mergeContents(n,e.contents);for(let t of e.overrides){let[e]=r.filter(e=>ge(e.identifiers,t.identifiers));e?(this.mergeContents(e.contents,t.contents),e.keys.push(...t.keys),e.keys=we(e.keys)):r.push(Ys(t))}for(let t of e.keys)i.indexOf(t)===-1&&i.push(t)}return new e(n,i,r,!a.length||a.every(t=>t instanceof e)?void 0:a,this.logService)}createOverrideConfigurationModel(t){let n=this.getContentsForOverrideIdentifer(t);if(!n||typeof n!=`object`||!Object.keys(n).length)return this;let r={};for(let e of we([...Object.keys(this.contents),...Object.keys(n)])){let t=this.contents[e],i=n[e];i&&(typeof t==`object`&&typeof i==`object`?(t=Ys(t),this.mergeContents(t,i)):t=i),r[e]=t}return new e(r,this.keys,this.overrides,void 0,this.logService)}mergeContents(e,t){for(let n of Object.keys(t)){if(n in e&&$e(e[n])&&$e(t[n])){this.mergeContents(e[n],t[n]);continue}e[n]=Ys(t[n])}}getContentsForOverrideIdentifer(e){let t=null,n=null,r=e=>{e&&(n?this.mergeContents(n,e):n=Ys(e))};for(let n of this.overrides)n.identifiers.length===1&&n.identifiers[0]===e?t=n.contents:n.identifiers.includes(e)&&r(n.contents);return r(t),n}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(e,t){this.updateValue(e,t,!0)}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){let t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),Rh(this.contents,e),dg.test(e)&&this.overrides.splice(this.overrides.findIndex(t=>ge(t.identifiers,fg(e))),1))}updateValue(e,t,n){if(Lh(this.contents,e,t,e=>this.logService.error(e)),n||=this.keys.indexOf(e)===-1,n&&this.keys.push(e),dg.test(e)){let t=fg(e),n={identifiers:t,keys:Object.keys(this.contents[e]),contents:Ih(this.contents[e],e=>this.logService.error(e))},r=this.overrides.findIndex(e=>ge(e.identifiers,t));r===-1?this.overrides.push(n):this.overrides[r]=n}}},hj=class{constructor(e,t){this._name=e,this.logService=t,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[],this._parseErrors=[]}get configurationModel(){return this._configurationModel||mj.createEmptyModel(this.logService)}get restrictedConfigurations(){return this._restrictedConfigurations}get errors(){return this._parseErrors}parse(e,t){if(!at(e)){let n=this.doParseContent(e);this.parseRaw(n,t)}}reparse(e){this._raw&&this.parseRaw(this._raw,e)}parseRaw(e,t){this._raw=e;let{contents:n,keys:r,overrides:i,restricted:a,hasExcludedProperties:o}=this.doParseRaw(e,t);this._configurationModel=new mj(n,r,i,o?[e]:void 0,this.logService),this._restrictedConfigurations=a||[]}doParseContent(e){let t={},n=null,r=[],i=[];function a(e){Array.isArray(r)?r.push(e):n!==null&&(r[n]=e)}let o={onObjectBegin:()=>{let e={};a(e),i.push(r),r=e,n=null},onObjectProperty:e=>{n=e},onObjectEnd:()=>{r=i.pop()},onArrayBegin:()=>{let e=[];a(e),i.push(r),r=e,n=null},onArrayEnd:()=>{r=i.pop()},onLiteralValue:a,onError:(e,t,n)=>{}};if(e)try{fj(e,o),t=r[0]||{}}catch(e){this.logService.error(`Error while parsing settings file ${this._name}: ${e}`),this._parseErrors=[e]}return t}doParseRaw(e,t){let n=Sm.as(Xh.Configuration).getConfigurationProperties(),r=this.filter(e,n,!0,t);e=r.raw;let i=Ih(e,e=>this.logService.error(`Conflict in settings file ${this._name}: ${e}`)),a=Object.keys(e),o=this.toOverrides(e,e=>this.logService.error(`Conflict in settings file ${this._name}: ${e}`));return{contents:i,keys:a,overrides:o,restricted:r.restricted,hasExcludedProperties:r.hasExcludedProperties}}filter(e,t,n,r){let i=!1;if(!r?.scopes&&!r?.skipRestricted&&!r?.exclude?.length)return{raw:e,restricted:[],hasExcludedProperties:i};let a={},o=[];for(let s in e)if(dg.test(s)&&n){let n=this.filter(e[s],t,!1,r);a[s]=n.raw,i||=n.hasExcludedProperties,o.push(...n.restricted)}else{let n=t[s];n?.restricted&&o.push(s),this.shouldInclude(s,n,r)?a[s]=e[s]:i=!0}return{raw:a,restricted:o,hasExcludedProperties:i}}shouldInclude(e,t,n){if(n.exclude?.includes(e))return!1;if(n.include?.includes(e))return!0;if(n.skipRestricted&&t?.restricted||n.skipUnregistered&&!t)return!1;let r=t?t.scope===void 0?Zh.WINDOW:t.scope:void 0;return r===void 0||n.scopes===void 0?!0:n.scopes.includes(r)}toOverrides(e,t){let n=[];for(let r of Object.keys(e))if(dg.test(r)){let i={};for(let t in e[r])i[t]=e[r][t];n.push({identifiers:fg(r),keys:Object.keys(i),contents:Ih(i,t)})}return n}},gj=class{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f){this.key=e,this.overrides=t,this._value=n,this.overrideIdentifiers=r,this.defaultConfiguration=i,this.policyConfiguration=a,this.applicationConfiguration=o,this.userConfiguration=s,this.localUserConfiguration=c,this.remoteUserConfiguration=l,this.workspaceConfiguration=u,this.folderConfigurationModel=d,this.memoryConfigurationModel=f}get value(){return pj(this._value)}toInspectValue(e){return e?.value!==void 0||e?.override!==void 0||e?.overrides!==void 0?e:void 0}get defaultInspectValue(){return this._defaultInspectValue||=this.defaultConfiguration.inspect(this.key,this.overrides.overrideIdentifier),this._defaultInspectValue}get defaultValue(){return this.defaultInspectValue.merged}get default(){return this.toInspectValue(this.defaultInspectValue)}get policyInspectValue(){return this._policyInspectValue===void 0&&(this._policyInspectValue=this.policyConfiguration?this.policyConfiguration.inspect(this.key):null),this._policyInspectValue}get policyValue(){return this.policyInspectValue?.merged}get policy(){return this.policyInspectValue?.value===void 0?void 0:{value:this.policyInspectValue.value}}get applicationInspectValue(){return this._applicationInspectValue===void 0&&(this._applicationInspectValue=this.applicationConfiguration?this.applicationConfiguration.inspect(this.key):null),this._applicationInspectValue}get applicationValue(){return this.applicationInspectValue?.merged}get application(){return this.toInspectValue(this.applicationInspectValue)}get userInspectValue(){return this._userInspectValue||=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier),this._userInspectValue}get userValue(){return this.userInspectValue.merged}get user(){return this.toInspectValue(this.userInspectValue)}get userLocalInspectValue(){return this._userLocalInspectValue||=this.localUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier),this._userLocalInspectValue}get userLocalValue(){return this.userLocalInspectValue.merged}get userLocal(){return this.toInspectValue(this.userLocalInspectValue)}get userRemoteInspectValue(){return this._userRemoteInspectValue||=this.remoteUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier),this._userRemoteInspectValue}get userRemoteValue(){return this.userRemoteInspectValue.merged}get userRemote(){return this.toInspectValue(this.userRemoteInspectValue)}get workspaceInspectValue(){return this._workspaceInspectValue===void 0&&(this._workspaceInspectValue=this.workspaceConfiguration?this.workspaceConfiguration.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceInspectValue}get workspaceValue(){return this.workspaceInspectValue?.merged}get workspace(){return this.toInspectValue(this.workspaceInspectValue)}get workspaceFolderInspectValue(){return this._workspaceFolderInspectValue===void 0&&(this._workspaceFolderInspectValue=this.folderConfigurationModel?this.folderConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceFolderInspectValue}get workspaceFolderValue(){return this.workspaceFolderInspectValue?.merged}get workspaceFolder(){return this.toInspectValue(this.workspaceFolderInspectValue)}get memoryInspectValue(){return this._memoryInspectValue===void 0&&(this._memoryInspectValue=this.memoryConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier)),this._memoryInspectValue}get memoryValue(){return this.memoryInspectValue.merged}get memory(){return this.toInspectValue(this.memoryInspectValue)}};let _j=class e{constructor(e,t,n,r,i,a,o,s,c,l){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=n,this._localUserConfiguration=r,this._remoteUserConfiguration=i,this._workspaceConfiguration=a,this._folderConfigurations=o,this._memoryConfiguration=s,this._memoryConfigurationByResource=c,this.logService=l,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new ze,this._userConfiguration=null}getValue(e,t,n){let r=this.getConsolidatedConfigurationModel(e,t,n);return r.getValue(e)}updateValue(e,t,n={}){let r;n.resource?(r=this._memoryConfigurationByResource.get(n.resource),r||(r=mj.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(n.resource,r))):r=this._memoryConfiguration,t===void 0?r.removeValue(e):r.setValue(e,t),n.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,n){let r=this.getConsolidatedConfigurationModel(e,t,n),i=this.getFolderConfigurationModelForResource(t.resource,n),a=t.resource&&this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration,o=new Set;for(let t of r.overrides)for(let n of t.identifiers)r.getOverrideValue(e,n)!==void 0&&o.add(n);return new gj(e,t,r.getValue(e),o.size?[...o]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,n?this._workspaceConfiguration:void 0,i||void 0,a)}keys(e){let t=this.getFolderConfigurationModelForResource(void 0,e);return{default:this._defaultConfiguration.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this._workspaceConfiguration.keys.slice(0),workspaceFolder:t?t.keys.slice(0):[]}}updateDefaultConfiguration(e){this._defaultConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updatePolicyConfiguration(e){this._policyConfiguration=e}updateApplicationConfiguration(e){this._applicationConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(e){this._localUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(e){this._remoteUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(e){this._workspaceConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(e,t){this._folderConfigurations.set(e,t),this._foldersConsolidatedConfigurations.delete(e)}deleteFolderConfiguration(e){this.folderConfigurations.delete(e),this._foldersConsolidatedConfigurations.delete(e)}compareAndUpdateDefaultConfiguration(e,t){let n=[];if(!t){let{added:n,updated:r,removed:i}=yj(this._defaultConfiguration,e);t=[...n,...r,...i]}for(let r of t)for(let t of fg(r)){let r=this._defaultConfiguration.getKeysForOverrideIdentifier(t),i=e.getKeysForOverrideIdentifier(t),a=[...i.filter(e=>r.indexOf(e)===-1),...r.filter(e=>i.indexOf(e)===-1),...r.filter(n=>!tc(this._defaultConfiguration.override(t).getValue(n),e.override(t).getValue(n)))];n.push([t,a])}return this.updateDefaultConfiguration(e),{keys:t,overrides:n}}compareAndUpdatePolicyConfiguration(e){let{added:t,updated:n,removed:r}=yj(this._policyConfiguration,e),i=[...t,...n,...r];return i.length&&this.updatePolicyConfiguration(e),{keys:i,overrides:[]}}compareAndUpdateApplicationConfiguration(e){let{added:t,updated:n,removed:r,overrides:i}=yj(this.applicationConfiguration,e),a=[...t,...n,...r];return a.length&&this.updateApplicationConfiguration(e),{keys:a,overrides:i}}compareAndUpdateLocalUserConfiguration(e){let{added:t,updated:n,removed:r,overrides:i}=yj(this.localUserConfiguration,e),a=[...t,...n,...r];return a.length&&this.updateLocalUserConfiguration(e),{keys:a,overrides:i}}compareAndUpdateRemoteUserConfiguration(e){let{added:t,updated:n,removed:r,overrides:i}=yj(this.remoteUserConfiguration,e),a=[...t,...n,...r];return a.length&&this.updateRemoteUserConfiguration(e),{keys:a,overrides:i}}compareAndUpdateWorkspaceConfiguration(e){let{added:t,updated:n,removed:r,overrides:i}=yj(this.workspaceConfiguration,e),a=[...t,...n,...r];return a.length&&this.updateWorkspaceConfiguration(e),{keys:a,overrides:i}}compareAndUpdateFolderConfiguration(e,t){let n=this.folderConfigurations.get(e),{added:r,updated:i,removed:a,overrides:o}=yj(n,t),s=[...r,...i,...a];return(s.length||!n)&&this.updateFolderConfiguration(e,t),{keys:s,overrides:o}}compareAndDeleteFolderConfiguration(e){let t=this.folderConfigurations.get(e);if(!t)throw Error(`Unknown folder`);this.deleteFolderConfiguration(e);let{added:n,updated:r,removed:i,overrides:a}=yj(t,void 0);return{keys:[...n,...r,...i],overrides:a}}get defaults(){return this._defaultConfiguration}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){if(!this._userConfiguration)if(this._remoteUserConfiguration.isEmpty())this._userConfiguration=this._localUserConfiguration;else{let e=this._localUserConfiguration.merge(this._remoteUserConfiguration);this._userConfiguration=new mj(e.contents,e.keys,e.overrides,void 0,this.logService)}return this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidatedConfigurationModel(e,t,n){let r=this.getConsolidatedConfigurationModelForResource(t,n);if(t.overrideIdentifier&&(r=r.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0){r=r.merge();for(let e of this._policyConfiguration.keys)r.setValue(e,this._policyConfiguration.getValue(e))}return r}getConsolidatedConfigurationModelForResource({resource:e},t){let n=this.getWorkspaceConsolidatedConfiguration();if(t&&e){let r=t.getFolder(e);r&&(n=this.getFolderConsolidatedConfiguration(r.uri)||n);let i=this._memoryConfigurationByResource.get(e);i&&(n=n.merge(i))}return n}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){let n=this.getWorkspaceConsolidatedConfiguration(),r=this._folderConfigurations.get(e);r?(t=n.merge(r),this._foldersConsolidatedConfigurations.set(e,t)):t=n}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){let n=t.getFolder(e);if(n)return this._folderConfigurations.get(n.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys,raw:Array.isArray(this.applicationConfiguration.raw)?void 0:this.applicationConfiguration.raw},userLocal:{contents:this.localUserConfiguration.contents,overrides:this.localUserConfiguration.overrides,keys:this.localUserConfiguration.keys,raw:Array.isArray(this.localUserConfiguration.raw)?void 0:this.localUserConfiguration.raw},userRemote:{contents:this.remoteUserConfiguration.contents,overrides:this.remoteUserConfiguration.overrides,keys:this.remoteUserConfiguration.keys,raw:Array.isArray(this.remoteUserConfiguration.raw)?void 0:this.remoteUserConfiguration.raw},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{let{contents:n,overrides:r,keys:i}=this._folderConfigurations.get(t);return e.push([t,{contents:n,overrides:r,keys:i}]),e},[])}}allKeys(){let e=new Set;return this._defaultConfiguration.keys.forEach(t=>e.add(t)),this.userConfiguration.keys.forEach(t=>e.add(t)),this._workspaceConfiguration.keys.forEach(t=>e.add(t)),this._folderConfigurations.forEach(t=>t.keys.forEach(t=>e.add(t))),[...e.values()]}allOverrideIdentifiers(){let e=new Set;return this._defaultConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this.userConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this._workspaceConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this._folderConfigurations.forEach(t=>t.getAllOverrideIdentifiers().forEach(t=>e.add(t))),[...e.values()]}getAllKeysForOverrideIdentifier(e){let t=new Set;return this._defaultConfiguration.getKeysForOverrideIdentifier(e).forEach(e=>t.add(e)),this.userConfiguration.getKeysForOverrideIdentifier(e).forEach(e=>t.add(e)),this._workspaceConfiguration.getKeysForOverrideIdentifier(e).forEach(e=>t.add(e)),this._folderConfigurations.forEach(n=>n.getKeysForOverrideIdentifier(e).forEach(e=>t.add(e))),[...t.values()]}static parse(t,n){let r=this.parseConfigurationModel(t.defaults,n),i=this.parseConfigurationModel(t.policy,n),a=this.parseConfigurationModel(t.application,n),o=this.parseConfigurationModel(t.userLocal,n),s=this.parseConfigurationModel(t.userRemote,n),c=this.parseConfigurationModel(t.workspace,n),l=t.folders.reduce((e,t)=>(e.set(w.revive(t[0]),this.parseConfigurationModel(t[1],n)),e),new ze);return new e(r,i,a,o,s,c,l,mj.createEmptyModel(n),new ze,n)}static parseConfigurationModel(e,t){return new mj(e.contents,e.keys,e.overrides,e.raw,t)}};var vj=class{constructor(e,t,n,r,i){this.change=e,this.previous=t,this.currentConfiguraiton=n,this.currentWorkspace=r,this.logService=i,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(let t of e.keys)this.affectedKeys.add(t);for(let[,t]of e.overrides)for(let e of t)this.affectedKeys.add(e);this._affectsConfigStr=this._marker;for(let e of this.affectedKeys)this._affectsConfigStr+=e+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=_j.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(e,t){let n=this._marker+e,r=this._affectsConfigStr.indexOf(n);if(r<0)return!1;let i=r+n.length;if(i>=this._affectsConfigStr.length)return!1;let a=this._affectsConfigStr.charCodeAt(i);if(a!==this._markerCode1&&a!==this._markerCode2)return!1;if(t){let n=this.previousConfiguration?this.previousConfiguration.getValue(e,t,this.previous?.workspace):void 0,r=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!tc(n,r)}return!0}};function yj(e,t){let{added:n,removed:r,updated:i}=bj(t?.rawConfiguration,e?.rawConfiguration),a=[],o=e?.getAllOverrideIdentifiers()||[],s=t?.getAllOverrideIdentifiers()||[];if(t){let e=s.filter(e=>!o.includes(e));for(let n of e)a.push([n,t.getKeysForOverrideIdentifier(n)])}if(e){let t=o.filter(e=>!s.includes(e));for(let n of t)a.push([n,e.getKeysForOverrideIdentifier(n)])}if(t&&e){for(let n of o)if(s.includes(n)){let r=bj({contents:e.getOverrideValue(void 0,n)||{},keys:e.getKeysForOverrideIdentifier(n)},{contents:t.getOverrideValue(void 0,n)||{},keys:t.getKeysForOverrideIdentifier(n)});a.push([n,[...r.added,...r.removed,...r.updated]])}}return{added:n,removed:r,updated:i,overrides:a}}function bj(e,t){let n=e?t?e.keys.filter(e=>t.keys.indexOf(e)===-1):[...e.keys]:[],r=t?e?t.keys.filter(t=>e.keys.indexOf(t)===-1):[...t.keys]:[],i=[];if(e&&t){for(let n of t.keys)if(e.keys.indexOf(n)!==-1){let r=Bh(t.contents,n),a=Bh(e.contents,n);tc(r,a)||i.push(n)}}return{added:n,removed:r,updated:i}}function xj(e,t){if(t){let n=t.split(`.`),r=e;for(let e=0;r&&e<n.length;e++)r=r[n[e]];return r}}function Sj(e){return e instanceof w}function Cj(e){return e&&e.uri instanceof w&&e.languageId&&typeof e.languageId==`string`}function wj(e){return e&&!e.uri&&e.languageId&&typeof e.languageId==`string`}function Tj(e){return e&&e.uri instanceof w&&(!e.name||typeof e.name==`string`)&&(!e.index||typeof e.index==`number`)}function Ej(e){if(Sj(e))return{resource:e};if(Cj(e))return{resource:e.uri,overrideIdentifier:e.languageId};if(wj(e))return{overrideIdentifier:e.languageId};if(Tj(e))return{resource:e.uri};if(e===null)return{resource:null}}let Dj=class{constructor(e,t,n){this._proxy=e.getProxy(E.MainThreadConfiguration),this._extHostWorkspace=t,this._logService=n,this._barrier=new bo,this._actual=null}getConfigProvider(){return this._barrier.wait().then(e=>this._actual)}$initializeConfiguration(e){this._actual=new Oj(this._proxy,this._extHostWorkspace,e,this._logService),this._barrier.open()}$acceptConfigurationChanged(e,t){this.getConfigProvider().then(n=>n.$acceptConfigurationChanged(e,t))}};Dj=A([j(0,Is),j(1,nj),j(2,xs)],Dj);var Oj=class{constructor(e,t,n,r){this._onDidChangeConfiguration=new x,this._proxy=e,this._logService=r,this._extHostWorkspace=t,this._configuration=_j.parse(n,r),this._configurationScopes=this._toMap(n.configurationScopes)}get onDidChangeConfiguration(){return this._onDidChangeConfiguration&&this._onDidChangeConfiguration.event}$acceptConfigurationChanged(e,t){let n={data:this._configuration.toData(),workspace:this._extHostWorkspace.workspace};this._configuration=_j.parse(e,this._logService),this._configurationScopes=this._toMap(e.configurationScopes),this._onDidChangeConfiguration.fire(this._toConfigurationChangeEvent(t,n))}getConfiguration(e,t,n){let r=Ej(t)||{},i=this._toReadonlyValue(this._configuration.getValue(e,r,this._extHostWorkspace.workspace));e&&this._validateConfigurationAccess(e,r,n?.identifier);function a(e){if(e==null)return null;if(typeof e==`boolean`)return e?Fh.USER:Fh.WORKSPACE;switch(e){case zS.Global:return Fh.USER;case zS.Workspace:return Fh.WORKSPACE;case zS.WorkspaceFolder:return Fh.WORKSPACE_FOLDER}}let o={has(e){return xj(i,e)!==void 0},get:(t,a)=>{this._validateConfigurationAccess(e?`${e}.${t}`:t,r,n?.identifier);let o=xj(i,t);if(o===void 0)o=a;else{let e,n=(t,r)=>{if($e(t)){let a,o=()=>{e||=Ys(i),a||=xj(e,r)};return new Proxy(t,{get:(t,i)=>{if(typeof i==`string`&&i.toLowerCase()===`tojson`)return o(),()=>a;if(e)return a||=xj(e,r),a[i];let s=t[i];return typeof i==`string`?n(s,`${r}.${i}`):s},set:(e,t,n)=>(o(),a&&(a[t]=n),!0),deleteProperty:(e,t)=>(o(),a&&delete a[t],!0),defineProperty:(e,t,n)=>(o(),a&&Object.defineProperty(a,t,n),!0)})}return Array.isArray(t)?Ys(t):t};o=n(o,t)}return o},update:(t,n,i,o)=>{t=e?`${e}.${t}`:t;let s=a(i);return n===void 0?this._proxy.$removeConfigurationOption(s,t,r,o):this._proxy.$updateConfigurationOption(s,t,n,r,o)},inspect:t=>{t=e?`${e}.${t}`:t;let n=this._configuration.inspect(t,r,this._extHostWorkspace.workspace);if(n)return{key:t,defaultValue:Ys(n.policy?.value??n.default?.value),globalLocalValue:Ys(n.userLocal?.value),globalRemoteValue:Ys(n.userRemote?.value),globalValue:Ys(n.user?.value??n.application?.value),workspaceValue:Ys(n.workspace?.value),workspaceFolderValue:Ys(n.workspaceFolder?.value),defaultLanguageValue:Ys(n.default?.override),globalLocalLanguageValue:Ys(n.userLocal?.override),globalRemoteLanguageValue:Ys(n.userRemote?.override),globalLanguageValue:Ys(n.user?.override??n.application?.override),workspaceLanguageValue:Ys(n.workspace?.override),workspaceFolderLanguageValue:Ys(n.workspaceFolder?.override),languageIds:Ys(n.overrideIdentifiers)}}};return typeof i==`object`&&ec(o,i,!1),Object.freeze(o)}_toReadonlyValue(e){let t=e=>$e(e)?new Proxy(e,{get:(e,n)=>t(e[n]),set:(e,t,n)=>{throw Error(`TypeError: Cannot assign to read only property '${String(t)}' of object`)},deleteProperty:(e,t)=>{throw Error(`TypeError: Cannot delete read only property '${String(t)}' of object`)},defineProperty:(e,t)=>{throw Error(`TypeError: Cannot define property '${String(t)}' for a readonly object`)},setPrototypeOf:e=>{throw Error(`TypeError: Cannot set prototype for a readonly object`)},isExtensible:()=>!1,preventExtensions:()=>!0}):e;return t(e)}_validateConfigurationAccess(e,t,n){let r=dg.test(e)?Zh.RESOURCE:this._configurationScopes.get(e),i=n?`[${n.value}] `:``;if(Zh.RESOURCE===r){t?.resource===void 0&&this._logService.warn(`${i}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`);return}if(Zh.WINDOW===r){t?.resource&&this._logService.warn(`${i}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`);return}}_toConfigurationChangeEvent(e,t){let n=new vj(e,t,this._configuration,this._extHostWorkspace.workspace,this._logService);return Object.freeze({affectsConfiguration:(e,t)=>n.affectsConfiguration(e,Ej(t))})}_toMap(e){return e.reduce((e,t)=>(e.set(t[0],t[1]),e),new Map)}};const kj=k(`IExtHostConfiguration`);var Aj=class{constructor(e,t){this.versionId=e,this.removedDueToLooping=t}},jj=class e extends y{static isHostExtension(e,t,n){if(t.getExtensionDescription(e))return!1;let r=n.getExtensionDescription(e);return r?!!((r.main||r.browser)&&r.api===`none`):!1}constructor(e,t){super(),this._activationEventsReader=e,this._onDidChange=this._register(new x),this.onDidChange=this._onDidChange.event,this._versionId=0,this._extensionDescriptions=t,this._initialize()}_initialize(){this._extensionDescriptions.sort(Pj),this._extensionsMap=new gs,this._extensionsArr=[],this._activationMap=new Map;for(let e of this._extensionDescriptions){if(this._extensionsMap.has(e.identifier)){console.error("Extension `"+e.identifier.value+"` is already registered");continue}this._extensionsMap.set(e.identifier,e),this._extensionsArr.push(e);let t=this._activationEventsReader.readActivationEvents(e);for(let n of t)this._activationMap.has(n)||this._activationMap.set(n,[]),this._activationMap.get(n).push(e)}}set(e){return this._extensionDescriptions=e,this._initialize(),this._versionId++,this._onDidChange.fire(void 0),{versionId:this._versionId}}deltaExtensions(t,n){this._extensionDescriptions=Fj(this._extensionDescriptions,n),this._extensionDescriptions=this._extensionDescriptions.concat(t);let r=e._findLoopingExtensions(this._extensionDescriptions);return this._extensionDescriptions=Fj(this._extensionDescriptions,r.map(e=>e.identifier)),this._initialize(),this._versionId++,this._onDidChange.fire(void 0),new Aj(this._versionId,r)}static _findLoopingExtensions(e){let t=new class{constructor(){this._arcs=new Map,this._nodesSet=new Set,this._nodesArr=[]}addNode(e){this._nodesSet.has(e)||(this._nodesSet.add(e),this._nodesArr.push(e))}addArc(e,t){this.addNode(e),this.addNode(t),this._arcs.has(e)?this._arcs.get(e).push(t):this._arcs.set(e,[t])}getArcs(e){return this._arcs.has(e)?this._arcs.get(e):[]}hasOnlyGoodArcs(e,n){let r=(t.getArcs(e));for(let e=0;e<r.length;e++)if(!n.has(r[e]))return!1;return!0}getNodes(){return this._nodesArr}},n=new gs;for(let r of e)if(n.set(r.identifier,r),r.extensionDependencies)for(let e of r.extensionDependencies)t.addArc(ms.toKey(r.identifier),ms.toKey(e));let r=new Set;t.getNodes().filter(e=>t.getArcs(e).length===0).forEach(e=>r.add(e));let i=t.getNodes().filter(e=>!r.has(e)),a;do{a=!1;for(let e=0;e<i.length;e++){let n=i[e];t.hasOnlyGoodArcs(n,r)&&(i.splice(e,1),e--,r.add(n),a=!0)}}while(a);return i.map(e=>n.get(e))}containsActivationEvent(e){return this._activationMap.has(e)}containsExtension(e){return this._extensionsMap.has(e)}getExtensionDescriptionsForActivationEvent(e){let t=this._activationMap.get(e);return t?t.slice(0):[]}getAllExtensionDescriptions(){return this._extensionsArr.slice(0)}getSnapshot(){return new Mj(this._versionId,this.getAllExtensionDescriptions())}getExtensionDescription(e){let t=this._extensionsMap.get(e);return t||void 0}getExtensionDescriptionByUUID(e){for(let t of this._extensionsArr)if(t.uuid===e)return t}getExtensionDescriptionByIdOrUUID(e,t){return this.getExtensionDescription(e)??(t?this.getExtensionDescriptionByUUID(t):void 0)}},Mj=class{constructor(e,t){this.versionId=e,this.extensions=t}},Nj;(function(e){e[e.Builtin=0]=`Builtin`,e[e.User=1]=`User`,e[e.Dev=2]=`Dev`})(Nj||={});function Pj(e,t){let n=e.isBuiltin?Nj.Builtin:e.isUnderDevelopment?Nj.Dev:Nj.User,r=t.isBuiltin?Nj.Builtin:t.isUnderDevelopment?Nj.Dev:Nj.User;if(n!==r)return n-r;let i=Lr.basename(e.extensionLocation.path),a=Lr.basename(t.extensionLocation.path);return i<a?-1:i>a?1:0}function Fj(e,t){let n=new hs(t);return e.filter(e=>!n.has(e.identifier))}var Ij=class e{static{this.NONE=new e(!1,-1,-1,-1)}constructor(e,t,n,r){this.startup=e,this.codeLoadingTime=t,this.activateCallTime=n,this.activateResolvedTime=r}},Lj=class{constructor(e){this._startup=e,this._codeLoadingStart=-1,this._codeLoadingStop=-1,this._activateCallStart=-1,this._activateCallStop=-1,this._activateResolveStart=-1,this._activateResolveStop=-1}_delta(e,t){return e===-1||t===-1?-1:t-e}build(){return new Ij(this._startup,this._delta(this._codeLoadingStart,this._codeLoadingStop),this._delta(this._activateCallStart,this._activateCallStop),this._delta(this._activateResolveStart,this._activateResolveStop))}codeLoadingStart(){this._codeLoadingStart=Date.now()}codeLoadingStop(){this._codeLoadingStop=Date.now()}activateCallStart(){this._activateCallStart=Date.now()}activateCallStop(){this._activateCallStop=Date.now()}activateResolveStart(){this._activateResolveStart=Date.now()}activateResolveStop(){this._activateResolveStop=Date.now()}},Rj=class{constructor(e,t,n,r,exports,a){this.activationFailed=e,this.activationFailedError=t,this.activationTimes=n,this.module=r,this.exports=exports,this.disposable=a}},zj=class extends Rj{constructor(e){super(!1,null,e,{activate:void 0,deactivate:void 0},void 0,y.None)}},Bj=class extends Rj{constructor(){super(!1,null,Ij.NONE,{activate:void 0,deactivate:void 0},void 0,y.None)}},Vj=class extends Rj{constructor(e){super(!0,e,Ij.NONE,{activate:void 0,deactivate:void 0},void 0,y.None)}};let Hj=class{constructor(e,t,n,r){this._logService=r,this._registry=e,this._globalRegistry=t,this._host=n,this._operations=new gs,this._alreadyActivatedEvents=Object.create(null)}dispose(){for(let[e,t]of this._operations)t.dispose()}async waitForActivatingExtensions(){let e=[];for(let[t,n]of this._operations)e.push(n.wait());await Promise.all(e)}isActivated(e){let t=this._operations.get(e);return!!(t&&t.value)}getActivatedExtension(e){let t=this._operations.get(e);if(!t||!t.value)throw Error(`Extension '${e.value}' is not known or not activated`);return t.value}async activateByEvent(e,t){if(this._alreadyActivatedEvents[e])return;let n=this._registry.getExtensionDescriptionsForActivationEvent(e);await this._activateExtensions(n.map(n=>({id:n.identifier,reason:{startup:t,extensionId:n.identifier,activationEvent:e}}))),this._alreadyActivatedEvents[e]=!0}activateById(e,t){let n=this._registry.getExtensionDescription(e);if(!n)throw Error(`Extension '${e.value}' is not known`);return this._activateExtensions([{id:n.identifier,reason:t}])}async _activateExtensions(e){let t=e.filter(e=>!this.isActivated(e.id)).map(e=>this._handleActivationRequest(e));await Promise.all(t.map(e=>e.wait()))}_handleActivationRequest(e){if(this._operations.has(e.id))return this._operations.get(e.id);if(this._isHostExtension(e.id))return this._createAndSaveOperation(e,null,[],null);let t=this._registry.getExtensionDescription(e.id);if(!t){let t=Error(`Cannot activate unknown extension '${e.id.value}'`),n=this._createAndSaveOperation(e,null,[],new Vj(t));return this._host.onExtensionActivationError(e.id,t,new Bg(e.id.value)),n}let n=[],r=t.extensionDependencies===void 0?[]:t.extensionDependencies;for(let i of r){if(this._isResolvedExtension(i))continue;let r=this._operations.get(i);if(r){n.push(r);continue}if(this._isHostExtension(i)){n.push(this._handleActivationRequest({id:this._globalRegistry.getExtensionDescription(i).identifier,reason:e.reason}));continue}let a=this._registry.getExtensionDescription(i);if(a){if(!a.main&&!a.browser)continue;n.push(this._handleActivationRequest({id:a.identifier,reason:e.reason}));continue}let o=t.displayName||t.identifier.value,s=Error(`Cannot activate the '${o}' extension because it depends on unknown extension '${i}'`),c=this._createAndSaveOperation(e,t.displayName,[],new Vj(s));return this._host.onExtensionActivationError(t.identifier,s,new Bg(i)),c}return this._createAndSaveOperation(e,t.displayName,n,null)}_createAndSaveOperation(e,t,n,r){let i=new Uj(e.id,t,e.reason,n,r,this._host,this._logService);return this._operations.set(e.id,i),i}_isHostExtension(e){return jj.isHostExtension(e,this._registry,this._globalRegistry)}_isResolvedExtension(e){let t=this._globalRegistry.getExtensionDescription(e);return t?!t.main&&!t.browser:!1}};Hj=A([j(3,xs)],Hj);let Uj=class{get value(){return this._value}get friendlyName(){return this._displayName||this._id.value}constructor(e,t,n,r,i,a,o){this._id=e,this._displayName=t,this._reason=n,this._deps=r,this._value=i,this._host=a,this._logService=o,this._barrier=new bo,this._isDisposed=!1,this._initialize()}dispose(){this._isDisposed=!0}wait(){return this._barrier.wait()}async _initialize(){await this._waitForDepsThenActivate(),this._barrier.open()}async _waitForDepsThenActivate(){if(!this._value){for(;this._deps.length>0;){for(let e=0;e<this._deps.length;e++){let t=this._deps[e];if(t.value&&!t.value.activationFailed){this._deps.splice(e,1),e--;continue}if(t.value&&t.value.activationFailed){let e=Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${t.friendlyName}' failed to activate`);e.detail=t.value.activationFailedError,this._value=new Vj(e),this._host.onExtensionActivationError(this._id,e,null);return}}this._deps.length>0&&await Promise.race(this._deps.map(e=>e.wait()))}await this._activate()}}async _activate(){try{this._value=await this._host.actualActivateExtension(this._id,this._reason)}catch(e){let t=Error();if(e&&e.name&&(t.name=e.name),e&&e.message?t.message=`Activating extension '${this._id.value}' failed: ${e.message}.`:t.message=`Activating extension '${this._id.value}' failed: ${e}.`,e&&e.stack&&(t.stack=e.stack),this._value=new Vj(t),this._isDisposed&&ae(e))return;this._host.onExtensionActivationError(this._id,t,null),this._logService.error(`Activating extension ${this._id.value} failed due to an error:`),this._logService.error(e)}}};Uj=A([j(6,xs)],Uj);var Wj=class{constructor(e,t){this._logService=t,this._onDidChangeStorage=new x,this.onDidChangeStorage=this._onDidChangeStorage.event,this._proxy=e.getProxy(E.MainThreadStorage)}registerExtensionStorageKeysToSync(e,t){this._proxy.$registerExtensionStorageKeysToSync(e,t)}async initializeExtensionStorage(e,t,n){let r=await this._proxy.$initializeExtensionStorage(e,t),i;return r&&(i=this.safeParseValue(e,t,r)),i||n}setValue(e,t,n){return this._proxy.$setValue(e,t,n)}$acceptValue(e,t,n){let r=this.safeParseValue(e,t,n);r&&this._onDidChangeStorage.fire({shared:e,key:t,value:r})}safeParseValue(e,t,n){try{return JSON.parse(n)}catch(n){this._logService.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${t}, global: ${e}): ${n}`)}}};const Gj=k(`IExtHostStorage`);var Kj=class{constructor(e,t,n){this._deferredPromises=new Map,this._id=e,this._shared=t,this._storage=n,this._init=this._storage.initializeExtensionStorage(this._shared,this._id,Object.create(null)).then(e=>(this._value=e,this)),this._storageListener=this._storage.onDidChangeStorage(e=>{e.shared===this._shared&&e.key===this._id&&(this._value=e.value)}),this._scheduler=new Do(()=>{let e=this._deferredPromises;this._deferredPromises=new Map,(async()=>{try{await this._storage.setValue(this._shared,this._id,this._value);for(let t of e.values())t.complete()}catch(t){for(let n of e.values())n.error(t)}})()},0)}keys(){return Object.entries(this._value??{}).filter(([,e])=>e!==void 0).map(([e])=>e)}get whenReady(){return this._init}get(e,t){let n=this._value[e];return n===void 0&&(n=t),n}update(e,t){typeof t==`object`&&t?this._value[e]=JSON.parse(JSON.stringify(t)):this._value[e]=t;let n=this._deferredPromises.get(e);if(n!==void 0)return n.p;let r=new No;return this._deferredPromises.set(e,r),this._scheduler.isScheduled()||this._scheduler.schedule(),r.p}dispose(){this._storageListener.dispose()}},qj=class extends Kj{setKeysForSync(e){this._storage.registerExtensionStorageKeysToSync({id:this._id,version:this._extension.version},e)}constructor(e,t){super(e.identifier.value,!0,t),this._extension=e}},Jj;let Yj=Jj=class{constructor(e,t){this._fileSystemProvider=new Map,this._writeQueue=new To,this._proxy=e.getProxy(E.MainThreadFileSystem);let n=this;this.value=Object.freeze({async stat(e){try{let t,r=n._fileSystemProvider.get(e.scheme);return r?(await n._proxy.$ensureActivation(e.scheme),t=await r.impl.stat(e)):t=await n._proxy.$stat(e),{type:t.type,ctime:t.ctime,mtime:t.mtime,size:t.size,permissions:t.permissions===oc.Readonly?1:void 0}}catch(e){Jj._handleError(e)}},async readDirectory(e){try{let t=n._fileSystemProvider.get(e.scheme);return t?(await n._proxy.$ensureActivation(e.scheme),(await t.impl.readDirectory(e)).slice()):await n._proxy.$readdir(e)}catch(e){return Jj._handleError(e)}},async createDirectory(e){try{let t=n._fileSystemProvider.get(e.scheme);return t&&!t.isReadonly?(await n._proxy.$ensureActivation(e.scheme),await n.mkdirp(t.impl,t.extUri,e)):await n._proxy.$mkdir(e)}catch(e){return Jj._handleError(e)}},async readFile(e){try{let t=n._fileSystemProvider.get(e.scheme);if(t)return await n._proxy.$ensureActivation(e.scheme),(await t.impl.readFile(e)).slice();{let t=await n._proxy.$readFile(e);return t.buffer}}catch(e){return Jj._handleError(e)}},async writeFile(e,t){try{let r=n._fileSystemProvider.get(e.scheme);return r&&!r.isReadonly?(await n._proxy.$ensureActivation(e.scheme),await n.mkdirp(r.impl,r.extUri,r.extUri.dirname(e)),await n._writeQueue.queueFor(e,()=>Promise.resolve(r.impl.writeFile(e,t,{create:!0,overwrite:!0})))):await n._proxy.$writeFile(e,b.wrap(t))}catch(e){return Jj._handleError(e)}},async delete(e,t){try{let r=n._fileSystemProvider.get(e.scheme);return r&&!r.isReadonly&&!t?.useTrash?(await n._proxy.$ensureActivation(e.scheme),await r.impl.delete(e,{recursive:!1,...t})):await n._proxy.$delete(e,{recursive:!1,useTrash:!1,atomic:!1,...t})}catch(e){return Jj._handleError(e)}},async rename(e,t,r){try{return await n._proxy.$rename(e,t,{overwrite:!1,...r})}catch(e){return Jj._handleError(e)}},async copy(e,t,r){try{return await n._proxy.$copy(e,t,{overwrite:!1,...r})}catch(e){return Jj._handleError(e)}},isWritableFileSystem(e){let n=t.getCapabilities(e);if(typeof n==`number`)return!(n&cc.Readonly)}})}async mkdirp(e,t,n){let r=[];for(;!t.isEqual(n,t.dirname(n));)try{let t=await e.stat(n);if((t.type&ac.Directory)===0)throw uC.FileExists(`Unable to create folder '${n.scheme===O.file?n.fsPath:n.toString(!0)}' that already exists but is not a directory`);break}catch(e){if(fc(e)!==lc.FileNotFound)throw e;r.push(t.basename(n)),n=t.dirname(n)}for(let i=r.length-1;i>=0;i--){n=t.joinPath(n,r[i]);try{await e.createDirectory(n)}catch(e){if(fc(e)!==lc.FileExists)throw e}}}static _handleError(e){if(e instanceof uC)throw e;if(e instanceof uc)switch(e.code){case lc.FileExists:throw uC.FileExists(e.message);case lc.FileNotFound:throw uC.FileNotFound(e.message);case lc.FileNotADirectory:throw uC.FileNotADirectory(e.message);case lc.FileIsADirectory:throw uC.FileIsADirectory(e.message);case lc.NoPermissions:throw uC.NoPermissions(e.message);case lc.Unavailable:throw uC.Unavailable(e.message);default:throw new uC(e.message,e.name)}if(!(e instanceof Error))throw new uC(String(e));if(e.name===`ENOPRO`||e.message.includes(`ENOPRO`))throw uC.Unavailable(e.message);switch(e.name){case lc.FileExists:throw uC.FileExists(e.message);case lc.FileNotFound:throw uC.FileNotFound(e.message);case lc.FileNotADirectory:throw uC.FileNotADirectory(e.message);case lc.FileIsADirectory:throw uC.FileIsADirectory(e.message);case lc.NoPermissions:throw uC.NoPermissions(e.message);case lc.Unavailable:throw uC.Unavailable(e.message);default:throw new uC(e.message,e.name)}}addFileSystemProvider(e,t,n){return this._fileSystemProvider.set(e,{impl:t,extUri:n?.isCaseSensitive?Ga:qa,isReadonly:!!n?.isReadonly}),_(()=>this._fileSystemProvider.delete(e))}getFileSystemProviderExtUri(e){return this._fileSystemProvider.get(e)?.extUri??Ga}};Yj=Jj=A([j(0,Is),j(1,Mc)],Yj);const Xj=k(`IExtHostConsumerFileSystem`),Zj=k(`IExtensionStoragePaths`);let Qj=class{constructor(e,t,n){this._logService=t,this._extHostFileSystem=n,this._workspace=e.workspace??void 0,this._environment=e.environment,this.whenReady=this._getOrCreateWorkspaceStoragePath().then(e=>this._value=e)}async _getWorkspaceStorageURI(e){return w.joinPath(this._environment.workspaceStorageHome,e)}async _getOrCreateWorkspaceStoragePath(){if(!this._workspace)return Promise.resolve(void 0);let e=this._workspace.id,t=await this._getWorkspaceStorageURI(e);try{return await this._extHostFileSystem.value.stat(t),this._logService.trace(`[ExtHostStorage] storage dir already exists`,t),t}catch{}try{return this._logService.trace(`[ExtHostStorage] creating dir and metadata-file`,t),await this._extHostFileSystem.value.createDirectory(t),await this._extHostFileSystem.value.writeFile(w.joinPath(t,`meta.json`),new TextEncoder().encode(JSON.stringify({id:this._workspace.id,configuration:w.revive(this._workspace.configuration)?.toString(),name:this._workspace.name},void 0,2))),t}catch(e){this._logService.error(`[ExtHostStorage]`,e);return}}workspaceValue(e){if(this._value)return w.joinPath(this._value,e.identifier.value)}globalValue(e){return w.joinPath(this._environment.globalStorageHome,e.identifier.value.toLowerCase())}onWillDeactivateAll(){}};Qj=A([j(0,ks),j(1,xs),j(2,Xj)],Qj);const $j=k(`configurationService`);var eM;(function(e){e.Http=`http`,e.Https=`https`})(eM||={});var tM;(function(e){e.ConstantPrivate=`constantPrivate`,e.Private=`private`,e.Public=`public`})(tM||={});var nM;(function(e){e[e.Notify=1]=`Notify`,e[e.OpenBrowser=2]=`OpenBrowser`,e[e.OpenPreview=3]=`OpenPreview`,e[e.Silent=4]=`Silent`,e[e.Ignore=5]=`Ignore`,e[e.OpenBrowserOnce=6]=`OpenBrowserOnce`})(nM||={});function rM(e){if(e.scheme!==`http`&&e.scheme!==`https`)return;let t=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(e.authority);if(t)return{address:t[1],port:+t[2]}}const iM=[`localhost`,`127.0.0.1`,`0:0:0:0:0:0:0:1`,`::1`];function aM(e){return iM.indexOf(e)>=0}const oM=[`0.0.0.0`,`0:0:0:0:0:0:0:0`,`::`];function sM(e){return oM.indexOf(e)>=0}var cM=class{constructor(e,t,n){this.remoteAddress=e,this.localAddress=t,this._dispose=n,this._onDispose=new x,this.onDidDispose=this._onDispose.event}dispose(){return this._onDispose.fire(),this._dispose()}};let lM=class extends y{constructor(e,t){super(),this.logService=e,this.configurationService=t,this._onTunnelOpened=new x,this.onTunnelOpened=this._onTunnelOpened.event,this._onTunnelClosed=new x,this.onTunnelClosed=this._onTunnelClosed.event,this._onAddedTunnelProvider=new x,this.onAddedTunnelProvider=this._onAddedTunnelProvider.event,this._tunnels=new Map,this._canElevate=!1,this._canChangeProtocol=!0,this._privacyOptions=[],this._factoryInProgress=new Set}get hasTunnelProvider(){return!!this._tunnelProvider}get defaultTunnelHost(){let e=this.configurationService.getValue(`remote.localPortHost`);return!e||e===`localhost`?`127.0.0.1`:`0.0.0.0`}setTunnelProvider(e){return this._tunnelProvider=e,e?(this._onAddedTunnelProvider.fire(),{dispose:()=>{this._tunnelProvider=void 0,this._canElevate=!1,this._privacyOptions=[]}}):(this._canElevate=!1,this._privacyOptions=[],this._onAddedTunnelProvider.fire(),{dispose:()=>{}})}setTunnelFeatures(e){this._canElevate=e.elevation,this._privacyOptions=e.privacyOptions,this._canChangeProtocol=e.protocol}get canChangeProtocol(){return this._canChangeProtocol}get canElevate(){return this._canElevate}get canChangePrivacy(){return this._privacyOptions.length>0}get privacyOptions(){return this._privacyOptions}get tunnels(){return this.getTunnels()}async getTunnels(){let e=[],t=Array.from(this._tunnels.values());for(let n of t){let t=Array.from(n.values());for(let n of t){let t=await n.value;t&&typeof t!=`string`&&e.push(t)}}return e}async dispose(){super.dispose();for(let e of this._tunnels.values()){for(let{value:t}of e.values())await t.then(e=>typeof e==`string`?void 0:e?.dispose());e.clear()}this._tunnels.clear()}setEnvironmentTunnel(e,t,n,r,i){this.addTunnelToMap(e,t,Promise.resolve({tunnelRemoteHost:e,tunnelRemotePort:t,localAddress:n,privacy:r,protocol:i,dispose:()=>Promise.resolve()}))}async getExistingTunnel(e,t){(sM(e)||aM(e))&&(e=iM[0]);let n=this.getTunnelFromMap(e,t);if(n)return++n.refcount,n.value}openTunnel(e,t,n,r,i,a=!1,o,s){this.logService.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${t}:${n} on local port ${i}.`);let c=this._tunnelProvider??e;if(!c)return;if(t||=`localhost`,r||=this.defaultTunnelHost,this._tunnelProvider&&this._factoryInProgress.has(n)){this.logService.debug(`ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.`);return}let l=this.retainOrCreateTunnel(c,t,n,r,i,a,o,s);return l?l.then(e=>{if(e){if(typeof e==`string`)return this.logService.trace(`ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel.`),this.removeEmptyOrErrorTunnelFromMap(t,n),e}else{this.logService.trace(`ForwardedPorts: (TunnelService) New tunnel is undefined.`),this.removeEmptyOrErrorTunnelFromMap(t,n);return}this.logService.trace(`ForwardedPorts: (TunnelService) New tunnel established.`);let r=this.makeTunnel(e);return(e.tunnelRemoteHost!==t||e.tunnelRemotePort!==n)&&this.logService.warn(`ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch.`),o&&e.privacy!==o&&this.logService.warn(`ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch.`),this._onTunnelOpened.fire(r),r}):(this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel was not created.`),l)}makeTunnel(e){return{tunnelRemotePort:e.tunnelRemotePort,tunnelRemoteHost:e.tunnelRemoteHost,tunnelLocalPort:e.tunnelLocalPort,localAddress:e.localAddress,privacy:e.privacy,protocol:e.protocol,dispose:async()=>{this.logService.trace(`ForwardedPorts: (TunnelService) dispose request for ${e.tunnelRemoteHost}:${e.tunnelRemotePort} `);let t=this._tunnels.get(e.tunnelRemoteHost);if(t){let n=t.get(e.tunnelRemotePort);n&&(n.refcount--,await this.tryDisposeTunnel(e.tunnelRemoteHost,e.tunnelRemotePort,n))}}}}async tryDisposeTunnel(e,t,n){if(n.refcount<=0){this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${e}:${t}.`);let r=n.value.then(async e=>{e&&typeof e!=`string`&&(await e.dispose(!0),this._onTunnelClosed.fire({host:e.tunnelRemoteHost,port:e.tunnelRemotePort}))});return this._tunnels.has(e)&&this._tunnels.get(e).delete(t),r}}async closeTunnel(e,t){this.logService.trace(`ForwardedPorts: (TunnelService) close request for ${e}:${t} `);let n=this._tunnels.get(e);if(n&&n.has(t)){let r=n.get(t);r.refcount=0,await this.tryDisposeTunnel(e,t,r)}}addTunnelToMap(e,t,n){this._tunnels.has(e)||this._tunnels.set(e,new Map),this._tunnels.get(e).set(t,{refcount:1,value:n})}async removeEmptyOrErrorTunnelFromMap(e,t){let n=this._tunnels.get(e);if(n){let r=n.get(t),i=r?await r.value:void 0;(!i||typeof i==`string`)&&n.delete(t),n.size===0&&this._tunnels.delete(e)}}getTunnelFromMap(e,t){let n=[e];aM(e)?(n.push(...iM),n.push(...oM)):sM(e)&&n.push(...oM);let r=n.map(e=>this._tunnels.get(e));for(let e of r){let n=e?.get(t);if(n)return n}}canTunnel(e){return!!rM(e)}createWithProvider(e,t,n,r,i,a,o){this.logService.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${t}:${n} on local port ${r}.`);let s=n;this._factoryInProgress.add(s);let c=r===void 0?n:r,l={elevationRequired:i?this.isPortPrivileged(c):!1},u={remoteAddress:{host:t,port:n},localAddressPort:r,privacy:a,public:a?a!==tM.Private:void 0,protocol:o},d=e.forwardPort(u,l);return d?(this.addTunnelToMap(t,n,d),d.finally(()=>{this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel created by provider.`),this._factoryInProgress.delete(s)})):this._factoryInProgress.delete(s),d}};lM=A([j(0,xs),j(1,$j)],lM);var uM=class extends cM{},dM;(function(e){function t(e){return{remoteAddress:e.remoteAddress,localAddress:e.localAddress,public:!!e.public,privacy:e.privacy??(e.public?tM.Public:tM.Private),protocol:e.protocol}}e.fromApiTunnel=t;function n(e){return{remoteAddress:{host:e.tunnelRemoteHost,port:e.tunnelRemotePort},localAddress:e.localAddress,public:e.privacy!==tM.ConstantPrivate&&e.privacy!==tM.ConstantPrivate,privacy:e.privacy,protocol:e.protocol}}e.fromServiceTunnel=n})(dM||={});const fM=k(`IExtHostTunnelService`);let pM=class extends y{constructor(e,t,n){super(),this.logService=n,this._showCandidatePort=()=>Promise.resolve(!0),this._extensionTunnels=new Map,this._onDidChangeTunnels=new x,this.onDidChangeTunnels=this._onDidChangeTunnels.event,this._providerHandleCounter=0,this._portAttributesProviders=new Map,this._proxy=e.getProxy(E.MainThreadTunnelService)}async openTunnel(e,t){this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) ${e.identifier.value} called openTunnel API for ${t.remoteAddress.host}:${t.remoteAddress.port}.`);let n=await this._proxy.$openTunnel(t,e.displayName);if(n){let e=new uM(n.remoteAddress,n.localAddress,()=>this._proxy.$closeTunnel(n.remoteAddress));return this._register(e),e}}async getTunnels(){return this._proxy.$getTunnels()}nextPortAttributesProviderHandle(){return this._providerHandleCounter++}registerPortsAttributesProvider(e,t){e.portRange===void 0&&e.commandPattern===void 0&&this.logService.error(`PortAttributesProvider must specify either a portRange or a commandPattern`);let n=this.nextPortAttributesProviderHandle();return this._portAttributesProviders.set(n,{selector:e,provider:t}),this._proxy.$registerPortsAttributesProvider(e,n),new Pb(()=>{this._portAttributesProviders.delete(n),this._proxy.$unregisterPortsAttributesProvider(n)})}async $providePortAttributes(e,t,n,r,i){let a=[];for(let o of e){let e=this._portAttributesProviders.get(o);if(!e)return[];a.push(...await Promise.all(t.map(async t=>{let a;try{a=await e.provider.providePortAttributes({port:t,pid:n,commandLine:r},i)}catch{a=await e.provider.providePortAttributes(t,n,r,i)}return{providedAttributes:a,port:t}})))}let o=a.filter(e=>!!e.providedAttributes);return o.length>0?o.map(e=>({autoForwardAction:e.providedAttributes.autoForwardAction,port:e.port})):[]}async $registerCandidateFinder(e){}registerTunnelProvider(e,t){if(this._forwardPortProvider)throw Error(`A tunnel provider has already been registered. Only the first tunnel provider to be registered will be used.`);this._forwardPortProvider=async(t,n)=>{let r=await e.provideTunnel(t,n,Oi.None);return r??void 0};let n=t.tunnelFeatures?{elevation:!!t.tunnelFeatures?.elevation,privacyOptions:t.tunnelFeatures?.privacyOptions,protocol:t.tunnelFeatures.protocol===void 0?!0:t.tunnelFeatures.protocol}:void 0;return this._proxy.$setTunnelProvider(n,!0),Promise.resolve(_(()=>{this._forwardPortProvider=void 0,this._proxy.$setTunnelProvider(void 0,!1)}))}async setTunnelFactory(e,t){if(e){e.candidatePortSource!==void 0&&this._proxy.$setCandidatePortSource(e.candidatePortSource),e.showCandidatePort&&(this._showCandidatePort=e.showCandidatePort,this._proxy.$setCandidateFilter());let n=e.tunnelFactory??(t?this.makeManagedTunnelFactory(t):void 0);if(n){this._forwardPortProvider=n;let t=e.tunnelFeatures?.privacyOptions??[];e.tunnelFeatures?.public&&t.length===0&&(t=[{id:`private`,label:C(2638,`Private`),themeIcon:`lock`},{id:`public`,label:C(2639,`Public`),themeIcon:`eye`}]);let r=e.tunnelFeatures?{elevation:!!e.tunnelFeatures?.elevation,public:!!e.tunnelFeatures?.public,privacyOptions:t,protocol:!0}:void 0;this._proxy.$setTunnelProvider(r,!!e.tunnelFactory)}}else this._forwardPortProvider=void 0;return _(()=>{this._forwardPortProvider=void 0})}makeManagedTunnelFactory(e){}async $closeTunnel(e,t){if(this._extensionTunnels.has(e.host)){let n=this._extensionTunnels.get(e.host);n.has(e.port)&&(t&&n.get(e.port).disposeListener.dispose(),await n.get(e.port).tunnel.dispose(),n.delete(e.port))}}async $onDidTunnelsChange(){this._onDidChangeTunnels.fire()}async $forwardPort(e,t){if(this._forwardPortProvider)try{this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) Getting tunnel from provider.`);let n=this._forwardPortProvider(e,t);if(this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) Got tunnel promise from provider.`),n!==void 0){let t=await n;if(this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) Successfully awaited tunnel from provider.`),t===void 0){this.logService.error(`ForwardedPorts: (ExtHostTunnelService) Resolved tunnel is undefined`);return}this._extensionTunnels.has(e.remoteAddress.host)||this._extensionTunnels.set(e.remoteAddress.host,new Map);let r=this._register(t.onDidDispose(()=>(this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) Extension fired tunnel's onDidDispose.`),this._proxy.$closeTunnel(t.remoteAddress))));return this._extensionTunnels.get(e.remoteAddress.host).set(e.remoteAddress.port,{tunnel:t,disposeListener:r}),dM.fromApiTunnel(t)}else this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) Tunnel is undefined`)}catch(e){if(this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) tunnel provider error`),e instanceof Error)return e.message}}async $applyCandidateFilter(e){let t=await Promise.all(e.map(e=>this._showCandidatePort(e.host,e.port,e.detail??``))),n=e.filter((e,n)=>t[n]);return this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) filtered from ${e.map(e=>e.port).join(`, `)} to ${n.map(e=>e.port).join(`, `)}`),n}};pM=A([j(0,Is),j(1,ks),j(2,xs)],pM);function mM(e){return[...e.entries()]}function hM(e){return e?[...e.entries()]:[]}var gM;(function(e){e.AutomationProfile=`terminal.integrated.automationProfile.`,e.DefaultProfile=`terminal.integrated.defaultProfile.`,e.Profiles=`terminal.integrated.profiles.`})(gM||={});var _M;(function(e){e.SendKeybindingsToShell=`terminal.integrated.sendKeybindingsToShell`,e.AutomationProfileLinux=`terminal.integrated.automationProfile.linux`,e.AutomationProfileMacOs=`terminal.integrated.automationProfile.osx`,e.AutomationProfileWindows=`terminal.integrated.automationProfile.windows`,e.ProfilesWindows=`terminal.integrated.profiles.windows`,e.ProfilesMacOs=`terminal.integrated.profiles.osx`,e.ProfilesLinux=`terminal.integrated.profiles.linux`,e.DefaultProfileLinux=`terminal.integrated.defaultProfile.linux`,e.DefaultProfileMacOs=`terminal.integrated.defaultProfile.osx`,e.DefaultProfileWindows=`terminal.integrated.defaultProfile.windows`,e.UseWslProfiles=`terminal.integrated.useWslProfiles`,e.TabsDefaultColor=`terminal.integrated.tabs.defaultColor`,e.TabsDefaultIcon=`terminal.integrated.tabs.defaultIcon`,e.TabsEnabled=`terminal.integrated.tabs.enabled`,e.TabsEnableAnimation=`terminal.integrated.tabs.enableAnimation`,e.TabsHideCondition=`terminal.integrated.tabs.hideCondition`,e.TabsShowActiveTerminal=`terminal.integrated.tabs.showActiveTerminal`,e.TabsShowActions=`terminal.integrated.tabs.showActions`,e.TabsLocation=`terminal.integrated.tabs.location`,e.TabsFocusMode=`terminal.integrated.tabs.focusMode`,e.MacOptionIsMeta=`terminal.integrated.macOptionIsMeta`,e.MacOptionClickForcesSelection=`terminal.integrated.macOptionClickForcesSelection`,e.AltClickMovesCursor=`terminal.integrated.altClickMovesCursor`,e.CopyOnSelection=`terminal.integrated.copyOnSelection`,e.EnableMultiLinePasteWarning=`terminal.integrated.enableMultiLinePasteWarning`,e.DrawBoldTextInBrightColors=`terminal.integrated.drawBoldTextInBrightColors`,e.FontFamily=`terminal.integrated.fontFamily`,e.FontSize=`terminal.integrated.fontSize`,e.LetterSpacing=`terminal.integrated.letterSpacing`,e.LineHeight=`terminal.integrated.lineHeight`,e.MinimumContrastRatio=`terminal.integrated.minimumContrastRatio`,e.TabStopWidth=`terminal.integrated.tabStopWidth`,e.FastScrollSensitivity=`terminal.integrated.fastScrollSensitivity`,e.MouseWheelScrollSensitivity=`terminal.integrated.mouseWheelScrollSensitivity`,e.BellDuration=`terminal.integrated.bellDuration`,e.FontWeight=`terminal.integrated.fontWeight`,e.FontWeightBold=`terminal.integrated.fontWeightBold`,e.CursorBlinking=`terminal.integrated.cursorBlinking`,e.CursorStyle=`terminal.integrated.cursorStyle`,e.CursorStyleInactive=`terminal.integrated.cursorStyleInactive`,e.CursorWidth=`terminal.integrated.cursorWidth`,e.Scrollback=`terminal.integrated.scrollback`,e.DetectLocale=`terminal.integrated.detectLocale`,e.DefaultLocation=`terminal.integrated.defaultLocation`,e.GpuAcceleration=`terminal.integrated.gpuAcceleration`,e.TerminalTitleSeparator=`terminal.integrated.tabs.separator`,e.TerminalTitle=`terminal.integrated.tabs.title`,e.TerminalDescription=`terminal.integrated.tabs.description`,e.RightClickBehavior=`terminal.integrated.rightClickBehavior`,e.MiddleClickBehavior=`terminal.integrated.middleClickBehavior`,e.Cwd=`terminal.integrated.cwd`,e.ConfirmOnExit=`terminal.integrated.confirmOnExit`,e.ConfirmOnKill=`terminal.integrated.confirmOnKill`,e.EnableBell=`terminal.integrated.enableBell`,e.EnableVisualBell=`terminal.integrated.enableVisualBell`,e.CommandsToSkipShell=`terminal.integrated.commandsToSkipShell`,e.AllowChords=`terminal.integrated.allowChords`,e.AllowMnemonics=`terminal.integrated.allowMnemonics`,e.TabFocusMode=`terminal.integrated.tabFocusMode`,e.EnvMacOs=`terminal.integrated.env.osx`,e.EnvLinux=`terminal.integrated.env.linux`,e.EnvWindows=`terminal.integrated.env.windows`,e.EnvironmentChangesIndicator=`terminal.integrated.environmentChangesIndicator`,e.EnvironmentChangesRelaunch=`terminal.integrated.environmentChangesRelaunch`,e.ShowExitAlert=`terminal.integrated.showExitAlert`,e.SplitCwd=`terminal.integrated.splitCwd`,e.WindowsEnableConpty=`terminal.integrated.windowsEnableConpty`,e.WindowsUseConptyDll=`terminal.integrated.windowsUseConptyDll`,e.WordSeparators=`terminal.integrated.wordSeparators`,e.EnableFileLinks=`terminal.integrated.enableFileLinks`,e.AllowedLinkSchemes=`terminal.integrated.allowedLinkSchemes`,e.UnicodeVersion=`terminal.integrated.unicodeVersion`,e.EnablePersistentSessions=`terminal.integrated.enablePersistentSessions`,e.PersistentSessionReviveProcess=`terminal.integrated.persistentSessionReviveProcess`,e.HideOnStartup=`terminal.integrated.hideOnStartup`,e.HideOnLastClosed=`terminal.integrated.hideOnLastClosed`,e.CustomGlyphs=`terminal.integrated.customGlyphs`,e.RescaleOverlappingGlyphs=`terminal.integrated.rescaleOverlappingGlyphs`,e.PersistentSessionScrollback=`terminal.integrated.persistentSessionScrollback`,e.InheritEnv=`terminal.integrated.inheritEnv`,e.ShowLinkHover=`terminal.integrated.showLinkHover`,e.IgnoreProcessNames=`terminal.integrated.ignoreProcessNames`,e.ShellIntegrationEnabled=`terminal.integrated.shellIntegration.enabled`,e.ShellIntegrationShowWelcome=`terminal.integrated.shellIntegration.showWelcome`,e.ShellIntegrationDecorationsEnabled=`terminal.integrated.shellIntegration.decorationsEnabled`,e.ShellIntegrationEnvironmentReporting=`terminal.integrated.shellIntegration.environmentReporting`,e.EnableImages=`terminal.integrated.enableImages`,e.SmoothScrolling=`terminal.integrated.smoothScrolling`,e.IgnoreBracketedPasteMode=`terminal.integrated.ignoreBracketedPasteMode`,e.FocusAfterRun=`terminal.integrated.focusAfterRun`,e.FontLigaturesEnabled=`terminal.integrated.fontLigatures.enabled`,e.FontLigaturesFeatureSettings=`terminal.integrated.fontLigatures.featureSettings`,e.FontLigaturesFallbackLigatures=`terminal.integrated.fontLigatures.fallbackLigatures`,e.DeveloperPtyHostLatency=`terminal.integrated.developer.ptyHost.latency`,e.DeveloperPtyHostStartupDelay=`terminal.integrated.developer.ptyHost.startupDelay`,e.DevMode=`terminal.integrated.developer.devMode`})(_M||={});var vM;(function(e){e.Bash=`bash`,e.Fish=`fish`,e.Sh=`sh`,e.Csh=`csh`,e.Ksh=`ksh`,e.Zsh=`zsh`})(vM||={});var yM;(function(e){e.CommandPrompt=`cmd`,e.Wsl=`wsl`,e.GitBash=`gitbash`})(yM||={});var bM;(function(e){e.PowerShell=`pwsh`,e.Python=`python`,e.Julia=`julia`,e.NuShell=`nu`,e.Node=`node`})(bM||={});var xM;(function(e){e[e.Api=0]=`Api`,e[e.Process=1]=`Process`,e[e.Sequence=2]=`Sequence`,e[e.Config=3]=`Config`})(xM||={});var SM;(function(e){e.LocalPty=`localPty`,e.PtyHost=`ptyHost`,e.PtyHostWindow=`ptyHostWindow`,e.Logger=`logger`,e.Heartbeat=`heartbeat`})(SM||={});var CM;(function(e){e.Cwd=`cwd`,e.InitialCwd=`initialCwd`,e.FixedDimensions=`fixedDimensions`,e.Title=`title`,e.ShellType=`shellType`,e.HasChildProcesses=`hasChildProcesses`,e.ResolvedShellLaunchConfig=`resolvedShellLaunchConfig`,e.OverrideDimensions=`overrideDimensions`,e.FailedShellIntegrationActivation=`failedShellIntegrationActivation`,e.UsedShellIntegrationInjection=`usedShellIntegrationInjection`,e.ShellIntegrationInjectionFailureReason=`shellIntegrationInjectionFailureReason`})(CM||={});var wM;(function(e){e[e.BeatInterval=5e3]=`BeatInterval`,e[e.ConnectingBeatInterval=2e4]=`ConnectingBeatInterval`,e[e.FirstWaitMultiplier=1.2]=`FirstWaitMultiplier`,e[e.SecondWaitMultiplier=1]=`SecondWaitMultiplier`,e[e.CreateProcessTimeout=5e3]=`CreateProcessTimeout`})(wM||={});var TM;(function(e){e[e.Panel=1]=`Panel`,e[e.Editor=2]=`Editor`})(TM||={});var EM;(function(e){e.TerminalView=`view`,e.Editor=`editor`})(EM||={});var DM;(function(e){e[e.GraceTime=6e4]=`GraceTime`,e[e.ShortGraceTime=6e3]=`ShortGraceTime`})(DM||={});var OM;(function(e){e[e.HighWatermarkChars=1e5]=`HighWatermarkChars`,e[e.LowWatermarkChars=5e3]=`LowWatermarkChars`,e[e.CharCountAckSize=5e3]=`CharCountAckSize`})(OM||={});var kM;(function(e){e.GitBash=`Git Bash`,e.Pwsh=`PowerShell`})(kM||={});var AM;(function(e){e[e.Off=0]=`Off`,e[e.FinalTerm=1]=`FinalTerm`,e[e.VSCode=2]=`VSCode`})(AM||={});var jM;(function(e){e.InjectionSettingDisabled=`injectionSettingDisabled`,e.NoExecutable=`noExecutable`,e.FeatureTerminal=`featureTerminal`,e.IgnoreShellIntegrationFlag=`ignoreShellIntegrationFlag`,e.Winpty=`winpty`,e.UnsupportedArgs=`unsupportedArgs`,e.UnsupportedShell=`unsupportedShell`,e.FailedToSetStickyBit=`failedToSetStickyBit`,e.FailedToCreateTmpDir=`failedToCreateTmpDir`})(jM||={});var MM;(function(e){e[e.Unknown=0]=`Unknown`,e[e.Shutdown=1]=`Shutdown`,e[e.Process=2]=`Process`,e[e.User=3]=`User`,e[e.Extension=4]=`Extension`})(MM||={});const NM={Backend:`workbench.contributions.terminal.processBackend`};function PM(e){return e?.toLowerCase()??``}var FM=class{constructor(e){this.remoteAuthority=e}affects(e){return PM(e)===this.remoteAuthority}},IM=class{constructor(){this._backends=new Map,this._onDidChangeBackends=new x,this.onDidChangeBackends=this._onDidChangeBackends.event}get backends(){return this._backends}registerTerminalBackend(e){let t=PM(e.remoteAuthority);if(this._backends.has(t))throw Error(`A terminal backend with remote authority '${t}' was already registered.`);this._backends.set(t,e),this._onDidChangeBackends.fire(new FM(t))}getTerminalBackend(e){return this._backends.get(PM(e))}};Sm.add(NM.Backend,new IM);var LM=class{constructor(e){this._callback=e,this._terminalBufferMap=new Map}dispose(){for(let e of this._terminalBufferMap.values())e.dispose()}startBuffering(e,t,n=5){let r=t(t=>{let i=typeof t==`string`?t:t.data,a=this._terminalBufferMap.get(e);if(a){a.data.push(i);return}let o=setTimeout(()=>this.flushBuffer(e),n);a={data:[i],timeoutId:o,dispose:()=>{clearTimeout(o),this.flushBuffer(e),r.dispose()}},this._terminalBufferMap.set(e,a)});return r}stopBuffering(e){let t=this._terminalBufferMap.get(e);t?.dispose()}flushBuffer(e){let t=this._terminalBufferMap.get(e);t&&(this._terminalBufferMap.delete(e),this._callback(e,t.data.join(``)))}};const RM=(e,t,n,r)=>{let i=t;return{enumerable:!0,configurable:!1,get(){return i},set(t){if(!n(i,t)){let n=i;i=t,e.listener?.(r(t,n))}}}},zM=(e,t)=>e===t,BM={range:(e,t)=>e===t?!0:!e||!t?!1:e.isEqual(t),label:zM,description:zM,sortText:zM,busy:zM,error:zM,canResolveChildren:zM,tags:(e,t)=>!(e.length!==t.length||e.some(e=>!t.find(t=>e.id===t.id)))},VM=e=>t=>({op:Zy.SetProp,update:e(t)}),HM=(e,t)=>({range:(()=>{let t,n=VM(e=>({range:vp.lift(K.from(e))}));return{enumerable:!0,configurable:!1,get(){return t},set(r){e.listener?.({op:Zy.DocumentSynced}),BM.range(t,r)||(t=r,e.listener?.(n(r)))}}})(),label:RM(e,t,BM.label,VM(e=>({label:e}))),description:RM(e,void 0,BM.description,VM(e=>({description:e}))),sortText:RM(e,void 0,BM.sortText,VM(e=>({sortText:e}))),canResolveChildren:RM(e,!1,BM.canResolveChildren,e=>({op:Zy.UpdateCanResolveChildren,state:e})),busy:RM(e,!1,BM.busy,VM(e=>({busy:e}))),error:RM(e,void 0,BM.error,VM(e=>({error:jD.fromStrict(e)||null}))),tags:RM(e,[],BM.tags,(e,t)=>({op:Zy.SetTags,new:e.map(zO.from),old:t.map(zO.from)}))}),UM=e=>{let t=dy.fromString(e.extId),n=new GM(t.controllerId,t.localId,e.label,w.revive(e.uri)||void 0);return n.range=K.to(e.range||void 0),n.description=e.description||void 0,n.sortText=e.sortText||void 0,n.tags=e.tags.map(e=>zO.to({id:Ty(e).tagId})),n},WM=e=>{let t;for(let n of e.tests){let e=UM(n.item);lb(e).parent=t,t=e}return t};var GM=class e{constructor(t,n,r,i){if(n.includes(ly.Delimiter))throw Error(`Test IDs may not include the ${JSON.stringify(n)} symbol`);let a=cb(this,t);Object.defineProperties(this,{id:{value:n,enumerable:!0,writable:!1},uri:{value:i,enumerable:!0,writable:!1},parent:{enumerable:!1,get(){return a.parent instanceof KM?void 0:a.parent}},children:{value:ob(a,lb,e),enumerable:!0,writable:!1},...HM(a,r)})}},KM=class extends GM{constructor(e,t){super(e,e,t,void 0),this._isRoot=!0}},qM=class extends nb{constructor(e,t,n){super({controllerId:e,getDocumentVersion:e=>e&&n.getDocument(e)?.version,getApiFor:lb,getChildren:e=>e.children,root:new KM(e,t),toITestItem:HO.from})}};let JM=class extends y{constructor(e,t,n){super(),this.initData=t,this._onDidChangeTelemetryEnabled=this._register(new x),this.onDidChangeTelemetryEnabled=this._onDidChangeTelemetryEnabled.event,this._onDidChangeTelemetryConfiguration=this._register(new x),this.onDidChangeTelemetryConfiguration=this._onDidChangeTelemetryConfiguration.event,this._productConfig={usage:!0,error:!0},this._level=Eg.NONE,this._inLoggingOnlyMode=!1,this._telemetryLoggers=new Map,this._inLoggingOnlyMode=this.initData.environment.isExtensionTelemetryLoggingOnly;let r=t.remote.isRemote?`remoteExtHostTelemetry`:e?`workerExtHostTelemetry`:`extHostTelemetry`;this._outputLogger=this._register(n.createLogger(r,{name:C(2635,`Extension Telemetry{0}`,this._inLoggingOnlyMode?` (Not Sent)`:``),hidden:!0,group:Ag}))}getTelemetryConfiguration(){return this._level===Eg.USAGE}getTelemetryDetails(){return{isCrashEnabled:this._level>=Eg.CRASH,isErrorsEnabled:this._productConfig.error?this._level>=Eg.ERROR:!1,isUsageEnabled:this._productConfig.usage?this._level>=Eg.USAGE:!1}}instantiateLogger(e,t,n){let r=this.getTelemetryDetails(),i=new YM(t,n,e,this._outputLogger,this._inLoggingOnlyMode,this.getBuiltInCommonProperties(e),{isUsageEnabled:r.isUsageEnabled,isErrorsEnabled:r.isErrorsEnabled}),a=this._telemetryLoggers.get(e.identifier.value)??[];return this._telemetryLoggers.set(e.identifier.value,[...a,i]),i.apiTelemetryLogger}$initializeTelemetryLevel(e,t,n){this._level=e,this._productConfig=n??{usage:!0,error:!0}}getBuiltInCommonProperties(e){let t=Object.create(null);switch(t[`common.extname`]=`${e.publisher}.${e.name}`,t[`common.extversion`]=e.version,t[`common.vscodemachineid`]=this.initData.telemetryInfo.machineId,t[`common.vscodesessionid`]=this.initData.telemetryInfo.sessionId,t[`common.vscodecommithash`]=this.initData.commit,t[`common.sqmid`]=this.initData.telemetryInfo.sqmId,t[`common.devDeviceId`]=this.initData.telemetryInfo.devDeviceId,t[`common.vscodeversion`]=this.initData.version,t[`common.vscodereleasedate`]=this.initData.date,t[`common.isnewappinstall`]=XM(this.initData.telemetryInfo.firstSessionDate),t[`common.product`]=this.initData.environment.appHost,this.initData.uiKind){case hn.Web:t[`common.uikind`]=`web`;break;case hn.Desktop:t[`common.uikind`]=`desktop`;break;default:t[`common.uikind`]=`unknown`}return t[`common.remotename`]=us(Mg(this.initData.remote.authority)),t}$onDidChangeTelemetryLevel(e){this._oldTelemetryEnablement=this.getTelemetryConfiguration(),this._level=e;let t=this.getTelemetryDetails();this._telemetryLoggers.forEach((e,t)=>{let n=e.filter(e=>!e.isDisposed);n.length===0?this._telemetryLoggers.delete(t):this._telemetryLoggers.set(t,n)}),this._telemetryLoggers.forEach(e=>{for(let n of e)n.updateTelemetryEnablements(t.isUsageEnabled,t.isErrorsEnabled)}),this._oldTelemetryEnablement!==this.getTelemetryConfiguration()&&this._onDidChangeTelemetryEnabled.fire(this.getTelemetryConfiguration()),this._onDidChangeTelemetryConfiguration.fire(this.getTelemetryDetails())}onExtensionError(e,t){let n=this._telemetryLoggers.get(e.value),r=n?.filter(e=>!e.isDisposed);if(!r)return this._telemetryLoggers.delete(e.value),!1;let i=!1;for(let e of r){if(e.ignoreUnhandledExtHostErrors)continue;e.logError(t),i=!0}return i}};JM=A([j(1,ks),j(2,Ss)],JM);var YM=class{static validateSender(e){if(typeof e!=`object`)throw TypeError(`TelemetrySender argument is invalid`);if(typeof e.sendEventData!=`function`)throw TypeError(`TelemetrySender.sendEventData must be a function`);if(typeof e.sendErrorData!=`function`)throw TypeError(`TelemetrySender.sendErrorData must be a function`);if(e.flush!==void 0&&typeof e.flush!=`function`)throw TypeError(`TelemetrySender.flush must be a function or undefined`)}constructor(e,t,n,r,i,a,o){this._extension=n,this._logger=r,this._inLoggingOnlyMode=i,this._commonProperties=a,this._onDidChangeEnableStates=new x,this.ignoreUnhandledExtHostErrors=t?.ignoreUnhandledErrors??!1,this._ignoreBuiltinCommonProperties=t?.ignoreBuiltInCommonProperties??!1,this._additionalCommonProperties=t?.additionalCommonProperties,this._sender=e,this._telemetryEnablements={isUsageEnabled:o.isUsageEnabled,isErrorsEnabled:o.isErrorsEnabled}}updateTelemetryEnablements(e,t){this._apiObject&&(this._telemetryEnablements={isUsageEnabled:e,isErrorsEnabled:t},this._onDidChangeEnableStates.fire(this._apiObject))}mixInCommonPropsAndCleanData(e){let t=`properties`in e?e.properties??{}:e;return t=Fg(t,[]),this._additionalCommonProperties&&(t=ec(t,this._additionalCommonProperties)),this._ignoreBuiltinCommonProperties||(t=ec(t,this._commonProperties)),`properties`in e?e.properties=t:e=t,e}logEvent(e,t){this._sender&&(e=this._extension.publisher===`vscode`?this._extension.name+`/`+e:this._extension.identifier.value+`/`+e,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||this._sender?.sendEventData(e,t),this._logger.trace(e,t))}logUsage(e,t){this._telemetryEnablements.isUsageEnabled&&this.logEvent(e,t)}logError(e,t){if(!(!this._telemetryEnablements.isErrorsEnabled||!this._sender))if(typeof e==`string`)this.logEvent(e,t);else{let n={name:e.name,message:e.message,stack:e.stack,cause:e.cause},r=Fg(n,[]),i=Error(r.message,{cause:r.cause});i.stack=r.stack,i.name=r.name,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||this._sender.sendErrorData(i,t),this._logger.trace(`exception`,t)}}get apiTelemetryLogger(){if(!this._apiObject){let e=this,t={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e._telemetryEnablements.isUsageEnabled},get isErrorsEnabled(){return e._telemetryEnablements.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e._onDidChangeEnableStates.event.bind(e)};this._apiObject=Object.freeze(t)}return this._apiObject}get isDisposed(){return!this._sender}dispose(){if(this._sender?.flush){let e=this._sender;this._sender=void 0,Promise.resolve(e.flush()).then(e=void 0),this._apiObject=void 0}else this._sender=void 0}};function XM(e){let t=Date.now()-new Date(e).getTime();return isNaN(t)?!1:t<1e3*60*60*24}const ZM=k(`IExtHostTelemetry`);let QM=class{#proxy;#telemetry;#extHostTelemetry;constructor(e,t,n){this._commands=new Map,this._apiCommands=new Map,this.#proxy=e.getProxy(E.MainThreadCommands),this._logService=t,this.#extHostTelemetry=n,this.#telemetry=e.getProxy(E.MainThreadTelemetry),this.converter=new eN(this,e=>{let t=this._apiCommands.get(e);return t?.result===tN.Void?t:void 0},t),this._argumentProcessors=[{processArgument(e){return Gu(e)}},{processArgument(e){return Qs(e,function(e){if(vp.isIRange(e))return K.to(e);if(_p.isIPosition(e))return SD.to(e);if(vp.isIRange(e.range)&&w.isUri(e.uri))return qD.to(e);if(e instanceof b)return e.buffer.buffer;if(!Array.isArray(e))return e})}}]}registerArgumentProcessor(e){this._argumentProcessors.push(e)}registerApiCommand(e){let t=this.registerCommand(!1,e.id,async(...t)=>{let n=e.args.map((n,r)=>{if(!n.validate(t[r]))throw Error(`Invalid argument '${n.name}' when running '${e.id}', received: ${typeof t[r]==`object`?JSON.stringify(t[r],null,`	`):t[r]} `);return n.convert(t[r])}),r=await this.executeCommand(e.internalId,...n);return e.result.convert(r,t,this.converter)},void 0,{description:e.description,args:e.args,returns:e.result.description});return this._apiCommands.set(e.id,e),new Pb(()=>{t.dispose(),this._apiCommands.delete(e.id)})}registerCommand(e,t,n,r,i,a){if(this._logService.trace(`ExtHostCommands#registerCommand`,t),!t.trim().length)throw Error(`invalid id`);if(this._commands.has(t))throw Error(`command '${t}' already exists`);return this._commands.set(t,{callback:n,thisArg:r,metadata:i,extension:a}),e&&this.#proxy.$registerCommand(t),new Pb(()=>{this._commands.delete(t)&&e&&this.#proxy.$unregisterCommand(t)})}executeCommand(e,...t){return this._logService.trace(`ExtHostCommands#executeCommand`,e),this._doExecuteCommand(e,t,!0)}async _doExecuteCommand(e,t,n){if(this._commands.has(e))return this.#proxy.$fireCommandActivationEvent(e),this._executeContributedCommand(e,t,!1);{let r=!1,i=Qs(t,function(e){if(e instanceof Fb)return SD.from(e);if(e instanceof Ib)return K.from(e);if(e instanceof ex)return qD.from(e);if(FC.isNotebookRange(e))return EO.from(e);if(e instanceof ArrayBuffer)return r=!0,b.wrap(new Uint8Array(e));if(e instanceof Uint8Array)return r=!0,b.wrap(e);if(e instanceof b)return r=!0,e;if(!Array.isArray(e))return e});try{let t=await this.#proxy.$executeCommand(e,r?new hi(i):i,n);return Gu(t)}catch(n){if(n instanceof Error&&n.message===`$executeCommand:retry`)return this._doExecuteCommand(e,t,!1);throw n}}}async _executeContributedCommand(e,t,n){let r=this._commands.get(e);if(!r)throw Error(`Unknown command`);let{callback:i,thisArg:a,metadata:o}=r;if(o?.args)for(let n=0;n<o.args.length;n++)try{ft(t[n],o.args[n].constraint)}catch{throw Error(`Running the contributed command: '${e}' failed. Illegal argument '${o.args[n].name}' - ${o.args[n].description}`)}let s=$t.create();try{return await i.apply(a,t)}catch(i){if(e===this.converter.delegatingCommandId){let n=this.converter.getActualCommand(...t);n&&(e=n.command)}if(ae(i)||this._logService.error(i,e,r.extension?.identifier),!n)throw i;if(r.extension?.identifier){let e=this.#extHostTelemetry.onExtensionError(r.extension.identifier,i);this._logService.trace(`forwarded error to extension?`,e,r.extension?.identifier)}throw new class extends Error{constructor(){super(Em(i)),this.id=e,this.source=r.extension?.displayName??r.extension?.name}}}finally{this._reportTelemetry(r,e,s.elapsed())}}_reportTelemetry(e,t,n){e.extension&&(t.startsWith(`code.copilot.logStructured`)||this.#telemetry.$publicLog2(`Extension:ActionExecuted`,{extensionId:e.extension.identifier.value,id:new Og(t),duration:n}))}$executeContributedCommand(e,...t){this._logService.trace(`ExtHostCommands#$executeContributedCommand`,e);let n=this._commands.get(e);return n?(t=t.map(e=>this._argumentProcessors.reduce((e,t)=>t.processArgument(e,n.extension),e)),this._executeContributedCommand(e,t,!0)):Promise.reject(Error(`Contributed command '${e}' does not exist.`))}getCommands(e=!1){return this._logService.trace(`ExtHostCommands#getCommands`,e),this.#proxy.$getCommands().then(t=>(e&&(t=t.filter(e=>e[0]!==`_`)),t))}$getContributedCommandMetadata(){let e=Object.create(null);for(let[t,n]of this._commands){let{metadata:r}=n;r&&(e[t]=r)}return Promise.resolve(e)}};QM=A([j(0,Is),j(1,xs),j(2,ZM)],QM);const $M=k(`IExtHostCommands`);var eN=class{constructor(e,t,n){this._commands=e,this._lookupApiCommand=t,this._logService=n,this.delegatingCommandId=`__vsc${Nc()}`,this._cache=new Map,this._cachIdPool=0,this._commands.registerCommand(!0,this.delegatingCommandId,this._executeConvertedCommand,this)}toInternal(e,t){if(!e)return;let n={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command)return n;let r=this._lookupApiCommand(e.command);if(r)n.id=r.internalId,n.arguments=r.args.map((t,n)=>t.convert(e.arguments&&e.arguments[n]));else if(Ce(e.arguments)){let r=`${e.command} /${++this._cachIdPool}`;this._cache.set(r,e),t.add(_(()=>{this._cache.delete(r),this._logService.trace(`CommandsConverter#DISPOSE`,r)})),n.$ident=r,n.id=this.delegatingCommandId,n.arguments=[r],this._logService.trace(`CommandsConverter#CREATE`,e.command,r)}return n}fromInternal(e){return typeof e.$ident==`string`?this._cache.get(e.$ident):{command:e.id,title:e.title,arguments:e.arguments}}getActualCommand(...e){return this._cache.get(e[0])}_executeConvertedCommand(...e){let t=this.getActualCommand(...e);return this._logService.trace(`CommandsConverter#EXECUTE`,e[0],t?t.command:`MISSING`),t?this._commands.executeCommand(t.command,...t.arguments||[]):Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}},Y=class e{static{this.Uri=new e(`uri`,`Uri of a text document`,e=>w.isUri(e),e=>e)}static{this.Position=new e(`position`,`A position in a text document`,e=>Fb.isPosition(e),SD.from)}static{this.Range=new e(`range`,`A range in a text document`,e=>Ib.isRange(e),K.from)}static{this.Selection=new e(`selection`,`A selection in a text document`,e=>Lb.isSelection(e),yD.from)}static{this.Number=new e(`number`,``,e=>typeof e==`number`,e=>e)}static{this.String=new e(`string`,``,e=>typeof e==`string`,e=>e)}static Arr(t){return new e(`${t.name}_array`,`Array of ${t.name}, ${t.description}`,e=>Array.isArray(e)&&e.every(e=>t.validate(e)),e=>e.map(e=>t.convert(e)))}static{this.CallHierarchyItem=new e(`item`,`A call hierarchy item`,e=>e instanceof _x,WD.from)}static{this.TypeHierarchyItem=new e(`item`,`A type hierarchy item`,e=>e instanceof yw,KO.from)}static{this.TestItem=new e(`testItem`,`A VS Code TestItem`,e=>e instanceof GM,HO.from)}static{this.TestProfile=new e(`testProfile`,`A VS Code test profile`,e=>e instanceof aw,BO.from)}constructor(e,t,n,r){this.name=e,this.description=t,this.validate=n,this.convert=r}optional(){return new e(this.name,`(optional) ${this.description}`,e=>e==null||this.validate(e),e=>e===void 0?void 0:e===null?null:this.convert(e))}with(t,n){return new e(t??this.name,n??this.description,this.validate,this.convert)}},tN=class e{static{this.Void=new e(`no result`,e=>e)}constructor(e,t){this.description=e,this.convert=t}},nN=class{constructor(e,t,n,r,i){this.id=e,this.internalId=t,this.description=n,this.args=r,this.result=i}};const rN=k(`IExtHostTerminalService`);var iN=class extends y{constructor(e,t,n,r){super(),this._proxy=e,this._id=t,this._creationOptions=n,this._name=r,this._disposed=!1,this._state={isInteractedWith:!1,shell:void 0},this.isOpen=!1,this._onWillDispose=this._register(new x),this.onWillDispose=this._onWillDispose.event,this._creationOptions=Object.freeze(this._creationOptions),this._pidPromise=new Promise(e=>this._pidPromiseComplete=e);let i=this;this.value={get name(){return i._name||``},get processId(){return i._pidPromise},get creationOptions(){return i._creationOptions},get exitStatus(){return i._exitStatus},get state(){return i._state},get selection(){return i._selection},get shellIntegration(){return i.shellIntegration},sendText(e,t=!0){i._checkDisposed(),i._proxy.$sendText(i._id,e,t)},show(e){i._checkDisposed(),i._proxy.$show(i._id,e)},hide(){i._checkDisposed(),i._proxy.$hide(i._id)},dispose(){i._disposed||(i._disposed=!0,i._proxy.$dispose(i._id))},get dimensions(){if(!(i._cols===void 0||i._rows===void 0))return{columns:i._cols,rows:i._rows}}}}dispose(){this._onWillDispose.fire(),super.dispose()}async create(e,t){if(typeof this._id!=`string`)throw Error(`Terminal has already been created`);await this._proxy.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??t?.cwd??void 0,env:e.env??void 0,icon:dN(e.iconPath)??void 0,color:dl.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,forceShellIntegration:t?.forceShellIntegration??void 0,isFeatureTerminal:t?.isFeatureTerminal??void 0,isExtensionOwnedTerminal:!0,useShellEnvironment:t?.useShellEnvironment??void 0,location:t?.location||this._serializeParentTerminal(e.location,t?.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0})}async createExtensionTerminal(e,t,n,r,i){if(typeof this._id!=`string`)throw Error(`Terminal has already been created`);if(await this._proxy.$createTerminal(this._id,{name:this._name,isExtensionCustomPtyTerminal:!0,icon:r,color:dl.isThemeColor(i)?i.id:void 0,location:t?.location||this._serializeParentTerminal(e,n),isTransient:!0}),typeof this._id==`string`)throw Error(`Terminal creation failed`);return this._id}_serializeParentTerminal(e,t){return typeof e==`object`?`parentTerminal`in e&&e.parentTerminal&&t?{parentTerminal:t}:`viewColumn`in e?{viewColumn:OD.from(e.viewColumn),preserveFocus:e.preserveFocus}:void 0:e}_checkDisposed(){if(this._disposed)throw Error(`Terminal has already been disposed`)}set name(e){this._name=e}setExitStatus(e,t){this._exitStatus=Object.freeze({code:e,reason:t})}setDimensions(e,t){return e===this._cols&&t===this._rows||e===0||t===0?!1:(this._cols=e,this._rows=t,!0)}setInteractedWith(){return this._state.isInteractedWith?!1:(this._state={...this._state,isInteractedWith:!0},!0)}setShellType(e){return this._state.shell===e?!1:(this._state={...this._state,shell:e},!0)}setSelection(e){this._selection=e}_setProcessId(e){this._pidPromiseComplete?(this._pidPromiseComplete(e),this._pidPromiseComplete=void 0):this._pidPromise.then(t=>{t!==e&&(this._pidPromise=Promise.resolve(e))})}},aN=class{get onProcessReady(){return this._onProcessReady.event}constructor(e){this._pty=e,this.id=0,this.shouldPersist=!1,this._onProcessData=new x,this.onProcessData=this._onProcessData.event,this._onProcessReady=new x,this._onDidChangeProperty=new x,this.onDidChangeProperty=this._onDidChangeProperty.event,this._onProcessExit=new x,this.onProcessExit=this._onProcessExit.event}refreshProperty(e){throw Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,t){throw Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${t}`)}async start(){}shutdown(){this._pty.close()}input(e){this._pty.handleInput?.(e)}sendSignal(e){}resize(e,t){this._pty.setDimensions?.({columns:e,rows:t})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve(``)}getCwd(){return Promise.resolve(``)}startSendingEvents(e){this._pty.onDidWrite(e=>this._onProcessData.fire(e)),this._pty.onDidClose?.((e=void 0)=>{this._onProcessExit.fire(e===void 0?void 0:e)}),this._pty.onDidOverrideDimensions?.(e=>{e&&this._onDidChangeProperty.fire({type:CM.OverrideDimensions,value:{cols:e.columns,rows:e.rows}})}),this._pty.onDidChangeName?.(e=>{this._onDidChangeProperty.fire({type:CM.Title,value:e})}),this._pty.open(e||void 0),e&&this._pty.setDimensions?.(e),this._onProcessReady.fire({pid:-1,cwd:``,windowsPty:void 0})}};let oN=1,sN=class extends y{get activeTerminal(){return this._activeTerminal?.value}get terminals(){return this._terminals.map(e=>e.value)}constructor(e,t,n){super(),this._extHostCommands=t,this._terminals=[],this._terminalProcesses=new Map,this._terminalProcessDisposables={},this._extensionTerminalAwaitingStart={},this._getTerminalPromises={},this._environmentVariableCollections=new Map,this._lastQuickFixCommands=this._register(new xt),this._linkProviders=new Set,this._completionProviders=new Map,this._profileProviders=new Map,this._quickFixProviders=new Map,this._terminalLinkCache=new Map,this._terminalLinkCancellationSource=new Map,this._onDidCloseTerminal=new x,this.onDidCloseTerminal=this._onDidCloseTerminal.event,this._onDidOpenTerminal=new x,this.onDidOpenTerminal=this._onDidOpenTerminal.event,this._onDidChangeActiveTerminal=new x,this.onDidChangeActiveTerminal=this._onDidChangeActiveTerminal.event,this._onDidChangeTerminalDimensions=new x,this.onDidChangeTerminalDimensions=this._onDidChangeTerminalDimensions.event,this._onDidChangeTerminalState=new x,this.onDidChangeTerminalState=this._onDidChangeTerminalState.event,this._onDidChangeShell=new x,this.onDidChangeShell=this._onDidChangeShell.event,this._onDidWriteTerminalData=new x({onWillAddFirstListener:()=>this._proxy.$startSendingDataEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingDataEvents()}),this.onDidWriteTerminalData=this._onDidWriteTerminalData.event,this._onDidExecuteCommand=new x({onWillAddFirstListener:()=>this._proxy.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingCommandEvents()}),this.onDidExecuteTerminalCommand=this._onDidExecuteCommand.event,this._proxy=n.getProxy(E.MainThreadTerminalService),this._bufferer=new LM(this._proxy.$sendProcessData),this._proxy.$registerProcessSupport(e),this._extHostCommands.registerArgumentProcessor({processArgument:e=>{let t=e=>{let t=e;return this.getTerminalById(t.instanceId)?.value};switch(e?.$mid){case Dn.TerminalContext:return t(e);default:if(Array.isArray(e))for(let n=0;n<e.length&&e[n].$mid===Dn.TerminalContext;n++)e[n]=t(e[n]);return e}}}),this._register({dispose:()=>{for(let[e,t]of this._terminalProcesses)t.shutdown(!0)}})}getDefaultShell(e){let t=e?this._defaultAutomationProfile:this._defaultProfile;return t?.path||``}getDefaultShellArgs(e){let t=e?this._defaultAutomationProfile:this._defaultProfile;return t?.args||[]}createExtensionTerminal(e,t){let n=new iN(this._proxy,Nc(),e,e.name),r=new aN(e.pty);return n.createExtensionTerminal(e.location,t,this._serializeParentTerminal(e,t).resolvedExtHostIdentifier,dN(e.iconPath),fN(e.color)).then(e=>{let t=this._setupExtHostProcessListeners(e,r);this._terminalProcessDisposables[e]=t}),this._terminals.push(n),n.value}_serializeParentTerminal(e,t){if(t||={},e.location&&typeof e.location==`object`&&`parentTerminal`in e.location){let n=e.location.parentTerminal;if(n){let e=this._terminals.find(e=>e.value===n);e&&(t.resolvedExtHostIdentifier=e._id)}}else e.location&&typeof e.location!=`object`?t.location=e.location:t.location&&typeof t.location==`object`&&`splitActiveTerminal`in t.location&&(t.location={splitActiveTerminal:!0});return t}attachPtyToTerminal(e,t){let n=this.getTerminalById(e);if(!n)throw Error(`Cannot resolve terminal with id ${e} for virtual process`);let r=new aN(t),i=this._setupExtHostProcessListeners(e,r);this._terminalProcessDisposables[e]=i}async $acceptActiveTerminalChanged(e){let t=this._activeTerminal;if(e===null){this._activeTerminal=void 0,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal);return}let n=this.getTerminalById(e);n&&(this._activeTerminal=n,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal.value))}async $acceptTerminalProcessData(e,t){let n=this.getTerminalById(e);n&&this._onDidWriteTerminalData.fire({terminal:n.value,data:t})}async $acceptTerminalDimensions(e,t,n){let r=this.getTerminalById(e);r&&r.setDimensions(t,n)&&this._onDidChangeTerminalDimensions.fire({terminal:r.value,dimensions:r.value.dimensions})}async $acceptDidExecuteCommand(e,t){let n=this.getTerminalById(e);n&&this._onDidExecuteCommand.fire({terminal:n.value,...t})}async $acceptTerminalMaximumDimensions(e,t,n){this._terminalProcesses.get(e)?.resize(t,n)}async $acceptTerminalTitleChange(e,t){let n=this.getTerminalById(e);n&&(n.name=t)}async $acceptTerminalClosed(e,t,n){let r=this._getTerminalObjectIndexById(this._terminals,e);if(r!==null){let e=this._terminals.splice(r,1)[0];e.setExitStatus(t,n),this._onDidCloseTerminal.fire(e.value)}}$acceptTerminalOpened(e,t,n,r){if(t){let n=this._getTerminalObjectIndexById(this._terminals,t);if(n!==null){this._terminals[n]._id=e,this._onDidOpenTerminal.fire(this.terminals[n]),this._terminals[n].isOpen=!0;return}}let i={name:r.name,shellPath:r.executable,shellArgs:r.args,cwd:typeof r.cwd==`string`?r.cwd:w.revive(r.cwd),env:r.env,hideFromUser:r.hideFromUser},a=new iN(this._proxy,e,i,n);this._terminals.push(a),this._onDidOpenTerminal.fire(a.value),a.isOpen=!0}async $acceptTerminalProcessId(e,t){let n=this.getTerminalById(e);n?._setProcessId(t)}async $startExtensionTerminal(e,t){let n=this.getTerminalById(e);if(!n)return{message:C(2636,`Could not find the terminal with id {0} on the extension host`,e)};n.isOpen||await new Promise(e=>{let t=this.onDidOpenTerminal(async r=>{r===n.value&&(t.dispose(),e())})});let r=this._terminalProcesses.get(e);r?r.startSendingEvents(t):this._extensionTerminalAwaitingStart[e]={initialDimensions:t}}_setupExtHostProcessListeners(e,t){let n=new v;n.add(t.onProcessReady(t=>this._proxy.$sendProcessReady(e,t.pid,t.cwd,t.windowsPty))),n.add(t.onDidChangeProperty(t=>this._proxy.$sendProcessProperty(e,t))),this._bufferer.startBuffering(e,t.onProcessData),n.add(t.onProcessExit(t=>this._onProcessExit(e,t))),this._terminalProcesses.set(e,t);let r=this._extensionTerminalAwaitingStart[e];return r&&t instanceof aN&&(t.startSendingEvents(r.initialDimensions),delete this._extensionTerminalAwaitingStart[e]),n}$acceptProcessAckDataEvent(e,t){this._terminalProcesses.get(e)?.acknowledgeDataEvent(t)}$acceptProcessInput(e,t){this._terminalProcesses.get(e)?.input(t)}$acceptTerminalInteraction(e){let t=this.getTerminalById(e);t?.setInteractedWith()&&this._onDidChangeTerminalState.fire(t.value)}$acceptTerminalSelection(e,t){this.getTerminalById(e)?.setSelection(t)}$acceptProcessResize(e,t,n){try{this._terminalProcesses.get(e)?.resize(t,n)}catch(e){if(e.code!==`EPIPE`&&e.code!==`ERR_IPC_CHANNEL_CLOSED`)throw e}}$acceptProcessShutdown(e,t){this._terminalProcesses.get(e)?.shutdown(t)}$acceptProcessRequestInitialCwd(e){this._terminalProcesses.get(e)?.getInitialCwd().then(t=>this._proxy.$sendProcessProperty(e,{type:CM.InitialCwd,value:t}))}$acceptProcessRequestCwd(e){this._terminalProcesses.get(e)?.getCwd().then(t=>this._proxy.$sendProcessProperty(e,{type:CM.Cwd,value:t}))}$acceptProcessRequestLatency(e){return Promise.resolve(e)}registerProfileProvider(e,t,n){if(this._profileProviders.has(t))throw Error(`Terminal profile provider "${t}" already registered`);return this._profileProviders.set(t,n),this._proxy.$registerProfileProvider(t,e.identifier.value),new Pb(()=>{this._profileProviders.delete(t),this._proxy.$unregisterProfileProvider(t)})}registerTerminalCompletionProvider(e,t,...n){if(this._completionProviders.has(t.id))throw Error(`Terminal completion provider "${t.id}" already registered`);return this._completionProviders.set(t.id,t),this._proxy.$registerCompletionProvider(t.id,e.identifier.value,...n),new Pb(()=>{this._completionProviders.delete(t.id),this._proxy.$unregisterCompletionProvider(t.id)})}async $provideTerminalCompletions(e,t){let n=new Ai().token;if(n.isCancellationRequested||!this.activeTerminal)return;let r=this._completionProviders.get(e);if(!r)return;let i=await r.provideTerminalCompletions(this.activeTerminal,t,n);if(i==null)return;let a=!Xn||this.activeTerminal.state?.shell===yM.GitBash?`/`:`\\`;return Pk.from(i,a)}$acceptTerminalShellType(e,t){let n=this.getTerminalById(e);n?.setShellType(t)&&this._onDidChangeTerminalState.fire(n.value)}registerTerminalQuickFixProvider(e,t,n){if(this._quickFixProviders.has(e))throw Error(`Terminal quick fix provider "${e}" is already registered`);return this._quickFixProviders.set(e,n),this._proxy.$registerQuickFixProvider(e,t),new Pb(()=>{this._quickFixProviders.delete(e),this._proxy.$unregisterQuickFixProvider(e)})}async $provideTerminalQuickFixes(e,t){let n=new Ai().token;if(n.isCancellationRequested)return;let r=this._quickFixProviders.get(e);if(!r)return;let i=await r.provideTerminalQuickFixes(t,n);if(i===null||Array.isArray(i)&&i.length===0)return;let a=new v;if(this._lastQuickFixCommands.value=a,!Array.isArray(i))return i?Mk.from(i,this._extHostCommands.converter,a):void 0;let o=[];for(let e of i){let t=Mk.from(e,this._extHostCommands.converter,a);t&&o.push(t)}return o}async $createContributedProfileTerminal(e,t){let n=new Ai().token,r=await this._profileProviders.get(e)?.provideTerminalProfile(n);if(!n.isCancellationRequested){if(r&&!(`options`in r)&&(r={options:r}),!r||!(`options`in r))throw Error(`No terminal profile options provided for id "${e}"`);if(`pty`in r.options){this.createExtensionTerminal(r.options,t);return}this.createTerminalFromOptions(r.options,t)}}registerLinkProvider(e){return this._linkProviders.add(e),this._linkProviders.size===1&&this._proxy.$startLinkProvider(),new Pb(()=>{this._linkProviders.delete(e),this._linkProviders.size===0&&this._proxy.$stopLinkProvider()})}async $provideLinks(e,t){let n=this.getTerminalById(e);if(!n)return[];this._terminalLinkCache.delete(e);let r=this._terminalLinkCancellationSource.get(e);r?.dispose(!0);let i=new Ai;this._terminalLinkCancellationSource.set(e,i);let a=[],o={terminal:n.value,line:t},s=[];for(let e of this._linkProviders)s.push(Po.withAsyncBody(async t=>{i.token.onCancellationRequested(()=>t({provider:e,links:[]}));let n=await e.provideTerminalLinks(o,i.token)||[];i.token.isCancellationRequested||t({provider:e,links:n})}));let c=await Promise.all(s);if(i.token.isCancellationRequested)return[];let l=new Map;for(let e of c)e&&e.links.length>0&&a.push(...e.links.map(t=>{let n={id:oN++,startIndex:t.startIndex,length:t.length,label:t.tooltip};return l.set(n.id,{provider:e.provider,link:t}),n}));return this._terminalLinkCache.set(e,l),a}$activateLink(e,t){let n=this._terminalLinkCache.get(e)?.get(t);n&&n.provider.handleTerminalLink(n.link)}_onProcessExit(e,t){this._bufferer.stopBuffering(e),this._terminalProcesses.delete(e),delete this._extensionTerminalAwaitingStart[e];let n=this._terminalProcessDisposables[e];n&&(n.dispose(),delete this._terminalProcessDisposables[e]),this._proxy.$sendProcessExit(e,t)}getTerminalById(e){return this._getTerminalObjectById(this._terminals,e)}getTerminalIdByApiObject(e){let t=this._terminals.findIndex(t=>t.value===e);return t>=0?t:null}_getTerminalObjectById(e,t){let n=this._getTerminalObjectIndexById(e,t);return n===null?null:e[n]}_getTerminalObjectIndexById(e,t){let n=e.findIndex(e=>e._id===t);return n>=0?n:null}getEnvironmentVariableCollection(e){let t=this._environmentVariableCollections.get(e.identifier.value);return t||(t=this._register(new cN),this._setEnvironmentVariableCollection(e.identifier.value,t)),t.getScopedEnvironmentVariableCollection(void 0)}_syncEnvironmentVariableCollection(e,t){let n=mM(t.map),r=hM(t.descriptionMap);this._proxy.$setEnvironmentVariableCollection(e,t.persistent,n.length===0?void 0:n,r)}$initEnvironmentVariableCollections(e){e.forEach(e=>{let t=e[0],n=this._register(new cN(e[1]));this._setEnvironmentVariableCollection(t,n)})}$acceptDefaultProfile(e,t){let n=this._defaultProfile;this._defaultProfile=e,this._defaultAutomationProfile=t,n?.path!==e.path&&this._onDidChangeShell.fire(e.path)}_setEnvironmentVariableCollection(e,t){this._environmentVariableCollections.set(e,t),this._register(t.onDidChangeCollection(()=>{this._syncEnvironmentVariableCollection(e,t)}))}};sN=A([j(1,$M),j(2,Is)],sN);var cN=class extends y{get persistent(){return this._persistent}set persistent(e){this._persistent=e,this._onDidChangeCollection.fire()}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e){super(),this.map=new Map,this.scopedCollections=new Map,this.descriptionMap=new Map,this._persistent=!0,this._onDidChangeCollection=new x,this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){let t=this.getScopeKey(e),n=this.scopedCollections.get(t);return n||(n=new lN(this,e),this.scopedCollections.set(t,n),this._register(n.onDidChangeCollection(()=>this._onDidChangeCollection.fire()))),n}replace(e,t,n,r){this._setIfDiffers(e,{value:t,type:Gb.Replace,options:n??{applyAtProcessCreation:!0},scope:r})}append(e,t,n,r){this._setIfDiffers(e,{value:t,type:Gb.Append,options:n??{applyAtProcessCreation:!0},scope:r})}prepend(e,t,n,r){this._setIfDiffers(e,{value:t,type:Gb.Prepend,options:n??{applyAtProcessCreation:!0},scope:r})}_setIfDiffers(e,t){if(t.options&&t.options.applyAtProcessCreation===!1&&!t.options.applyAtShellIntegration)throw Error(`EnvironmentVariableMutatorOptions must apply at either process creation or shell integration`);let n=this.getKey(e,t.scope),r=this.map.get(n),i=t.options?{applyAtProcessCreation:t.options.applyAtProcessCreation??!1,applyAtShellIntegration:t.options.applyAtShellIntegration??!1}:{applyAtProcessCreation:!0};if(!r||r.value!==t.value||r.type!==t.type||r.options?.applyAtProcessCreation!==i.applyAtProcessCreation||r.options?.applyAtShellIntegration!==i.applyAtShellIntegration||r.scope?.workspaceFolder?.index!==t.scope?.workspaceFolder?.index){let n=this.getKey(e,t.scope),r={variable:e,...t,options:i};this.map.set(n,r),this._onDidChangeCollection.fire()}}get(e,t){let n=this.getKey(e,t),r=this.map.get(n);return r?pN(r):void 0}getKey(e,t){let n=this.getScopeKey(t);return n.length?`${e}:::${n}`:e}getScopeKey(e){return this.getWorkspaceKey(e?.workspaceFolder)??``}getWorkspaceKey(e){return e?e.uri.toString():void 0}getVariableMap(e){let t=new Map;for(let[n,r]of this.map)this.getScopeKey(r.scope)===this.getScopeKey(e)&&t.set(r.variable,pN(r));return t}delete(e,t){let n=this.getKey(e,t);this.map.delete(n),this._onDidChangeCollection.fire()}clear(e){if(e?.workspaceFolder){for(let[t,n]of this.map)n.scope?.workspaceFolder?.index===e.workspaceFolder.index&&this.map.delete(t);this.clearDescription(e)}else this.map.clear(),this.descriptionMap.clear();this._onDidChangeCollection.fire()}setDescription(e,t){let n=this.getScopeKey(t),r=this.descriptionMap.get(n);if(!r||r.description!==e){let r;r=typeof e==`string`?e:e?.value.split(`

`)[0];let i={description:r,scope:t};this.descriptionMap.set(n,i),this._onDidChangeCollection.fire()}}getDescription(e){let t=this.getScopeKey(e);return this.descriptionMap.get(t)?.description}clearDescription(e){let t=this.getScopeKey(e);this.descriptionMap.delete(t)}},lN=class{get persistent(){return this.collection.persistent}set persistent(e){this.collection.persistent=e}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e,t){this.collection=e,this.scope=t,this._onDidChangeCollection=new x}getScoped(e){return this.collection.getScopedEnvironmentVariableCollection(e)}replace(e,t,n){this.collection.replace(e,t,n,this.scope)}append(e,t,n){this.collection.append(e,t,n,this.scope)}prepend(e,t,n){this.collection.prepend(e,t,n,this.scope)}get(e){return this.collection.get(e,this.scope)}forEach(e,t){this.collection.getVariableMap(this.scope).forEach((n,r)=>e.call(t,r,n,this),this.scope)}[Symbol.iterator](){return this.collection.getVariableMap(this.scope).entries()}delete(e){this.collection.delete(e,this.scope),this._onDidChangeCollection.fire(void 0)}clear(){this.collection.clear(this.scope)}set description(e){this.collection.setDescription(e,this.scope)}get description(){return this.collection.getDescription(this.scope)}};let uN=class extends sN{constructor(e,t){super(!1,e,t)}createTerminal(e,t,n){throw new fe}createTerminalFromOptions(e,t){throw new fe}};uN=A([j(0,$M),j(1,Is)],uN);function dN(e){if(!(!e||typeof e==`string`))return`id`in e?{id:e.id,color:e.color}:e}function fN(e){return dl.isThemeColor(e)?e:void 0}function pN(e){let t={...e};return delete t.scope,t.options=t.options??void 0,delete t.variable,t}const mN=`/.well-known`,hN=`${mN}/oauth-authorization-server`,gN=`${mN}/openid-configuration`;var _N;(function(e){e.InvalidRequest=`invalid_request`,e.InvalidClient=`invalid_client`,e.InvalidGrant=`invalid_grant`,e.UnauthorizedClient=`unauthorized_client`,e.UnsupportedGrantType=`unsupported_grant_type`,e.InvalidScope=`invalid_scope`})(_N||={});var vN;(function(e){e.AuthorizationPending=`authorization_pending`,e.SlowDown=`slow_down`,e.AccessDenied=`access_denied`,e.ExpiredToken=`expired_token`})(vN||={});var yN;(function(e){e.InvalidRedirectUri=`invalid_redirect_uri`,e.InvalidClientMetadata=`invalid_client_metadata`,e.InvalidSoftwareStatement=`invalid_software_statement`,e.UnapprovedSoftwareStatement=`unapproved_software_statement`})(yN||={});function bN(e){if(typeof e!=`object`||!e)return!1;let t=e;return t.resource!==void 0}function xN(e){if(typeof e!=`object`||!e)return!1;let t=e;return t.issuer!==void 0}function SN(e){if(typeof e!=`object`||!e)return!1;let t=e;return t.client_id!==void 0}function CN(e){if(typeof e!=`object`||!e)return!1;let t=e;return t.access_token!==void 0&&t.token_type!==void 0}function wN(e){if(typeof e!=`object`||!e)return!1;let t=e;return t.error!==void 0}function TN(e){if(typeof e!=`object`||!e)return!1;let t=e;return t.error!==void 0}function EN(e){return{issuer:e.toString(),authorization_endpoint:new URL(`/authorize`,e).toString(),token_endpoint:new URL(`/token`,e).toString(),registration_endpoint:new URL(`/register`,e).toString(),response_types_supported:[`code`,`id_token`,`id_token token`]}}const DN=[`authorization_code`,`refresh_token`,`urn:ietf:params:oauth:grant-type:device_code`],ON=33418;async function kN(e,t,n){if(!e.registration_endpoint)throw Error(`Server does not support dynamic registration`);let r=await fetch(e.registration_endpoint,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({client_name:t,client_uri:`https://code.visualstudio.com`,grant_types:e.grant_types_supported?e.grant_types_supported.filter(e=>DN.includes(e)):DN,response_types:[`code`],redirect_uris:[`https://insiders.vscode.dev/redirect`,`https://vscode.dev/redirect`,`http://localhost`,`http://127.0.0.1`,`http://localhost:${ON}`,`http://127.0.0.1:${ON}`],scope:n?.join(` `),token_endpoint_auth_method:`none`,application_type:`native`})});if(!r.ok){let t=await r.text(),n=t;try{let e=JSON.parse(t);TN(e)&&(n=`${e.error}${e.error_description?`: ${e.error_description}`:``}`)}catch{}throw Error(`Registration to ${e.registration_endpoint} failed: ${n}`)}let i=await r.json();if(SN(i))return i;throw Error(`Invalid authorization dynamic client registration response: ${JSON.stringify(i)}`)}function AN(e){let t=e.split(` `),n=t[0],r={};if(t.length>1){let e=t.slice(1).join(` `).split(`,`);e.forEach(e=>{let[t,n]=e.split(`=`).map(e=>e.trim().replace(/"/g,``));r[t]=n})}return{scheme:n,params:r}}function jN(e){let t=e.split(`.`);if(t.length!==3)throw Error(`Invalid JWT token format: token must have three parts separated by dots`);let[n,r,i]=t;try{let e=JSON.parse(Wt(n).toString());if(typeof e!=`object`)throw Error(`Invalid JWT token format: header is not a JSON object`);let t=JSON.parse(Wt(r).toString());if(typeof t!=`object`)throw Error(`Invalid JWT token format: payload is not a JSON object`);return t}catch(e){throw e instanceof Error?Error(`Failed to parse JWT token: ${e.message}`):Error(`Failed to parse JWT token`)}}var MN;let NN=class{static{MN=this}static{this.InitialState={focused:!0,active:!0}}getState(){let e=this._state;return{get focused(){return e.focused},get active(){return e.active}}}constructor(e,t){this._onDidChangeWindowState=new x,this.onDidChangeWindowState=this._onDidChangeWindowState.event,this._state=MN.InitialState,e.handle&&(this._nativeHandle=Wt(e.handle).buffer),this._proxy=t.getProxy(E.MainThreadWindow),this._proxy.$getInitialState().then(({isFocused:e,isActive:t})=>{this.onDidChangeWindowProperty(`focused`,e),this.onDidChangeWindowProperty(`active`,t)})}get nativeHandle(){return this._nativeHandle}$onDidChangeActiveNativeWindowHandle(e){this._nativeHandle=e?Wt(e).buffer:void 0}$onDidChangeWindowFocus(e){this.onDidChangeWindowProperty(`focused`,e)}$onDidChangeWindowActive(e){this.onDidChangeWindowProperty(`active`,e)}onDidChangeWindowProperty(e,t){t!==this._state[e]&&(this._state={...this._state,[e]:t},this._onDidChangeWindowState.fire(this._state))}openUri(e,t){let n;if(typeof e==`string`){n=e;try{e=w.parse(e)}catch{return Promise.reject(`Invalid uri - '${e}'`)}}return Ii(e.scheme)?Promise.reject(`Invalid scheme - cannot be empty`):e.scheme===O.command?Promise.reject(`Invalid scheme '${e.scheme}'`):this._proxy.$openUri(e,n,t)}async asExternalUri(e,t){if(Ii(e.scheme))return Promise.reject(`Invalid scheme - cannot be empty`);let n=await this._proxy.$asExternalUri(e,t);return w.from(n)}};NN=MN=A([j(0,ks),j(1,Is)],NN);const PN=k(`IExtHostWindow`);var FN;let IN=class{static{FN=this}static{this.HandlePool=0}constructor(e){this.handles=new hs,this.handlers=new Map,this._proxy=e.getProxy(E.MainThreadUrls)}registerUriHandler(e,t){let n=e.identifier;if(this.handles.has(n))throw Error(`Protocol handler already registered for extension ${n}`);let r=FN.HandlePool++;return this.handles.add(n),this.handlers.set(r,t),this._proxy.$registerUriHandler(r,n,e.displayName||e.name),_(()=>{this.handles.delete(n),this.handlers.delete(r),this._proxy.$unregisterUriHandler(r)})}$handleExternalUri(e,t){let n=this.handlers.get(e);if(!n)return Promise.resolve(void 0);try{n.handleUri(w.revive(t))}catch(e){m(e)}return Promise.resolve(void 0)}async createAppUri(e){return w.revive(await this._proxy.$createAppUri(e))}};IN=FN=A([j(0,Is)],IN);const LN=k(`IExtHostUrlsService`);function RN(e){return(t,n,r)=>{let i=null,a=null;if(typeof r.value==`function`?(i=`value`,a=r.value):typeof r.get==`function`&&(i=`get`,a=r.get),!a||typeof n==`symbol`)throw Error(`not supported`);r[i]=e(a,n)}}function zN(e,t,n){return RN((t,n)=>{let r=`$debounce$${n}`,i=`$debounce$result$${n}`;return function(...n){this[i]||(this[i]=void 0),clearTimeout(this[r]),this[r]=setTimeout(()=>{t.apply(this,n),this[i]=void 0},e)}})}function BN(e,t,n){return RN((r,i)=>{let a=`$throttle$timer$${i}`,o=`$throttle$result$${i}`,s=`$throttle$lastRun$${i}`,c=`$throttle$pending$${i}`;return function(...i){if(this[o]||(this[o]=n?n():void 0),(this[s]===null||this[s]===void 0)&&(this[s]=-Number.MAX_VALUE),t&&(this[o]=t(this[o],...i)),this[c])return;let l=this[s]+e;l<=Date.now()?(this[s]=Date.now(),r.apply(this,[this[o]]),this[o]=n?n():void 0):(this[c]=!0,this[a]=setTimeout(()=>{this[c]=!1,this[s]=Date.now(),r.apply(this,[this[o]]),this[o]=n?n():void 0},l-Date.now()))}})}const VN=k(`IExtHostProgress`);let HN=class{constructor(e){this._handles=0,this._mapHandleToCancellationSource=new Map,this._proxy=e.getProxy(E.MainThreadProgress)}async withProgress(e,t,n){let r=this._handles++,{title:i,location:a,cancellable:o}=t,s={label:e.displayName||e.name,id:e.identifier.value};return this._proxy.$startProgress(r,{location:bO.from(a),title:i,source:s,cancellable:o},e.isUnderDevelopment?void 0:e.identifier.value).catch(te),this._withProgress(r,n,!!o)}async withProgressFromSource(e,t,n){let r=this._handles++,{title:i,location:a,cancellable:o}=t;return this._proxy.$startProgress(r,{location:bO.from(a),title:i,source:e,cancellable:o},void 0).catch(te),this._withProgress(r,n,!!o)}_withProgress(e,t,n){let r;n&&(r=new Ai,this._mapHandleToCancellationSource.set(e,r));let i=e=>{this._proxy.$progressEnd(e),this._mapHandleToCancellationSource.delete(e),r?.dispose()},a;try{a=t(new WN(this._proxy,e),n&&r?r.token:Oi.None)}catch(t){throw i(e),t}return a.then(t=>i(e),t=>i(e)),a}$acceptProgressCanceled(e){let t=this._mapHandleToCancellationSource.get(e);t&&(t.cancel(),this._mapHandleToCancellationSource.delete(e))}};HN=A([j(0,Is)],HN);function UN(e,t){return e.message=t.message,typeof t.increment==`number`&&(typeof e.increment==`number`?e.increment+=t.increment:e.increment=t.increment),e}var WN=class extends ym{constructor(e,t){super(e=>this.throttledReport(e)),this._proxy=e,this._handle=t}throttledReport(e){this._proxy.$progressReport(this._handle,e)}};WN.__decorator=A([BN(100,(e,t)=>UN(e,t),()=>Object.create(null))],WN.prototype,`throttledReport`,null);const GN=k(`IExtHostAuthentication`);let KN=class{constructor(e,t,n,r,i,a,o){this._initData=t,this._extHostWindow=n,this._extHostUrls=r,this._extHostProgress=i,this._extHostLoggerService=a,this._logService=o,this._dynamicAuthProviderCtor=JN,this._authenticationProviders=new Map,this._providerOperations=new ho,this._onDidChangeSessions=new x,this._getSessionTaskSingler=new qN,this._onDidDynamicAuthProviderTokensChange=new x,this._proxy=e.getProxy(E.MainThreadAuthentication)}getExtensionScopedSessionsEvent(e){let t=e.toLowerCase();return en.chain(this._onDidChangeSessions.event,e=>e.filter(e=>!e.extensionIdFilter||e.extensionIdFilter.includes(t)).map(e=>({provider:e.provider})))}async getSession(e,t,n,r={}){let i=ms.toKey(e.identifier),a=[...n].sort().join(` `),o=Object.keys(r),s=o.sort().map(e=>`${e}:${!!r[e]}`).join(`, `);return await this._getSessionTaskSingler.getOrCreate(`${i} ${t} ${a} ${s}`,async()=>{await this._proxy.$ensureProvider(t);let a=e.displayName||e.name;return this._proxy.$getSession(t,n,i,a,r)})}async getAccounts(e){return await this._proxy.$ensureProvider(e),await this._proxy.$getAccounts(e)}registerAuthenticationProvider(e,t,n,r){return this._providerOperations.queue(e,async()=>{if(this._authenticationProviders.get(e)){this._logService.error(`An authentication provider with id '${e}' is already registered. The existing provider will not be replaced.`);return}let i=n.onDidChangeSessions(t=>this._proxy.$sendDidChangeSessions(e,t));this._authenticationProviders.set(e,{label:t,provider:n,disposable:i,options:r??{supportsMultipleAccounts:!1}}),await this._proxy.$registerAuthenticationProvider(e,t,r?.supportsMultipleAccounts??!1,r?.supportedAuthorizationServers)}),new Pb(()=>{this._providerOperations.queue(e,async()=>{let t=this._authenticationProviders.get(e);t&&(t.disposable?.dispose(),this._authenticationProviders.delete(e),await this._proxy.$unregisterAuthenticationProvider(e))})})}$createSession(e,t,n){return this._providerOperations.queue(e,async()=>{let r=this._authenticationProviders.get(e);if(r)return n.authorizationServer=w.revive(n.authorizationServer),await r.provider.createSession(t,n);throw Error(`Unable to find authentication provider with handle: ${e}`)})}$removeSession(e,t){return this._providerOperations.queue(e,async()=>{let n=this._authenticationProviders.get(e);if(n)return await n.provider.removeSession(t);throw Error(`Unable to find authentication provider with handle: ${e}`)})}$getSessions(e,t,n){return this._providerOperations.queue(e,async()=>{let r=this._authenticationProviders.get(e);if(r)return n.authorizationServer=w.revive(n.authorizationServer),await r.provider.getSessions(t,n);throw Error(`Unable to find authentication provider with handle: ${e}`)})}$onDidChangeAuthenticationSessions(e,t,n){return e.startsWith(`__`)||this._onDidChangeSessions.fire({provider:{id:e,label:t},extensionIdFilter:n}),Promise.resolve()}$onDidUnregisterAuthenticationProvider(e){return this._providerOperations.queue(e,async()=>{let t=this._authenticationProviders.get(e);t&&(t.disposable?.dispose(),this._authenticationProviders.delete(e))})}async $registerDynamicAuthProvider(e,t,n,r,i,a){if(!r){let a=w.revive(e);if(t.registration_endpoint)try{let e=await kN(t,this._initData.environment.appName,n?.scopes_supported);r=e.client_id,i=e.client_secret}catch(e){this._logService.warn(`Dynamic registration failed for ${a.toString()}: ${e.message}. Prompting user for client ID and client secret...`)}if(!r){this._logService.info(`Prompting user for client registration details for ${a.toString()}`);let e=await this._proxy.$promptForClientRegistration(a.toString());if(!e)throw Error(`User did not provide client details`);r=e.clientId,i=e.clientSecret,this._logService.info(`User provided client registration for ${a.toString()}`),i?this._logService.trace(`User provided client secret for ${a.toString()}`):this._logService.trace(`User did not provide client secret for ${a.toString()}`)}}let o=new this._dynamicAuthProviderCtor(this._extHostWindow,this._extHostUrls,this._initData,this._extHostProgress,this._extHostLoggerService,this._proxy,w.revive(e),t,n,r,i,this._onDidDynamicAuthProviderTokensChange,a||[]);return await this._providerOperations.queue(o.id,async()=>{this._authenticationProviders.set(o.id,{label:o.label,provider:o,disposable:Pb.from(o,o.onDidChangeSessions(e=>this._proxy.$sendDidChangeSessions(o.id,e)),o.onDidChangeClientId(()=>this._proxy.$sendDidChangeDynamicProviderInfo({providerId:o.id,clientId:o.clientId,clientSecret:o.clientSecret}))),options:{supportsMultipleAccounts:!1}}),await this._proxy.$registerDynamicAuthenticationProvider(o.id,o.label,o.authorizationServer,o.clientId,o.clientSecret)}),o.id}async $onDidChangeDynamicAuthProviderTokens(e,t,n){this._onDidDynamicAuthProviderTokensChange.fire({authProviderId:e,clientId:t,tokens:n})}};KN=A([j(0,Is),j(1,ks),j(2,PN),j(3,LN),j(4,VN),j(5,Ss),j(6,xs)],KN);var qN=class{constructor(){this._inFlightPromises=new Map}getOrCreate(e,t){let n=this._inFlightPromises.get(e);if(n)return n;let r=t().finally(()=>this._inFlightPromises.delete(e));return this._inFlightPromises.set(e,r),r}};let JN=class{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f){this._extHostWindow=e,this._extHostUrls=t,this._initData=n,this._extHostProgress=r,this._proxy=a,this.authorizationServer=o,this._serverMetadata=s,this._resourceMetadata=c,this._clientId=l,this._clientSecret=u,this._onDidChangeSessions=new x,this.onDidChangeSessions=this._onDidChangeSessions.event,this._onDidChangeClientId=new x,this.onDidChangeClientId=this._onDidChangeClientId.event;let p=o.toString(!0);this.id=c?.resource?p+` `+c?.resource:p,this.label=c?.resource_name??this.authorizationServer.authority,this._logger=i.createLogger(this.id,{name:this.label}),this._disposable=new v,this._disposable.add(this._onDidChangeSessions);let ee=en.chain(d.event,e=>e.filter(e=>e.authProviderId===this.id&&e.clientId===l).map(e=>e.tokens));this._tokenStore=this._disposable.add(new YN({onDidChange:ee,set:e=>a.$setSessionsForDynamicAuthProvider(this.id,this.clientId,e)},f,this._logger)),this._disposable.add(this._tokenStore.onDidChangeSessions(e=>this._onDidChangeSessions.fire(e))),this._createFlows=[],s.authorization_endpoint&&this._createFlows.push({label:C(2617,`URL Handler`),handler:(e,t,n)=>this._createWithUrlHandler(e,t,n)})}get clientId(){return this._clientId}get clientSecret(){return this._clientSecret}async getSessions(e,t){if(this._logger.info(`Getting sessions for scopes: ${e?.join(` `)??`all`}`),!e)return this._tokenStore.sessions;let n=[...e].sort(),r=e.join(` `),i=this._tokenStore.sessions.filter(e=>ge([...e.scopes].sort(),n));if(this._logger.info(`Found ${i.length} sessions for scopes: ${r}`),i.length){let e=[],t=[],a=new Map(this._tokenStore.tokens.map(e=>[e.access_token,e]));for(let n of i){let i=a.get(n.accessToken);if(i&&i.expires_in){let a=Date.now(),o=i.expires_in*1e3;if(a>i.created_at+o-300*1e3){if(this._logger.info(`Token for session ${n.id} is about to expire, refreshing...`),t.push(i),!i.refresh_token){this._logger.warn(`No refresh token available for scopes ${n.scopes.join(` `)}. Throwing away token.`);continue}try{let t=await this.exchangeRefreshTokenForToken(i.refresh_token);t.scope!==r&&(this._logger.warn(`Token scopes '${t.scope}' do not match requested scopes '${r}'. Overwriting token with what was requested...`),t.scope=r),this._logger.info(`Successfully created a new token for scopes ${n.scopes.join(` `)}.`),e.push(t)}catch(e){this._logger.error(`Failed to refresh token: ${e}`)}}}}return(e.length||t.length)&&(this._tokenStore.update({added:e,removed:t}),i=this._tokenStore.sessions.filter(e=>ge([...e.scopes].sort(),n))),this._logger.info(`Found ${i.length} sessions for scopes: ${r}`),i}return[]}async createSession(e,t){this._logger.info(`Creating session for scopes: ${e.join(` `)}`);let n;for(let t=0;t<this._createFlows.length;t++){let{handler:r}=this._createFlows[t];try{if(n=await this._extHostProgress.withProgressFromSource({label:this.label,id:this.id},{location:CS.Notification,title:C(2618,`Authenticating to '{0}'`,this.label),cancellable:!0},(t,n)=>r(e,t,n)),n)break}catch(e){let n=this._createFlows[t+1]?.label;if(!n)break;let r=ae(e)?C(2619,`Having trouble authenticating to '{0}'? Would you like to try a different way? ({1})`,this.label,n):C(2620,`You have not yet finished authenticating to '{0}'. Would you like to try a different way? ({1})`,this.label,n),i=await this._proxy.$showContinueNotification(r);if(!i)throw new oe;this._logger.error(`Failed to create token via flow '${n}': ${e}`)}}if(!n)throw Error(`Failed to create authentication token`);n.scope!==e.join(` `)&&(this._logger.warn(`Token scopes '${n.scope}' do not match requested scopes '${e.join(` `)}'. Overwriting token with what was requested...`),n.scope=e.join(` `)),this._tokenStore.update({added:[{...n,created_at:Date.now()}],removed:[]});let r=this._tokenStore.sessions.find(e=>e.accessToken===n.access_token);return this._logger.info(`Created session for scopes: ${n.scope}`),r}async removeSession(e){this._logger.info(`Removing session with id: ${e}`);let t=this._tokenStore.sessions.find(t=>t.id===e);if(!t){this._logger.error(`Session with id ${e} not found`);return}let n=this._tokenStore.tokens.find(e=>e.access_token===t.accessToken);if(!n){this._logger.error(`Failed to retrieve token for removed session: ${t.id}`);return}this._tokenStore.update({added:[],removed:[n]}),this._logger.info(`Removed token for session: ${t.id} with scopes: ${t.scopes.join(` `)}`)}dispose(){this._disposable.dispose()}async _createWithUrlHandler(e,t,n){if(!this._serverMetadata.authorization_endpoint)throw Error(`Authorization Endpoint required`);if(!this._serverMetadata.token_endpoint)throw Error(`Token endpoint not available in server metadata`);let r=this.generateRandomString(64),i=await this.generateCodeChallenge(r),a=this.generateRandomString(32),o=w.parse(`${this._initData.environment.appUriScheme}://dynamicauthprovider/${this.authorizationServer.authority}/authorize?nonce=${a}`),s;try{s=await this._extHostUrls.createAppUri(o)}catch(e){throw Error(`Failed to create external URI: ${e}`)}let c=new URL(this._serverMetadata.authorization_endpoint);c.searchParams.append(`client_id`,this._clientId),c.searchParams.append(`response_type`,`code`),c.searchParams.append(`state`,s.toString()),c.searchParams.append(`code_challenge`,i),c.searchParams.append(`code_challenge_method`,`S256`);let l=e.join(` `);l&&c.searchParams.append(`scope`,l),this._resourceMetadata?.resource&&c.searchParams.append(`resource`,this._resourceMetadata.resource);let u=`https://vscode.dev/redirect`;c.searchParams.append(`redirect_uri`,u);let d=this.waitForAuthorizationCode(o);this._logger.info(`Opening authorization URL for scopes: ${l}`),this._logger.trace(`Authorization URL: ${c.toString()}`);let f=await this._extHostWindow.openUri(c.toString(),{});if(!f)throw new oe;t.report({message:C(2621,`Complete the authentication in the browser window that has opened.`)});let p;try{let e=await lo(d,n);p=e.code}catch(e){throw ae(e)?(this._logger.info(`Authorization code request was cancelled by the user.`),e):(this._logger.error(`Failed to receive authorization code: ${e}`),Error(`Failed to receive authorization code: ${e}`))}this._logger.info(`Authorization code received for scopes: ${l}`);let ee=await this.exchangeCodeForToken(p,r,u);return ee}generateRandomString(e){let t=new Uint8Array(e);return crypto.getRandomValues(t),Array.from(t).map(e=>e.toString(16).padStart(2,`0`)).join(``).substring(0,e)}async generateCodeChallenge(e){let t=new TextEncoder,n=t.encode(e),r=await crypto.subtle.digest(`SHA-256`,n);return Gt(b.wrap(new Uint8Array(r)),!1,!1).replace(/\+/g,`-`).replace(/\//g,`_`).replace(/=+$/,``)}async waitForAuthorizationCode(e){let t=await this._proxy.$waitForUriHandler(e),n=/[?&]code=([^&]+)/.exec(t.query||``);if(!n||n.length<2)throw Error(`Authentication failed: No authorization code received`);return{code:n[1]}}async exchangeCodeForToken(e,t,n){if(!this._serverMetadata.token_endpoint)throw Error(`Token endpoint not available in server metadata`);let r=new URLSearchParams;r.append(`client_id`,this._clientId),r.append(`grant_type`,`authorization_code`),r.append(`code`,e),r.append(`redirect_uri`,n),r.append(`code_verifier`,t),this._clientSecret&&r.append(`client_secret`,this._clientSecret),this._logger.info(`Exchanging authorization code for token...`),this._logger.trace(`Url: ${this._serverMetadata.token_endpoint}`),this._logger.trace(`Token request body: ${r.toString()}`);let i;try{i=await fetch(this._serverMetadata.token_endpoint,{method:`POST`,headers:{"Content-Type":`application/x-www-form-urlencoded`,Accept:`application/json`},body:r.toString()})}catch(e){throw this._logger.error(`Failed to exchange authorization code for token: ${e}`),Error(`Failed to exchange authorization code for token: ${e}`)}if(!i.ok){let e=await i.text();throw Error(`Token exchange failed: ${i.status} ${i.statusText} - ${e}`)}let a=await i.json();if(CN(a))return this._logger.info(`Successfully exchanged authorization code for token.`),a;throw wN(a)&&a.error===_N.InvalidClient?(this._logger.warn(`Client ID (${this._clientId}) was invalid, generated a new one.`),await this._generateNewClientId(),Error(`Client ID was invalid, generated a new one. Please try again.`)):Error(`Invalid authorization token response: ${JSON.stringify(a)}`)}async exchangeRefreshTokenForToken(e){if(!this._serverMetadata.token_endpoint)throw Error(`Token endpoint not available in server metadata`);let t=new URLSearchParams;t.append(`client_id`,this._clientId),t.append(`grant_type`,`refresh_token`),t.append(`refresh_token`,e),this._clientSecret&&t.append(`client_secret`,this._clientSecret);let n=await fetch(this._serverMetadata.token_endpoint,{method:`POST`,headers:{"Content-Type":`application/x-www-form-urlencoded`,Accept:`application/json`},body:t.toString()}),r=await n.json();if(CN(r))return{...r,created_at:Date.now()};throw wN(r)&&r.error===_N.InvalidClient?(this._logger.warn(`Client ID (${this._clientId}) was invalid, generated a new one.`),await this._generateNewClientId(),Error(`Client ID was invalid, generated a new one. Please try again.`)):Error(`Invalid authorization token response: ${JSON.stringify(r)}`)}async _generateNewClientId(){try{let e=await kN(this._serverMetadata,this._initData.environment.appName,this._resourceMetadata?.scopes_supported);this._clientId=e.client_id,this._clientSecret=e.client_secret,this._onDidChangeClientId.fire()}catch(e){this._logger.info(`Dynamic registration failed for ${this.authorizationServer.toString()}: ${e}. Prompting user for client ID and client secret.`);try{let e=await this._proxy.$promptForClientRegistration(this.authorizationServer.toString());if(!e)throw Error(`User did not provide client details`);this._clientId=e.clientId,this._clientSecret=e.clientSecret,this._logger.info(`User provided client ID for ${this.authorizationServer.toString()}`),e.clientSecret?this._logger.info(`User provided client secret for ${this.authorizationServer.toString()}`):this._logger.info(`User did not provide client secret for ${this.authorizationServer.toString()} (optional)`),this._onDidChangeClientId.fire()}catch{throw this._logger.error(`Failed to fetch new client ID and user did not provide one: ${e}`),Error(`Failed to fetch new client ID and user did not provide one: ${e}`)}}}};JN=A([j(0,PN),j(1,LN),j(2,ks),j(3,VN),j(4,Ss)],JN);var YN=class{constructor(e,t,n){this._persistence=e,this._logger=n,this._onDidChangeSessions=new x,this.onDidChangeSessions=this._onDidChangeSessions.event,this._disposable=new v,this._tokensObservable=EE(`tokens`,t),this._sessionsObservable=bE({equalsFn:(e,t)=>ge(e,t,(e,t)=>e.accessToken===t.accessToken)},e=>this._tokensObservable.read(e).map(e=>this._getSessionFromToken(e))),this._disposable.add(this._registerChangeEventAutorun()),this._disposable.add(this._persistence.onDidChange(e=>this._tokensObservable.set(e,void 0)))}get tokens(){return this._tokensObservable.get()}get sessions(){return this._sessionsObservable.get()}dispose(){this._disposable.dispose()}update({added:e,removed:t}){this._logger.trace(`Updating tokens: added ${e.length}, removed ${t.length}`);let n=[...this._tokensObservable.get()];for(let e of t){let t=n.findIndex(t=>t.access_token===e.access_token);t!==-1&&n.splice(t,1)}for(let t of e){let e=n.findIndex(e=>e.access_token===t.access_token);e===-1?n.push(t):n[e]=t}(e.length||t.length)&&(this._tokensObservable.set(n,void 0),this._persistence.set(n)),this._logger.trace(`Tokens updated: ${n.length} tokens stored.`)}_registerChangeEventAutorun(){let e=[];return xE(t=>{this._logger.trace(`Checking for session changes...`);let n=this._sessionsObservable.read(t);if(e===n){this._logger.trace(`No session changes detected.`);return}if(!n||n.length===0){this._logger.trace(`All sessions removed.`),e.length>0&&(this._onDidChangeSessions.fire({added:[],removed:e,changed:[]}),e=[]);return}let r=[],i=[];for(let t of n){let n=e.some(e=>e.accessToken===t.accessToken);n||r.push(t)}for(let t of e){let e=n.some(e=>e.accessToken===t.accessToken);e||i.push(t)}(r.length>0||i.length>0)&&(this._logger.trace(`Sessions changed: added ${r.length}, removed ${i.length}`),this._onDidChangeSessions.fire({added:r,removed:i,changed:[]})),e=n})}_getSessionFromToken(e){let t;if(e.id_token)try{t=jN(e.id_token)}catch{}if(!t)try{t=jN(e.access_token)}catch{}let n=e.scope?e.scope.split(` `):t?.scope?t.scope.split(` `):[];return{id:mh(e.access_token,0).toString(),accessToken:e.access_token,account:{id:t?.sub||`unknown`,label:t?.preferred_username||t?.name||t?.email||`MCP`},scopes:n,idToken:e.id_token}}};const XN={label:C(5437,`Other Models`),order:2**53-1};var ZN;const QN=k(`IExtHostLanguageModels`);var $N=class{constructor(e,t){this.option=e,this.stream=new Lo,this.stream=t??new Lo}},eP=class{constructor(){this._responseStreams=new Map,this._defaultStream=new Lo,this._isDone=!1;let e=this;this.apiObject={get stream(){return e._defaultStream.asyncIterable},get text(){return Io.map(e._defaultStream.asyncIterable,e=>{if(e instanceof CT)return e.value}).coalesce()}}}*_streams(){if(this._responseStreams.size>0)for(let[,e]of this._responseStreams)yield e.stream;else yield this._defaultStream}handleFragment(e){if(this._isDone)return;let t=new Map;for(let n of pt.wrap(e)){let e;e=n.part.type===`text`?new CT(n.part.value,n.part.audience):n.part.type===`data`?new CT(``):new xT(n.part.toolCallId,n.part.name,n.part.parameters);let r=t.get(n.index);r?r.push(e):t.set(n.index,[e])}for(let[e,n]of t){let t=this._responseStreams.get(e);t||(t=this._responseStreams.size===0?new $N(e,this._defaultStream):new $N(e),this._responseStreams.set(e,t)),t.stream.emitMany(n)}}reject(e){this._isDone=!0;for(let t of this._streams())t.reject(e)}resolve(){this._isDone=!0;for(let e of this._streams())e.resolve()}};let tP=class{static{ZN=this}static{this._idPool=1}constructor(e,t,n){this._logService=t,this._extHostAuthentication=n,this._onDidChangeModelAccess=new x,this._onDidChangeProviders=new x,this.onDidChangeProviders=this._onDidChangeProviders.event,this._languageModelProviders=new Map,this._localModels=new Map,this._modelAccessList=new gs,this._pendingRequest=new Map,this._ignoredFileProviders=new Map,this._languageAccessInformationExtensions=new Set,this._proxy=e.getProxy(E.MainThreadLanguageModels)}dispose(){this._onDidChangeModelAccess.dispose(),this._onDidChangeProviders.dispose()}registerLanguageModelProvider(e,t,n){this._languageModelProviders.set(t,{extension:e.identifier,extensionName:e.displayName||e.name,provider:n}),this._proxy.$registerLanguageModelProvider(t);let r;return n.onDidChange&&(r=n.onDidChange(()=>{this._proxy.$onLMProviderChange(t)})),_(()=>{this._languageModelProviders.delete(t),this._clearModelCache(t),r?.dispose(),this._proxy.$unregisterProvider(t)})}_clearModelCache(e){this._localModels.forEach((t,n)=>{t.metadata.vendor===e&&this._localModels.delete(n)})}async $prepareLanguageModelProvider(e,t,n){let r=this._languageModelProviders.get(e);if(!r)return[];this._clearModelCache(e);let i=await r.provider.prepareLanguageModelChat(t,n)??[],a=i.map(t=>{let n;return t.auth&&(n={providerLabel:r.extensionName,accountLabel:typeof t.auth==`object`?t.auth.label:void 0}),{metadata:{extension:r.extension,id:t.id,vendor:e,name:t.name??``,family:t.family??``,cost:t.cost,description:t.description,version:t.version,maxInputTokens:t.maxInputTokens,maxOutputTokens:t.maxOutputTokens,auth:n,isDefault:t.isDefault,isUserSelectable:t.isUserSelectable,modelPickerCategory:t.category??XN,capabilities:t.capabilities?{vision:t.capabilities.vision,toolCalling:!!t.capabilities.toolCalling,agentMode:!!t.capabilities.toolCalling}:void 0},identifier:`${e}/${t.id}`}});for(let e=0;e<a.length;e++)this._localModels.set(a[e].identifier,{metadata:a[e].metadata,info:i[e]});return a}async $startChatRequest(e,t,n,r,i,a){let o=this._localModels.get(e);if(!o)throw Error(`Model not found`);let s=this._languageModelProviders.get(o.metadata.vendor);if(!s)throw Error(`Language model provider for '${o.metadata.id}' not found.`);let c=[],l=()=>{c.length>0&&(this._proxy.$reportResponsePart(t,c),c.length=0)},u=new Do(l,30),d=e=>{let t=c.push(e);t>30?(l(),u.cancel()):u.schedule()},f=new ym(async e=>{if(a.isCancellationRequested){this._logService.warn(`[CHAT](${s.extension.value}) CANNOT send progress because the REQUEST IS CANCELLED`);return}let t;if(e.part instanceof xT?t={type:`tool_use`,name:e.part.name,parameters:e.part.input,toolCallId:e.part.callId}:e.part instanceof CT?t={type:`text`,value:e.part.value,audience:e.part.audience}:e.part instanceof wT&&(t={type:`data`,value:{mimeType:e.part.mimeType,data:b.wrap(e.part.data)},audience:e.part.audience}),!t){this._logService.warn(`[CHAT](${s.extension.value}) UNKNOWN part ${JSON.stringify(e)}`);return}d({index:e.index,part:t})}),p;try{p=s.provider.provideLanguageModelChatResponse(o.info,r.value.map($O.to),{...i,modelOptions:i.modelOptions??{},extensionId:ms.toKey(n)},f,a)}catch(e){throw e}Promise.resolve(p).then(()=>{l(),this._proxy.$reportResponseDone(t,void 0)},e=>{l(),this._proxy.$reportResponseDone(t,ne(e))})}$provideTokenLength(e,t,n){let r=this._localModels.get(e);if(!r)return Promise.resolve(0);let i=this._languageModelProviders.get(r.metadata.vendor);return i?Promise.resolve(i.provider.provideTokenCount(r.info,t,n)):Promise.resolve(0)}async getDefaultLanguageModel(e,t){let n;t&&await this.selectLanguageModels(e,{});for(let[e,t]of this._localModels)if(t.metadata.isDefault){n=e;break}return n?this.getLanguageModelByIdentifier(e,n):this.getDefaultLanguageModel(e,!0)}async getLanguageModelByIdentifier(e,t){let n=this._localModels.get(t);if(!n)return;this._isUsingAuth(e.identifier,n.metadata)&&await this._fakeAuthPopulate(n.metadata);let r;if(!r){let i=this;r={id:n.info.id,vendor:n.metadata.vendor,family:n.info.family,version:n.info.version,name:n.info.name,capabilities:{supportsImageToText:n.metadata.capabilities?.vision??!1,supportsToolCalling:!!n.metadata.capabilities?.toolCalling},maxInputTokens:n.metadata.maxInputTokens,countTokens(e,n){if(!i._localModels.has(t))throw DT.NotFound(t);return i._computeTokenLength(t,e,n??Oi.None)},sendRequest(n,r,a){if(!i._localModels.has(t))throw DT.NotFound(t);return i._sendChatRequest(e,t,n,r??{},a??Oi.None)}}}return r}async selectLanguageModels(e,t){let n=await this._proxy.$selectChatModels({...t,extension:e.identifier}),r=[];for(let t of n){let n=await this.getLanguageModelByIdentifier(e,t);n&&r.push(n)}return r}async _sendChatRequest(e,t,n,r,i){let a=this._convertMessages(e,n),o=e.identifier,s=this._localModels.get(t)?.metadata;if(!s||!this._localModels.has(t))throw DT.NotFound(`Language model '${t}' is unknown.`);if(this._isUsingAuth(o,s)){let n=await this._getAuthAccess(e,{identifier:s.extension,displayName:s.auth.providerLabel},r.justification,!1);if(!n||!this._modelAccessList.get(o)?.has(s.extension))throw DT.NoPermissions(`Language model '${t}' cannot be used by '${o.value}'.`)}let c=Math.random()*1e6|0,l=new eP;this._pendingRequest.set(c,{languageModelId:t,res:l});try{await this._proxy.$tryStartChatRequest(o,t,c,new hi(a),r,i)}catch(e){throw this._pendingRequest.delete(c),DT.tryDeserialize(e)??e}return l.apiObject}_convertMessages(e,t){let n=[];for(let r of t)r.role===hT.System&&U(e,`languageModelSystem`),n.push($O.from(r));return n}async $acceptResponsePart(e,t){let n=this._pendingRequest.get(e);n&&n.res.handleFragment(t)}async $acceptResponseDone(e,t){let n=this._pendingRequest.get(e);n&&(this._pendingRequest.delete(e),t?n.res.reject(DT.tryDeserialize(t)??re(t)):n.res.resolve())}async _getAuthAccess(e,t,n,r){let i=`__`+t.identifier.value,a=await this._extHostAuthentication.getSession(e,i,[],{silent:!0});if(a)return this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}]),!0;if(r)return!1;try{let r=n?C(2627,`Justification: {1}`,t.displayName,n):void 0;return await this._extHostAuthentication.getSession(e,i,[],{forceNewSession:{detail:r}}),this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}]),!0}catch{return!1}}_isUsingAuth(e,t){return!!t.auth&&!ms.equals(t.extension,e)}async _fakeAuthPopulate(e){if(e.auth)for(let t of this._languageAccessInformationExtensions)try{await this._getAuthAccess(t,{identifier:e.extension,displayName:``},void 0,!0)}catch(e){this._logService.error(`Fake Auth request failed`),this._logService.error(e)}}async _computeTokenLength(e,t,n){let r=this._localModels.get(e);if(!r)throw DT.NotFound(`Language model '${e}' is unknown.`);return this._languageModelProviders.get(r.metadata.vendor)?.provider.provideTokenCount(r.info,t,n)??0}$updateModelAccesslist(e){let t=[];for(let{from:n,to:r,enabled:i}of e){let e=this._modelAccessList.get(n)??new hs,a=e.has(r);if(a!==i){i?e.add(r):e.delete(r),this._modelAccessList.set(n,e);let a={from:n,to:r};t.push(a),this._onDidChangeModelAccess.fire(a)}}}createLanguageModelAccessInformation(e){this._languageAccessInformationExtensions.add(e);let t=en.signal(en.filter(this._onDidChangeModelAccess.event,t=>ms.equals(t.from,e.identifier))),n=en.signal(this._onDidChangeProviders.event);return{get onDidChange(){return en.any(t,n)},canSendRequest(e){return!0}}}fileIsIgnored(e,t,n=Oi.None){return U(e,`chatParticipantAdditions`),this._proxy.$fileIsIgnored(t,n)}async $isFileIgnored(e,t,n){let r=this._ignoredFileProviders.get(e);if(!r)throw Error(`Unknown LanguageModelIgnoredFileProvider`);return await r.provideFileIgnored(w.revive(t),n)??!1}registerIgnoredFileProvider(e,t){U(e,`chatParticipantPrivate`);let n=ZN._idPool++;return this._proxy.$registerFileIgnoreProvider(n),this._ignoredFileProviders.set(n,t),_(()=>{this._proxy.$unregisterFileIgnoreProvider(n),this._ignoredFileProviders.delete(n)})}};tP=ZN=A([j(0,Is),j(1,xs),j(2,GN)],tP);const nP=3600*24;nP*7,nP*30,nP*365;function rP(e){return e.getFullYear()+`-`+String(e.getMonth()+1).padStart(2,`0`)+`-`+String(e.getDate()).padStart(2,`0`)+`T`+String(e.getHours()).padStart(2,`0`)+`:`+String(e.getMinutes()).padStart(2,`0`)+`:`+String(e.getSeconds()).padStart(2,`0`)+`.`+(e.getMilliseconds()/1e3).toFixed(3).slice(2,5)+`Z`}const iP={DateTimeFormat(e,t){return new u(()=>{try{return new Intl.DateTimeFormat(e,t)}catch{return new Intl.DateTimeFormat(void 0,t)}})},Collator(e,t){return new u(()=>{try{return new Intl.Collator(e,t)}catch{return new Intl.Collator(void 0,t)}})},Segmenter(e,t){return new u(()=>{try{return new Intl.Segmenter(e,t)}catch{return new Intl.Segmenter(void 0,t)}})},Locale(e,t){return new u(()=>{try{return new Intl.Locale(e,t)}catch{return new Intl.Locale(`en`,t)}})},NumberFormat(e,t){return new u(()=>{try{return new Intl.NumberFormat(e,t)}catch{return new Intl.NumberFormat(void 0,t)}})}};var aP=class e{constructor(t){let n=Pi(t);this._defaultValue=n,this._asciiMap=e._createAsciiMap(n),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256);return t.fill(e),t}set(e,t){let n=Pi(t);e>=0&&e<256?this._asciiMap[e]=n:this._map.set(e,n)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}},oP;(function(e){e[e.False=0]=`False`,e[e.True=1]=`True`})(oP||={});var sP;(function(e){e[e.Regular=0]=`Regular`,e[e.Whitespace=1]=`Whitespace`,e[e.WordSeparator=2]=`WordSeparator`})(sP||={});var cP=class extends aP{constructor(e,t){super(sP.Regular),this._segmenter=null,this._cachedLine=null,this._cachedSegments=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=iP.Segmenter(this.intlSegmenterLocales,{granularity:`word`}):this._segmenter=null;for(let t=0,n=e.length;t<n;t++)this.set(e.charCodeAt(t),sP.WordSeparator);this.set(S.Space,sP.Whitespace),this.set(S.Tab,sP.Whitespace)}findPrevIntlWordBeforeOrAtOffset(e,t){let n=null;for(let r of this._getIntlSegmenterWordsOnLine(e)){if(r.index>t)break;n=r}return n}findNextIntlWordAtOrAfterOffset(e,t){for(let n of this._getIntlSegmenterWordsOnLine(e)){if(n.index<t)continue;return n}return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.value.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){let t=[];for(let n of e)this._isWordLike(n)&&t.push(n);return t}_isWordLike(e){return!!e.isWordLike}};const lP=new We(10);function uP(e,t){let n=`${e}/${t.join(`,`)}`,r=lP.get(n);return r||(r=new cP(e,t),lP.set(n,r)),r}var dP=class{constructor(e,t,n,r){this.searchString=e,this.isRegex=t,this.matchCase=n,this.wordSeparators=r}parseSearchRequest(){if(this.searchString===``)return null;let e;e=this.isRegex?fP(this.searchString):this.searchString.indexOf(`
`)>=0;let t=null;try{t=Ui(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let n=!this.isRegex&&!e;return n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(n=this.matchCase),new fm(t,this.wordSeparators?uP(this.wordSeparators,[]):null,n?this.searchString:null)}};function fP(e){if(!e||e.length===0)return!1;for(let t=0,n=e.length;t<n;t++){let r=e.charCodeAt(t);if(r===S.LineFeed)return!0;if(r===S.Backslash){if(t++,t>=n)break;let r=e.charCodeAt(t);if(r===S.n||r===S.r||r===S.W)return!0}}return!1}function pP(e,t,n){if(!n)return new cm(e,null);let r=[];for(let e=0,n=t.length;e<n;e++)r[e]=t[e];return new cm(e,r)}function mP(e,t,n,r,i){if(r===0)return!0;let a=t.charCodeAt(r-1);if(e.get(a)!==sP.Regular||a===S.CarriageReturn||a===S.LineFeed)return!0;if(i>0){let n=t.charCodeAt(r);if(e.get(n)!==sP.Regular)return!0}return!1}function hP(e,t,n,r,i){if(r+i===n)return!0;let a=t.charCodeAt(r+i);if(e.get(a)!==sP.Regular||a===S.CarriageReturn||a===S.LineFeed)return!0;if(i>0){let n=t.charCodeAt(r+i-1);if(e.get(n)!==sP.Regular)return!0}return!1}function gP(e,t,n,r,i){return mP(e,t,n,r,i)&&hP(e,t,n,r,i)}var _P=class{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){let t=e.length,n;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(n=this._searchRegex.exec(e),!n))return null;let r=n.index,i=n[0].length;if(r===this._prevMatchStartIndex&&i===this._prevMatchLength){if(i===0){aa(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=r,this._prevMatchLength=i,!this._wordSeparators||gP(this._wordSeparators,e,t,r,i))return n}while(n);return null}};const vP=k(`contextService`),yP=k(`editorGroupsService`),bP=k(`pathService`);function xP(e){return typeof e==`object`&&`uri`in e&&`pattern`in e}let SP=class{constructor(e,t,n,r,i,a){this.configurationService=e,this.workspaceContextService=t,this.editorGroupsService=n,this.logService=r,this.pathService=i,this.uriIdentityService=a}aiText(e,t,n={}){let r=this.commonQuery(t?.map(Ac),n);return{...r,type:$k.aiText,contentPattern:e}}text(e,t,n={}){e=this.getContentPattern(e,n);let r=this.configurationService.getValue(),i=t&&t.some(e=>{let t=this.configurationService.getValue({resource:e});return!t.search.useRipgrep}),a=this.commonQuery(t?.map(Ac),n);return{...a,type:$k.Text,contentPattern:e,previewOptions:n.previewOptions,maxFileSize:n.maxFileSize,usePCRE2:r.search.usePCRE2||i||!1,surroundingContext:n.surroundingContext,userDisabledExcludesAndIgnoreFiles:n.disregardExcludeSettings&&n.disregardIgnoreFiles}}getContentPattern(e,t){let n=this.configurationService.getValue();e.isRegExp&&(e.pattern=e.pattern.replace(/\r?\n/g,`\\n`));let r={...e,wordSeparators:n.editor.wordSeparators};return this.isCaseSensitive(e,t)&&(r.isCaseSensitive=!0),this.isMultiline(e)&&(r.isMultiline=!0),t.notebookSearchConfig?.includeMarkupInput&&(r.notebookInfo||={},r.notebookInfo.isInNotebookMarkdownInput=t.notebookSearchConfig.includeMarkupInput),t.notebookSearchConfig?.includeMarkupPreview&&(r.notebookInfo||={},r.notebookInfo.isInNotebookMarkdownPreview=t.notebookSearchConfig.includeMarkupPreview),t.notebookSearchConfig?.includeCodeInput&&(r.notebookInfo||={},r.notebookInfo.isInNotebookCellInput=t.notebookSearchConfig.includeCodeInput),t.notebookSearchConfig?.includeOutput&&(r.notebookInfo||={},r.notebookInfo.isInNotebookCellOutput=t.notebookSearchConfig.includeOutput),r}file(e,t={}){let n=this.commonQuery(e,t);return{...n,type:$k.File,filePattern:t.filePattern?t.filePattern.trim():t.filePattern,exists:t.exists,sortByScore:t.sortByScore,cacheKey:t.cacheKey,shouldGlobMatchFilePattern:t.shouldGlobSearch}}handleIncludeExclude(e,t){if(!e)return{};if(Array.isArray(e)){if(e=e.filter(e=>e.length>0).map(DP),!e.length)return{}}else e=DP(e);return t?this.parseSearchPaths(e):{pattern:wP(...Array.isArray(e)?e:[e])}}commonQuery(e=[],t={}){let n=Array.isArray(t.excludePattern)?t.excludePattern.map(e=>e.pattern).flat():t.excludePattern;n=n?.length===1?n[0]:n;let r=this.handleIncludeExclude(t.includePattern,t.expandPatterns),i=this.handleIncludeExclude(n,t.expandPatterns),a=e.length>1,o=(r.searchPaths&&r.searchPaths.length?r.searchPaths.map(e=>this.getFolderQueryForSearchPath(e,t,i)):e.map(e=>this.getFolderQueryForRoot(e,t,i,a))).filter(e=>!!e),s={_reason:t._reason,folderQueries:o,usingSearchPaths:!!(r.searchPaths&&r.searchPaths.length),extraFileResources:t.extraFileResources,excludePattern:i.pattern,includePattern:r.pattern,onlyOpenEditors:t.onlyOpenEditors,maxResults:t.maxResults,onlyFileScheme:t.onlyFileScheme};if(t.onlyOpenEditors){let e=be(this.editorGroupsService.groups.flatMap(e=>e.editors.map(e=>e.resource)));this.logService.trace(`QueryBuilder#commonQuery - openEditor URIs`,JSON.stringify(e));let t=e.filter(e=>uA(s,e.fsPath)),n=this.commonQueryFromFileList(t);return this.logService.trace(`QueryBuilder#commonQuery - openEditor Query`,JSON.stringify(n)),{...s,...n}}let c=t.extraFileResources&&t.extraFileResources.filter(e=>uA(s,e.fsPath));return s.extraFileResources=c&&c.length?c:void 0,s}commonQueryFromFileList(e){let t=[],n=new ze,r={},i=!1;return e.forEach(e=>{if(e.scheme===O.walkThrough)return;let a=to(e);if(a){let r=this.workspaceContextService.getWorkspaceFolder(e)?.uri??this.uriIdentityService.extUri.dirname(e),a=n.get(r);a||(i=!0,a={folder:r,includePattern:{}},t.push(a),n.set(r,a));let o=Hr(r.fsPath,e.fsPath);st(a.includePattern)[o.replace(/\\/g,`/`)]=!0}else e.fsPath&&(i=!0,r[e.fsPath]=!0)}),{folderQueries:t,includePattern:r,usingSearchPaths:!0,excludePattern:i?void 0:{"**/*":!0}}}isCaseSensitive(e,t){if(t.isSmartCase){if(e.isRegExp){if(Sa(e.pattern,!0))return!0}else if(Sa(e.pattern))return!0}return!!e.isCaseSensitive}isMultiline(e){return e.isMultiline||e.isRegExp&&fP(e.pattern)||e.pattern.indexOf(`
`)>=0?!0:!!e.isMultiline}parseSearchPaths(e){let t=e=>zr(e)||/^\.\.?([\/\\]|$)/.test(e),n=Array.isArray(e)?e:TP(e),r=n.map(e=>{let t=this.pathService.resolvedUserHome;return t?S_(e,t.scheme===O.file?t.fsPath:t.path):e}),i=Me(r,e=>t(e)?`searchPaths`:`exprSegments`),a=(i.exprSegments||[]).map(e=>Hi(e,`/`)).map(e=>Hi(e,`\\`)).map(e=>(e[0]===`.`&&(e=`*`+e),EP(e))),o={},s=this.expandSearchPathPatterns(i.searchPaths||[]);s&&s.length&&(o.searchPaths=s);let c=a.flat(),l=wP(...c);return l&&(o.pattern=l),o}getExcludesForFolder(e,t){return t.disregardExcludeSettings?void 0:lA(e,!t.disregardSearchExcludeSettings)}expandSearchPathPatterns(e){if(!e||!e.length)return[];let t=e.flatMap(e=>{let{pathPortion:t,globPortion:n}=CP(e);n&&=OP(n);let r=this.expandOneSearchPath(t);return r.flatMap(e=>this.resolveOneSearchPathPattern(e,n))}),n=new Map;return t.forEach(e=>{let t=e.searchPath.toString(),r=n.get(t);r?e.pattern&&(r.pattern=r.pattern||{},r.pattern[e.pattern]=!0):n.set(t,{searchPath:e.searchPath,pattern:e.pattern?wP(e.pattern):void 0})}),Array.from(n.values())}expandOneSearchPath(e){if(zr(e)){let t=this.workspaceContextService.getWorkspace().folders;return t[0]&&t[0].uri.scheme!==O.file?[{searchPath:t[0].uri.with({path:e})}]:[{searchPath:w.file(Rr(e))}]}if(this.workspaceContextService.getWorkbenchState()===Dc.FOLDER){let t=this.workspaceContextService.getWorkspace().folders[0].uri;if(e=DP(e),e.startsWith(`../`)||e===`..`){let n=Lr.resolve(t.path,e);return[{searchPath:t.with({path:n})}]}let n=OP(e);return[{searchPath:t,pattern:n}]}else if(e===`./`||e===`.\\`)return[];else{let t=e.replace(/^\.[\/\\]/,``),n=this.workspaceContextService.getWorkspace().folders,r=n.map(e=>{let n=t.match(RegExp(`^${zi(e.name)}(?:/(.*)|$)`));return n?{match:n,folder:e}:null}).filter(it);if(r.length)return r.map(e=>{let t=e.match[1];return{searchPath:e.folder.uri,pattern:t&&OP(t)}});{let t=e.match(/\.[\/\\](.+)[\/\\]?/),n=t?t[1]:e,r=C(13385,`Workspace folder does not exist: {0}`,n);throw Error(r)}}}resolveOneSearchPathPattern(e,t){let n=e.pattern&&t?`${e.pattern}/${t}`:e.pattern||t,r=[{searchPath:e.searchPath,pattern:n}];return n&&!n.endsWith(`**`)&&r.push({searchPath:e.searchPath,pattern:n+`/**`}),r}getFolderQueryForSearchPath(e,t,n){let r=this.getFolderQueryForRoot(Ac(e.searchPath),t,n,!1);return r?{...r,includePattern:e.pattern}:null}getFolderQueryForRoot(e,t,n,r){let i,a=w.isUri(e)?e:e.uri,o=t.excludePattern?.map(n=>{let r=t.excludePattern&&xP(n)?n.uri:void 0,i=!r||!(w.isUri(e)&&this.uriIdentityService.extUri.isEqual(e,r));return i?r:void 0});if(o?.length||(o=[void 0]),n.searchPaths){let e=n.searchPaths.filter(e=>Ja(e.searchPath,a))[0];if(e&&!e.pattern)return null;e&&(i=e.pattern)}let s=this.configurationService.getValue({resource:a}),c=this.getExcludesForFolder(s,t),l={...c||{},...i||{}},u=w.isUri(e)?Xa(e):e.name,d=o.map(e=>Object.keys(l).length>0?{folder:e,pattern:l}:void 0).filter(e=>e);return{folder:a,folderName:r?u:void 0,excludePattern:d,fileEncoding:s.files&&s.files.encoding,disregardIgnoreFiles:typeof t.disregardIgnoreFiles==`boolean`?t.disregardIgnoreFiles:!s.search?.useIgnoreFiles,disregardGlobalIgnoreFiles:typeof t.disregardGlobalIgnoreFiles==`boolean`?t.disregardGlobalIgnoreFiles:!s.search?.useGlobalIgnoreFiles,disregardParentIgnoreFiles:typeof t.disregardParentIgnoreFiles==`boolean`?t.disregardParentIgnoreFiles:!s.search?.useParentIgnoreFiles,ignoreSymlinks:typeof t.ignoreSymlinks==`boolean`?t.ignoreSymlinks:!s.search?.followSymlinks}}};SP=A([j(0,$j),j(1,vP),j(2,yP),j(3,xs),j(4,bP),j(5,Sh)],SP);function CP(e){let t=e.match(/[\*\{\}\(\)\[\]\?]/);if(t){let n=t.index,r=e.substr(0,n).match(/[/|\\][^/\\]*$/);if(r){let t=e.substr(0,r.index);return t.match(/[/\\]/)||(t+=`/`),{pathPortion:t,globPortion:e.substr((r.index||0)+1)}}}return{pathPortion:e}}function wP(...e){return e.length?e.reduce((e,t)=>(e[t]=!0,e),Object.create(null)):void 0}function TP(e){return lv(e,`,`).map(e=>e.trim()).filter(e=>!!e.length)}function EP(e){let t=[`**/${e}/**`,`**/${e}`];return t.map(e=>e.replace(/\*\*\/\*\*/g,`**`))}function DP(e){return e.replace(/\\/g,`/`)}function OP(e){return DP(e).replace(/^\.\//,``).replace(/\/+$/g,``)}k(`searchService`);function kP(e,t){let n=t.activationEvents;if(!n)return Promise.resolve(void 0);let r=[],i=[];for(let t of n)if(/^workspaceContains:/.test(t)){let n=t.substr(18);n.indexOf(`*`)>=0||n.indexOf(`?`)>=0||e.forceUsingSearch?i.push(n):r.push(n)}if(r.length===0&&i.length===0)return Promise.resolve(void 0);let{promise:a,resolve:o}=fo(),s=e=>o({activationEvent:e}),c=Promise.all(r.map(t=>AP(e,t,s))).then(()=>{}),l=jP(e,t.identifier,i,s);return Promise.all([c,l]).then(()=>{o(void 0)}),a}async function AP(e,t,n){for(let r of e.folders)if(await e.exists($a(w.revive(r),t))){n(`workspaceContains:${t}`);return}}async function jP(e,t,n,r){if(n.length===0)return Promise.resolve(void 0);let i=new Ai,a=e.checkExists(e.folders,n,i.token),o=setTimeout(async()=>{i.cancel(),e.logService.info(`Not activating extension '${t.value}': Timed out while searching for 'workspaceContains' pattern ${n.join(`,`)}`)},7e3),s=!1;try{s=await a}catch(e){ae(e)||m(e)}i.dispose(),clearTimeout(o),s&&r(`workspaceContains:${n.join(`,`)}`)}var MP=class{constructor(e){this._onDidChangePassword=new x,this.onDidChangePassword=this._onDidChangePassword.event,this._proxy=e.getProxy(E.MainThreadSecretState)}async $onDidChangePassword(e){this._onDidChangePassword.fire(e)}get(e,t){return this._proxy.$getPassword(e,t)}store(e,t,n){return this._proxy.$setPassword(e,t,n)}delete(e,t){return this._proxy.$deletePassword(e,t)}keys(e){return this._proxy.$getKeys(e)}};const NP=k(`IExtHostSecretState`);var PP=class{#secretState;constructor(e,t){this.disposables=new v,this._extensionDescription=e,this._id=ms.toKey(e.identifier),this.#secretState=t,this.onDidChange=en.map(en.filter(this.#secretState.onDidChangePassword,e=>e.extensionId===this._id),e=>({key:e.key}),this.disposables)}dispose(){this.disposables.dispose()}get(e){return this.#secretState.get(this._id,e)}store(e,t){return this.#secretState.store(this._id,e,t)}delete(e){return this.#secretState.delete(this._id,e)}keys(){return U(this._extensionDescription,`secretStorageKeys`),this.#secretState.keys(this._id)||[]}};let FP=class{constructor(e,t,n){this.logService=n,this.bundleCache=new Map,this._proxy=t.getProxy(E.MainThreadLocalization),this.currentLanguage=e.environment.appLanguage,this.isDefaultLanguage=this.currentLanguage===`en`}getMessage(e,t){let{message:n,args:r,comment:i}=t;if(this.isDefaultLanguage)return Ri(n,r??{});let a=n;i&&i.length>0&&(a+=`/${Array.isArray(i)?i.join(``):i}`);let o=this.bundleCache.get(e)?.contents[a];return o||this.logService.warn(`Using default string since no string found in i18n bundle that has the key: ${a}`),Ri(o??n,r??{})}getBundle(e){return this.bundleCache.get(e)?.contents}getBundleUri(e){return this.bundleCache.get(e)?.uri}async initializeLocalizedMessages(e){if(this.isDefaultLanguage||!e.l10n&&!e.isBuiltin||this.bundleCache.has(e.identifier.value))return;let t,n=await this.getBundleLocation(e);if(!n){this.logService.error(`No bundle location found for extension ${e.identifier.value}`);return}try{let r=await this._proxy.$fetchBundleContents(n),i=JSON.parse(r);t=e.isBuiltin?i.contents?.bundle:i}catch(t){this.logService.error(`Failed to load translations for ${e.identifier.value} from ${n}: ${t.message}`);return}t&&this.bundleCache.set(e.identifier.value,{contents:t,uri:n})}async getBundleLocation(e){if(e.isBuiltin){let t=await this._proxy.$fetchBuiltInBundleUri(e.identifier.value,this.currentLanguage);return w.revive(t)}return e.l10n?w.joinPath(e.extensionLocation,e.l10n,`bundle.l10n.${this.currentLanguage}.json`):void 0}};FP=A([j(0,ks),j(1,Is),j(2,xs)],FP);const IP=k(`IExtHostLocalizationService`),LP=k(`IExtHostManagedSockets`);let RP=class{constructor(e){this._remoteSocketIdCounter=0,this._factory=null,this._managedRemoteSockets=new Map,this._proxy=e.getProxy(E.MainThreadManagedSockets)}setFactory(e,t){for(let e of this._managedRemoteSockets.values())e.dispose();this._factory&&this._proxy.$unregisterSocketFactory(this._factory.socketFactoryId),this._factory=new zP(e,t),this._proxy.$registerSocketFactory(this._factory.socketFactoryId)}async $openRemoteSocket(e){if(!this._factory||this._factory.socketFactoryId!==e)throw Error(`No socket factory with id ${e}`);let t=++this._remoteSocketIdCounter,n=await this._factory.makeConnection(),r=new v;return this._managedRemoteSockets.set(t,new BP(t,n,r)),r.add(_(()=>this._managedRemoteSockets.delete(t))),r.add(n.onDidEnd(()=>{this._proxy.$onDidManagedSocketEnd(t),r.dispose()})),r.add(n.onDidClose(e=>{this._proxy.$onDidManagedSocketClose(t,e?.stack??e?.message),r.dispose()})),r.add(n.onDidReceiveMessage(e=>this._proxy.$onDidManagedSocketHaveData(t,b.wrap(e)))),t}$remoteSocketWrite(e,t){this._managedRemoteSockets.get(e)?.actual.send(t.buffer)}$remoteSocketEnd(e){let t=this._managedRemoteSockets.get(e);t&&(t.actual.end(),t.dispose())}async $remoteSocketDrain(e){await this._managedRemoteSockets.get(e)?.actual.drain?.()}};RP=A([j(0,Is)],RP);var zP=class{constructor(e,t){this.socketFactoryId=e,this.makeConnection=t}},BP=class extends y{constructor(e,t,n){super(),this.socketId=e,this.actual=t,this._register(n)}},VP;const HP=k(`IHostUtils`);let UP=VP=class extends y{constructor(e,t,n,r,i,a,o,s,c,l,u,d,f){super(),this._extHostManagedSockets=d,this._extHostLanguageModels=f,this._onDidChangeRemoteConnectionData=this._register(new x),this.onDidChangeRemoteConnectionData=this._onDidChangeRemoteConnectionData.event,this._realPathCache=new Map,this._isTerminating=!1,this._hostUtils=t,this._extHostContext=n,this._initData=o,this._extHostWorkspace=r,this._extHostConfiguration=i,this._logService=a,this._extHostTunnelService=c,this._extHostTerminalService=l,this._extHostLocalizationService=u,this._mainThreadWorkspaceProxy=this._extHostContext.getProxy(E.MainThreadWorkspace),this._mainThreadTelemetryProxy=this._extHostContext.getProxy(E.MainThreadTelemetry),this._mainThreadExtensionsProxy=this._extHostContext.getProxy(E.MainThreadExtensionService),this._almostReadyToRunExtensions=new bo,this._readyToStartExtensionHost=new bo,this._readyToRunExtensions=new bo,this._eagerExtensionsActivated=new bo,this._activationEventsReader=new ZP(this._initData.extensions.activationEvents),this._globalRegistry=new jj(this._activationEventsReader,this._initData.extensions.allExtensions);let p=new hs(this._initData.extensions.myExtensions);this._myRegistry=new jj(this._activationEventsReader,YP(this._globalRegistry,p)),ar&&(this._logService.info(`Creating extension host with the following global extensions: ${KP(this._globalRegistry)}`),this._logService.info(`Creating extension host with the following local extensions: ${KP(this._myRegistry)}`)),this._storage=new Wj(this._extHostContext,this._logService),this._secretState=new MP(this._extHostContext),this._storagePath=s,this._instaService=this._store.add(e.createChild(new Os([Gj,this._storage],[NP,this._secretState]))),this._activator=this._register(new Hj(this._myRegistry,this._globalRegistry,{onExtensionActivationError:(e,t,n)=>{this._mainThreadExtensionsProxy.$onExtensionActivationError(e,ne(t),n)},actualActivateExtension:async(e,t)=>{if(jj.isHostExtension(e,this._myRegistry,this._globalRegistry))return await this._mainThreadExtensionsProxy.$activateExtension(e,t),new Bj;let n=this._myRegistry.getExtensionDescription(e);return this._activateExtension(n,t)}},this._logService)),this._extensionPathIndex=null,this._resolvers=Object.create(null),this._started=!1,this._remoteConnectionData=this._initData.remote.connectionData}getRemoteConnectionData(){return this._remoteConnectionData}async initialize(){try{await this._beforeAlmostReadyToRunExtensions(),this._almostReadyToRunExtensions.open(),await this._extHostWorkspace.waitForInitializeCall(),Tn(`code/extHost/ready`),this._readyToStartExtensionHost.open(),this._initData.autoStart&&this._startExtensionHost()}catch(e){m(e)}}async _deactivateAll(){this._storagePath.onWillDeactivateAll();let e=[];try{let t=this._myRegistry.getAllExtensionDescriptions(),n=t.map(e=>e.identifier),r=n.filter(e=>this.isActivated(e));e=r.map(e=>this._deactivate(e))}catch{}await Promise.all(e)}terminate(e,t=0){if(this._isTerminating)return;this._isTerminating=!0,this._logService.info(`Extension host terminating: ${e}`),this._logService.flush(),this._extHostTerminalService.dispose(),this._activator.dispose(),tr&&p(e=>{this._logService.error(e)}),this._extHostContext.dispose();let n=this._deactivateAll();Promise.race([xo(5e3),n]).finally(()=>{this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} exiting with code ${t}`):this._logService.info(`Extension host exiting with code ${t}`),this._logService.flush(),this._logService.dispose(),this._hostUtils.exit(t)})}isActivated(e){return this._readyToRunExtensions.isOpen()?this._activator.isActivated(e):!1}async getExtension(e){let t=await this._mainThreadExtensionsProxy.$getExtension(e);return t&&{...t,identifier:new ms(t.identifier.value),extensionLocation:w.revive(t.extensionLocation)}}_activateByEvent(e,t){return this._activator.activateByEvent(e,t)}_activateById(e,t){return this._activator.activateById(e,t)}activateByIdWithErrors(e,t){return this._activateById(e,t).then(()=>{let t=this._activator.getActivatedExtension(e);if(t.activationFailed)return Promise.reject(t.activationFailedError)})}getExtensionRegistry(){return this._readyToRunExtensions.wait().then(e=>this._myRegistry)}getExtensionExports(e){if(this._readyToRunExtensions.isOpen())return this._activator.getActivatedExtension(e).exports;try{return this._activator.getActivatedExtension(e).exports}catch{return null}}async _realPathExtensionUri(e){if(e.scheme===O.file&&this._hostUtils.fsRealpath){let t=e.fsPath;this._realPathCache.has(t)||this._realPathCache.set(t,this._hostUtils.fsRealpath(t));let n=await this._realPathCache.get(t);return w.file(n)}return e}async getExtensionPathIndex(){return this._extensionPathIndex||=this._createExtensionPathIndex(this._myRegistry.getAllExtensionDescriptions()).then(e=>new XP(e)),this._extensionPathIndex}async _createExtensionPathIndex(e){let t=Js.forUris(e=>Ka.ignorePathCasing(e));return await Promise.all(e.map(async e=>{if(this._getEntryPoint(e)){let n=await this._realPathExtensionUri(e.extensionLocation);t.set(n,e)}})),t}_deactivate(e){let t=Promise.resolve(void 0);if(!this._readyToRunExtensions.isOpen()||!this._activator.isActivated(e))return t;let n=this._activator.getActivatedExtension(e);if(!n)return t;try{typeof n.module.deactivate==`function`&&(t=Promise.resolve(n.module.deactivate()).then(void 0,e=>(this._logService.error(e),Promise.resolve(void 0))))}catch(t){this._logService.error(`An error occurred when deactivating the extension '${e.value}':`),this._logService.error(t)}try{n.disposable.dispose()}catch(t){this._logService.error(`An error occurred when disposing the subscriptions for extension '${e.value}':`),this._logService.error(t)}return t}async _activateExtension(e,t){return this._initData.remote.isRemote?this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier):await this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier),this._doActivateExtension(e,t).then(n=>{let r=n.activationTimes;return this._mainThreadExtensionsProxy.$onDidActivateExtension(e.identifier,r.codeLoadingTime,r.activateCallTime,r.activateResolvedTime,t),this._logExtensionActivationTimes(e,t,`success`,r),n},n=>{throw this._logExtensionActivationTimes(e,t,`failure`),n})}_logExtensionActivationTimes(e,t,n,r){let i=GP(e,t);this._mainThreadTelemetryProxy.$publicLog2(`extensionActivationTimes`,{...i,...r||{},outcome:n})}_doActivateExtension(e,t){let n=GP(e,t);this._mainThreadTelemetryProxy.$publicLog2(`activatePlugin`,n);let r=this._getEntryPoint(e);if(!r)return Promise.resolve(new zj(Ij.NONE));this._logService.info(`ExtensionService#_doActivateExtension ${e.identifier.value}, startup: ${t.startup}, activationEvent: '${t.activationEvent}'${e.identifier.value===t.extensionId.value?``:`, root cause: ${t.extensionId.value}`}`),this._logService.flush();let i=this._isESM(e),a=new v,o=new Lj(t.startup);return Promise.all([i?this._loadESMModule(e,$a(e.extensionLocation,r),o):this._loadCommonJSModule(e,$a(e.extensionLocation,r),o),this._loadExtensionContext(e,a)]).then(t=>(Tn(`code/extHost/willActivateExtension/${e.identifier.value}`),VP._callActivate(this._logService,e.identifier,t[0],t[1],a,o))).then(t=>(Tn(`code/extHost/didActivateExtension/${e.identifier.value}`),t))}_loadExtensionContext(e,t){let n=this._extHostLanguageModels.createLanguageModelAccessInformation(e),r=t.add(new qj(e,this._storage)),i=t.add(new Kj(e.identifier.value,!1,this._storage)),a=t.add(new PP(e,this._secretState)),o=e.isUnderDevelopment?this._initData.environment.extensionTestsLocationURI?QC.Test:QC.Development:QC.Production,s=this._initData.remote.isRemote?jC.Workspace:jC.UI;return this._logService.trace(`ExtensionService#loadExtensionContext ${e.identifier.value}`),Promise.all([r.whenReady,i.whenReady,this._storagePath.whenReady]).then(()=>{let t=this,c,l,u=Hg(e,`ipc`)?this._initData.messagePorts?.get(ms.toKey(e.identifier)):void 0;return Object.freeze({globalState:r,workspaceState:i,secrets:a,subscriptions:[],get languageModelAccessInformation(){return n},get extensionUri(){return e.extensionLocation},get extensionPath(){return e.extensionLocation.fsPath},asAbsolutePath(t){return Br(e.extensionLocation.fsPath,t)},get storagePath(){return t._storagePath.workspaceValue(e)?.fsPath},get globalStoragePath(){return t._storagePath.globalValue(e).fsPath},get logPath(){return Br(t._initData.logsLocation.fsPath,e.identifier.value)},get logUri(){return w.joinPath(t._initData.logsLocation,e.identifier.value)},get storageUri(){return t._storagePath.workspaceValue(e)},get globalStorageUri(){return t._storagePath.globalValue(e)},get extensionMode(){return o},get extension(){return c===void 0&&(c=new JP(t,e.identifier,e,s,!1)),c},get extensionRuntime(){return U(e,`extensionRuntime`),t.extensionRuntime},get environmentVariableCollection(){return t._extHostTerminalService.getEnvironmentVariableCollection(e)},get messagePassingProtocol(){if(!l){if(!u)return;let e=en.buffer(en.fromDOMEventEmitter(u,`message`,e=>e.data));u.start(),l={onDidReceiveMessage:e,postMessage:u.postMessage.bind(u)}}return l}})})}static _callActivate(e,t,n,r,i,a){return n||={activate:void 0,deactivate:void 0},this._callActivateOptional(e,t,n,r,a).then(e=>new Rj(!1,null,a.build(),n,e,_(()=>{i.dispose(),yt(r.subscriptions)})))}static _callActivateOptional(e,t,n,r,i){if(typeof n.activate==`function`)try{i.activateCallStart(),e.trace(`ExtensionService#_callActivateOptional ${t.value}`);let a=n.activate.apply(globalThis,[r]);return i.activateCallStop(),i.activateResolveStart(),Promise.resolve(a).then(e=>(i.activateResolveStop(),e))}catch(e){return Promise.reject(e)}else return Promise.resolve(n)}_activateOneStartupFinished(e,t){this._activateById(e.identifier,{startup:!1,extensionId:e.identifier,activationEvent:t}).then(void 0,e=>{this._logService.error(e)})}_activateAllStartupFinishedDeferred(e,t=0){let n=Date.now();ur(()=>{for(let r=t;r<e.length;r+=1){let t=e[r];for(let i of t.activationEvents??[])if(i===`onStartupFinished`)if(Date.now()-n>50){this._activateAllStartupFinishedDeferred(e,r);break}else this._activateOneStartupFinished(t,i)}})}_activateAllStartupFinished(){this._mainThreadExtensionsProxy.$setPerformanceMarks(En()),this._extHostConfiguration.getConfigProvider().then(e=>{let t=e.getConfiguration(`extensions.experimental`).get(`deferredStartupFinishedActivation`),n=this._myRegistry.getAllExtensionDescriptions();if(t)this._activateAllStartupFinishedDeferred(n);else for(let e of n)if(e.activationEvents)for(let t of e.activationEvents)t===`onStartupFinished`&&this._activateOneStartupFinished(e,t)})}_handleEagerExtensions(){let e=this._activateByEvent(`*`,!0).then(void 0,e=>{this._logService.error(e)});this._register(this._extHostWorkspace.onDidChangeWorkspace(e=>this._handleWorkspaceContainsEagerExtensions(e.added)));let t=this._extHostWorkspace.workspace?this._extHostWorkspace.workspace.folders:[],n=this._handleWorkspaceContainsEagerExtensions(t),r=this._handleRemoteResolverEagerExtensions(),i=Promise.all([r,e,n]).then(()=>{});return Promise.race([i,xo(1e4)]).then(()=>{this._activateAllStartupFinished()}),i}_handleWorkspaceContainsEagerExtensions(e){return e.length===0?Promise.resolve(void 0):Promise.all(this._myRegistry.getAllExtensionDescriptions().map(t=>this._handleWorkspaceContainsEagerExtension(e,t))).then(()=>{})}async _handleWorkspaceContainsEagerExtension(e,t){if(this.isActivated(t.identifier))return;let n=!this._initData.remote.isRemote&&!!this._initData.remote.authority,r={logService:this._logService,folders:e.map(e=>e.uri),forceUsingSearch:n||!this._hostUtils.fsExists,exists:e=>this._hostUtils.fsExists(e.fsPath),checkExists:(e,t,n)=>this._mainThreadWorkspaceProxy.$checkExists(e,t,n)},i=await kP(r,t);if(i)return this._activateById(t.identifier,{startup:!0,extensionId:t.identifier,activationEvent:i.activationEvent}).then(void 0,e=>this._logService.error(e))}async _handleRemoteResolverEagerExtensions(){if(this._initData.remote.authority)return this._activateByEvent(`onResolveRemoteAuthority:${this._initData.remote.authority}`,!1)}async $extensionTestsExecute(){await this._eagerExtensionsActivated.wait();try{return await this._doHandleExtensionTests()}catch(e){throw console.error(e),e}}async _doHandleExtensionTests(){let{extensionDevelopmentLocationURI:e,extensionTestsLocationURI:t}=this._initData.environment;if(!e||!t)throw Error(C(2623,`Cannot load test runner.`));let n=(await this.getExtensionPathIndex()).findSubstr(t),r=this._isESM(n,t.path),i=await(r?this._loadESMModule(null,t,new Lj(!1)):this._loadCommonJSModule(null,t,new Lj(!1)));if(!i||typeof i.run!=`function`)throw Error(C(2624,`Path {0} does not point to a valid extension test runner.`,t.toString()));return new Promise((e,n)=>{let r=(t,r)=>{t?(ar&&this._logService.error(`Test runner called back with error`,t),n(t)):(ar&&(r?this._logService.info(`Test runner called back with ${r} failures.`):this._logService.info(`Test runner called back with successful outcome.`)),e(typeof r==`number`&&r>0?1:0))},a=Ua(t),o=i.run(a,r);o&&o.then&&o.then(()=>{ar&&this._logService.info(`Test runner finished successfully.`),e(0)}).catch(e=>{ar&&this._logService.error(`Test runner finished with error`,e),n(e instanceof Error&&e.stack?e.stack:String(e))})})}_startExtensionHost(){if(this._started)throw Error(`Extension host is already started!`);return this._started=!0,this._readyToStartExtensionHost.wait().then(()=>this._readyToRunExtensions.open()).then(()=>Promise.race([this._activator.waitForActivatingExtensions(),xo(1e3)])).then(()=>this._handleEagerExtensions()).then(()=>{this._eagerExtensionsActivated.open(),this._logService.info(`Eager extensions activated`)})}registerRemoteAuthorityResolver(e,t){return this._resolvers[e]=t,_(()=>{delete this._resolvers[e]})}async getRemoteExecServer(e){let{resolver:t}=await this._activateAndGetResolver(e);return t?.resolveExecServer?.(e,{resolveAttempt:0})}async _activateAndGetResolver(e){let t=e.indexOf(`+`);if(t===-1)throw new Ub(`Not an authority that can be resolved!`,pb.InvalidAuthority);let n=e.substr(0,t);return await this._almostReadyToRunExtensions.wait(),await this._activateByEvent(`onResolveRemoteAuthority:${n}`,!1),{authorityPrefix:n,resolver:this._resolvers[n]}}async $resolveAuthority(e,t){let n=$t.create(!1),r=()=>`[resolveAuthority(${mb(e)},${t})][${n.elapsed()}ms] `,i=e=>this._logService.info(`${r()}${e}`),a=e=>this._logService.warn(`${r()}${e}`),o=(e,t=void 0)=>this._logService.error(`${r()}${e}`,t),s=e=>{if(e instanceof Ub)return{type:`error`,error:{code:e._code,message:e._message,detail:e._detail}};throw e},c=async e=>{i(`activating resolver for ${e}...`);let{resolver:t,authorityPrefix:n}=await this._activateAndGetResolver(e);if(!t)throw o(`no resolver for ${n}`),new Ub(`No remote extension installed to resolve ${n}.`,pb.NoResolverFound);return{resolver:t,authorityPrefix:n,remoteAuthority:e}},l=e.split(/@|%40/g).reverse();i(`activating remote resolvers ${l.join(` -> `)}`);let u;try{u=await Promise.all(l.map(c)).catch(async t=>{if(!(t instanceof Ub)||t._code!==pb.InvalidAuthority)throw t;return a(`resolving nested authorities failed: ${t.message}`),[await c(e)]})}catch(e){return s(e)}let d=new Eo;d.cancelAndSet(()=>i(`waiting...`),1e3);let f,p;for(let[e,{authorityPrefix:n,resolver:r,remoteAuthority:a}]of u.entries())try{if(e===u.length-1)i(`invoking final resolve()...`),Tn(`code/extHost/willResolveAuthority/${n}`),f=await r.resolve(a,{resolveAttempt:t,execServer:p}),Tn(`code/extHost/didResolveAuthorityOK/${n}`),i(`setting tunnel factory...`),this._register(await this._extHostTunnelService.setTunnelFactory(r,Hb.isManagedResolvedAuthority(f)?f:void 0));else{if(i(`invoking resolveExecServer() for ${a}`),Tn(`code/extHost/willResolveExecServer/${n}`),p=await r.resolveExecServer?.(a,{resolveAttempt:t,execServer:p}),!p)throw new Ub(`Exec server was not available for ${a}`,pb.NoResolverFound);Tn(`code/extHost/didResolveExecServerOK/${n}`)}}catch(e){return Tn(`code/extHost/didResolveAuthorityError/${n}`),o(`returned an error`,e),d.dispose(),s(e)}d.dispose();let ee={environmentTunnels:f.environmentTunnels,features:f.tunnelFeatures?{elevation:f.tunnelFeatures.elevation,privacyOptions:f.tunnelFeatures.privacyOptions,protocol:f.tunnelFeatures.protocol===void 0?!0:f.tunnelFeatures.protocol}:void 0},m={extensionHostEnv:f.extensionHostEnv,isTrusted:f.isTrusted,authenticationSession:f.authenticationSessionForInitializingExtensions?{id:f.authenticationSessionForInitializingExtensions.id,providerId:f.authenticationSessionForInitializingExtensions.providerId}:void 0};i(`returned ${Hb.isManagedResolvedAuthority(f)?`managed authority`:`${f.host}:${f.port}`}`);let te;if(Hb.isManagedResolvedAuthority(f)){let n=t;this._extHostManagedSockets.setFactory(n,f.makeConnection),te={authority:e,connectTo:new db(n),connectionToken:f.connectionToken}}else te={authority:e,connectTo:new fb(f.host,f.port),connectionToken:f.connectionToken};return{type:`ok`,value:{authority:te,options:m,tunnelInformation:ee}}}async $getCanonicalURI(e,t){this._logService.info(`$getCanonicalURI invoked for authority (${mb(e)})`);let{resolver:n}=await this._activateAndGetResolver(e);if(!n)return null;let r=w.revive(t);if(n.getCanonicalURI===void 0)return r;let i=await uo(()=>n.getCanonicalURI(r));return i||r}async $startExtensionHost(e){e.toAdd.forEach(e=>e.extensionLocation=w.revive(e.extensionLocation));let{globalRegistry:t,myExtensions:n}=WP(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),r=await this._createExtensionPathIndex(n),i=await this.getExtensionPathIndex();return i.setSearchTree(r),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(n),ar&&(this._logService.info(`$startExtensionHost: global extensions: ${KP(this._globalRegistry)}`),this._logService.info(`$startExtensionHost: local extensions: ${KP(this._myRegistry)}`)),this._startExtensionHost()}$activateByEvent(e,t){return t===Ug.Immediate?this._almostReadyToRunExtensions.wait().then(t=>this._activateByEvent(e,!1)):this._readyToRunExtensions.wait().then(t=>this._activateByEvent(e,!1))}async $activate(e,t){return await this._readyToRunExtensions.wait(),this._myRegistry.getExtensionDescription(e)?(await this._activateById(e,t),!0):!1}async $deltaExtensions(e){e.toAdd.forEach(e=>e.extensionLocation=w.revive(e.extensionLocation));let{globalRegistry:t,myExtensions:n}=WP(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),r=await this._createExtensionPathIndex(n),i=await this.getExtensionPathIndex();return i.setSearchTree(r),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(n),ar&&(this._logService.info(`$deltaExtensions: global extensions: ${KP(this._globalRegistry)}`),this._logService.info(`$deltaExtensions: local extensions: ${KP(this._myRegistry)}`)),Promise.resolve(void 0)}async $test_latency(e){return e}async $test_up(e){return e.byteLength}async $test_down(e){let t=b.alloc(e),n=Math.random()%256;for(let r=0;r<e;r++)t.writeUInt8(n,r);return t}async $updateRemoteConnectionData(e){this._remoteConnectionData=e,this._onDidChangeRemoteConnectionData.fire()}_isESM(e,t){return t??=e?this._getEntryPoint(e):t,t?.endsWith(`.mjs`)||e?.type===`module`&&!t?.endsWith(`.cjs`)}};UP=VP=A([j(0,ys),j(1,HP),j(2,Is),j(3,nj),j(4,kj),j(5,xs),j(6,ks),j(7,Zj),j(8,fM),j(9,rN),j(10,IP),j(11,LP),j(12,QN)],UP);function WP(e,t,n,r){e.addActivationEvents(r.addActivationEvents);let i=new jj(e,t.getAllExtensionDescriptions());i.deltaExtensions(r.toAdd,r.toRemove);let a=new hs(n.getAllExtensionDescriptions().map(e=>e.identifier));for(let e of r.myToRemove)a.delete(e);for(let e of r.myToAdd)a.add(e);let o=YP(i,a);return{globalRegistry:i,myExtensions:o}}function GP(e,t){let n={id:e.identifier.value,name:e.name,extensionVersion:e.version,publisherDisplayName:e.publisher,activationEvents:e.activationEvents?e.activationEvents.join(`,`):null,isBuiltin:e.isBuiltin,reason:t.activationEvent,reasonId:t.extensionId.value};return n}function KP(e){return e.getAllExtensionDescriptions().map(e=>e.identifier.value).join(`,`)}const qP=k(`IExtHostExtensionService`);var JP=class{#extensionService;#originExtensionId;#identifier;constructor(e,t,n,r,i){this.#extensionService=e,this.#originExtensionId=t,this.#identifier=n.identifier,this.id=n.identifier.value,this.extensionUri=n.extensionLocation,this.extensionPath=Rr(Ua(n.extensionLocation)),this.packageJSON=n,this.extensionKind=r,this.isFromDifferentExtensionHost=i}get isActive(){return this.#extensionService.isActivated(this.#identifier)}get exports(){if(!(this.packageJSON.api===`none`||this.isFromDifferentExtensionHost))return this.#extensionService.getExtensionExports(this.#identifier)}async activate(){if(this.isFromDifferentExtensionHost)throw Error(`Cannot activate foreign extension`);return await this.#extensionService.activateByIdWithErrors(this.#identifier,{startup:!1,extensionId:this.#originExtensionId,activationEvent:`api`}),this.exports}};function YP(e,t){return e.getAllExtensionDescriptions().filter(e=>t.has(e.identifier))}var XP=class{constructor(e){this._searchTree=e}setSearchTree(e){this._searchTree=e}findSubstr(e){return this._searchTree.findSubstr(e)}forEach(e){return this._searchTree.forEach(e)}},ZP=class{constructor(e){this._map=new gs,this.addActivationEvents(e)}readActivationEvents(e){return this._map.get(e.identifier)??[]}addActivationEvents(e){for(let t of Object.keys(e))this._map.set(t,e[t])}};const QP=k(`IExtHostApiDeprecationService`);let $P=class{constructor(e,t){this._extHostLogService=t,this._reportedUsages=new Set,this._telemetryShape=e.getProxy(E.MainThreadTelemetry)}report(e,t,n){let r=this.getUsageKey(e,t);this._reportedUsages.has(r)||(this._reportedUsages.add(r),t.isUnderDevelopment&&this._extHostLogService.warn(`[Deprecation Warning] '${e}' is deprecated. ${n}`),this._telemetryShape.$publicLog2(`extHostDeprecatedApiUsage`,{extensionId:t.identifier.value,apiId:e}))}getUsageKey(e,t){return`${e}-${t.identifier.value}`}};$P=A([j(0,Is),j(1,xs)],$P);var eF;(function(e){e[e.Off=0]=`Off`,e[e.Trace=1]=`Trace`,e[e.Debug=2]=`Debug`,e[e.Info=3]=`Info`,e[e.Warning=4]=`Warning`,e[e.Error=5]=`Error`})(eF||={});const tF=eF.Info;function nF(e,t){return e!==eF.Off&&e<=t}function rF(e,t,n){switch(t){case eF.Trace:e.trace(n);break;case eF.Debug:e.debug(n);break;case eF.Info:e.info(n);break;case eF.Warning:e.warn(n);break;case eF.Error:e.error(n);break;case eF.Off:break;default:throw Error(`Invalid log level ${t}`)}}function iF(e,t=!1){let n=``;for(let r=0;r<e.length;r++){let i=e[r];if(i instanceof Error&&(i=Em(i,t)),typeof i==`object`)try{i=JSON.stringify(i)}catch{}n+=(r>0?` `:``)+i}return n}var aF=class extends y{constructor(){super(...arguments),this.level=tF,this._onDidChangeLogLevel=this._register(new x),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return nF(this.level,e)}canLog(e){return this._store.isDisposed?!1:this.checkLogLevel(e)}},oF=class extends aF{constructor(e){super(),this.logAlways=e}checkLogLevel(e){return this.logAlways||super.checkLogLevel(e)}trace(e,...t){this.canLog(eF.Trace)&&this.log(eF.Trace,iF([e,...t],!0))}debug(e,...t){this.canLog(eF.Debug)&&this.log(eF.Debug,iF([e,...t]))}info(e,...t){this.canLog(eF.Info)&&this.log(eF.Info,iF([e,...t]))}warn(e,...t){this.canLog(eF.Warning)&&this.log(eF.Warning,iF([e,...t]))}error(e,...t){if(this.canLog(eF.Error))if(e instanceof Error){let t=Array.prototype.slice.call(arguments);t[0]=e.stack,this.log(eF.Error,iF(t))}else this.log(eF.Error,iF([e,...t]))}flush(){}},sF=class extends aF{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(let t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(let n of this.loggers)n.trace(e,...t)}debug(e,...t){for(let n of this.loggers)n.debug(e,...t)}info(e,...t){for(let n of this.loggers)n.info(e,...t)}warn(e,...t){for(let n of this.loggers)n.warn(e,...t)}error(e,...t){for(let n of this.loggers)n.error(e,...t)}flush(){for(let e of this.loggers)e.flush()}dispose(){for(let e of this.loggers)e.dispose();super.dispose()}},cF=class extends y{constructor(e,t,n){if(super(),this.logLevel=e,this.logsHome=t,this._loggers=new ze,this._onDidChangeLoggers=this._register(new x),this.onDidChangeLoggers=this._onDidChangeLoggers.event,this._onDidChangeLogLevel=this._register(new x),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event,this._onDidChangeVisibility=this._register(new x),this.onDidChangeVisibility=this._onDidChangeVisibility.event,n)for(let e of n)this._loggers.set(e.resource,{logger:void 0,info:e})}getLoggerEntry(e){return Ze(e)?[...this._loggers.values()].find(t=>t.info.id===e):this._loggers.get(e)}getLogger(e){return this.getLoggerEntry(e)?.logger}createLogger(e,t){let n=this.toResource(e),r=Ze(e)?e:t?.id??uh(n.toString()).toString(16),i=this._loggers.get(n)?.logger,a=t?.logLevel===`always`?eF.Trace:t?.logLevel;i||=this.doCreateLogger(n,a??this.getLogLevel(n)??this.logLevel,{...t,id:r});let o={logger:i,info:{resource:n,id:r,logLevel:a,name:t?.name,hidden:t?.hidden,group:t?.group,extensionId:t?.extensionId,when:t?.when}};return this.registerLogger(o.info),this._loggers.set(n,o),i}toResource(e){return Ze(e)?$a(this.logsHome,`${e}.log`):e}setLogLevel(e,t){if(w.isUri(e)){let n=e,r=t,i=this._loggers.get(n);i&&r!==i.info.logLevel&&(i.info.logLevel=r===this.logLevel?void 0:r,i.logger?.setLevel(r),this._loggers.set(i.info.resource,i),this._onDidChangeLogLevel.fire([n,r]))}else{this.logLevel=e;for(let[e,t]of this._loggers.entries())this._loggers.get(e)?.info.logLevel===void 0&&t.logger?.setLevel(this.logLevel);this._onDidChangeLogLevel.fire(this.logLevel)}}setVisibility(e,t){let n=this.getLoggerEntry(e);n&&t!==!n.info.hidden&&(n.info.hidden=!t,this._loggers.set(n.info.resource,n),this._onDidChangeVisibility.fire([n.info.resource,t]))}getLogLevel(e){let t;return e&&(t=this._loggers.get(e)?.info.logLevel),t??this.logLevel}registerLogger(e){let t=this._loggers.get(e.resource);t?t.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this._loggers.set(e.resource,{info:e,logger:void 0}),this._onDidChangeLoggers.fire({added:[e],removed:[]}))}deregisterLogger(e){let t=this.toResource(e),n=this._loggers.get(t);n&&(n.logger&&n.logger.dispose(),this._loggers.delete(t),this._onDidChangeLoggers.fire({added:[],removed:[n.info]}))}*getRegisteredLoggers(){for(let e of this._loggers.values())yield e.info}getRegisteredLogger(e){return this._loggers.get(e)?.info}dispose(){this._loggers.forEach(e=>e.logger?.dispose()),this._loggers.clear(),super.dispose()}};function lF(e){switch(e){case eF.Trace:return`trace`;case eF.Debug:return`debug`;case eF.Info:return`info`;case eF.Warning:return`warn`;case eF.Error:return`error`;case eF.Off:return`off`}}function uF(e){switch(e){case`trace`:return eF.Trace;case`debug`:return eF.Debug;case`info`:return eF.Info;case`warn`:return eF.Warning;case`error`:return eF.Error;case`critical`:return eF.Error;case`off`:return eF.Off}}new I(`logLevel`,lF(eF.Info));let dF=class extends cF{constructor(e,t){super(t.logLevel,t.logsLocation,t.loggers.map(e=>Gu(e))),this._proxy=e.getProxy(E.MainThreadLogger)}$setLogLevel(e,t){t?this.setLogLevel(w.revive(t),e):this.setLogLevel(e)}setVisibility(e,t){super.setVisibility(e,t),this._proxy.$setVisibility(e,t)}doCreateLogger(e,t,n){return new fF(this._proxy,e,t,n)}};dF=A([j(0,Is),j(1,ks)],dF);var fF=class extends oF{constructor(e,t,n,r){super(r?.logLevel===`always`),this.proxy=e,this.file=t,this.isLoggerCreated=!1,this.buffer=[],this.setLevel(n),this.proxy.$createLogger(t,r).then(()=>{this.doLog(this.buffer),this.isLoggerCreated=!0})}log(e,t){let n=[[e,t]];this.isLoggerCreated?this.doLog(n):this.buffer.push(...n)}doLog(e){this.proxy.$log(this.file,e)}flush(){this.proxy.$flush(this.file)}},pF=class extends y{constructor(e,t=[]){super(),this.logger=new sF([e,...t]),this._register(e.onDidChangeLogLevel(e=>this.setLevel(e)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}flush(){this.logger.flush()}};let mF=class extends pF{constructor(e,t,n){let r=n.remote.isRemote?`remoteexthost`:e?`workerexthost`:`exthost`,i=n.remote.isRemote?C(2628,`Extension Host (Remote)`):e?C(2629,`Extension Host (Worker)`):C(2630,`Extension Host`);super(t.createLogger(r,{name:i}))}};mF=A([j(1,Ss),j(2,ks)],mF);var hF=class{static async installEarlyHandler(e){Error.stackTraceLimit=100;let t=e.get(xs),n=e.get(Is),r=n.getProxy(E.MainThreadErrors);p(e=>{t.error(e);let n=ne(e);r.$onUnexpectedError(n)})}static async installFullHandler(e){let t=e.get(xs),n=e.get(Is),r=e.get(qP),i=e.get(ZM),a=e.get(QP),o=n.getProxy(E.MainThreadExtensionService),s=n.getProxy(E.MainThreadErrors),c=await r.getExtensionRegistry(),l=await r.getExtensionPathIndex(),u=new WeakMap;function d(e,t){if(u.has(e))return u.get(e).stack;let n=``,r,i;for(let e of t)n+=`\n\tat ${e.toString()}`,i=e.getFileName(),!r&&i&&(r=l.findSubstr(w.file(i)));let a=`${e.name||`Error`}: ${e.message||``}${n}`;return u.set(e,{extensionIdentifier:r?.identifier,stack:a}),a}let ee=Symbol(`prepareStackTrace wrapped`),m=d;Object.defineProperty(Error,`prepareStackTrace`,{configurable:!1,get(){return m},set(e){if(e===d||!e||e[ee]){m=e||d;return}m=function(t,n){return d(t,n),e.call(Error,t,n)},Object.assign(m,{[ee]:!0})}}),p(e=>{se.is(e)||t.error(e);let n=ne(e),r;if(e instanceof _s)r=e.extension;else{let t=u.get(e);r=t?.extensionIdentifier}if(r)if(se.is(e)){let t=c.getExtensionDescription(r);t&&a.report(e.name,t,`${e.message}\n FROM: ${e.stack}`)}else{o.$onExtensionRuntimeError(r,n);let a=i.onExtensionError(r,e);t.trace(`forwarded error to extension?`,a,r)}}),f.addListener(e=>{s.$onUnexpectedError(e)})}},gF=class e{constructor(t,n,r,i,a){this._hostUtils=r,this._rpcProtocol=new ts(t,null,i),n=e._transform(n,this._rpcProtocol);let o=new Os(...Ds());o.set(ks,{_serviceBrand:void 0,...n,messagePorts:a}),o.set(Is,new Ls(this._rpcProtocol)),o.set(Rs,new zs(i)),o.set(HP,r),o.set(xs,new Cs(mF,[!0],!0)),o.set(Ss,new Cs(dF,[],!0));let s=new Ns(o,!0);tr&&s.invokeFunction(hF.installEarlyHandler),this._logService=s.invokeFunction(e=>e.get(xs)),Tn(`code/extHost/didCreateServices`),this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} started`):this._logService.info(`Extension host started`),this._logService.trace(`initData`,n),this._extensionService=s.invokeFunction(e=>e.get(qP)),this._extensionService.initialize(),tr&&s.invokeFunction(hF.installFullHandler)}async asBrowserUri(e){let t=this._rpcProtocol.getProxy(E.MainThreadExtensionService);return w.revive(await t.$asBrowserUri(e))}async getAllStaticBrowserUris(){let e=this._rpcProtocol.getProxy(E.MainThreadExtensionService);return(await e.$getAllStaticBrowserUris()).map(([e,t])=>[w.revive(e),w.revive(t)])}terminate(e){this._extensionService.terminate(e)}getExtHostExtensionService(){return this._extensionService}static _transform(e,t){e.extensions.allExtensions.forEach(e=>{e.extensionLocation=w.revive(t.transformIncomingURIs(e.extensionLocation))}),e.environment.appRoot=w.revive(t.transformIncomingURIs(e.environment.appRoot));let n=e.environment.extensionDevelopmentLocationURI;return n&&(e.environment.extensionDevelopmentLocationURI=n.map(e=>w.revive(t.transformIncomingURIs(e)))),e.environment.extensionTestsLocationURI=w.revive(t.transformIncomingURIs(e.environment.extensionTestsLocationURI)),e.environment.globalStorageHome=w.revive(t.transformIncomingURIs(e.environment.globalStorageHome)),e.environment.workspaceStorageHome=w.revive(t.transformIncomingURIs(e.environment.workspaceStorageHome)),e.nlsBaseUrl=w.revive(t.transformIncomingURIs(e.nlsBaseUrl)),e.logsLocation=w.revive(t.transformIncomingURIs(e.logsLocation)),e.workspace=t.transformIncomingURIs(e.workspace),e}};const _F=(function(e){let t=n=>{globalThis.removeEventListener(`message`,t);let r=n.data;Object.defineProperties(globalThis,{postMessage:{value(e,t){r.postMessage(e,t)}},onmessage:{get(){return r.onmessage},set(e){r.onmessage=e}}}),r.addEventListener(`message`,e=>{globalThis.dispatchEvent(new MessageEvent(`message`,{data:e.data,ports:e.ports?[...e.ports]:void 0}))}),r.start(),globalThis.Worker=class{constructor(){throw TypeError(`Nested workers from within nested worker are NOT supported.`)}},importScripts(e)};globalThis.addEventListener(`message`,t)}).toString();var vF=class extends EventTarget{constructor(e,t,n){super(),this.onmessage=null,this.onmessageerror=null,this.onerror=null;let r=`((${_F})('${t}'))`,i=new Blob([r],{type:`application/javascript`}),a=URL.createObjectURL(i),o=new MessageChannel,s=a,c={type:`_newWorker`,id:s,port:o.port2,url:a,options:n};e(c,[o.port2]),this.postMessage=o.port1.postMessage.bind(o.port1),this.terminate=()=>{let t={type:`_terminateWorker`,id:s};e(t),URL.revokeObjectURL(a),o.port1.close(),o.port2.close()},Object.defineProperties(this,{onmessage:{get(){return o.port1.onmessage},set(e){o.port1.onmessage=e}},onmessageerror:{get(){return o.port1.onmessageerror},set(e){o.port1.onmessageerror=e}}}),o.port1.addEventListener(`messageerror`,e=>{let t=new MessageEvent(`messageerror`,{data:e.data});this.dispatchEvent(t)}),o.port1.addEventListener(`message`,e=>{let t=new MessageEvent(`message`,{data:e.data});this.dispatchEvent(t)}),o.port1.start()}};new I(`inOutput`,!1),new I(`activeLogOutput`,!1),new I(`activeLogOutput.isLog`,!1),new I(`activeLogOutput.levelSettable`,!1),new I(`activeLogOutput.level`,``),new I(`activeLogOutput.levelIsDefault`,!1),new I(`outputView.scrollLock`,!1),new I(`activeOutputChannel`,``),new I(`output.filter.trace`,!0),new I(`output.filter.debug`,!0),new I(`output.filter.info`,!0),new I(`output.filter.warning`,!0),new I(`output.filter.error`,!0),new I(`outputFilterFocus`,!1),new I(`output.filter.categories`,``);var yF;(function(e){e[e.Append=1]=`Append`,e[e.Replace=2]=`Replace`,e[e.Clear=3]=`Clear`})(yF||={});const bF={OutputChannels:`workbench.contributions.outputChannels`};function xF(e){return Array.isArray(e.source)}var SF=class extends y{constructor(){super(...arguments),this.channels=new Map,this._onDidRegisterChannel=this._register(new x),this.onDidRegisterChannel=this._onDidRegisterChannel.event,this._onDidRemoveChannel=this._register(new x),this.onDidRemoveChannel=this._onDidRemoveChannel.event,this._onDidUpdateChannelFiles=this._register(new x),this.onDidUpdateChannelSources=this._onDidUpdateChannelFiles.event}registerChannel(e){this.channels.has(e.id)||(this.channels.set(e.id,e),this._onDidRegisterChannel.fire(e.id))}getChannels(){let e=[];return this.channels.forEach(t=>e.push(t)),e}getChannel(e){return this.channels.get(e)}updateChannelSources(e,t){let n=this.channels.get(e);n&&xF(n)&&(n.source=t,this._onDidUpdateChannelFiles.fire(n))}removeChannel(e){let t=this.channels.get(e);t&&(this.channels.delete(e),this._onDidRemoveChannel.fire(t))}};Sm.add(bF.OutputChannels,new SF);var CF=class extends oF{constructor(e,t,n,r,i){super(),this.id=e,this.name=t,this.logger=n,this.proxy=r,this.extension=i,this.offset=0,this.visible=!1,this.setLevel(n.getLevel()),this._register(n.onDidChangeLogLevel(e=>this.setLevel(e))),this._register(_(()=>this.proxy.$dispose(this.id)))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+`
`)}append(e){this.info(e)}clear(){let e=this.offset;this.logger.flush(),this.proxy.$update(this.id,yF.Clear,e)}replace(e){let t=this.offset;this.info(e),this.proxy.$update(this.id,yF.Replace,t),this.visible&&this.logger.flush()}show(e,t){this.logger.flush(),this.proxy.$reveal(this.id,!!(typeof e==`boolean`?e:t))}hide(){this.proxy.$close(this.id)}log(e,t){this.offset+=b.fromString(t).byteLength,rF(this.logger,e,t),this.visible&&(this.logger.flush(),this.proxy.$update(this.id,yF.Append))}},wF=class extends CF{appendLine(e){this.append(e)}};let TF=class{constructor(e,t,n,r,i,a){this.initData=t,this.extHostFileSystem=n,this.extHostFileSystemInfo=r,this.loggerService=i,this.logService=a,this.extensionLogDirectoryPromise=new Map,this.namePool=1,this.channels=new Map,this.visibleChannelId=null,this.proxy=e.getProxy(E.MainThreadOutputService),this.outputsLocation=this.extHostFileSystemInfo.extUri.joinPath(t.logsLocation,`output_logging_${rP(new Date).replace(/-|:|\.\d+Z$/g,``)}`)}$setVisibleChannel(e){this.visibleChannelId=e;for(let[e,t]of this.channels)t.visible=e===this.visibleChannelId}createOutputChannel(e,t,n){if(e=e.trim(),!e)throw Error("illegal argument `name`. must not be falsy");let r=typeof t==`object`&&t.log,i=Ze(t)?t:void 0;if(Ze(i)&&!i.trim())throw Error("illegal argument `languageId`. must not be empty");let a,o=this.initData.environment.extensionLogLevel?.find(([e])=>ms.equals(n.identifier,e))?.[1];o&&(a=uF(o));let s=new v,c=r?this.doCreateLogOutputChannel(e,a,n,s):this.doCreateOutputChannel(e,i,n,s);return c.then(e=>{this.channels.set(e.id,e),e.visible=e.id===this.visibleChannelId,s.add(_(()=>this.channels.delete(e.id)))}),r?this.createExtHostLogOutputChannel(e,a??this.logService.getLevel(),c,s):this.createExtHostOutputChannel(e,c,s)}async doCreateOutputChannel(e,t,n,r){this.outputDirectoryPromise||=this.extHostFileSystem.value.createDirectory(this.outputsLocation).then(()=>this.outputsLocation);let i=await this.outputDirectoryPromise,a=this.extHostFileSystemInfo.extUri.joinPath(i,`${this.namePool++}-${e.replace(/[\\/:\*\?"<>\|]/g,``)}.log`),o=r.add(this.loggerService.createLogger(a,{logLevel:`always`,donotRotate:!0,donotUseFormatters:!0,hidden:!0})),s=await this.proxy.$register(e,a,t,n.identifier.value);return r.add(_(()=>this.loggerService.deregisterLogger(a))),new CF(s,e,o,this.proxy,n)}async doCreateLogOutputChannel(e,t,n,r){let i=await this.createExtensionLogDirectory(n),a=e.replace(/[\\/:\*\?"<>\|]/g,``),o=this.extHostFileSystemInfo.extUri.joinPath(i,`${a}.log`),s=`${n.identifier.value}.${a}`,c=r.add(this.loggerService.createLogger(o,{id:s,name:e,logLevel:t,extensionId:n.identifier.value}));return r.add(_(()=>this.loggerService.deregisterLogger(o))),new wF(s,e,c,this.proxy,n)}createExtensionLogDirectory(e){let t=this.extensionLogDirectoryPromise.get(e.identifier.value);if(!t){let n=this.extHostFileSystemInfo.extUri.joinPath(this.initData.logsLocation,e.identifier.value);this.extensionLogDirectoryPromise.set(e.identifier.value,t=(async()=>{try{await this.extHostFileSystem.value.createDirectory(n)}catch(e){if(fc(e)!==lc.FileExists)throw e}return n})())}return t}createExtHostOutputChannel(e,t,n){let r=()=>{if(n.isDisposed)throw Error(`Channel has been closed`)};return t.then(e=>n.add(e)),{get name(){return e},append(e){r(),t.then(t=>t.append(e))},appendLine(e){r(),t.then(t=>t.appendLine(e))},clear(){r(),t.then(e=>e.clear())},replace(e){r(),t.then(t=>t.replace(e))},show(e,n){r(),t.then(t=>t.show(e,n))},hide(){r(),t.then(e=>e.hide())},dispose(){n.dispose()}}}createExtHostLogOutputChannel(e,t,n,r){let i=()=>{if(r.isDisposed)throw Error(`Channel has been closed`)},a=r.add(new x);function o(e){t=e,a.fire(e)}return n.then(e=>{e.logLevel!==t&&o(e.logLevel),r.add(e.onDidChangeLogLevel(e=>o(e)))}),{...this.createExtHostOutputChannel(e,n,r),get logLevel(){return t},onDidChangeLogLevel:a.event,trace(e,...t){i(),n.then(n=>n.trace(e,...t))},debug(e,...t){i(),n.then(n=>n.debug(e,...t))},info(e,...t){i(),n.then(n=>n.info(e,...t))},warn(e,...t){i(),n.then(n=>n.warn(e,...t))},error(e,...t){i(),n.then(n=>n.error(e,...t))}}}};TF=A([j(0,Is),j(1,ks),j(2,Xj),j(3,Mc),j(4,Ss),j(5,xs)],TF);const EF=k(`IExtHostOutputService`);var DF;let OF=class{static{DF=this}static{this._handlePool=0}static{this._maxEventSize=250}constructor(e,t){this._logService=t,this._provider=new Map,this._proxy=e.getProxy(E.MainThreadDecorations)}registerFileDecorationProvider(e,t){let n=DF._handlePool++;this._provider.set(n,{provider:e,extensionDescription:t}),this._proxy.$registerDecorationProvider(n,t.identifier.value);let r=e.onDidChangeFileDecorations&&e.onDidChangeFileDecorations(e=>{if(!e){this._proxy.$onDidChange(n,null);return}let r=De(e);if(r.length<=DF._maxEventSize){this._proxy.$onDidChange(n,r);return}this._logService.warn(`[Decorations] CAPPING events from decorations provider`,t.identifier.value,r.length);let i=r.map(e=>({uri:e,rank:Bi(e.path,`/`)})),a=_e(i,(e,t)=>e.rank-t.rank||Ji(e.uri.path,t.uri.path)),o=[];outer:for(let e of a){let t;for(let n of e){let e=Ur(n.uri.path);if(t!==e&&(t=e,o.push(n.uri)>=DF._maxEventSize))break outer}}this._proxy.$onDidChange(n,o)});return new Pb(()=>{r?.dispose(),this._proxy.$unregisterDecorationProvider(n),this._provider.delete(n)})}async $provideDecorations(e,t,n){if(!this._provider.has(e))return Object.create(null);let r=Object.create(null),{provider:i,extensionDescription:a}=this._provider.get(e);return await Promise.all(t.map(async e=>{try{let{uri:t,id:o}=e,s=await Promise.resolve(i.provideFileDecoration(w.revive(t),n));if(!s)return;try{MC.validate(s),s.badge&&typeof s.badge!=`string`&&U(a,`codiconDecoration`),r[o]=[s.propagate,s.tooltip,s.badge,s.color]}catch(e){this._logService.warn(`INVALID decoration from extension '${a.identifier.value}': ${e}`)}}catch(e){this._logService.error(e)}})),r}};OF=DF=A([j(0,Is),j(1,xs)],OF);const kF=k(`IExtHostDecorations`);var AF=class{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,t){e=Fi(e);let n=this.values,r=this.prefixSum,i=t.length;return i===0?!1:(this.values=new Uint32Array(n.length+i),this.values.set(n.subarray(0,e),0),this.values.set(n.subarray(e),e+i),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(r.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=Fi(e),t=Fi(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=Fi(e),t=Fi(t);let n=this.values,r=this.prefixSum;if(e>=n.length)return!1;let i=n.length-e;return t>=i&&(t=i),t===0?!1:(this.values=new Uint32Array(n.length-t),this.values.set(n.subarray(0,e),0),this.values.set(n.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(r.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=Fi(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let n=t;n<=e;n++)this.prefixSum[n]=this.prefixSum[n-1]+this.values[n];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,n=this.values.length-1,r=0,i=0,a=0;for(;t<=n;)if(r=t+(n-t)/2|0,i=this.prefixSum[r],a=i-this.values[r],e<a)n=r-1;else if(e>=i)t=r+1;else break;return new jF(r,e-a)}},jF=class{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}},MF=class{constructor(e,t,n,r){this._uri=e,this._lines=t,this._eol=n,this._versionId=r,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);let t=e.changes;for(let e of t)this._acceptDeleteRange(e.range),this._acceptInsertText(new _p(e.range.startLineNumber,e.range.startColumn),e.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){let e=this._eol.length,t=this._lines.length,n=new Uint32Array(t);for(let r=0;r<t;r++)n[r]=this._lines[r].length+e;this._lineStarts=new AF(n)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;let n=Gi(t);if(n.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}n[n.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]);let r=new Uint32Array(n.length-1);for(let t=1;t<n.length;t++)this._lines.splice(e.lineNumber+t-1,0,n[t]),r[t-1]=n[t].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,r)}};const NF=new Map;function PF(e,t){t?NF.set(e,t):NF.delete(e)}function FF(e){return NF.get(e)}var IF=class extends MF{constructor(e,t,n,r,i,a,o,s){super(t,n,r,i),this._proxy=e,this._languageId=a,this._isDirty=o,this._encoding=s,this._isDisposed=!1}dispose(){qe(!this._isDisposed),this._isDisposed=!0,this._isDirty=!1}equalLines(e){return ge(this._lines,e)}get document(){if(!this._document){let e=this;this._document={get uri(){return e._uri},get fileName(){return e._uri.fsPath},get isUntitled(){return e._uri.scheme===O.untitled},get languageId(){return e._languageId},get version(){return e._versionId},get isClosed(){return e._isDisposed},get isDirty(){return e._isDirty},get encoding(){return e._encoding},save(){return e._save()},getText(t){return t?e._getTextInRange(t):e.getText()},get eol(){return e._eol===`
`?Wb.LF:Wb.CRLF},get lineCount(){return e._lines.length},lineAt(t){return e._lineAt(t)},offsetAt(t){return e._offsetAt(t)},positionAt(t){return e._positionAt(t)},validateRange(t){return e._validateRange(t)},validatePosition(t){return e._validatePosition(t)},getWordRangeAtPosition(t,n){return e._getWordRangeAtPosition(t,n)},[Symbol.for(`debug.description`)](){return`TextDocument(${e._uri.toString()})`}}}return Object.freeze(this._document)}_acceptLanguageId(e){qe(!this._isDisposed),this._languageId=e}_acceptIsDirty(e){qe(!this._isDisposed),this._isDirty=e}_acceptEncoding(e){qe(!this._isDisposed),this._encoding=e}_save(){return this._isDisposed?Promise.reject(Error(`Document has been closed`)):this._proxy.$trySaveDocument(this._uri)}_getTextInRange(e){let t=this._validateRange(e);if(t.isEmpty)return``;if(t.isSingleLine)return this._lines[t.start.line].substring(t.start.character,t.end.character);let n=this._eol,r=t.start.line,i=t.end.line,a=[];a.push(this._lines[r].substring(t.start.character));for(let e=r+1;e<i;e++)a.push(this._lines[e]);return a.push(this._lines[i].substring(0,t.end.character)),a.join(n)}_lineAt(e){let t;if(e instanceof Fb?t=e.line:typeof e==`number`&&(t=e),typeof t!=`number`||t<0||t>=this._lines.length||Math.floor(t)!==t)throw Error("Illegal value for `line`");return new LF(t,this._lines[t],t===this._lines.length-1)}_offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.line-1)+e.character}_positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();let t=this._lineStarts.getIndexOf(e),n=this._lines[t.index].length;return new Fb(t.index,Math.min(t.remainder,n))}_validateRange(e){if(!(e instanceof Ib))throw Error(`Invalid argument`);let t=this._validatePosition(e.start),n=this._validatePosition(e.end);return t===e.start&&n===e.end?e:new Ib(t.line,t.character,n.line,n.character)}_validatePosition(e){if(!(e instanceof Fb))throw Error(`Invalid argument`);if(this._lines.length===0)return e.with(0,0);let{line:t,character:n}=e,r=!1;if(t<0)t=0,n=0,r=!0;else if(t>=this._lines.length)t=this._lines.length-1,n=this._lines[t].length,r=!0;else{let e=this._lines[t].length;n<0?(n=0,r=!0):n>e&&(n=e,r=!0)}return r?new Fb(t,n):e}_getWordRangeAtPosition(e,t){let n=this._validatePosition(e);if(!t)t=FF(this._languageId);else if(Wi(t))throw Error(`[getWordRangeAtPosition]: ignoring custom regexp '${t.source}' because it matches the empty string.`);let r=od(n.character+1,id(t),this._lines[n.line],0);if(r)return new Ib(n.line,r.startColumn-1,n.line,r.endColumn-1)}},LF=class{constructor(e,t,n){this._line=e,this._text=t,this._isLastLine=n}get lineNumber(){return this._line}get text(){return this._text}get range(){return new Ib(this._line,0,this._line,this._text.length)}get rangeIncludingLineBreak(){return this._isLastLine?this.range:new Ib(this._line,0,this._line+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this._text)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this._text.length}},RF=class{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}};new RF(`id#`);var zF=class e{static{this._Keys=new RF(`TextEditorDecorationType`)}constructor(t,n,r){let i=e._Keys.nextId();t.$registerTextEditorDecorationType(n.identifier,i,LD.from(r)),this.value=Object.freeze({key:i,dispose(){t.$removeTextEditorDecorationType(i)}})}},BF=class{constructor(e,t){this._collectedEdits=[],this._setEndOfLine=void 0,this._finalized=!1,this._document=e,this._documentVersionId=e.version,this._undoStopBefore=t.undoStopBefore,this._undoStopAfter=t.undoStopAfter}finalize(){return this._finalized=!0,{documentVersionId:this._documentVersionId,edits:this._collectedEdits,setEndOfLine:this._setEndOfLine,undoStopBefore:this._undoStopBefore,undoStopAfter:this._undoStopAfter}}_throwIfFinalized(){if(this._finalized)throw Error(`Edit is only valid while callback runs`)}replace(e,t){this._throwIfFinalized();let n=null;if(e instanceof Fb)n=new Ib(e,e);else if(e instanceof Ib)n=e;else throw Error(`Unrecognized location`);this._pushEdit(n,t,!1)}insert(e,t){this._throwIfFinalized(),this._pushEdit(new Ib(e,e),t,!0)}delete(e){this._throwIfFinalized();let t=null;if(e instanceof Ib)t=e;else throw Error(`Unrecognized location`);this._pushEdit(t,null,!0)}_pushEdit(e,t,n){let r=this._document.validateRange(e);this._collectedEdits.push({range:r,text:t,forceMoveMarkers:n})}setEndOfLine(e){if(this._throwIfFinalized(),e!==Wb.LF&&e!==Wb.CRLF)throw h(`endOfLine`);this._setEndOfLine=e}},VF=class{constructor(e,t,n,r){this._proxy=e,this._id=t,this._accept(n),this._logService=r;let i=this;this.value={get tabSize(){return i._tabSize},set tabSize(e){i._setTabSize(e)},get indentSize(){return i._indentSize},set indentSize(e){i._setIndentSize(e)},get insertSpaces(){return i._insertSpaces},set insertSpaces(e){i._setInsertSpaces(e)},get cursorStyle(){return i._cursorStyle},set cursorStyle(e){i._setCursorStyle(e)},get lineNumbers(){return i._lineNumbers},set lineNumbers(e){i._setLineNumbers(e)}}}_accept(e){this._tabSize=e.tabSize,this._indentSize=e.indentSize,this._originalIndentSize=e.originalIndentSize,this._insertSpaces=e.insertSpaces,this._cursorStyle=e.cursorStyle,this._lineNumbers=vO.to(e.lineNumbers)}_validateTabSize(e){if(e===`auto`)return`auto`;if(typeof e==`number`){let t=Math.floor(e);return t>0?t:null}if(typeof e==`string`){let t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setTabSize(e){let t=this._validateTabSize(e);if(t!==null){if(typeof t==`number`){if(this._tabSize===t)return;this._tabSize=t}this._warnOnError(`setTabSize`,this._proxy.$trySetOptions(this._id,{tabSize:t}))}}_validateIndentSize(e){if(e===`tabSize`)return`tabSize`;if(typeof e==`number`){let t=Math.floor(e);return t>0?t:null}if(typeof e==`string`){let t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setIndentSize(e){let t=this._validateIndentSize(e);if(t!==null){if(typeof t==`number`){if(this._originalIndentSize===t)return;this._indentSize=t,this._originalIndentSize=t}this._warnOnError(`setIndentSize`,this._proxy.$trySetOptions(this._id,{indentSize:t}))}}_validateInsertSpaces(e){return e===`auto`?`auto`:e===`false`?!1:!!e}_setInsertSpaces(e){let t=this._validateInsertSpaces(e);if(typeof t==`boolean`){if(this._insertSpaces===t)return;this._insertSpaces=t}this._warnOnError(`setInsertSpaces`,this._proxy.$trySetOptions(this._id,{insertSpaces:t}))}_setCursorStyle(e){this._cursorStyle!==e&&(this._cursorStyle=e,this._warnOnError(`setCursorStyle`,this._proxy.$trySetOptions(this._id,{cursorStyle:e})))}_setLineNumbers(e){this._lineNumbers!==e&&(this._lineNumbers=e,this._warnOnError(`setLineNumbers`,this._proxy.$trySetOptions(this._id,{lineNumbers:vO.from(e)})))}assign(e){let t={},n=!1;if(e.tabSize!==void 0){let r=this._validateTabSize(e.tabSize);r===`auto`?(n=!0,t.tabSize=r):typeof r==`number`&&this._tabSize!==r&&(this._tabSize=r,n=!0,t.tabSize=r)}if(e.indentSize!==void 0){let r=this._validateIndentSize(e.indentSize);r===`tabSize`?(n=!0,t.indentSize=r):typeof r==`number`&&this._originalIndentSize!==r&&(this._indentSize=r,this._originalIndentSize=r,n=!0,t.indentSize=r)}if(e.insertSpaces!==void 0){let r=this._validateInsertSpaces(e.insertSpaces);r===`auto`?(n=!0,t.insertSpaces=r):this._insertSpaces!==r&&(this._insertSpaces=r,n=!0,t.insertSpaces=r)}e.cursorStyle!==void 0&&this._cursorStyle!==e.cursorStyle&&(this._cursorStyle=e.cursorStyle,n=!0,t.cursorStyle=e.cursorStyle),e.lineNumbers!==void 0&&this._lineNumbers!==e.lineNumbers&&(this._lineNumbers=e.lineNumbers,n=!0,t.lineNumbers=vO.from(e.lineNumbers)),n&&this._warnOnError(`setOptions`,this._proxy.$trySetOptions(this._id,t))}_warnOnError(e,t){t.catch(t=>{this._logService.warn(`ExtHostTextEditorOptions '${e}' failed:'`),this._logService.warn(t)})}},HF=class{constructor(e,t,n,r,i,a,o,s){this.id=e,this._proxy=t,this._logService=n,this._disposed=!1,this._hasDecorationsForKey=new Set,this._selections=i,this._options=new VF(this._proxy,this.id,a,n),this._visibleRanges=o,this._viewColumn=s;let c=this;this.value=Object.freeze({get document(){return r.value},set document(e){throw new ue(`document`)},get selection(){return c._selections&&c._selections[0]},set selection(e){if(!(e instanceof Lb))throw h(`selection`);c._selections=[e],c._trySetSelection()},get selections(){return c._selections},set selections(e){if(!Array.isArray(e)||e.some(e=>!(e instanceof Lb)))throw h(`selections`);e.length===0&&(e=[new Lb(0,0,0,0)]),c._selections=e,c._trySetSelection()},get visibleRanges(){return c._visibleRanges},set visibleRanges(e){throw new ue(`visibleRanges`)},get diffInformation(){return c._diffInformation},get options(){return c._options.value},set options(e){c._disposed||c._options.assign(e)},get viewColumn(){return c._viewColumn},set viewColumn(e){throw new ue(`viewColumn`)},edit(e,t={undoStopBefore:!0,undoStopAfter:!0}){if(c._disposed)return Promise.reject(Error(`TextEditor#edit not possible on closed editors`));let n=new BF(r.value,t);return e(n),c._applyEdit(n)},insertSnippet(n,i,a={undoStopBefore:!0,undoStopAfter:!0}){if(c._disposed)return Promise.reject(Error(`TextEditor#insertSnippet not possible on closed editors`));let o;if(!i||Array.isArray(i)&&i.length===0)o=c._selections.map(e=>K.from(e));else if(i instanceof Fb){let{lineNumber:e,column:t}=SD.from(i);o=[{startLineNumber:e,startColumn:t,endLineNumber:e,endColumn:t}]}else if(i instanceof Ib)o=[K.from(i)];else{o=[];for(let e of i)if(e instanceof Ib)o.push(K.from(e));else{let{lineNumber:t,column:n}=SD.from(e);o.push({startLineNumber:t,startColumn:n,endLineNumber:t,endColumn:n})}}return a.keepWhitespace===void 0&&(a.keepWhitespace=!1),t.$tryInsertSnippet(e,r.value.version,n.value,o,a)},setDecorations(n,r){let i=r.length===0;i&&!c._hasDecorationsForKey.has(n.key)||(i?c._hasDecorationsForKey.delete(n.key):c._hasDecorationsForKey.add(n.key),c._runOnProxy(()=>{if(AD(r))return t.$trySetDecorations(e,n.key,MD(r));{let i=Array(4*r.length);for(let e=0,t=r.length;e<t;e++){let t=r[e];i[4*e]=t.start.line+1,i[4*e+1]=t.start.character+1,i[4*e+2]=t.end.line+1,i[4*e+3]=t.end.character+1}return t.$trySetDecorationsFast(e,n.key,i)}}))},revealRange(n,r){c._runOnProxy(()=>t.$tryRevealRange(e,K.from(n),r||Ux.Default))},show(n){t.$tryShowEditor(e,OD.from(n))},hide(){t.$tryHideEditor(e)},[Symbol.for(`debug.description`)](){return`TextEditor(${this.document.uri.toString()})`}})}dispose(){qe(!this._disposed),this._disposed=!0}_acceptOptions(e){qe(!this._disposed),this._options._accept(e)}_acceptVisibleRanges(e){qe(!this._disposed),this._visibleRanges=e}_acceptViewColumn(e){qe(!this._disposed),this._viewColumn=e}_acceptSelections(e){qe(!this._disposed),this._selections=e}_acceptDiffInformation(e){qe(!this._disposed),this._diffInformation=e}async _trySetSelection(){let e=this._selections.map(yD.from);return await this._runOnProxy(()=>this._proxy.$trySetSelections(this.id,e)),this.value}_applyEdit(e){let t=e.finalize();if(t.edits.length===0&&!t.setEndOfLine)return Promise.resolve(!0);let n=t.edits.map(e=>e.range);n.sort((e,t)=>e.end.line===t.end.line?e.end.character===t.end.character?e.start.line===t.start.line?e.start.character-t.start.character:e.start.line-t.start.line:e.end.character-t.end.character:e.end.line-t.end.line);for(let e=0,t=n.length-1;e<t;e++){let t=n[e].end,r=n[e+1].start;if(r.isBefore(t))return Promise.reject(Error(`Overlapping ranges are not allowed!`))}let r=t.edits.map(e=>({range:K.from(e.range),text:e.text,forceMoveMarkers:e.forceMoveMarkers}));return this._proxy.$tryApplyEdits(this.id,t.documentVersionId,r,{setEndOfLine:typeof t.setEndOfLine==`number`?yO.from(t.setEndOfLine):void 0,undoStopBefore:t.undoStopBefore,undoStopAfter:t.undoStopAfter})}_runOnProxy(e){return this._disposed?(this._logService.warn(`TextEditor is closed/disposed`),Promise.resolve(void 0)):e().then(()=>this,e=>(e instanceof Error&&e.name===`DISPOSED`||this._logService.warn(e),null))}},UF=class{constructor(e){this.value=e,this._count=0}ref(){this._count++}unref(){return--this._count===0}};let WF=class{constructor(e,t){this._extHostRpc=e,this._logService=t,this._activeEditorId=null,this._editors=new Map,this._documents=new ze,this._onDidAddDocuments=new x,this._onDidRemoveDocuments=new x,this._onDidChangeVisibleTextEditors=new x,this._onDidChangeActiveTextEditor=new x,this.onDidAddDocuments=this._onDidAddDocuments.event,this.onDidRemoveDocuments=this._onDidRemoveDocuments.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event}$acceptDocumentsAndEditorsDelta(e){this.acceptDocumentsAndEditorsDelta(e)}acceptDocumentsAndEditorsDelta(e){let t=[],n=[],r=[];if(e.removedDocuments)for(let n of e.removedDocuments){let e=w.revive(n),r=this._documents.get(e);r?.unref()&&(this._documents.delete(e),t.push(r.value))}if(e.addedDocuments)for(let t of e.addedDocuments){let e=w.revive(t.uri),r=this._documents.get(e);if(r&&e.scheme!==O.vscodeNotebookCell&&e.scheme!==O.vscodeInteractiveInput)throw Error(`document '${e} already exists!'`);r||(r=new UF(new IF(this._extHostRpc.getProxy(E.MainThreadDocuments),e,t.lines,t.EOL,t.versionId,t.languageId,t.isDirty,t.encoding)),this._documents.set(e,r),n.push(r.value)),r.ref()}if(e.removedEditors)for(let t of e.removedEditors){let e=this._editors.get(t);this._editors.delete(t),e&&r.push(e)}if(e.addedEditors)for(let t of e.addedEditors){let e=w.revive(t.documentUri);qe(this._documents.has(e),`document '${e}' does not exist`),qe(!this._editors.has(t.id),`editor '${t.id}' already exists!`);let n=this._documents.get(e).value,r=new HF(t.id,this._extHostRpc.getProxy(E.MainThreadTextEditors),this._logService,new u(()=>n.document),t.selections.map(yD.to),t.options,t.visibleRanges.map(e=>K.to(e)),typeof t.editorPosition==`number`?OD.to(t.editorPosition):void 0);this._editors.set(t.id,r)}e.newActiveEditor!==void 0&&(qe(e.newActiveEditor===null||this._editors.has(e.newActiveEditor),`active editor '${e.newActiveEditor}' does not exist`),this._activeEditorId=e.newActiveEditor),yt(t),yt(r),e.removedDocuments&&this._onDidRemoveDocuments.fire(t),e.addedDocuments&&this._onDidAddDocuments.fire(n),(e.removedEditors||e.addedEditors)&&this._onDidChangeVisibleTextEditors.fire(this.allEditors().map(e=>e.value)),e.newActiveEditor!==void 0&&this._onDidChangeActiveTextEditor.fire(this.activeEditor())}getDocument(e){return this._documents.get(e)?.value}allDocuments(){return pt.map(this._documents.values(),e=>e.value)}getEditor(e){return this._editors.get(e)}activeEditor(e){if(!this._activeEditorId)return;let t=this._editors.get(this._activeEditorId);return e?t:t?.value}allEditors(){return[...this._editors.values()]}};WF=A([j(0,Is),j(1,xs)],WF);const GF=k(`IExtHostDocumentsAndEditors`),KF={type:`object`,additionalProperties:!1,properties:{type:{type:`string`,description:C(10738,`The actual task type. Please note that types starting with a '$' are reserved for internal usage.`)},required:{type:`array`,items:{type:`string`}},properties:{type:`object`,description:C(10739,`Additional properties of the task type`),additionalProperties:{$ref:`http://json-schema.org/draft-07/schema#`}},when:{type:`string`,markdownDescription:C(10740,"Condition which must be true to enable this type of task. Consider using `shellExecutionSupported`, `processExecutionSupported`, and `customExecutionSupported` as appropriate for this task definition. See the [API documentation](https://code.visualstudio.com/api/extension-guides/task-provider#when-clause) for more information."),default:``}}};var qF;(function(e){function t(e,t,n){if(!e)return;let r=Ze(e.type)?e.type:void 0;if(!r||r.length===0){n.error(C(10741,`The task type configuration is missing the required 'taskType' property`));return}let i=[];if(Array.isArray(e.required))for(let t of e.required)Ze(t)&&i.push(t);return{extensionId:t.value,taskType:r,required:i,properties:e.properties?Ys(e.properties):{},when:e.when?Td.deserialize(e.when):void 0}}e.from=t})(qF||={});const JF=t_.registerExtensionPoint({extensionPoint:`taskDefinitions`,activationEventsGenerator:(e,t)=>{for(let n of e)n.type&&t.push(`onTaskType:${n.type}`)},jsonSchema:{description:C(10742,`Contributes task kinds`),type:`array`,items:KF}});var YF=class{constructor(){this._onDefinitionsChanged=new x,this.onDefinitionsChanged=this._onDefinitionsChanged.event,this.taskTypes=Object.create(null),this.readyPromise=new Promise((e,t)=>{JF.setHandler((t,n)=>{this._schema=void 0;try{for(let e of n.removed){let t=e.value;for(let e of t)this.taskTypes&&e.type&&this.taskTypes[e.type]&&delete this.taskTypes[e.type]}for(let e of n.added){let t=e.value;for(let n of t){let t=qF.from(n,e.description.identifier,e.collector);t&&(this.taskTypes[t.taskType]=t)}}(n.removed.length>0||n.added.length>0)&&this._onDefinitionsChanged.fire()}catch{}e(void 0)})})}onReady(){return this.readyPromise}get(e){return this.taskTypes[e]}all(){return Object.keys(this.taskTypes).map(e=>this.taskTypes[e])}getJsonSchema(){if(this._schema===void 0){let e=[];for(let t of this.all()){let n={type:`object`,additionalProperties:!1};t.required.length>0&&(n.required=t.required.slice(0)),t.properties===void 0?n.properties=Object.create(null):n.properties=Ys(t.properties),n.properties.type={type:`string`,enum:[t.taskType]},e.push(n)}this._schema={oneOf:e}}return this._schema}};const XF=new YF,ZF={IconContribution:`base.contributions.icons`};var QF;(function(e){function t(e,t){let n=e.defaults;for(;fl.isThemeIcon(n);){let e=rI.getIcon(n.id);if(!e)return;n=e.defaults}return n}e.getDefinition=t})(QF||={});var $F;(function(e){function t(e){return{weight:e.weight,style:e.style,src:e.src.map(e=>({format:e.format,location:e.location.toString()}))}}e.toJSONObject=t;function n(e){let t=e=>Ze(e)?e:void 0;if(e&&Array.isArray(e.src)&&e.src.every(e=>Ze(e.format)&&Ze(e.location)))return{weight:t(e.weight),style:t(e.style),src:e.src.map(e=>({format:e.format,location:w.parse(e.location)}))}}e.fromJSONObject=n})($F||={});const eI=/^([\w_-]+)$/,tI=C(2325,`The font ID must only contain letters, numbers, underscores and dashes.`);var nI=class extends y{constructor(){super(),this._onDidChange=this._register(new x),this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:`object`,properties:{fontId:{type:`string`,description:C(2326,`The id of the font to use. If not set, the font that is defined first is used.`),pattern:eI.source,patternErrorMessage:tI},fontCharacter:{type:`string`,description:C(2327,`The font character associated with the icon definition.`)}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:`\\\\e030`}}]}},type:`object`,properties:{}},this.iconReferenceSchema={type:`string`,pattern:`^${fl.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,n,r){let i=this.iconsById[e];if(i){if(n&&!i.description){i.description=n,this.iconSchema.properties[e].markdownDescription=`${n} $(${e})`;let t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enumDescriptions[t]=n),this._onDidChange.fire()}return i}let a={id:e,description:n,defaults:t,deprecationMessage:r};this.iconsById[e]=a;let o={$ref:`#/definitions/icons`};return r&&(o.deprecationMessage=r),n&&(o.markdownDescription=`${n}: $(${e})`),this.iconSchema.properties[e]=o,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(n||``),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];let t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){let n=this.iconFontsById[e];return n||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){let e=(e,t)=>e.id.localeCompare(t.id),t=e=>{for(;fl.isThemeIcon(e.defaults);)e=this.iconsById[e.defaults.id];return`codicon codicon-${e?e.id:``}`},n=[];n.push(`| preview     | identifier                        | default codicon ID                | description`),n.push(`| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |`);let r=Object.keys(this.iconsById).map(e=>this.iconsById[e]);for(let i of r.filter(e=>!!e.description).sort(e))n.push(`|<i class="${t(i)}"></i>|${i.id}|${fl.isThemeIcon(i.defaults)?i.defaults.id:i.id}|${i.description||``}|`);n.push(`| preview     | identifier                        `),n.push(`| ----------- | --------------------------------- |`);for(let i of r.filter(e=>!fl.isThemeIcon(e.defaults)).sort(e))n.push(`|<i class="${t(i)}"></i>|${i.id}|`);return n.join(`
`)}};const rI=new nI;Sm.add(ZF.IconContribution,rI);function iI(e,t,n,r){return rI.registerIcon(e,t,n,r)}function aI(){let e=cl();for(let t in e){let n=`\\`+e[t].toString(16);rI.registerIcon(t,{fontCharacter:n})}}aI();const oI=`vscode://schemas/icons`,sI=Sm.as(Gh.JSONContribution);sI.registerSchema(oI,rI.getIconSchema());const cI=new Do(()=>sI.notifySchemaChanged(oI),200);rI.onDidChange(()=>{cI.isScheduled()||cI.schedule()}),iI(`widget-close`,P.close,C(2328,`Icon for the close action in widgets.`)),iI(`goto-previous-location`,P.arrowUp,C(2329,`Icon for goto previous editor location.`)),iI(`goto-next-location`,P.arrowDown,C(2330,`Icon for goto next editor location.`)),fl.modify(P.sync,`spin`),fl.modify(P.loading,`spin`),iI(`rerun-task`,P.refresh,C(10531,`View icon of the rerun task.`)),new I(`taskRunning`,!1,C(10752,`Whether a task is currently running.`)),new I(`taskTerminalActive`,!1,C(10753,`Whether the active terminal is a task terminal.`)),Nn(10754,`Tasks`);var lI;(function(e){e[e.Escape=1]=`Escape`,e[e.Strong=2]=`Strong`,e[e.Weak=3]=`Weak`})(lI||={}),(function(e){function t(t){if(!t)return e.Strong;switch(t.toLowerCase()){case`escape`:return e.Escape;case`strong`:return e.Strong;case`weak`:return e.Weak;default:return e.Strong}}e.from=t})(lI||={});var uI;(function(e){e.defaults={cwd:"${workspaceFolder}"}})(uI||={});var dI;(function(e){e[e.Always=1]=`Always`,e[e.Silent=2]=`Silent`,e[e.Never=3]=`Never`})(dI||={}),(function(e){function t(t){switch(t.toLowerCase()){case`always`:return e.Always;case`silent`:return e.Silent;case`never`:return e.Never;default:return e.Always}}e.fromString=t})(dI||={});var fI;(function(e){e[e.Never=1]=`Never`,e[e.OnProblem=2]=`OnProblem`,e[e.Always=3]=`Always`})(fI||={}),(function(e){function t(t){switch(t.toLowerCase()){case`always`:return e.Always;case`never`:return e.Never;case`onproblem`:return e.OnProblem;default:return e.OnProblem}}e.fromString=t})(fI||={});var pI;(function(e){e[e.Shared=1]=`Shared`,e[e.Dedicated=2]=`Dedicated`,e[e.New=3]=`New`})(pI||={}),(function(e){function t(t){switch(t.toLowerCase()){case`shared`:return e.Shared;case`dedicated`:return e.Dedicated;case`new`:return e.New;default:return e.Shared}}e.fromString=t})(pI||={});var mI;(function(e){e.defaults={echo:!0,reveal:dI.Always,revealProblems:fI.Never,focus:!1,panel:pI.Shared,showReuseMessage:!0,clear:!1}})(mI||={});var hI;(function(e){e[e.Shell=1]=`Shell`,e[e.Process=2]=`Process`,e[e.CustomExecution=3]=`CustomExecution`})(hI||={}),(function(e){function t(t){switch(t.toLowerCase()){case`shell`:return e.Shell;case`process`:return e.Process;case`customExecution`:return e.CustomExecution;default:return e.Process}}e.fromString=t;function n(t){switch(t){case e.Shell:return`shell`;case e.Process:return`process`;case e.CustomExecution:return`customExecution`;default:return`process`}}e.toString=n})(hI||={});var gI;(function(e){function t(e){return Ze(e)?e:e.value}e.value=t})(gI||={});var _I;(function(e){e.Clean={_id:`clean`,isDefault:!1},e.Build={_id:`build`,isDefault:!1},e.Rebuild={_id:`rebuild`,isDefault:!1},e.Test={_id:`test`,isDefault:!1};function t(t){return t===e.Clean._id||t===e.Build._id||t===e.Rebuild._id||t===e.Test._id}e.is=t;function n(e){if(e!==void 0)return Ze(e)?t(e)?{_id:e,isDefault:!1}:void 0:e}e.from=n})(_I||={});var vI;(function(e){e[e.Global=1]=`Global`,e[e.Workspace=2]=`Workspace`,e[e.Folder=3]=`Folder`})(vI||={});var yI;(function(e){e.Workspace=`workspace`,e.Extension=`extension`,e.InMemory=`inMemory`,e.WorkspaceFile=`workspaceFile`,e.User=`user`;function t(t){switch(t){case e.User:return Fh.USER;case e.WorkspaceFile:return Fh.WORKSPACE;default:return Fh.WORKSPACE_FOLDER}}e.toConfigurationTarget=t})(yI||={});var bI;(function(e){e.parallel=`parallel`,e.sequence=`sequence`})(bI||={});var xI;(function(e){e[e.default=1]=`default`,e[e.folderOpen=2]=`folderOpen`})(xI||={});var SI;(function(e){e.terminateNewest=`terminateNewest`,e.terminateOldest=`terminateOldest`,e.prompt=`prompt`,e.warn=`warn`,e.silent=`silent`})(SI||={});var CI;(function(e){e.defaults={reevaluateOnRerun:!0,runOn:xI.default,instanceLimit:1,instancePolicy:SI.prompt}})(CI||={});var wI;(function(e){e[e.Process=1]=`Process`,e[e.Terminal=2]=`Terminal`})(wI||={}),(function(e){e._default=e.Terminal})(wI||={});var TI;(function(e){e[e.V0_1_0=1]=`V0_1_0`,e[e.V2_0_0=2]=`V2_0_0`})(TI||={});var EI;(function(e){e.SingleRun=`singleRun`,e.Background=`background`})(EI||={});var DI;(function(e){e.Changed=`changed`,e.ProcessStarted=`processStarted`,e.ProcessEnded=`processEnded`,e.Terminated=`terminated`,e.Start=`start`,e.AcquiredInput=`acquiredInput`,e.DependsOnStarted=`dependsOnStarted`,e.Active=`active`,e.Inactive=`inactive`,e.End=`end`,e.ProblemMatcherStarted=`problemMatcherStarted`,e.ProblemMatcherEnded=`problemMatcherEnded`,e.ProblemMatcherFoundErrors=`problemMatcherFoundErrors`})(DI||={});var OI;(function(e){e[e.System=0]=`System`,e[e.User=1]=`User`,e[e.FolderOpen=2]=`FolderOpen`,e[e.ConfigurationChange=3]=`ConfigurationChange`,e[e.Reconnect=4]=`Reconnect`})(OI||={});var kI;(function(e){function t(e){return{taskId:e._id,taskName:e.configurationProperties.name,runType:e.configurationProperties.isBackground?EI.Background:EI.SingleRun,group:e.configurationProperties.group,__task:e}}function n(e,n,r){return{...t(e),kind:DI.Start,terminalId:n,resolvedVariables:r}}e.start=n;function r(e,n,r){return{...t(e),kind:DI.ProcessStarted,terminalId:n,processId:r}}e.processStarted=r;function i(e,n,r){return{...t(e),kind:DI.ProcessEnded,terminalId:n,exitCode:r}}e.processEnded=i;function a(e,n,r){return{...t(e),kind:DI.Terminated,exitReason:r,terminalId:n}}e.terminated=a;function o(e,n,r){return{...t(n),kind:e,terminalId:r}}e.general=o;function s(e,n,r){return{...t(e),kind:DI.ProblemMatcherEnded,hasErrors:n}}e.problemMatcherEnded=s;function c(){return{kind:DI.Changed}}e.changed=c})(kI||={});var AI;(function(e){function t(e){let n=Object.keys(e).sort(),r=``;for(let i of n){let n=e[i];n instanceof Object?n=t(n):typeof n==`string`&&(n=n.replace(/,/g,`,,`)),r+=i+`,`+n+`,`}return r}function n(e){let n=t(e),r={_key:n,type:e.taskType};return Object.assign(r,e),r}e.create=n})(AI||={});var jI;(function(e){e.AutoDetect=`task.autoDetect`,e.SaveBeforeRun=`task.saveBeforeRun`,e.ShowDecorations=`task.showDecorations`,e.ProblemMatchersNeverPrompt=`task.problemMatchers.neverPrompt`,e.SlowProviderWarning=`task.slowProviderWarning`,e.QuickOpenHistory=`task.quickOpen.history`,e.QuickOpenDetail=`task.quickOpen.detail`,e.QuickOpenSkip=`task.quickOpen.skip`,e.QuickOpenShowAll=`task.quickOpen.showAll`,e.AllowAutomaticTasks=`task.allowAutomaticTasks`,e.Reconnection=`task.reconnection`,e.VerboseLogging=`task.verboseLogging`})(jI||={});var MI;(function(e){e.Tasks=`tasks`,e.SuppressTaskName=`tasks.suppressTaskName`,e.Windows=`tasks.windows`,e.Osx=`tasks.osx`,e.Linux=`tasks.linux`,e.ShowOutput=`tasks.showOutput`,e.IsShellCommand=`tasks.isShellCommand`,e.ServiceTestSetting=`tasks.service.testSetting`})(MI||={});var NI;(function(e){function t(e,t){let n=XF.get(e.type);if(n===void 0){let t=Ys(e);return delete t._key,AI.create(t)}let r=Object.create(null);r.type=n.taskType;let i=new Set;n.required.forEach(e=>i.add(e));let a=n.properties;for(let n of Object.keys(a)){let o=e[n];if(o!=null)r[n]=o;else if(i.has(n)){let i=a[n];if(i.default!==void 0)r[n]=Ys(i.default);else switch(i.type){case`boolean`:r[n]=!1;break;case`number`:case`integer`:r[n]=0;break;case`string`:r[n]=``;break;default:t.error(C(10755,`Error: the task identifier '{0}' is missing the required property '{1}'. The task identifier will be ignored.`,JSON.stringify(e,void 0,0),n));return}}}return AI.create(r)}e.createTaskIdentifier=t})(NI||={});var PI;(function(e){function t(e){if(e!=null)return e}e.from=t;function n(e){if(e!=null)return e}e.to=n})(PI||={});var FI;(function(e){function t(e){if(e!=null)return e}e.from=t;function n(e){if(e!=null)return e}e.to=n})(FI||={});var II;(function(e){function t(e){if(e!=null)return e}e.from=t;function n(e){if(e!=null)return e}e.to=n})(II||={});var LI;(function(e){function t(e){if(e){let t=e;return t&&!!t.process}else return!1}e.is=t;function n(e){if(e==null)return;let t={process:e.process,args:e.args};return e.options&&(t.options=II.from(e.options)),t}e.from=n;function r(e){if(e!=null)return new _S(e.process,e.args,e.options)}e.to=r})(LI||={});var RI;(function(e){function t(e){if(e!=null)return e}e.from=t;function n(e){if(e!=null)return e}e.to=n})(RI||={});var zI;(function(e){function t(e){if(e){let t=e;return t&&(!!t.commandLine||!!t.command)}else return!1}e.is=t;function n(e){if(e==null)return;let t={};return e.commandLine===void 0?(t.command=e.command,t.args=e.args):t.commandLine=e.commandLine,e.options&&(t.options=RI.from(e.options)),t}e.from=n;function r(e){if(!(e==null||e.command===void 0&&e.commandLine===void 0))return e.commandLine?new vS(e.commandLine,e.options):new vS(e.command,e.args?e.args:[],e.options)}e.to=r})(zI||={});var BI;(function(e){function t(e){if(e){let t=e;return t&&t.customExecution===`customExecution`}else return!1}e.is=t;function n(e){return{customExecution:`customExecution`}}e.from=n;function r(e,t){return t.get(e)}e.to=r})(BI||={});var VI;(function(e){function t(e,t){let n;return e.scope!==void 0&&typeof e.scope!=`number`?n=e.scope.uri:e.scope!==void 0&&typeof e.scope==`number`&&(n=e.scope===bS.Workspace&&t&&t.workspaceFile?t.workspaceFile:`settings`),{id:e._id,workspaceFolder:n}}e.from=t})(VI||={});var HI;(function(e){function t(e){if(e!=null)return{_id:e.id,isDefault:e.isDefault}}e.from=t})(HI||={});var UI;(function(e){function t(e,t){if(e==null)return[];let r=[];for(let i of e){let e=n(i,t);e&&r.push(e)}return r}e.fromMany=t;function n(e,t){if(e==null)return;let n;e.execution instanceof _S?n=LI.from(e.execution):e.execution instanceof vS?n=zI.from(e.execution):e.execution&&e.execution instanceof xS&&(n=BI.from(e.execution));let r=PI.from(e.definition),i;if(i=e.scope?typeof e.scope==`number`?e.scope:e.scope.uri:bS.Workspace,!r||!i)return;let a={_id:e._id,definition:r,name:e.name,source:{extensionId:t.identifier.value,label:e.source,scope:i},execution:n,isBackground:e.isBackground,group:HI.from(e.group),presentationOptions:FI.from(e.presentationOptions),problemMatchers:De(e.problemMatchers),hasDefinedMatchers:e.hasDefinedMatchers,runOptions:e.runOptions?e.runOptions:{reevaluateOnRerun:!0},detail:e.detail};return a}e.from=n;async function r(e,t,n){if(e==null)return;let r;LI.is(e.execution)?r=LI.to(e.execution):zI.is(e.execution)?r=zI.to(e.execution):BI.is(e.execution)&&(r=BI.to(e._id,n));let i=PI.to(e.definition),a;if(e.source&&(a=e.source.scope===void 0?bS.Workspace:typeof e.source.scope==`number`?e.source.scope:await t.resolveWorkspaceFolder(w.revive(e.source.scope))),!i||!a)return;let o=new SS(i,a,e.name,e.source.label,r,e.problemMatchers);return e.isBackground!==void 0&&(o.isBackground=e.isBackground),e.group!==void 0&&(o.group=hS.from(e.group._id),o.group&&e.group.isDefault&&(o.group=new hS(o.group.id,o.group.label),e.group.isDefault===!0&&(o.group.isDefault=e.group.isDefault))),e.presentationOptions&&(o.presentationOptions=FI.to(e.presentationOptions)),e._id&&(o._id=e._id),e.detail&&(o.detail=e.detail),o}e.to=r})(UI||={});var WI;(function(e){function t(e){return e}e.from=t;function n(e){if(e)return Object.assign(Object.create(null),e)}e.to=n})(WI||={});var GI=class{#tasks;constructor(e,t,n){this._id=t,this._task=n,this.#tasks=e}get task(){return this._task}terminate(){this.#tasks.terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}get terminal(){return this._terminal}set terminal(e){this._terminal=e}};let KI=class{constructor(e,t,n,r,i,a,o,s){this._onDidExecuteTask=new x,this._onDidTerminateTask=new x,this._onDidTaskProcessStarted=new x,this._onDidTaskProcessEnded=new x,this._onDidStartTaskProblemMatchers=new x,this._onDidEndTaskProblemMatchers=new x,this._proxy=e.getProxy(E.MainThreadTask),this._workspaceProvider=n,this._editorService=r,this._configurationService=i,this._terminalService=a,this._handleCounter=0,this._handlers=new Map,this._taskExecutions=new Map,this._taskExecutionPromises=new Map,this._providedCustomExecutions2=new Map,this._notProvidedCustomExecutions=new Set,this._activeCustomExecutions2=new Map,this._logService=o,this._deprecationService=s,this._proxy.$registerSupportedExecutions(!0)}registerTaskProvider(e,t,n){if(!n)return new Pb(()=>{});let r=this.nextHandle();return this._handlers.set(r,{type:t,provider:n,extension:e}),this._proxy.$registerTaskProvider(r,t),new Pb(()=>{this._handlers.delete(r),this._proxy.$unregisterTaskProvider(r)})}registerTaskSystem(e,t){this._proxy.$registerTaskSystem(e,t)}fetchTasks(e){return this._proxy.$fetchTasks(WI.from(e)).then(async e=>{let t=[];for(let n of e){let e=await UI.to(n,this._workspaceProvider,this._providedCustomExecutions2);e&&t.push(e)}return t})}get taskExecutions(){let e=[];return this._taskExecutions.forEach(t=>e.push(t)),e}terminateTask(e){if(!(e instanceof GI))throw Error(`No valid task execution provided`);return this._proxy.$terminateTask(e._id)}get onDidStartTask(){return this._onDidExecuteTask.event}async $onDidStartTask(e,t,n){let r=this._providedCustomExecutions2.get(e.id);r&&(this._activeCustomExecutions2.set(e.id,r),this._terminalService.attachPtyToTerminal(t,await r.callback(n))),this._lastStartedTask=e.id;let i=await this.getTaskExecution(e),a=this._terminalService.getTerminalById(t)?.value;i&&(i.terminal=a),this._onDidExecuteTask.fire({execution:i})}get onDidEndTask(){return this._onDidTerminateTask.event}async $OnDidEndTask(e){if(!this._taskExecutionPromises.has(e.id))return;let t=await this.getTaskExecution(e);this._taskExecutionPromises.delete(e.id),this._taskExecutions.delete(e.id),this.customExecutionComplete(e),this._onDidTerminateTask.fire({execution:t})}get onDidStartTaskProcess(){return this._onDidTaskProcessStarted.event}async $onDidStartTaskProcess(e){let t=await this.getTaskExecution(e.id);this._onDidTaskProcessStarted.fire({execution:t,processId:e.processId})}get onDidEndTaskProcess(){return this._onDidTaskProcessEnded.event}async $onDidEndTaskProcess(e){let t=await this.getTaskExecution(e.id);this._onDidTaskProcessEnded.fire({execution:t,exitCode:e.exitCode})}get onDidStartTaskProblemMatchers(){return this._onDidStartTaskProblemMatchers.event}async $onDidStartTaskProblemMatchers(e){let t;try{t=await this.getTaskExecution(e.execution.id)}catch{return}this._onDidStartTaskProblemMatchers.fire({execution:t})}get onDidEndTaskProblemMatchers(){return this._onDidEndTaskProblemMatchers.event}async $onDidEndTaskProblemMatchers(e){let t;try{t=await this.getTaskExecution(e.execution.id)}catch{return}this._onDidEndTaskProblemMatchers.fire({execution:t,hasErrors:e.hasErrors})}$provideTasks(e,t){let n=this._handlers.get(e);if(!n)return Promise.reject(Error(`no handler found`));let r=[],i=uo(()=>n.provider.provideTasks(Oi.None)).then(e=>this.provideTasksInternal(t,r,n,e));return new Promise(e=>{i.then(t=>{Promise.all(r).then(()=>{e(t)})})})}async $resolveTask(e,t){let n=this._handlers.get(e);if(!n)return Promise.reject(Error(`no handler found`));if(t.definition.type!==n.type)throw Error(`Unexpected: Task of type [${t.definition.type}] cannot be resolved by provider of type [${n.type}].`);let r=await UI.to(t,this._workspaceProvider,this._providedCustomExecutions2);if(!r)throw Error(`Unexpected: Task cannot be resolved.`);let i=await n.provider.resolveTask(r,Oi.None);if(!i)return;this.checkDeprecation(i,n);let a=UI.from(i,n.extension);if(!a)throw Error(`Unexpected: Task cannot be resolved.`);if(i.definition!==r.definition)throw Error(`Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.`);return BI.is(a.execution)&&await this.addCustomExecution(a,i,!0),await this.resolveTaskInternal(a)}nextHandle(){return this._handleCounter++}async addCustomExecution(e,t,n){let r=await this._proxy.$createTaskId(e);!n&&!this._providedCustomExecutions2.has(r)&&(this._notProvidedCustomExecutions.add(r),this._activeCustomExecutions2.set(r,t.execution)),this._providedCustomExecutions2.set(r,t.execution)}async getTaskExecution(e,t){if(typeof e==`string`){let t=this._taskExecutionPromises.get(e);if(!t)throw new pe(`Unexpected: The specified task is missing an execution`);return t}let n=this._taskExecutionPromises.get(e.id);if(n)return n;let r;return r=t?Promise.resolve(new GI(this,e.id,t)):UI.to(e.task,this._workspaceProvider,this._providedCustomExecutions2).then(t=>{if(!t)throw new pe(`Unexpected: Task does not exist.`);return new GI(this,e.id,t)}),this._taskExecutionPromises.set(e.id,r),r.then(t=>(this._taskExecutions.set(e.id,t),t))}checkDeprecation(e,t){let n=e;n._deprecated&&this._deprecationService.report(`Task.constructor`,t.extension,"Use the Task constructor that takes a `scope` instead.")}customExecutionComplete(e){let t=this._activeCustomExecutions2.get(e.id);t&&this._activeCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.has(e.id)&&this._lastStartedTask!==e.id&&(this._providedCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.delete(e.id));let n=this._notProvidedCustomExecutions.values(),r=n.next();for(;!r.done;)!this._activeCustomExecutions2.has(r.value)&&this._lastStartedTask!==r.value&&(this._providedCustomExecutions2.delete(r.value),this._notProvidedCustomExecutions.delete(r.value)),r=n.next()}};KI=A([j(0,Is),j(1,ks),j(2,nj),j(3,GF),j(4,kj),j(5,rN),j(6,xs),j(7,QP)],KI);let qI=class extends KI{constructor(e,t,n,r,i,a,o,s){super(e,t,n,r,i,a,o,s),this.registerTaskSystem(O.vscodeRemote,{scheme:O.vscodeRemote,authority:``,platform:Yn(Jn.Web)})}async executeTask(e,t){if(!t.execution)throw Error(`Tasks to execute must include an execution`);let n=UI.from(t,e);if(n===void 0)throw Error(`Task is not valid`);if(BI.is(n.execution))await this.addCustomExecution(n,t,!1);else throw new fe;let r=await this.getTaskExecution(await this._proxy.$getTaskExecution(n),t);return this._proxy.$executeTask(n).catch(e=>{throw Error(e)}),r}provideTasksInternal(e,t,n,r){let i=[];if(r)for(let a of r){if(this.checkDeprecation(a,n),!a.definition||!e[a.definition.type]){let e=a.source?a.source:`No task source`;this._logService.warn(`The task [${e}, ${a.name}] uses an undefined task type. The task will be ignored in the future.`)}let r=UI.from(a,n.extension);r&&BI.is(r.execution)?(i.push(r),t.push(this.addCustomExecution(r,a,!0))):this._logService.warn(`Only custom execution tasks supported.`)}return{tasks:i,extension:n.extension}}async resolveTaskInternal(e){if(BI.is(e.execution))return e;this._logService.warn(`Only custom execution tasks supported.`)}async $resolveVariables(e,t){let n={process:void 0,variables:Object.create(null)};return n}async $jsonTasksSupported(){return!1}async $findExecutable(e,t,n){}};qI=A([j(0,Is),j(1,ks),j(2,nj),j(3,GF),j(4,kj),j(5,rN),j(6,xs),j(7,QP)],qI);const JI=k(`IExtHostTask`);var YI=class{constructor(){this.pendingRequests=new Map,this.queue=[],this._onError=new x,this._onExit=new x,this.sequence=1}get onError(){return this._onError.event}get onExit(){return this._onExit.event}onMessage(e){this.messageCallback&&this._onError.fire(Error(`attempt to set more than one 'Message' callback`)),this.messageCallback=e}onEvent(e){this.eventCallback&&this._onError.fire(Error(`attempt to set more than one 'Event' callback`)),this.eventCallback=e}onRequest(e){this.requestCallback&&this._onError.fire(Error(`attempt to set more than one 'Request' callback`)),this.requestCallback=e}sendResponse(e){e.seq>0?this._onError.fire(Error(`attempt to send more than one response for command ${e.command}`)):this.internalSend(`response`,e)}sendRequest(e,t,n,r){let i={command:e};if(t&&Object.keys(t).length>0&&(i.arguments=t),this.internalSend(`request`,i),typeof r==`number`){let t=setTimeout(()=>{clearTimeout(t);let n=this.pendingRequests.get(i.seq);if(n){this.pendingRequests.delete(i.seq);let t={type:`response`,seq:0,request_seq:i.seq,success:!1,command:e,message:C(6391,`Timeout after {0} ms for '{1}'`,r,e)};n(t)}},r)}return n&&this.pendingRequests.set(i.seq,n),i.seq}acceptMessage(e){this.messageCallback?this.messageCallback(e):(this.queue.push(e),this.queue.length===1&&this.processQueue())}needsTaskBoundaryBetween(e,t){return e.type!==`event`||t.type!==`event`}async processQueue(){let e;for(;this.queue.length;){if((!e||this.needsTaskBoundaryBetween(this.queue[0],e))&&await xo(0),e=this.queue.shift(),!e)return;switch(e.type){case`event`:this.eventCallback?.(e);break;case`request`:this.requestCallback?.(e);break;case`response`:{let t=e,n=this.pendingRequests.get(t.request_seq);n&&(this.pendingRequests.delete(t.request_seq),n(t));break}}}}internalSend(e,t){t.type=e,t.seq=this.sequence++,this.sendMessage(t)}async cancelPendingRequests(){if(this.pendingRequests.size===0)return Promise.resolve();let e=new Map;this.pendingRequests.forEach((t,n)=>e.set(n,t)),await xo(500),e.forEach((e,t)=>{let n={type:`response`,seq:0,request_seq:t,success:!1,command:`canceled`,message:`canceled`};e(n),this.pendingRequests.delete(t)})}getPendingRequestIds(){return Array.from(this.pendingRequests.keys())}dispose(){this.queue=[]}};function XI(e){return e.type&&(e.label||e.program||e.runtime)}const ZI=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;function QI(e){return!!(e&&e.match(ZI))}function $I(e){if(typeof e.path==`string`&&!(typeof e.sourceReference==`number`&&e.sourceReference>0)){if(QI(e.path))return w.parse(e.path);if(zr(e.path))return w.file(e.path)}return e.path}function eL(e){if(typeof e.path==`object`){let t=w.revive(e.path);if(t)return t.scheme===O.file?t.fsPath:t.toString()}return e.path}function tL(e,t){let n=t?$I:eL,r=Ys(e);return rL(r,(e,t)=>{e&&t&&(t.path=n(t))}),r}function nL(e,t){let n=t?$I:eL,r=Ys(e);return rL(r,(e,t)=>{!e&&t&&(t.path=n(t))}),r}function rL(e,t){switch(e.type){case`event`:{let n=e;switch(n.event){case`output`:t(!1,n.body.source);break;case`loadedSource`:t(!1,n.body.source);break;case`breakpoint`:t(!1,n.body.breakpoint.source);break}break}case`request`:{let n=e;switch(n.command){case`setBreakpoints`:t(!0,n.arguments.source);break;case`breakpointLocations`:t(!0,n.arguments.source);break;case`source`:t(!0,n.arguments.source);break;case`gotoTargets`:t(!0,n.arguments.source);break;case`launchVSCode`:n.arguments.args.forEach(e=>t(!1,e));break}break}case`response`:{let n=e;if(n.success&&n.body)switch(n.command){case`stackTrace`:n.body.stackFrames.forEach(e=>t(!1,e.source));break;case`loadedSources`:n.body.sources.forEach(e=>t(!1,e));break;case`scopes`:n.body.scopes.forEach(e=>t(!1,e.source));break;case`setFunctionBreakpoints`:n.body.breakpoints.forEach(e=>t(!1,e.source));break;case`setBreakpoints`:n.body.breakpoints.forEach(e=>t(!1,e.source));break;case`disassemble`:{let e=n;e.body?.instructions.forEach(e=>t(!1,e.location))}break;case`locations`:t(!1,n.body?.source);break}break}}}const iL=k(`IExtHostEditorTabs`);var aL=class{constructor(e,t,n){this._activeTabIdGetter=n,this._parentGroup=t,this.acceptDtoUpdate(e)}get apiObject(){if(!this._apiObject){let e=this,t={get isActive(){return e._dto.id===e._activeTabIdGetter()},get label(){return e._dto.label},get input(){return e._input},get isDirty(){return e._dto.isDirty},get isPinned(){return e._dto.isPinned},get isPreview(){return e._dto.isPreview},get group(){return e._parentGroup.apiObject}};this._apiObject=Object.freeze(t)}return this._apiObject}get tabId(){return this._dto.id}acceptDtoUpdate(e){this._dto=e,this._input=this._initInput()}_initInput(){switch(this._dto.input.kind){case _i.TextInput:return new bw(w.revive(this._dto.input.uri));case _i.TextDiffInput:return new xw(w.revive(this._dto.input.original),w.revive(this._dto.input.modified));case _i.TextMergeInput:return new Sw(w.revive(this._dto.input.base),w.revive(this._dto.input.input1),w.revive(this._dto.input.input2),w.revive(this._dto.input.result));case _i.CustomEditorInput:return new Cw(w.revive(this._dto.input.uri),this._dto.input.viewType);case _i.WebviewEditorInput:return new ww(this._dto.input.viewType);case _i.NotebookInput:return new Tw(w.revive(this._dto.input.uri),this._dto.input.notebookType);case _i.NotebookDiffInput:return new Ew(w.revive(this._dto.input.original),w.revive(this._dto.input.modified),this._dto.input.notebookType);case _i.TerminalEditorInput:return new Dw;case _i.InteractiveEditorInput:return new Ow(w.revive(this._dto.input.uri),w.revive(this._dto.input.inputBoxUri));case _i.ChatEditorInput:return new kw;case _i.MultiDiffEditorInput:return new Aw(this._dto.input.diffEditors.map(e=>new xw(w.revive(e.original),w.revive(e.modified))));default:return}}},oL=class{constructor(e,t){this._tabs=[],this._activeTabId=``,this._dto=e,this._activeGroupIdGetter=t;for(let t of e.tabs)t.isActive&&(this._activeTabId=t.id),this._tabs.push(new aL(t,this,()=>this.activeTabId()))}get apiObject(){if(!this._apiObject){let e=this,t={get isActive(){return e._dto.groupId===e._activeGroupIdGetter()},get viewColumn(){return OD.to(e._dto.viewColumn)},get activeTab(){return e._tabs.find(t=>t.tabId===e._activeTabId)?.apiObject},get tabs(){return Object.freeze(e._tabs.map(e=>e.apiObject))}};this._apiObject=Object.freeze(t)}return this._apiObject}get groupId(){return this._dto.groupId}get tabs(){return this._tabs}acceptGroupDtoUpdate(e){this._dto=e}acceptTabOperation(e){if(e.kind===vi.TAB_OPEN){let t=new aL(e.tabDto,this,()=>this.activeTabId());return this._tabs.splice(e.index,0,t),e.tabDto.isActive&&(this._activeTabId=t.tabId),t}else if(e.kind===vi.TAB_CLOSE){let t=this._tabs.splice(e.index,1)[0];if(!t)throw Error(`Tab close updated received for index ${e.index} which does not exist`);return t.tabId===this._activeTabId&&(this._activeTabId=``),t}else if(e.kind===vi.TAB_MOVE){if(e.oldIndex===void 0)throw Error(`Invalid old index on move IPC`);let t=this._tabs.splice(e.oldIndex,1)[0];if(!t)throw Error(`Tab move updated received for index ${e.oldIndex} which does not exist`);return this._tabs.splice(e.index,0,t),t}let t=this._tabs.find(t=>t.tabId===e.tabDto.id);if(!t)throw Error(`INVALID tab`);return e.tabDto.isActive?this._activeTabId=e.tabDto.id:this._activeTabId===e.tabDto.id&&!e.tabDto.isActive&&(this._activeTabId=``),t.acceptDtoUpdate(e.tabDto),t}activeTabId(){return this._activeTabId}};let sL=class{constructor(e){this._onDidChangeTabs=new x,this._onDidChangeTabGroups=new x,this._extHostTabGroups=[],this._proxy=e.getProxy(E.MainThreadEditorTabs)}get tabGroups(){if(!this._apiObject){let e=this,t={onDidChangeTabGroups:e._onDidChangeTabGroups.event,onDidChangeTabs:e._onDidChangeTabs.event,get all(){return Object.freeze(e._extHostTabGroups.map(e=>e.apiObject))},get activeTabGroup(){let t=e._activeGroupId,n=st(e._extHostTabGroups.find(e=>e.groupId===t)?.apiObject);return n},close:async(e,t)=>{let n=Array.isArray(e)?e:[e];return n.length?cL(n[0])?this._closeGroups(n,t):this._closeTabs(n,t):!0}};this._apiObject=Object.freeze(t)}return this._apiObject}$acceptEditorTabModel(e){let t=new Set(this._extHostTabGroups.map(e=>e.groupId)),n=new Set(e.map(e=>e.groupId)),r=Ne(t,n),i=this._extHostTabGroups.filter(e=>r.removed.includes(e.groupId)).map(e=>e.apiObject),a=[],o=[];this._extHostTabGroups=e.map(e=>{let t=new oL(e,()=>this._activeGroupId);return r.added.includes(t.groupId)?a.push(t.apiObject):o.push(t.apiObject),t});let s=st(e.find(e=>e.isActive===!0)?.groupId);s!==void 0&&this._activeGroupId!==s&&(this._activeGroupId=s),this._onDidChangeTabGroups.fire(Object.freeze({opened:a,closed:i,changed:o}))}$acceptTabGroupUpdate(e){let t=this._extHostTabGroups.find(t=>t.groupId===e.groupId);if(!t)throw Error(`Update Group IPC call received before group creation.`);t.acceptGroupDtoUpdate(e),e.isActive&&(this._activeGroupId=e.groupId),this._onDidChangeTabGroups.fire(Object.freeze({changed:[t.apiObject],opened:[],closed:[]}))}$acceptTabOperation(e){let t=this._extHostTabGroups.find(t=>t.groupId===e.groupId);if(!t)throw Error(`Update Tabs IPC call received before group creation.`);let n=t.acceptTabOperation(e);switch(e.kind){case vi.TAB_OPEN:this._onDidChangeTabs.fire(Object.freeze({opened:[n.apiObject],closed:[],changed:[]}));return;case vi.TAB_CLOSE:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[n.apiObject],changed:[]}));return;case vi.TAB_MOVE:case vi.TAB_UPDATE:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[],changed:[n.apiObject]}));return}}_findExtHostTabFromApi(e){for(let t of this._extHostTabGroups)for(let n of t.tabs)if(n.apiObject===e)return n}_findExtHostTabGroupFromApi(e){return this._extHostTabGroups.find(t=>t.apiObject===e)}async _closeTabs(e,t){let n=[];for(let t of e){let e=this._findExtHostTabFromApi(t);if(!e)throw Error(`Tab close: Invalid tab not found!`);n.push(e.tabId)}return this._proxy.$closeTab(n,t)}async _closeGroups(e,t){let n=[];for(let t of e){let e=this._findExtHostTabGroupFromApi(t);if(!e)throw Error(`Group close: Invalid group not found!`);n.push(e.groupId)}return this._proxy.$closeGroup(n,t)}};sL=A([j(0,Is)],sL);function cL(e){let t=e;return t.tabs!==void 0}var lL;(function(e){e.ViewletId=`workbench.view.extension.test`,e.ExplorerViewId=`workbench.view.testing`,e.OutputPeekContributionId=`editor.contrib.testingOutputPeek`,e.DecorationsContributionId=`editor.contrib.testingDecorations`,e.CoverageDecorationsContributionId=`editor.contrib.coverageDecorations`,e.CoverageViewId=`workbench.view.testCoverage`,e.ResultsPanelId=`workbench.panel.testResults`,e.ResultsViewId=`workbench.panel.testResults.view`,e.MessageLanguageId=`vscodeInternalTestMessage`})(lL||={});var uL;(function(e){e.List=`list`,e.Tree=`true`})(uL||={});var dL;(function(e){e.ByLocation=`location`,e.ByStatus=`status`,e.ByDuration=`duration`})(dL||={}),fy.Errored,C(11834,`Errored`),fy.Failed,C(11835,`Failed`),fy.Passed,C(11836,`Passed`),fy.Queued,C(11837,`Queued`),fy.Running,C(11838,`Running`),fy.Skipped,C(11839,`Skipped`),fy.Unset,C(11840,`Not yet run`),hy.Debug,C(11842,`Debug`),hy.Run,C(11843,`Run`),hy.Coverage,C(11844,`Coverage`);var fL;(function(e){e.CancelTestRefreshAction=`testing.cancelTestRefresh`,e.CancelTestRunAction=`testing.cancelRun`,e.ClearTestResultsAction=`testing.clearTestResults`,e.CollapseAllAction=`testing.collapseAll`,e.ConfigureTestProfilesAction=`testing.configureProfile`,e.ContinousRunUsingForTest=`testing.continuousRunUsingForTest`,e.CoverageAtCursor=`testing.coverageAtCursor`,e.CoverageByUri=`testing.coverage.uri`,e.CoverageClear=`testing.coverage.close`,e.CoverageCurrentFile=`testing.coverageCurrentFile`,e.CoverageFilterToTest=`testing.coverageFilterToTest`,e.CoverageFilterToTestInEditor=`testing.coverageFilterToTestInEditor`,e.CoverageLastRun=`testing.coverageLastRun`,e.CoverageSelectedAction=`testing.coverageSelected`,e.CoverageToggleToolbar=`testing.coverageToggleToolbar`,e.CoverageViewChangeSorting=`testing.coverageViewChangeSorting`,e.DebugAction=`testing.debug`,e.DebugAllAction=`testing.debugAll`,e.DebugAtCursor=`testing.debugAtCursor`,e.DebugByUri=`testing.debug.uri`,e.DebugCurrentFile=`testing.debugCurrentFile`,e.DebugFailedTests=`testing.debugFailTests`,e.DebugFailedFromLastRun=`testing.debugFailedFromLastRun`,e.DebugLastRun=`testing.debugLastRun`,e.DebugSelectedAction=`testing.debugSelected`,e.FilterAction=`workbench.actions.treeView.testExplorer.filter`,e.GetExplorerSelection=`_testing.getExplorerSelection`,e.GetSelectedProfiles=`testing.getSelectedProfiles`,e.GoToTest=`testing.editFocusedTest`,e.GoToRelatedTest=`testing.goToRelatedTest`,e.PeekRelatedTest=`testing.peekRelatedTest`,e.GoToRelatedCode=`testing.goToRelatedCode`,e.PeekRelatedCode=`testing.peekRelatedCode`,e.HideTestAction=`testing.hideTest`,e.OpenCoverage=`testing.openCoverage`,e.OpenOutputPeek=`testing.openOutputPeek`,e.RefreshTestsAction=`testing.refreshTests`,e.ReRunFailedTests=`testing.reRunFailTests`,e.ReRunFailedFromLastRun=`testing.reRunFailedFromLastRun`,e.ReRunLastRun=`testing.reRunLastRun`,e.RunAction=`testing.run`,e.RunAllAction=`testing.runAll`,e.RunAllWithCoverageAction=`testing.coverageAll`,e.RunAtCursor=`testing.runAtCursor`,e.RunByUri=`testing.run.uri`,e.RunCurrentFile=`testing.runCurrentFile`,e.RunSelectedAction=`testing.runSelected`,e.RunUsingProfileAction=`testing.runUsing`,e.RunWithCoverageAction=`testing.coverage`,e.SearchForTestExtension=`testing.searchForTestExtension`,e.SelectDefaultTestProfiles=`testing.selectDefaultTestProfiles`,e.ShowMostRecentOutputAction=`testing.showMostRecentOutput`,e.StartContinousRun=`testing.startContinuousRun`,e.StartContinousRunFromExtension=`testing.startContinuousRunFromExtension`,e.StopContinousRunFromExtension=`testing.stopContinuousRunFromExtension`,e.StopContinousRun=`testing.stopContinuousRun`,e.TestingSortByDurationAction=`testing.sortByDuration`,e.TestingSortByLocationAction=`testing.sortByLocation`,e.TestingSortByStatusAction=`testing.sortByStatus`,e.TestingViewAsListAction=`testing.viewAsList`,e.TestingViewAsTreeAction=`testing.viewAsTree`,e.ToggleContinousRunForTest=`testing.toggleContinuousRunForTest`,e.ToggleInlineTestOutput=`testing.toggleInlineTestOutput`,e.UnhideAllTestsAction=`testing.unhideAllTests`,e.UnhideTestAction=`testing.unhideTest`})(fL||={});let pL=0;const mL=new WeakMap,hL=k(`IExtHostTesting`);let gL=class extends y{constructor(e,t,n,r){super(),this.logService=t,this.commands=n,this.editors=r,this.resultsChangedEmitter=this._register(new x),this.controllers=new Map,this.defaultProfilesChangedEmitter=this._register(new x),this.followupProviders=new Set,this.testFollowups=new Map,this.onResultsChanged=this.resultsChangedEmitter.event,this.results=[],this.proxy=e.getProxy(E.MainThreadTesting),this.observer=new wL(this.proxy),this.runTracker=new yL(this.proxy,t),n.registerArgumentProcessor({processArgument:e=>{switch(e?.$mid){case Dn.TestItemContext:{let t=e,n=t.tests[t.tests.length-1].item.extId,r=this.controllers.get(dy.root(n));return r?.collection.tree.get(n)?.actual??WM(e)}case Dn.TestMessageMenuArgs:{let{test:t,message:n}=e,r=t.item.extId;return{test:this.controllers.get(dy.root(r))?.collection.tree.get(r)?.actual??WM({tests:[t]}),message:RO.to(n)}}default:return e}}}),n.registerCommand(!1,`testing.getExplorerSelection`,async()=>{let e=await n.executeCommand(fL.GetExplorerSelection),t=e=>{let t=this.controllers.get(dy.root(e));if(t)return dy.isRoot(e)?t.controller:t.collection.tree.get(e)?.actual};return{include:e?.include.map(t).filter(it)||[],exclude:e?.exclude.map(t).filter(it)||[]}})}createTestController(e,t,n,r){if(this.controllers.has(t))throw Error(`Attempt to insert a duplicate controller with ID "${t}"`);let i=new v,a=i.add(new qM(t,n,this.editors));a.root.label=n;let o=new Map,s=new Set,c=this.proxy,l=()=>{let e=0;r&&(e|=my.Refresh);let t=d.relatedCodeProvider;return t&&(t?.provideRelatedTests&&(e|=my.TestRelatedToCode),t?.provideRelatedCode&&(e|=my.CodeRelatedToTest)),e},u={items:a.root.children,get label(){return n},set label(e){n=e,a.root.label=e,c.$updateController(t,{label:n})},get refreshHandler(){return r},set refreshHandler(e){r=e,c.$updateController(t,{capabilities:l()})},get id(){return t},get relatedCodeProvider(){return d.relatedCodeProvider},set relatedCodeProvider(n){U(e,`testRelatedCode`),d.relatedCodeProvider=n,c.$updateController(t,{capabilities:l()})},createRunProfile:(e,n,r,i,a,c)=>{let l=uh(e);for(;o.has(l);)l++;return new EL(this.proxy,o,s,this.defaultProfilesChangedEmitter.event,t,l,e,n,r,i,a,c)},createTestItem(e,n,r){return new GM(t,e,n,r)},createTestRun:(n,r,i=!0)=>this.runTracker.createTestRun(e,t,a,n,r,i),invalidateTestResults:e=>{if(e===void 0)this.proxy.$markTestRetired(void 0);else{let n=e instanceof Array?e:[e];this.proxy.$markTestRetired(n.map(e=>dy.fromExtHostTestItem(e,t).toString()))}},set resolveHandler(e){a.resolveHandler=e},get resolveHandler(){return a.resolveHandler},dispose:()=>{i.dispose()}},d={controller:u,collection:a,profiles:o,extension:e,activeProfiles:s};return c.$registerTestController(t,n,l()),i.add(_(()=>c.$unregisterTestController(t))),this.controllers.set(t,d),i.add(_(()=>this.controllers.delete(t))),i.add(a.onDidGenerateDiff(e=>c.$publishDiff(t,e.map(Hy.serialize)))),u}createTestObserver(){return this.observer.checkout()}async runTests(e,t=Oi.None){let n=bL(e);if(!n)throw Error("The request passed to `vscode.test.runTests` must include a profile");let r=this.controllers.get(n.controllerId);if(!r)throw Error(`Controller not found`);await this.proxy.$runTests({preserveFocus:e.preserveFocus??!0,group:VO.from(n.kind),targets:[{testIds:e.include?.map(e=>dy.fromExtHostTestItem(e,r.collection.root.id).toString())??[r.collection.root.id],profileId:n.profileId,controllerId:n.controllerId}],exclude:e.exclude?.map(e=>e.id)},t)}registerTestFollowupProvider(e){return this.followupProviders.add(e),{dispose:()=>{this.followupProviders.delete(e)}}}async $getTestsRelatedToCode(e,t,n){let r=this.editors.getDocument(w.revive(e));if(!r)return[];let i=SD.to(t),a=[];return await Promise.all([...this.controllers.values()].map(async e=>{let t;try{t=await e.relatedCodeProvider?.provideRelatedTests?.(r.document,i,n)}catch(t){n.isCancellationRequested||this.logService.warn(`Error thrown while providing related tests for ${e.controller.label}`,t)}if(t){for(let n of t)a.push(dy.fromExtHostTestItem(n,e.controller.id).toString());e.collection.flushDiff()}})),a}async $getCodeRelatedToTest(e,t){let n=this.controllers.get(dy.root(e));if(!n)return[];let r=n.collection.tree.get(e);if(!r)return[];let i=await n.relatedCodeProvider?.provideRelatedCode?.(r.actual,t);return i?.map(qD.from)??[]}$syncTests(){for(let{collection:e}of this.controllers.values())e.flushDiff();return Promise.resolve()}async $getCoverageDetails(e,t,n){let r=await this.runTracker.getCoverageDetails(e,t,n);return r?.map(WO.fromDetails)}async $disposeRun(e){this.runTracker.disposeTestRun(e)}$configureRunProfile(e,t){this.controllers.get(e)?.profiles.get(t)?.configureHandler?.()}$setDefaultRunProfiles(e){let t=new Map;for(let[n,r]of Object.entries(e)){let e=this.controllers.get(n);if(!e)continue;let i=new Map,a=r.filter(t=>!e.activeProfiles.has(t)),o=[...e.activeProfiles].filter(e=>!r.includes(e));for(let t of a)i.set(t,!0),e.activeProfiles.add(t);for(let t of o)i.set(t,!1),e.activeProfiles.delete(t);i.size&&t.set(n,i)}this.defaultProfilesChangedEmitter.fire(t)}async $refreshTests(e,t){await this.controllers.get(e)?.controller.refreshHandler?.(t)}$publishTestResults(e){this.results=Object.freeze(e.map(e=>{let t=UO.to(e),n=e.tasks.findIndex(e=>e.hasCoverage);return n!==-1&&(t.getDetailedCoverage=(t,r=Oi.None)=>this.proxy.$getCoverageDetails(e.id,n,t,r).then(e=>e.map(WO.to))),mL.set(t,e.id),t}).concat(this.results).sort((e,t)=>t.completedAt-e.completedAt).slice(0,32)),this.resultsChangedEmitter.fire()}async $expandTest(e,t){let n=this.controllers.get(dy.fromString(e).controllerId)?.collection;n&&(await n.expand(e,t<0?1/0:t),n.flushDiff())}$acceptDiff(e){this.observer.applyDiff(e.map(e=>Hy.deserialize({asCanonicalUri:e=>e},e)))}async $runControllerTests(e,t){return Promise.all(e.map(e=>this.runControllerTestRequest(e,!1,t)))}async $startContinuousRun(e,t){let n=new Ai(t),r=await Promise.all(e.map(e=>this.runControllerTestRequest(e,!0,n.token)));return!t.isCancellationRequested&&!r.some(e=>e.error)&&await new Promise(e=>t.onCancellationRequested(e)),n.dispose(!0),r}async $provideTestFollowups(e,t){let n=this.results.find(t=>mL.get(t)===e.resultId),r=n&&DL(dy.fromString(e.extId),n?.results);if(!r)return[];let i=[];return await Promise.all([...this.followupProviders].map(async a=>{try{let o=await a.provideFollowup(n,r,e.taskIndex,e.messageIndex,t);o&&(i=i.concat(o))}catch(e){this.logService.error(`Error thrown while providing followup for test message`,e)}})),t.isCancellationRequested?[]:i.map(e=>{let t=pL++;return this.testFollowups.set(t,e),{title:e.title,id:t}})}$disposeTestFollowups(e){for(let t of e)this.testFollowups.delete(t)}$executeTestFollowup(e){let t=this.testFollowups.get(e);return t?this.commands.executeCommand(t.command,...t.arguments||[]):Promise.resolve()}$cancelExtensionTestRun(e,t){e===void 0?this.runTracker.cancelAllRuns():this.runTracker.cancelRunById(e,t)}getMetadataForRun(e){for(let t of this.runTracker.trackers){let n=t.getTaskIdForRun(e);if(n)return{taskId:n,runId:t.id}}}async runControllerTestRequest(e,t,n){let r=this.controllers.get(e.controllerId);if(!r)return{};let{collection:i,profiles:a,extension:o}=r,s=a.get(e.profileId);if(!s)return{};let c=e.testIds.map(e=>i.tree.get(e)).filter(it),l=e.excludeExtIds.map(e=>r.collection.tree.get(e)).filter(it).filter(e=>c.some(t=>t.fullId.compare(e.fullId)===uy.IsChild));if(!c.length)return{};let u=new ow(c.some(e=>e.actual instanceof KM)?void 0:c.map(e=>e.actual),l.map(e=>e.actual),s,t),d=gy(e)&&this.runTracker.prepareForMainThreadTestRun(o,u,xL.fromInternal(e,r.collection),s,n);try{return await s.runHandler(u,n),{}}catch(e){return{error:String(e)}}finally{d&&d.hasRunningTasks&&!n.isCancellationRequested&&await en.toPromise(d.onEnd)}}};gL=A([j(0,Is),j(1,xs),j(2,$M),j(3,GF)],gL);var _L;(function(e){e[e.Running=0]=`Running`,e[e.Cancelling=1]=`Cancelling`,e[e.Ended=2]=`Ended`})(_L||={});var vL=class extends y{get hasRunningTasks(){return this.running>0}get id(){return this.dto.id}constructor(e,t,n,r,i,a){super(),this.dto=e,this.proxy=t,this.logService=n,this.profile=r,this.extension=i,this.state=_L.Running,this.running=0,this.tasks=new Map,this.sharedTestIds=new Set,this.endEmitter=this._register(new x),this.publishedCoverage=new Map,this.onEnd=this.endEmitter.event,this.cts=this._register(new Ai(a));let o=this._register(new Do(()=>this.forciblyEndTasks(),1e4));this._register(this.cts.token.onCancellationRequested(()=>o.schedule()));let s=new x;this.onDidDispose=s.event,this._register(_(()=>{s.fire(),s.dispose()}))}getTaskIdForRun(e){for(let[t,{run:n}]of this.tasks)if(n===e)return t}cancel(e){e?this.tasks.get(e)?.cts.cancel():this.state===_L.Running?(this.cts.cancel(),this.state=_L.Cancelling):this.state===_L.Cancelling&&this.forciblyEndTasks()}async getCoverageDetails(e,t,n){let[,r]=dy.fromString(e).path,i=this.publishedCoverage.get(e);if(!i)return[];let{report:a,extIds:o}=i,s=this.tasks.get(r);if(!s)throw Error(`unreachable: run task was not found`);let c;if(t&&a instanceof fw){let e=o.indexOf(t);if(e===-1)return[];c=a.includesTests[e]}let l=c?this.profile?.loadDetailedCoverageForTest?.(s.run,a,c,n):this.profile?.loadDetailedCoverage?.(s.run,a,n);return await l??[]}createRun(e){let t=this.dto.id,n=this.dto.controllerId,r=Nc(),i=e=>(t,...n)=>{if(o){this.logService.warn(`Setting the state of test "${t.id}" is a no-op after the run ends.`);return}this.ensureTestIsKnown(t),e(t,...n)},a=(e,i)=>{let a=i instanceof Array?i.map(RO.from):[RO.from(i)];if(e.uri&&e.range){let t={range:K.from(e.range),uri:e.uri};for(let e of a)e.location=e.location||t}this.proxy.$appendTestMessagesInRun(t,r,dy.fromExtHostTestItem(e,n).toString(),a)},o=!1,s=this._register(new Ai(this.cts.token)),c={isPersisted:this.dto.isPersisted,token:s.token,name:e,onDidDispose:this.onDidDispose,addCoverage:e=>{if(o)return;let i=e instanceof fw?e.includesTests:[];if(i.length)for(let e of i)this.ensureTestIsKnown(e);let a=e.uri.toString(),s=new dy([t,r,a]).toString();this.publishedCoverage.set(s,{report:e,extIds:i.map(e=>dy.fromExtHostTestItem(e,n).toString())}),this.proxy.$appendCoverage(t,r,WO.fromFile(n,s,e))},enqueued:i(e=>{this.proxy.$updateTestStateInRun(t,r,dy.fromExtHostTestItem(e,n).toString(),fy.Queued)}),skipped:i(e=>{this.proxy.$updateTestStateInRun(t,r,dy.fromExtHostTestItem(e,n).toString(),fy.Skipped)}),started:i(e=>{this.proxy.$updateTestStateInRun(t,r,dy.fromExtHostTestItem(e,n).toString(),fy.Running)}),errored:i((e,i,o)=>{a(e,i),this.proxy.$updateTestStateInRun(t,r,dy.fromExtHostTestItem(e,n).toString(),fy.Errored,o)}),failed:i((e,i,o)=>{a(e,i),this.proxy.$updateTestStateInRun(t,r,dy.fromExtHostTestItem(e,n).toString(),fy.Failed,o)}),passed:i((e,n)=>{this.proxy.$updateTestStateInRun(t,r,dy.fromExtHostTestItem(e,this.dto.controllerId).toString(),fy.Passed,n)}),appendOutput:(e,i,a)=>{o||(a&&this.ensureTestIsKnown(a),this.proxy.$appendOutputToRun(t,r,b.fromString(e),i&&qD.from(i),a&&dy.fromExtHostTestItem(a,n).toString()))},end:()=>{o||(o=!0,this.proxy.$finishedTestRunTask(t,r),--this.running||this.markEnded())}};return this.running++,this.tasks.set(r,{run:c,cts:s}),this.proxy.$startedTestRunTask(t,{id:r,ctrlId:this.dto.controllerId,name:e||this.extension.displayName||this.extension.identifier.value,running:!0}),c}forciblyEndTasks(){for(let{run:e}of this.tasks.values())e.end()}markEnded(){this.state!==_L.Ended&&(this.state=_L.Ended,this.endEmitter.fire())}ensureTestIsKnown(e){if(!(e instanceof GM))throw new ib(e.id);if(this.sharedTestIds.has(dy.fromExtHostTestItem(e,this.dto.controllerId).toString()))return;let t=[],n=this.dto.colllection.root;for(;;){let r=HO.from(e);if(t.unshift(r),this.sharedTestIds.has(r.extId)||(this.sharedTestIds.add(r.extId),e===n))break;e=e.parent||n}this.proxy.$addTestsToRun(this.dto.controllerId,this.dto.id,t)}dispose(){this.markEnded(),super.dispose()}},yL=class{get trackers(){return this.tracked.values()}constructor(e,t){this.proxy=e,this.logService=t,this.tracked=new Map,this.trackedById=new Map}getCoverageDetails(e,t,n){let r=dy.root(e);return this.trackedById.get(r)?.getCoverageDetails(e,t,n)||[]}disposeTestRun(e){this.trackedById.get(e)?.dispose(),this.trackedById.delete(e);for(let[t,{id:n}]of this.tracked)n===e&&this.tracked.delete(t)}prepareForMainThreadTestRun(e,t,n,r,i){return this.getTracker(t,n,r,e,i)}cancelRunById(e,t){this.trackedById.get(e)?.cancel(t)}cancelAllRuns(){for(let e of this.tracked.values())e.cancel()}createTestRun(e,t,n,r,i,a){let o=this.tracked.get(r);if(o)return o.createRun(i);let s=xL.fromPublic(t,n,r,a),c=bL(r);this.proxy.$startedExtensionTestRun({controllerId:t,continuous:!!r.continuous,profile:c&&{group:VO.from(c.kind),id:c.profileId},exclude:r.exclude?.map(e=>dy.fromExtHostTestItem(e,n.root.id).toString())??[],id:s.id,include:r.include?.map(e=>dy.fromExtHostTestItem(e,n.root.id).toString())??[n.root.id],preserveFocus:r.preserveFocus??!0,persist:a});let l=this.getTracker(r,s,r.profile,e);return en.once(l.onEnd)(()=>{this.proxy.$finishedExtensionTestRun(s.id)}),l.createRun(i)}getTracker(e,t,n,r,i){let a=new vL(t,this.proxy,this.logService,n,r,i);return this.tracked.set(e,a),this.trackedById.set(a.id,a),a}};const bL=e=>{if(e.profile){if(!(e.profile instanceof EL))throw Error(`TestRunRequest.profile is not an instance created from TestController.createRunProfile`);return e.profile}};var xL=class e{static fromPublic(t,n,r,i){return new e(t,Nc(),i,n)}static fromInternal(t,n){return new e(t.controllerId,t.runId,!0,n)}constructor(e,t,n,r){this.controllerId=e,this.id=t,this.isPersisted=n,this.colllection=r}},SL=class{get isEmpty(){return this.added.size===0&&this.removed.size===0&&this.updated.size===0}constructor(e){this.emitter=e,this.added=new Set,this.updated=new Set,this.removed=new Set,this.alreadyRemoved=new Set}add(e){this.added.add(e)}update(e){Object.assign(e.revived,HO.toPlain(e.item)),this.added.has(e)||this.updated.add(e)}remove(e){if(this.added.has(e)){this.added.delete(e);return}this.updated.delete(e);let t=dy.parentId(e.item.extId);if(t&&this.alreadyRemoved.has(t.toString())){this.alreadyRemoved.add(e.item.extId);return}this.removed.add(e)}getChangeEvent(){let{added:e,updated:t,removed:n}=this;return{get added(){return[...e].map(e=>e.revived)},get updated(){return[...t].map(e=>e.revived)},get removed(){return[...n].map(e=>e.revived)}}}complete(){this.isEmpty||this.emitter.fire(this.getChangeEvent())}},CL=class extends Uy{constructor(){super(...arguments),this.changeEmitter=new x,this.onDidChangeTests=this.changeEmitter.event}get rootTests(){return this.roots}getMirroredTestDataById(e){return this.items.get(e)}getMirroredTestDataByReference(e){return this.items.get(e.id)}createItem(e,t){return{...e,revived:HO.toPlain(e.item),depth:t?t.depth+1:0,children:new Set}}createChangeCollector(){return new SL(this.changeEmitter)}},wL=class{constructor(e){this.proxy=e}checkout(){this.current||=this.createObserverData();let e=this.current;return e.observers++,{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map(e=>e.revived)},dispose:Ke(()=>{--e.observers===0&&(this.proxy.$unsubscribeFromDiffs(),this.current=void 0)})}}getMirroredTestDataByReference(e){return this.current?.tests.getMirroredTestDataByReference(e)}applyDiff(e){this.current?.tests.apply(e)}createObserverData(){let e=new CL({asCanonicalUri:e=>e});return this.proxy.$subscribeToDiffs(),{observers:0,tests:e}}};const TL=(e,t,n,r)=>{n?Object.assign(n,r):t.$updateTestRunConfig(e.controllerId,e.profileId,r)};var EL=class extends aw{#proxy;#activeProfiles;#onDidChangeDefaultProfiles;#initialPublish;#profiles;get label(){return this._label}set label(e){e!==this._label&&(this._label=e,TL(this,this.#proxy,this.#initialPublish,{label:e}))}get supportsContinuousRun(){return this._supportsContinuousRun}set supportsContinuousRun(e){e!==this._supportsContinuousRun&&(this._supportsContinuousRun=e,TL(this,this.#proxy,this.#initialPublish,{supportsContinuousRun:e}))}get isDefault(){return this.#activeProfiles.has(this.profileId)}set isDefault(e){e!==this.isDefault&&(e?this.#activeProfiles.add(this.profileId):this.#activeProfiles.delete(this.profileId),TL(this,this.#proxy,this.#initialPublish,{isDefault:e}))}get tag(){return this._tag}set tag(e){e?.id!==this._tag?.id&&(this._tag=e,TL(this,this.#proxy,this.#initialPublish,{tag:e?zO.namespace(this.controllerId,e.id):null}))}get configureHandler(){return this._configureHandler}set configureHandler(e){e!==this._configureHandler&&(this._configureHandler=e,TL(this,this.#proxy,this.#initialPublish,{hasConfigurationHandler:!!e}))}get onDidChangeDefault(){return en.chain(this.#onDidChangeDefaultProfiles,e=>e.map(e=>e.get(this.controllerId)?.get(this.profileId)).filter(it))}constructor(e,t,n,r,i,a,o,s,c,l=!1,u=void 0,d=!1){super(i,a,s),this._label=o,this.runHandler=c,this._tag=u,this._supportsContinuousRun=d,this.#proxy=e,this.#profiles=t,this.#activeProfiles=n,this.#onDidChangeDefaultProfiles=r,t.set(a,this);let f=VO.from(s);l&&n.add(a),this.#initialPublish={profileId:a,controllerId:i,tag:u?zO.namespace(this.controllerId,u.id):null,label:o,group:f,isDefault:l,hasConfigurationHandler:!1,supportsContinuousRun:d},queueMicrotask(()=>{this.#initialPublish&&=(this.#proxy.$publishTestRunProfile(this.#initialPublish),void 0)})}dispose(){this.#profiles?.delete(this.profileId)&&(this.#profiles=void 0,this.#proxy.$removeTestProfile(this.controllerId,this.profileId)),this.#initialPublish=void 0}};function DL(e,t){for(let n=0;n<e.path.length;n++){let r=t.find(t=>t.id===e.path[n]);if(!r)return;if(n===e.path.length-1)return r;t=r.children}}var OL;(function(e){e.Unknown=`unknown`,e.Env=`env`,e.Config=`config`,e.Command=`command`,e.Input=`input`,e.ExtensionInstallFolder=`extensionInstallFolder`,e.WorkspaceFolder=`workspaceFolder`,e.Cwd=`cwd`,e.WorkspaceFolderBasename=`workspaceFolderBasename`,e.UserHome=`userHome`,e.LineNumber=`lineNumber`,e.ColumnNumber=`columnNumber`,e.SelectedText=`selectedText`,e.File=`file`,e.FileWorkspaceFolder=`fileWorkspaceFolder`,e.FileWorkspaceFolderBasename=`fileWorkspaceFolderBasename`,e.RelativeFile=`relativeFile`,e.RelativeFileDirname=`relativeFileDirname`,e.FileDirname=`fileDirname`,e.FileExtname=`fileExtname`,e.FileBasename=`fileBasename`,e.FileBasenameNoExtension=`fileBasenameNoExtension`,e.FileDirnameBasename=`fileDirnameBasename`,e.ExecPath=`execPath`,e.ExecInstallFolder=`execInstallFolder`,e.PathSeparator=`pathSeparator`,e.PathSeparatorAlias=`/`})(OL||={});const kL=Object.values(OL).filter(e=>typeof e==`string`);var AL=class extends pe{constructor(e,t){super(t),this.variable=e}},jL=class e{static{this.VARIABLE_LHS="${"}constructor(e){this.locations=new Map,this.newReplacementNotifiers=new Set,typeof e==`string`?(this.stringRoot=!0,this.root={value:e}):(this.stringRoot=!1,this.root=structuredClone(e))}static parse(t){if(t instanceof e)return t;let n=new e(t);return n.applyPlatformSpecificKeys(),n.parseObject(n.root),n}applyPlatformSpecificKeys(){let e=this.root,t=Xn?`windows`:Zn?`osx`:Qn?`linux`:void 0;t&&e&&typeof e==`object`&&e.hasOwnProperty(t)&&Object.keys(e[t]).forEach(n=>e[n]=e[t][n]),delete e.windows,delete e.osx,delete e.linux}parseVariable(e,t){if(e[t]!==`$`||e[t+1]!==`{`)return;let n=t+2,r=1;for(;n<e.length;){if(e[n]===`{`)r++;else if(e[n]===`}`&&(r--,r===0))break;n++}if(r!==0)return;let i=e.slice(t,n+1),a=e.substring(t+2,n),o=a.indexOf(`:`);return o===-1?{replacement:{id:i,name:a,inner:a},end:n}:{replacement:{id:i,inner:a,name:a.slice(0,o),arg:a.slice(o+1)},end:n}}parseObject(e){if(!(typeof e!=`object`||!e)){if(Array.isArray(e)){for(let t=0;t<e.length;t++){let n=e[t];typeof n==`string`?this.parseString(e,t,n):this.parseObject(n)}return}for(let[t,n]of Object.entries(e))this.parseString(e,t,t,!0),typeof n==`string`?this.parseString(e,t,n):this.parseObject(n)}}parseString(e,t,n,r,i){let a=0;for(;a<n.length;){let o=n.indexOf("${",a);if(o===-1)break;let s=this.parseVariable(n,o);if(s){if(a=s.end+1,i?.includes(s.replacement.id))continue;let n=this.locations.get(s.replacement.id)||{locations:[],replacement:s.replacement},o={object:e,propertyName:t,replaceKeyName:r};n.locations.push(o),this.locations.set(s.replacement.id,n),n.resolved?this._resolveAtLocation(s.replacement,o,n.resolved,i):this.newReplacementNotifiers.forEach(e=>e(s.replacement))}else a=o+2}}*unresolved(){let e=new Map,t=t=>{e.set(t.id,t)};for(let t of this.locations.values())t.resolved===void 0&&e.set(t.replacement.id,t.replacement);for(this.newReplacementNotifiers.add(t);;){let t=pt.first(e);if(!t)break;let[n,r]=t;yield r,e.delete(n)}this.newReplacementNotifiers.delete(t)}resolved(){return pt.map(pt.filter(this.locations.values(),e=>!!e.resolved),e=>[e.replacement,e.resolved])}resolve(e,t){typeof t!=`object`&&(t={value:String(t)});let n=this.locations.get(e.id);if(n&&(n.resolved=t,t.value!==void 0))for(let r of n.locations||pt.empty())this._resolveAtLocation(e,r,t)}_resolveAtLocation(e,{replaceKeyName:t,propertyName:n,object:r},i,a=[]){if(i.value!==void 0){if(a.push(e.id),t&&typeof n==`string`){let t=r[n],o=n.replaceAll(e.id,i.value);delete r[n],r[o]=t,this._renameKeyInLocations(r,n,o),this.parseString(r,o,i.value,!0,a)}else r[n]=r[n].replaceAll(e.id,i.value),this.parseString(r,n,i.value,!1,a);a.pop()}}_renameKeyInLocations(e,t,n){for(let r of this.locations.values())for(let i of r.locations)i.object===e&&i.propertyName===t&&(i.propertyName=n)}toObject(){return this.stringRoot?this.root.value:this.root}},ML=class{constructor(e,t,n,r){this._contributedVariables=new Map,this.resolvableVariables=new Set(kL),this._context=e,this._labelService=t,this._userHomePromise=n,r&&(this._envVariablesPromise=r.then(e=>this.prepareEnv(e)))}prepareEnv(e){if(Xn){let t=Object.create(null);return Object.keys(e).forEach(n=>{t[n.toLowerCase()]=e[n]}),t}return e}async resolveWithEnvironment(e,t,n){let r=jL.parse(n);for(let n of r.unresolved()){let i=await this.evaluateSingleVariable(n,t?.uri,e);i!==void 0&&r.resolve(n,String(i))}return r.toObject()}async resolveAsync(e,t){let n=jL.parse(t);for(let t of n.unresolved()){let r=await this.evaluateSingleVariable(t,e?.uri);r!==void 0&&n.resolve(t,String(r))}return n.toObject()}resolveWithInteractionReplace(e,t){throw Error(`resolveWithInteractionReplace not implemented.`)}resolveWithInteraction(e,t){throw Error(`resolveWithInteraction not implemented.`)}contributeVariable(e,t){if(this._contributedVariables.has(e))throw Error(`Variable `+e+` is contributed twice.`);this.resolvableVariables.add(e),this._contributedVariables.set(e,t)}fsPath(e){return this._labelService?this._labelService.getUriLabel(e,{noPrefix:!0}):e.fsPath}async evaluateSingleVariable(e,t,n,r){let i={env:n===void 0?await this._envVariablesPromise:this.prepareEnv(n),userHome:n===void 0?await this._userHomePromise:void 0},{name:a,arg:o}=e,s=t=>{let n=this._context.getFilePath();if(n)return x_(n);throw new AL(t,C(12946,`Variable {0} can not be resolved. Please open an editor.`,e.id))},c=t=>{let n=s(t);if(this._context.getWorkspaceFolderPathForFile){let e=this._context.getWorkspaceFolderPathForFile();if(e)return x_(e)}throw new AL(t,C(12947,`Variable {0}: can not find workspace folder of '{1}'.`,e.id,Wr(n)))},l=e=>{if(o){let t=this._context.getFolderUri(o);if(t)return t;throw new AL(e,C(12948,`Variable {0} can not be resolved. No such folder '{1}'.`,e,o))}if(t)return t;throw this._context.getWorkspaceFolderCount()>1?new AL(e,C(12949,`Variable {0} can not be resolved in a multi folder workspace. Scope this variable using ':' and a workspace folder name.`,e)):new AL(e,C(12950,`Variable {0} can not be resolved. Please open a folder.`,e))};switch(a){case`env`:if(o){if(i.env){let e=i.env[Xn?o.toLowerCase():o];if(Ze(e))return e}return``}throw new AL(OL.Env,C(12951,`Variable {0} can not be resolved because no environment variable name is given.`,e.id));case`config`:if(o){let n=this._context.getConfigurationValue(t,o);if(at(n))throw new AL(OL.Config,C(12952,`Variable {0} can not be resolved because setting '{1}' not found.`,e.id,o));if($e(n))throw new AL(OL.Config,C(12953,`Variable {0} can not be resolved because '{1}' is a structured value.`,e.id,o));return n}throw new AL(OL.Config,C(12954,`Variable {0} can not be resolved because no settings name is given.`,e.id));case`command`:return this.resolveFromMap(OL.Command,e.id,o,r,`command`);case`input`:return this.resolveFromMap(OL.Input,e.id,o,r,`input`);case`extensionInstallFolder`:if(o){let t=await this._context.getExtension(o);if(!t)throw new AL(OL.ExtensionInstallFolder,C(12955,`Variable {0} can not be resolved because the extension {1} is not installed.`,e.id,o));return this.fsPath(t.extensionLocation)}throw new AL(OL.ExtensionInstallFolder,C(12956,`Variable {0} can not be resolved because no extension name is given.`,e.id));default:switch(a){case`workspaceRoot`:case`workspaceFolder`:{let e=l(OL.WorkspaceFolder);return e?x_(this.fsPath(e)):void 0}case`cwd`:{if(!t&&!o)return Sr();let e=l(OL.Cwd);return e?x_(this.fsPath(e)):void 0}case`workspaceRootFolderName`:case`workspaceFolderBasename`:{let e=l(OL.WorkspaceFolderBasename);return e?x_(Wr(this.fsPath(e))):void 0}case`userHome`:if(i.userHome)return i.userHome;throw new AL(OL.UserHome,C(12957,`Variable {0} can not be resolved. UserHome path is not defined`,e.id));case`lineNumber`:{let t=this._context.getLineNumber();if(t)return t;throw new AL(OL.LineNumber,C(12958,`Variable {0} can not be resolved. Make sure to have a line selected in the active editor.`,e.id))}case`columnNumber`:{let t=this._context.getColumnNumber();if(t)return t;throw Error(C(12959,`Variable {0} can not be resolved. Make sure to have a column selected in the active editor.`,e.id))}case`selectedText`:{let t=this._context.getSelectedText();if(t)return t;throw new AL(OL.SelectedText,C(12960,`Variable {0} can not be resolved. Make sure to have some text selected in the active editor.`,e.id))}case`file`:return s(OL.File);case`fileWorkspaceFolder`:return c(OL.FileWorkspaceFolder);case`fileWorkspaceFolderBasename`:return Wr(c(OL.FileWorkspaceFolderBasename));case`relativeFile`:return t||o?Hr(this.fsPath(l(OL.RelativeFile)),s(OL.RelativeFile)):s(OL.RelativeFile);case`relativeFileDirname`:{let e=Ur(s(OL.RelativeFileDirname));if(t||o){let t=Hr(this.fsPath(l(OL.RelativeFileDirname)),e);return t.length===0?`.`:t}return e}case`fileDirname`:return Ur(s(OL.FileDirname));case`fileExtname`:return Gr(s(OL.FileExtname));case`fileBasename`:return Wr(s(OL.FileBasename));case`fileBasenameNoExtension`:{let e=Wr(s(OL.FileBasenameNoExtension));return e.slice(0,e.length-Gr(e).length)}case`fileDirnameBasename`:return Wr(Ur(s(OL.FileDirnameBasename)));case`execPath`:{let t=this._context.getExecPath();return t||e.id}case`execInstallFolder`:{let t=this._context.getAppRoot();return t||e.id}case`pathSeparator`:case`/`:return Kr;default:try{return this.resolveFromMap(OL.Unknown,e.id,o,r,void 0)}catch{return e.id}}}}resolveFromMap(e,t,n,r,i){if(n&&r){let a=i===void 0?r[n]:r[i+`:`+n];if(typeof a==`string`)return a;throw new AL(e,C(12961,`Variable {0} can not be resolved because the command has no value.`,t))}return t}};const NL=k(`IExtHostVariableResolverProvider`);var PL=class extends ML{constructor(e,t,n,r,i,a,o){function s(){if(n){let e=n.activeEditor();if(e)return e.document.uri;let t=r.tabGroups.all.find(e=>e.isActive)?.activeTab;if(t!==void 0){if(t.input instanceof xw||t.input instanceof Ew)return t.input.modified;if(t.input instanceof bw||t.input instanceof Tw||t.input instanceof Cw)return t.input.uri}}}super({getFolderUri:e=>{let t=a.folders.filter(t=>t.name===e);if(t&&t.length>0)return t[0].uri},getWorkspaceFolderCount:()=>a.folders.length,getConfigurationValue:(e,t)=>i.getConfiguration(void 0,e).get(t),getAppRoot:()=>Sr(),getExecPath:()=>Cr.VSCODE_EXEC_PATH,getFilePath:()=>{let e=s();if(e)return Rr(e.fsPath)},getWorkspaceFolderPathForFile:()=>{if(t){let e=s();if(e){let n=t.getWorkspaceFolder(e);if(n)return Rr(n.uri.fsPath)}}},getSelectedText:()=>{if(n){let e=n.activeEditor();if(e&&!e.selection.isEmpty)return e.document.getText(e.selection)}},getLineNumber:()=>{if(n){let e=n.activeEditor();if(e)return String(e.selection.end.line+1)}},getColumnNumber:()=>{if(n){let e=n.activeEditor();if(e)return String(e.selection.end.character+1)}},getExtension:t=>e.getExtension(t)},void 0,o?Promise.resolve(o):void 0,Promise.resolve(Cr))}};let FL=class extends y{constructor(e,t,n,r,i){super(),this.extensionService=e,this.workspaceService=t,this.editorService=n,this.configurationService=r,this.editorTabs=i,this._resolver=new u(async()=>{let e=await this.configurationService.getConfigProvider(),t=await this.workspaceService.getWorkspaceFolders2()||[],n={folders:t};return this._register(this.workspaceService.onDidChangeWorkspace(async e=>{n.folders=await this.workspaceService.getWorkspaceFolders2()||[]})),new PL(this.extensionService,this.workspaceService,this.editorService,this.editorTabs,e,n,this.homeDir())})}getResolver(){return this._resolver.value}homeDir(){}};FL=A([j(0,qP),j(1,nj),j(2,GF),j(3,kj),j(4,iL)],FL);const IL=k(`IExtHostDebugService`);let LL=class extends y{get onDidStartDebugSession(){return this._onDidStartDebugSession.event}get onDidTerminateDebugSession(){return this._onDidTerminateDebugSession.event}get onDidChangeActiveDebugSession(){return this._onDidChangeActiveDebugSession.event}get activeDebugSession(){return this._activeDebugSession?.api}get onDidReceiveDebugSessionCustomEvent(){return this._onDidReceiveDebugSessionCustomEvent.event}get activeDebugConsole(){return this._activeDebugConsole.value}constructor(e,t,n,r,i,a,o,s){super(),this._workspaceService=t,this._extensionService=n,this._configurationService=r,this._editorTabs=i,this._variableResolver=a,this._commands=o,this._testing=s,this._debugSessions=new Map,this._debugVisualizationTreeItemIdsCounter=0,this._debugVisualizationProviders=new Map,this._debugVisualizationTrees=new Map,this._debugVisualizationTreeItemIds=new WeakMap,this._debugVisualizationElements=new Map,this._visualizers=new Map,this._visualizerIdCounter=0,this._configProviderHandleCounter=0,this._configProviders=[],this._adapterFactoryHandleCounter=0,this._adapterFactories=[],this._trackerFactoryHandleCounter=0,this._trackerFactories=[],this._debugAdapters=new Map,this._debugAdaptersTrackers=new Map,this._onDidStartDebugSession=this._register(new x),this._onDidTerminateDebugSession=this._register(new x),this._onDidChangeActiveDebugSession=this._register(new x),this._onDidReceiveDebugSessionCustomEvent=this._register(new x),this._debugServiceProxy=e.getProxy(E.MainThreadDebugService),this._onDidChangeBreakpoints=this._register(new x),this._onDidChangeActiveStackItem=this._register(new x),this._activeDebugConsole=new zL(this._debugServiceProxy),this._breakpoints=new Map,this._extensionService.getExtensionRegistry().then(e=>{this._register(e.onDidChange(t=>{this.registerAllDebugTypes(e)})),this.registerAllDebugTypes(e)}),this._telemetryProxy=e.getProxy(E.MainThreadTelemetry)}async $getVisualizerTreeItem(e,t){let n=this.hydrateVisualizationContext(t);if(!n)return;let r=await this._debugVisualizationTrees.get(e)?.getTreeItem?.(n);return r?this.convertVisualizerTreeItem(e,r):void 0}registerDebugVisualizationTree(e,t,n){let r=ms.toKey(e.identifier),i=this.extensionVisKey(r,t);if(this._debugVisualizationProviders.has(i))throw Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationTrees.set(i,n),this._debugServiceProxy.$registerDebugVisualizerTree(i,!!n.editItem),_(()=>{this._debugServiceProxy.$unregisterDebugVisualizerTree(i),this._debugVisualizationTrees.delete(t)})}async $getVisualizerTreeItemChildren(e,t){let n=this._debugVisualizationElements.get(t)?.item;if(!n)return[];let r=await this._debugVisualizationTrees.get(e)?.getChildren?.(n);return r?.map(t=>this.convertVisualizerTreeItem(e,t))||[]}async $editVisualizerTreeItem(e,t){let n=this._debugVisualizationElements.get(e);if(!n)return;let r=await this._debugVisualizationTrees.get(n.provider)?.editItem?.(n.item,t);return this.convertVisualizerTreeItem(n.provider,r||n.item)}$disposeVisualizedTree(e){let t=this._debugVisualizationElements.get(e);if(!t)return;let n=[t.children];for(let e of n)if(e)for(let t of e)n.push(this._debugVisualizationElements.get(t)?.children),this._debugVisualizationElements.delete(t)}convertVisualizerTreeItem(e,t){let n=this._debugVisualizationTreeItemIds.get(t);return n||(n=this._debugVisualizationTreeItemIdsCounter++,this._debugVisualizationTreeItemIds.set(t,n),this._debugVisualizationElements.set(n,{provider:e,item:t})),zk.from(t,n)}asDebugSourceUri(e,t){let n=e;if(typeof n.sourceReference==`number`&&n.sourceReference>0){let e=`debug:${encodeURIComponent(n.path||``)}`,r=`?`;return t&&(e+=`${r}session=${encodeURIComponent(t.id)}`,r=`&`),e+=`${r}ref=${n.sourceReference}`,w.parse(e)}else if(n.path)return w.file(n.path);else throw Error(`cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.`)}registerAllDebugTypes(e){let t=[];for(let n of e.getAllExtensionDescriptions())if(n.contributes){let e=n.contributes.debuggers;if(e&&e.length>0)for(let n of e)XI(n)&&t.push(n.type)}this._debugServiceProxy.$registerDebugTypes(t)}get activeStackItem(){return this._activeStackItem}get onDidChangeActiveStackItem(){return this._onDidChangeActiveStackItem.event}get onDidChangeBreakpoints(){return this._onDidChangeBreakpoints.event}get breakpoints(){let e=[];return this._breakpoints.forEach(t=>e.push(t)),e}async $resolveDebugVisualizer(e,t){let n=this._visualizers.get(e);if(!n)throw Error(`No debug visualizer found with id '${e}'`);let{v:r,provider:i,extensionId:a}=n;if(r.visualization||(r=await i.resolveDebugVisualization?.(r,t)||r,n.v=r),!r.visualization)throw Error(`No visualization returned from resolveDebugVisualization in '${i}'`);return this.serializeVisualization(a,r.visualization)}async $executeDebugVisualizerCommand(e){let t=this._visualizers.get(e);if(!t)throw Error(`No debug visualizer found with id '${e}'`);let n=t.v.visualization;n&&`command`in n&&this._commands.executeCommand(n.command,...n.arguments||[])}hydrateVisualizationContext(e){let t=this._debugSessions.get(e.sessionId);return t&&{session:t.api,variable:e.variable,containerId:e.containerId,frameId:e.frameId,threadId:e.threadId}}async $provideDebugVisualizers(e,t,n,r){let i=this.hydrateVisualizationContext(n),a=this.extensionVisKey(e,t),o=this._debugVisualizationProviders.get(a);if(!i||!o)return[];let s=await o.provideDebugVisualization(i,r);return s?s.map(t=>{let n=++this._visualizerIdCounter;this._visualizers.set(n,{v:t,provider:o,extensionId:e});let r=t.iconPath?this.getIconPathOrClass(t.iconPath):void 0;return{id:n,name:t.name,iconClass:r?.iconClass,iconPath:r?.iconPath,visualization:this.serializeVisualization(e,t.visualization)}}):[]}$disposeDebugVisualizers(e){for(let t of e)this._visualizers.delete(t)}registerDebugVisualizationProvider(e,t,n){if(!e.contributes?.debugVisualizers?.some(e=>e.id===t))throw Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${t})`);let r=ms.toKey(e.identifier),i=this.extensionVisKey(r,t);if(this._debugVisualizationProviders.has(i))throw Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationProviders.set(i,n),this._debugServiceProxy.$registerDebugVisualizer(r,t),_(()=>{this._debugServiceProxy.$unregisterDebugVisualizer(r,t),this._debugVisualizationProviders.delete(t)})}addBreakpoints(e){let t=e.filter(e=>{let t=e.id;return this._breakpoints.has(t)?!1:(this._breakpoints.set(t,e),!0)});this.fireBreakpointChanges(t,[],[]);let n=[],r=new Map;for(let e of t)if(e instanceof WS){let t=r.get(e.location.uri.toString());t||(t={type:`sourceMulti`,uri:e.location.uri,lines:[]},r.set(e.location.uri.toString(),t),n.push(t)),t.lines.push({id:e.id,enabled:e.enabled,condition:e.condition,hitCondition:e.hitCondition,logMessage:e.logMessage,line:e.location.range.start.line,character:e.location.range.start.character,mode:e.mode})}else e instanceof GS&&n.push({type:`function`,id:e.id,enabled:e.enabled,hitCondition:e.hitCondition,logMessage:e.logMessage,condition:e.condition,functionName:e.functionName,mode:e.mode});return this._debugServiceProxy.$registerBreakpoints(n)}removeBreakpoints(e){let t=e.filter(e=>this._breakpoints.delete(e.id));this.fireBreakpointChanges([],t,[]);let n=t.filter(e=>e instanceof WS).map(e=>e.id),r=t.filter(e=>e instanceof GS).map(e=>e.id),i=t.filter(e=>e instanceof KS).map(e=>e.id);return this._debugServiceProxy.$unregisterBreakpoints(n,r,i)}startDebugging(e,t,n){let r=n.testRun&&this._testing.getMetadataForRun(n.testRun);return this._debugServiceProxy.$startDebugging(e?e.uri:void 0,t,{parentSessionID:n.parentSession?n.parentSession.id:void 0,lifecycleManagedByParent:n.lifecycleManagedByParent,repl:n.consoleMode===TC.MergeWithParent?`mergeWithParent`:`separate`,noDebug:n.noDebug,compact:n.compact,suppressSaveBeforeStart:n.suppressSaveBeforeStart,testRun:r&&{runId:r.runId,taskId:r.taskId},suppressDebugStatusbar:n.suppressDebugStatusbar??n.debugUI?.simple,suppressDebugToolbar:n.suppressDebugToolbar??n.debugUI?.simple,suppressDebugView:n.suppressDebugView??n.debugUI?.simple})}stopDebugging(e){return this._debugServiceProxy.$stopDebugging(e?e.id:void 0)}registerDebugConfigurationProvider(e,t,n){if(!t)return new Pb(()=>{});let r=this._configProviderHandleCounter++;return this._configProviders.push({type:e,handle:r,provider:t}),this._debugServiceProxy.$registerDebugConfigurationProvider(e,n,!!t.provideDebugConfigurations,!!t.resolveDebugConfiguration,!!t.resolveDebugConfigurationWithSubstitutedVariables,r),new Pb(()=>{this._configProviders=this._configProviders.filter(e=>e.provider!==t),this._debugServiceProxy.$unregisterDebugConfigurationProvider(r)})}registerDebugAdapterDescriptorFactory(e,t,n){if(!n)return new Pb(()=>{});if(!this.definesDebugType(e,t))throw Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${t}' debugger.`);if(this.getAdapterDescriptorFactoryByType(t))throw Error(`a DebugAdapterDescriptorFactory can only be registered once per a type.`);let r=this._adapterFactoryHandleCounter++;return this._adapterFactories.push({type:t,handle:r,factory:n}),this._debugServiceProxy.$registerDebugAdapterDescriptorFactory(t,r),new Pb(()=>{this._adapterFactories=this._adapterFactories.filter(e=>e.factory!==n),this._debugServiceProxy.$unregisterDebugAdapterDescriptorFactory(r)})}registerDebugAdapterTrackerFactory(e,t){if(!t)return new Pb(()=>{});let n=this._trackerFactoryHandleCounter++;return this._trackerFactories.push({type:e,handle:n,factory:t}),new Pb(()=>{this._trackerFactories=this._trackerFactories.filter(e=>e.factory!==t)})}async $runInTerminal(e,t){return Promise.resolve(void 0)}async $substituteVariables(e,t){let n,r=await this.getFolder(e);r&&(n={uri:r.uri,name:r.name,index:r.index,toResource:()=>{throw Error(`Not implemented`)}});let i=await this._variableResolver.getResolver();return i.resolveAsync(n,t)}createDebugAdapter(e,t){if(e instanceof XS)return new VL(e.implementation)}createSignService(){}async $startDASession(e,t){let n=this,r=await this.getSession(t);return this.getAdapterDescriptor(this.getAdapterDescriptorFactoryByType(r.type),r).then(t=>{if(!t)throw Error(`Couldn't find a debug adapter descriptor for debug type '${r.type}' (extension might have failed to activate)`);let i=this.createDebugAdapter(t,r);if(!i)throw Error(`Couldn't create a debug adapter for type '${r.type}'.`);let a=i;return this._debugAdapters.set(e,a),this.getDebugAdapterTrackers(r).then(t=>(t&&this._debugAdaptersTrackers.set(e,t),a.onMessage(async i=>{if(i.type===`request`&&i.command===`handshake`){let e=i,t={type:`response`,seq:0,command:e.command,request_seq:e.seq,success:!0};this._signService||=this.createSignService();try{if(this._signService){let n=await this._signService.sign(e.arguments.value);t.body={signature:n},a.sendResponse(t)}else throw Error(`no signer`)}catch(e){t.success=!1,t.message=e.message,a.sendResponse(t)}}else{t&&t.onDidSendMessage&&t.onDidSendMessage(i);try{i=nL(i,!0)}catch(e){let t=i.type+`_`+(i.command??i.event??``);throw this._telemetryProxy.$publicLog2(`debugProtocolMessageError`,{type:t,from:r.type}),e}n._debugServiceProxy.$acceptDAMessage(e,i)}}),a.onError(n=>{t&&t.onError&&t.onError(n),this._debugServiceProxy.$acceptDAError(e,n.name,n.message,n.stack)}),a.onExit(n=>{t&&t.onExit&&t.onExit(n??void 0,void 0),this._debugServiceProxy.$acceptDAExit(e,n??void 0,void 0)}),t&&t.onWillStartSession&&t.onWillStartSession(),a.startSession()))})}$sendDAMessage(e,t){t=tL(t,!1);let n=this._debugAdaptersTrackers.get(e);n&&n.onWillReceiveMessage&&n.onWillReceiveMessage(t);let r=this._debugAdapters.get(e);r?.sendMessage(t)}$stopDASession(e){let t=this._debugAdaptersTrackers.get(e);this._debugAdaptersTrackers.delete(e),t&&t.onWillStopSession&&t.onWillStopSession();let n=this._debugAdapters.get(e);return this._debugAdapters.delete(e),n?n.stopSession():Promise.resolve(void 0)}$acceptBreakpointsDelta(e){let t=[],n=[],r=[];if(e.added)for(let n of e.added){let e=n.id;if(e&&!this._breakpoints.has(e)){let r;if(n.type===`function`)r=new GS(n.functionName,n.enabled,n.condition,n.hitCondition,n.logMessage,n.mode);else if(n.type===`data`)r=new KS(n.label,n.dataId,n.canPersist,n.enabled,n.hitCondition,n.condition,n.logMessage,n.mode);else{let e=w.revive(n.uri);r=new WS(new ex(e,new Fb(n.line,n.character)),n.enabled,n.condition,n.hitCondition,n.logMessage,n.mode)}HS(r,e),this._breakpoints.set(e,r),t.push(r)}}if(e.removed)for(let t of e.removed){let e=this._breakpoints.get(t);e&&(this._breakpoints.delete(t),n.push(e))}if(e.changed){for(let t of e.changed)if(t.id){let e=this._breakpoints.get(t.id);if(e){if(e instanceof GS&&t.type===`function`){let n=e;n.enabled=t.enabled,n.condition=t.condition,n.hitCondition=t.hitCondition,n.logMessage=t.logMessage,n.functionName=t.functionName}else if(e instanceof WS&&t.type===`source`){let n=e;n.enabled=t.enabled,n.condition=t.condition,n.hitCondition=t.hitCondition,n.logMessage=t.logMessage,n.location=new ex(w.revive(t.uri),new Fb(t.line,t.character))}r.push(e)}}}this.fireBreakpointChanges(t,n,r)}async $acceptStackFrameFocus(e){let t;if(e){let n=await this.getSession(e.sessionId);t=e.kind===`thread`?new QS(n.api,e.threadId):new ZS(n.api,e.threadId,e.frameId)}this._activeStackItem=t,this._onDidChangeActiveStackItem.fire(this._activeStackItem)}$provideDebugConfigurations(e,t,n){return uo(async()=>{let r=this.getConfigProviderByHandle(e);if(!r)throw Error(`no DebugConfigurationProvider found`);if(!r.provideDebugConfigurations)throw Error(`DebugConfigurationProvider has no method provideDebugConfigurations`);let i=await this.getFolder(t);return r.provideDebugConfigurations(i,n)}).then(e=>{if(!e)throw Error(`nothing returned from DebugConfigurationProvider.provideDebugConfigurations`);return e})}$resolveDebugConfiguration(e,t,n,r){return uo(async()=>{let i=this.getConfigProviderByHandle(e);if(!i)throw Error(`no DebugConfigurationProvider found`);if(!i.resolveDebugConfiguration)throw Error(`DebugConfigurationProvider has no method resolveDebugConfiguration`);let a=await this.getFolder(t);return i.resolveDebugConfiguration(a,n,r)})}$resolveDebugConfigurationWithSubstitutedVariables(e,t,n,r){return uo(async()=>{let i=this.getConfigProviderByHandle(e);if(!i)throw Error(`no DebugConfigurationProvider found`);if(!i.resolveDebugConfigurationWithSubstitutedVariables)throw Error(`DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables`);let a=await this.getFolder(t);return i.resolveDebugConfigurationWithSubstitutedVariables(a,n,r)})}async $provideDebugAdapter(e,t){let n=this.getAdapterDescriptorFactoryByHandle(e);if(!n)return Promise.reject(Error(`no adapter descriptor factory found for handle`));let r=await this.getSession(t);return this.getAdapterDescriptor(n,r).then(e=>{if(!e)throw Error(`Couldn't find a debug adapter descriptor for debug type '${r.type}'`);return this.convertToDto(e)})}async $acceptDebugSessionStarted(e){let t=await this.getSession(e);this._onDidStartDebugSession.fire(t.api)}async $acceptDebugSessionTerminated(e){let t=await this.getSession(e);t&&(this._onDidTerminateDebugSession.fire(t.api),this._debugSessions.delete(t.id))}async $acceptDebugSessionActiveChanged(e){this._activeDebugSession=e?await this.getSession(e):void 0,this._onDidChangeActiveDebugSession.fire(this._activeDebugSession?.api)}async $acceptDebugSessionNameChanged(e,t){let n=await this.getSession(e);n?._acceptNameChanged(t)}async $acceptDebugSessionCustomEvent(e,t){let n=await this.getSession(e),r={session:n.api,event:t.event,body:t.body};this._onDidReceiveDebugSessionCustomEvent.fire(r)}convertToDto(e){if(e instanceof qS)return this.convertExecutableToDto(e);if(e instanceof JS)return this.convertServerToDto(e);if(e instanceof YS)return this.convertPipeServerToDto(e);if(e instanceof XS)return this.convertImplementationToDto(e);throw Error(`convertToDto unexpected type`)}convertExecutableToDto(e){return{type:`executable`,command:e.command,args:e.args,options:e.options}}convertServerToDto(e){return{type:`server`,port:e.port,host:e.host}}convertPipeServerToDto(e){return{type:`pipeServer`,path:e.path}}convertImplementationToDto(e){return{type:`implementation`}}getAdapterDescriptorFactoryByType(e){let t=this._adapterFactories.filter(t=>t.type===e);if(t.length>0)return t[0].factory}getAdapterDescriptorFactoryByHandle(e){let t=this._adapterFactories.filter(t=>t.handle===e);if(t.length>0)return t[0].factory}getConfigProviderByHandle(e){let t=this._configProviders.filter(t=>t.handle===e);if(t.length>0)return t[0].provider}definesDebugType(e,t){if(e.contributes){let n=e.contributes.debuggers;if(n&&n.length>0){for(let e of n)if(e.label&&e.type&&e.type===t)return!0}}return!1}getDebugAdapterTrackers(e){let t=e.configuration,n=t.type,r=this._trackerFactories.filter(e=>e.type===n||e.type===`*`).map(t=>uo(()=>t.factory.createDebugAdapterTracker(e.api)).then(e=>e,e=>null));return Promise.race([Promise.all(r).then(e=>{let t=be(e);if(t.length>0)return new BL(t)}),new Promise(e=>setTimeout(()=>e(void 0),1e3))]).catch(e=>{})}async getAdapterDescriptor(e,t){let n=t.configuration.debugServer;if(typeof n==`number`)return Promise.resolve(new JS(n));if(e){let n=await this._extensionService.getExtensionRegistry();return uo(()=>e.createDebugAdapterDescriptor(t.api,this.daExecutableFromPackage(t,n))).then(e=>{if(e)return e})}let r=await this._extensionService.getExtensionRegistry();return Promise.resolve(this.daExecutableFromPackage(t,r))}daExecutableFromPackage(e,t){}fireBreakpointChanges(e,t,n){(e.length>0||t.length>0||n.length>0)&&this._onDidChangeBreakpoints.fire(Object.freeze({added:e,removed:t,changed:n}))}async getSession(e){if(e)if(typeof e==`string`){let t=this._debugSessions.get(e);if(t)return t}else{let t=this._debugSessions.get(e.id);if(!t){let n=await this.getFolder(e.folderUri),r=e.parent?this._debugSessions.get(e.parent):void 0;t=new RL(this._debugServiceProxy,e.id,e.type,e.name,n,e.configuration,r?.api),this._debugSessions.set(t.id,t),this._debugServiceProxy.$sessionCached(t.id)}return t}throw Error(`cannot find session`)}getFolder(e){if(e){let t=w.revive(e);return this._workspaceService.resolveWorkspaceFolder(t)}return Promise.resolve(void 0)}extensionVisKey(e,t){return`${e}\0${t}`}serializeVisualization(e,t){if(t){if(`title`in t&&`command`in t)return{type:tv.Command};if(`treeId`in t)return{type:tv.Tree,id:`${e}\0${t.treeId}`};throw Error(`Unsupported debug visualization type`)}}getIconPathOrClass(e){let t=this.getIconUris(e),n,r;return`id`in t?r=fl.asClassName(t):n=t,{iconPath:n,iconClass:r}}getIconUris(e){if(e instanceof LS)return{id:e.id};let t=typeof e==`object`&&`dark`in e?e.dark:e,n=typeof e==`object`&&`light`in e?e.light:e;return{dark:typeof t==`string`?w.file(t):t,light:typeof n==`string`?w.file(n):n}}};LL=A([j(0,Is),j(1,nj),j(2,qP),j(3,kj),j(4,iL),j(5,NL),j(6,$M),j(7,hL)],LL);var RL=class{constructor(e,t,n,r,i,a,o){this._debugServiceProxy=e,this._id=t,this._type=n,this._name=r,this._workspaceFolder=i,this._configuration=a,this._parentSession=o}get api(){let e=this;return this.apiSession??=Object.freeze({id:e._id,type:e._type,get name(){return e._name},set name(t){e._name=t,e._debugServiceProxy.$setDebugSessionName(e._id,t)},parentSession:e._parentSession,workspaceFolder:e._workspaceFolder,configuration:e._configuration,customRequest(t,n){return e._debugServiceProxy.$customDebugAdapterRequest(e._id,t,n)},getDebugProtocolBreakpoint(t){return e._debugServiceProxy.$getDebugProtocolBreakpoint(e._id,t.id)}})}get id(){return this._id}get type(){return this._type}_acceptNameChanged(e){this._name=e}get configuration(){return this._configuration}},zL=class{constructor(e){this.value=Object.freeze({append(t){e.$appendDebugConsole(t)},appendLine(e){this.append(e+`
`)}})}},BL=class{constructor(e){this.trackers=e}onWillStartSession(){this.trackers.forEach(e=>e.onWillStartSession?e.onWillStartSession():void 0)}onWillReceiveMessage(e){this.trackers.forEach(t=>t.onWillReceiveMessage?t.onWillReceiveMessage(e):void 0)}onDidSendMessage(e){this.trackers.forEach(t=>t.onDidSendMessage?t.onDidSendMessage(e):void 0)}onWillStopSession(){this.trackers.forEach(e=>e.onWillStopSession?e.onWillStopSession():void 0)}onError(e){this.trackers.forEach(t=>t.onError?t.onError(e):void 0)}onExit(e,t){this.trackers.forEach(n=>n.onExit?n.onExit(e,t):void 0)}},VL=class extends YI{constructor(e){super(),this.implementation=e,e.onDidSendMessage(e=>{this.acceptMessage(e)})}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.implementation.handleMessage(e)}stopSession(){return this.implementation.dispose(),Promise.resolve(void 0)}};let HL=class extends LL{constructor(e,t,n,r,i,a,o,s){super(e,t,n,r,i,a,o,s)}};HL=A([j(0,Is),j(1,nj),j(2,qP),j(3,kj),j(4,iL),j(5,NL),j(6,$M),j(7,hL)],HL);function UL(e){return`uri`in e&&`ranges`in e&&`preview`in e}function WL(e){return e.folderOptions.map(t=>({folder:t.folder,excludes:t.excludes.map(e=>typeof e==`string`?e:e.pattern),includes:t.includes,useGlobalIgnoreFiles:t.useIgnoreFiles.global,useIgnoreFiles:t.useIgnoreFiles.local,useParentIgnoreFiles:t.useIgnoreFiles.parent,followSymlinks:t.followSymlinks,maxResults:e.maxResults,session:e.session}))}var GL=class{constructor(e){this.provider=e}provideFileSearchResults(e,t,n){let r=async()=>{let r=WL(t);return Promise.all(r.map(t=>this.provider.provideFileSearchResults({pattern:e},t,n)))};return r().then(e=>be(e).flat())}};function KL(e){return e.folderOptions.map(t=>({folder:t.folder,excludes:t.excludes.map(e=>typeof e==`string`?e:e.pattern),includes:t.includes,useGlobalIgnoreFiles:t.useIgnoreFiles.global,useIgnoreFiles:t.useIgnoreFiles.local,useParentIgnoreFiles:t.useIgnoreFiles.parent,followSymlinks:t.followSymlinks,maxResults:e.maxResults,previewOptions:qL(e.previewOptions),maxFileSize:e.maxFileSize,encoding:t.encoding,afterContext:e.surroundingContext,beforeContext:e.surroundingContext}))}function qL(e){return{matchLines:e?.matchLines??yA.matchLines,charsPerLine:e?.charsPerLine??yA.charsPerLine}}function JL(e){if(UL(e)){let t=De(e.ranges).map((t,n)=>{let r=De(e.preview.matches),i=r[n];return{sourceRange:t,previewRange:i}});return new Kk(e.uri,t,e.preview.text)}else return new qk(e.uri,e.text,e.lineNumber)}var YL=class{constructor(e){this.provider=e}provideTextSearchResults(e,t,n,r){let i=e=>{XL(e)&&n.report(JL(e))},a=async()=>be(await Promise.all(KL(t).map(t=>this.provider.provideTextSearchResults(e,t,{report:e=>i(e)},r)))).reduce((e,t)=>({limitHit:e.limitHit||t.limitHit}),{limitHit:!1}),o=a();return o.then(e=>({limitHit:e.limitHit,message:be(De(e.message))}))}};function XL(e){if(ZL(e)){if(Array.isArray(e.ranges)){if(!Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type."),!1;if(e.preview.matches.length!==e.ranges.length)return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}else if(Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}return!0}function ZL(e){return!!e.preview}var QL=class extends Js{constructor(e,t,n=()=>!1){let r=new Ws(n,()=>!1);super(r);let i=new ze;e.forEach((e,t)=>{let n=e.folder.with({query:``,fragment:``});i.has(n)?i.get(n).push({fq:e,i:t}):i.set(n,[{fq:e,i:t}])}),i.forEach((e,n)=>{let r=new Map;for(let n of e){let e=t(n.fq,n.i);r.set(this.encodeKey(n.fq.folder),e)}super.set(n,r)})}findQueryFragmentAwareSubstr(e){let t=super.findSubstr(e.with({query:``,fragment:``}));if(!t)return;let n=this.encodeKey(e);return t.get(n)}forEachFolderQueryInfo(e){return this.forEach(t=>t.forEach(t=>e(t)))}encodeKey(e){let t=``;return e.query&&(t+=e.query),e.fragment&&(t+=`#`+e.fragment),t}},$L=class{constructor(e,t,n){this.config=e,this.provider=t,this.sessionLifecycle=n,this.isLimitHit=!1,this.resultCount=0,this.isCanceled=!1,this.filePattern=e.filePattern,this.includePattern=e.includePattern&&kv(e.includePattern),this.maxResults=e.maxResults||void 0,this.exists=e.exists,this.activeCancellationTokens=new Set,this.globalExcludePattern=e.excludePattern&&kv(e.excludePattern)}cancel(){this.isCanceled=!0,this.activeCancellationTokens.forEach(e=>e.cancel()),this.activeCancellationTokens=new Set}search(e){let t=this.config.folderQueries||[];return new Promise((n,r)=>{let i=t=>{this.resultCount++,e(t)};if(this.isCanceled)return n({limitHit:this.isLimitHit});this.config.extraFileResources&&this.config.extraFileResources.forEach(e=>{let t=e.toString(),n=Wr(t);this.globalExcludePattern&&this.globalExcludePattern(t,n)||this.matchFile(i,{base:e,basename:n})}),this.doSearch(t,i).then(e=>{n({limitHit:this.isLimitHit,stats:e||void 0})},e=>{r(Error(Em(e)))})})}async doSearch(e,t){let n=new Ai,r=e.map(e=>this.getSearchOptionsForFolder(e)),i=this.provider instanceof GL?this.sessionLifecycle?.tokenSource.token:this.sessionLifecycle?.obj,a={folderOptions:r,maxResults:this.config.maxResults??Zk,session:i},o=e=>{let t=new pA(this.config,e),n=!t.hasSiblingExcludeClauses();return{queryTester:t,noSiblingsClauses:n,folder:e.folder,tree:this.initDirectoryTree()}},s=new QL(e,o),c;try{this.activeCancellationTokens.add(n),c=$t.create();let e=await this.provider.provideFileSearchResults(this.config.filePattern||``,a,n.token),r=c.elapsed(),i=$t.create();return this.isCanceled&&!this.isLimitHit||(e&&e.forEach(e=>{let n=s.findQueryFragmentAwareSubstr(e),r=Lr.relative(n.folder.path,e.path);if(n.noSiblingsClauses){let i=Wr(e.path);this.matchFile(t,{base:n.folder,relativePath:r,basename:i});return}this.addDirectoryEntries(n.tree,n.folder,r,t)}),this.isCanceled&&!this.isLimitHit)?null:(s.forEachFolderQueryInfo(e=>{this.matchDirectoryTree(e.tree,e.queryTester,t)}),{providerTime:r,postProcessTime:i.elapsed()})}finally{n.dispose(),this.activeCancellationTokens.delete(n)}}getSearchOptionsForFolder(e){let t=fA(this.config.includePattern,e.includePattern),n=e.excludePattern?.map(e=>({folder:e.folder,patterns:fA(this.config.excludePattern,e.pattern)}));n?.length||(n=[{folder:void 0,patterns:fA(this.config.excludePattern,void 0)}]);let r=vA(n);return{folder:e.folder,excludes:r,includes:t,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks}}initDirectoryTree(){let e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries[`.`]=e.rootEntries,e}addDirectoryEntries({pathToEntries:e},t,n,r){if(n===this.filePattern){let e=Wr(this.filePattern);this.matchFile(r,{base:t,relativePath:this.filePattern,basename:e})}function i(n){let r=Wr(n),a=Ur(n),o=e[a];o||(o=e[a]=[],i(a)),o.push({base:t,relativePath:n,basename:r})}i(n)}matchDirectoryTree({rootEntries:e,pathToEntries:t},n,r){let i=this,a=this.filePattern;function o(e){let s=gA(()=>e.map(e=>e.basename));for(let c=0,l=e.length;c<l;c++){let l=e[c],{relativePath:u,basename:d}=l;if(n.matchesExcludesSync(u,d,a===d?void 0:s))continue;let f=t[u];if(f)o(f);else{if(u===a)continue;i.matchFile(r,l)}if(i.isLimitHit)break}}o(e)}matchFile(e,t){(!this.includePattern||t.relativePath&&this.includePattern(t.relativePath,t.basename))&&((this.exists||this.maxResults&&this.resultCount>=this.maxResults)&&(this.isLimitHit=!0,this.cancel()),this.isLimitHit||e(t))}},eR=class{constructor(){this._obj={},this.tokenSource=new Ai}get obj(){if(this._obj)return this._obj;throw Error(`Session object has been dereferenced.`)}cancel(){this.tokenSource.cancel(),this._obj=void 0}},tR=class e{constructor(){this.sessions=new Map}static{this.BATCH_SIZE=512}fileSearch(t,n,r,i){let a=this.getSessionTokenSource(t.cacheKey),o=new $L(t,n,a),s=0,c=e=>{s+=e.length,r(e.map(e=>this.rawMatchToSearchItem(e)))};return this.doSearch(o,e.BATCH_SIZE,c,i).then(e=>({limitHit:e.limitHit,stats:e.stats?{fromCache:!1,type:`fileSearchProvider`,resultCount:s,detailStats:e.stats}:void 0,messages:[]}))}clearCache(e){this.sessions.get(e)?.cancel(),this.sessions.delete(e)}getSessionTokenSource(e){if(e)return this.sessions.has(e)||this.sessions.set(e,new eR),this.sessions.get(e)}rawMatchToSearchItem(e){return e.relativePath?{resource:$a(e.base,e.relativePath)}:{resource:e.base}}doSearch(e,t,n,r){let i=r.onCancellationRequested(()=>{e.cancel()}),a=e=>{e&&(o.push(e),t>0&&o.length>=t&&(n(o),o=[]))},o=[];return e.search(a).then(e=>(o.length&&n(o),i.dispose(),e),e=>(o.length&&n(o),i.dispose(),Promise.reject(e)))}},nR=class{constructor(e,t,n){this.queryProviderPair=e,this.fileUtils=t,this.processType=n,this.collector=null,this.isLimitHit=!1,this.resultCount=0}get query(){return this.queryProviderPair.query}search(e,t,n){let r=this.query.folderQueries||[],i=new Ai(t);return new Promise((t,a)=>{this.collector=new iR(e);let o=!1,s=(e,t)=>{if(!(e instanceof Jk)&&!o&&!this.isLimitHit){let n=this.resultSize(e);e instanceof Kk&&typeof this.query.maxResults==`number`&&this.resultCount+n>this.query.maxResults&&(this.isLimitHit=!0,o=!0,i.cancel(),e=this.trimResultToSize(e,this.query.maxResults-this.resultCount));let r=this.resultSize(e);this.resultCount+=r;let a=e instanceof Kk;(r>0||!a)&&this.collector.add(e,t)}};this.doSearch(r,s,i.token,n).then(e=>{i.dispose(),this.collector.flush(),t({limitHit:this.isLimitHit||e?.limitHit,messages:this.getMessagesFromResults(e),stats:{type:this.processType}})},e=>{i.dispose();let t=Em(e);a(Error(t))})})}getMessagesFromResults(e){return e?.message?Array.isArray(e.message)?e.message:[e.message]:[]}resultSize(e){return e instanceof Kk?Array.isArray(e.ranges)?e.ranges.length:1:0}trimResultToSize(e,t){return new Kk(e.uri,e.ranges.slice(0,t),e.previewText)}async doSearch(e,t,n,r){let i=new QL(e,(e,t)=>{let n=new pA(this.query,e);return{queryTester:n,folder:e.folder,folderIdx:t}},()=>!0),a=[],o={report:e=>{if(e instanceof Jk)r?.(e);else{if(e.uri===void 0)throw Error(`Text search result URI is undefined. Please check provider implementation.`);let n=i.findQueryFragmentAwareSubstr(e.uri),r=n.folder.scheme===O.file?hA(()=>this.fileUtils.readdir(Qa(e.uri))):void 0,o=eo(n.folder,e.uri);if(o){let i=n.queryTester.includedInQuery(o,Wr(o),r);oo(i)?a.push(i.then(r=>{r&&t(e,n.folderIdx)})):i&&t(e,n.folderIdx)}}}},s=e.map(e=>this.getSearchOptionsForFolder(e)),c={folderOptions:s,maxFileSize:this.query.maxFileSize,maxResults:this.query.maxResults??Zk,previewOptions:this.query.previewOptions??yA,surroundingContext:this.query.surroundingContext??0};`usePCRE2`in this.query&&(c.usePCRE2=this.query.usePCRE2);let l;return l=this.queryProviderPair.query.type===$k.aiText?await this.queryProviderPair.provider.provideAITextSearchResults(this.queryProviderPair.query.contentPattern,c,o,n):await this.queryProviderPair.provider.provideTextSearchResults(rR(this.queryProviderPair.query.contentPattern),c,o,n),a.length&&await Promise.all(a),l}getSearchOptionsForFolder(e){let t=fA(this.query.includePattern,e.includePattern),n=e.excludePattern?.map(e=>({folder:e.folder,patterns:fA(this.query.excludePattern,e.pattern)}));(!n||n.length===0)&&(n=[{folder:void 0,patterns:fA(this.query.excludePattern,void 0)}]);let r=vA(n),i={folder:w.from(e.folder),excludes:r,includes:t,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks,encoding:(e.fileEncoding&&this.fileUtils.toCanonicalName(e.fileEncoding))??``};return i}};function rR(e){return{isCaseSensitive:e.isCaseSensitive||!1,isRegExp:e.isRegExp||!1,isWordMatch:e.isWordMatch||!1,isMultiline:e.isMultiline||!1,pattern:e.pattern}}var iR=class{constructor(e){this._onResult=e,this._currentFolderIdx=-1,this._currentFileMatch=null,this._batchedCollector=new oR(512,e=>this.sendItems(e))}add(e,t){this._currentFileMatch&&(this._currentFolderIdx!==t||!Ja(this._currentUri,e.uri))&&(this.pushToCollector(),this._currentFileMatch=null),this._currentFileMatch||=(this._currentFolderIdx=t,{resource:e.uri,results:[]}),this._currentFileMatch.results.push(aR(e))}pushToCollector(){let e=this._currentFileMatch&&this._currentFileMatch.results?this._currentFileMatch.results.length:0;this._batchedCollector.addItem(this._currentFileMatch,e)}flush(){this.pushToCollector(),this._batchedCollector.flush()}sendItems(e){this._onResult(e)}};function aR(e){return e instanceof Kk?{previewText:e.previewText,rangeLocations:e.ranges.map(e=>({preview:{startLineNumber:e.previewRange.start.line,startColumn:e.previewRange.start.character,endLineNumber:e.previewRange.end.line,endColumn:e.previewRange.end.character},source:{startLineNumber:e.sourceRange.start.line,startColumn:e.sourceRange.start.character,endLineNumber:e.sourceRange.end.line,endColumn:e.sourceRange.end.character}}))}:{text:e.text,lineNumber:e.lineNumber}}var oR=class e{static{this.TIMEOUT=4e3}static{this.START_BATCH_AFTER_COUNT=50}constructor(e,t){this.maxBatchSize=e,this.cb=t,this.totalNumberCompleted=0,this.batch=[],this.batchSize=0}addItem(e,t){e&&this.addItemToBatch(e,t)}addItems(e,t){e&&this.addItemsToBatch(e,t)}addItemToBatch(e,t){this.batch.push(e),this.batchSize+=t,this.onUpdate()}addItemsToBatch(e,t){this.batch=this.batch.concat(e),this.batchSize+=t,this.onUpdate()}onUpdate(){this.totalNumberCompleted<e.START_BATCH_AFTER_COUNT||this.batchSize>=this.maxBatchSize?this.flush():this.timeoutHandle||=setTimeout(()=>{this.flush()},e.TIMEOUT)}flush(){this.batchSize&&(this.totalNumberCompleted+=this.batchSize,this.cb(this.batch),this.batch=[],this.batchSize=0,this.timeoutHandle&&=(clearTimeout(this.timeoutHandle),void 0))}};const sR=k(`IExtHostSearch`);let cR=class{constructor(e,t,n){this.extHostRpc=e,this._uriTransformer=t,this._logService=n,this._proxy=this.extHostRpc.getProxy(E.MainThreadSearch),this._handlePool=0,this._textSearchProvider=new Map,this._textSearchUsedSchemes=new Set,this._aiTextSearchProvider=new Map,this._aiTextSearchUsedSchemes=new Set,this._fileSearchProvider=new Map,this._fileSearchUsedSchemes=new Set,this._fileSearchManager=new tR}_transformScheme(e){return this._uriTransformer.transformOutgoingScheme(e)}registerTextSearchProviderOld(e,t){if(this._textSearchUsedSchemes.has(e))throw Error(`a text search provider for the scheme '${e}' is already registered`);this._textSearchUsedSchemes.add(e);let n=this._handlePool++;return this._textSearchProvider.set(n,new YL(t)),this._proxy.$registerTextSearchProvider(n,this._transformScheme(e)),_(()=>{this._textSearchUsedSchemes.delete(e),this._textSearchProvider.delete(n),this._proxy.$unregisterProvider(n)})}registerTextSearchProvider(e,t){if(this._textSearchUsedSchemes.has(e))throw Error(`a text search provider for the scheme '${e}' is already registered`);this._textSearchUsedSchemes.add(e);let n=this._handlePool++;return this._textSearchProvider.set(n,t),this._proxy.$registerTextSearchProvider(n,this._transformScheme(e)),_(()=>{this._textSearchUsedSchemes.delete(e),this._textSearchProvider.delete(n),this._proxy.$unregisterProvider(n)})}registerAITextSearchProvider(e,t){if(this._aiTextSearchUsedSchemes.has(e))throw Error(`an AI text search provider for the scheme '${e}'is already registered`);this._aiTextSearchUsedSchemes.add(e);let n=this._handlePool++;return this._aiTextSearchProvider.set(n,t),this._proxy.$registerAITextSearchProvider(n,this._transformScheme(e)),_(()=>{this._aiTextSearchUsedSchemes.delete(e),this._aiTextSearchProvider.delete(n),this._proxy.$unregisterProvider(n)})}registerFileSearchProviderOld(e,t){if(this._fileSearchUsedSchemes.has(e))throw Error(`a file search provider for the scheme '${e}' is already registered`);this._fileSearchUsedSchemes.add(e);let n=this._handlePool++;return this._fileSearchProvider.set(n,new GL(t)),this._proxy.$registerFileSearchProvider(n,this._transformScheme(e)),_(()=>{this._fileSearchUsedSchemes.delete(e),this._fileSearchProvider.delete(n),this._proxy.$unregisterProvider(n)})}registerFileSearchProvider(e,t){if(this._fileSearchUsedSchemes.has(e))throw Error(`a file search provider for the scheme '${e}' is already registered`);this._fileSearchUsedSchemes.add(e);let n=this._handlePool++;return this._fileSearchProvider.set(n,t),this._proxy.$registerFileSearchProvider(n,this._transformScheme(e)),_(()=>{this._fileSearchUsedSchemes.delete(e),this._fileSearchProvider.delete(n),this._proxy.$unregisterProvider(n)})}$provideFileSearchResults(e,t,n,r){let i=lR(n),a=this._fileSearchProvider.get(e);if(a)return this._fileSearchManager.fileSearch(i,a,n=>{this._proxy.$handleFileMatch(e,t,n.map(e=>e.resource))},r);throw Error(`unknown provider: `+e)}async doInternalFileSearchWithCustomCallback(e,t,n){return{messages:[]}}$clearCache(e){return this._fileSearchManager.clearCache(e),Promise.resolve(void 0)}$provideTextSearchResults(e,t,n,r){let i=this._textSearchProvider.get(e);if(!i||!i.provideTextSearchResults)throw Error(`Unknown Text Search Provider ${e}`);let a=lR(n),o=this.createTextSearchManager(a,i);return o.search(n=>this._proxy.$handleTextMatch(e,t,n),r)}$provideAITextSearchResults(e,t,n,r){let i=this._aiTextSearchProvider.get(e);if(!i||!i.provideAITextSearchResults)throw Error(`Unknown AI Text Search Provider ${e}`);let a=lR(n),o=this.createAITextSearchManager(a,i);return o.search(n=>this._proxy.$handleTextMatch(e,t,n),r,n=>this._proxy.$handleKeywordResult(e,t,n))}$enableExtensionHostSearch(){}async $getAIName(e){let t=this._aiTextSearchProvider.get(e);if(!(!t||!t.provideAITextSearchResults))return t.name??`AI`}createTextSearchManager(e,t){return new nR({query:e,provider:t},{readdir:e=>Promise.resolve([]),toCanonicalName:e=>e},`textSearchProvider`)}createAITextSearchManager(e,t){return new nR({query:e,provider:t},{readdir:e=>Promise.resolve([]),toCanonicalName:e=>e},`aiTextSearchProvider`)}};cR=A([j(0,Is),j(1,Rs),j(2,xs)],cR);function lR(e){return{...e,folderQueries:e.folderQueries&&e.folderQueries.map(uR),extraFileResources:e.extraFileResources&&e.extraFileResources.map(e=>w.revive(e))}}function uR(e){return Gu(e)}const dR=k(`IExtHostTerminalShellIntegration`);let fR=class extends y{constructor(e,t){super(),this._extHostTerminalService=t,this._activeShellIntegrations=new Map,this._onDidChangeTerminalShellIntegration=new x,this.onDidChangeTerminalShellIntegration=this._onDidChangeTerminalShellIntegration.event,this._onDidStartTerminalShellExecution=new x,this.onDidStartTerminalShellExecution=this._onDidStartTerminalShellExecution.event,this._onDidEndTerminalShellExecution=new x,this.onDidEndTerminalShellExecution=this._onDidEndTerminalShellExecution.event,this._proxy=e.getProxy(E.MainThreadTerminalShellIntegration),this._register(_(()=>{for(let[e,t]of this._activeShellIntegrations)t.dispose();this._activeShellIntegrations.clear()}))}$shellIntegrationChange(e){let t=this._extHostTerminalService.getTerminalById(e);if(!t)return;let n=t.value,r=this._activeShellIntegrations.get(e);r||(r=new pR(t.value,this._onDidStartTerminalShellExecution),this._activeShellIntegrations.set(e,r),r.store.add(t.onWillDispose(()=>this._activeShellIntegrations.get(e)?.dispose())),r.store.add(r.onDidRequestShellExecution(t=>this._proxy.$executeCommand(e,t))),r.store.add(r.onDidRequestEndExecution(e=>this._onDidEndTerminalShellExecution.fire(e))),r.store.add(r.onDidRequestChangeShellIntegration(e=>this._onDidChangeTerminalShellIntegration.fire(e))),t.shellIntegration=r.value),this._onDidChangeTerminalShellIntegration.fire({terminal:n,shellIntegration:r.value})}$shellExecutionStart(e,t,n,r,i){this._activeShellIntegrations.has(e)||this.$shellIntegrationChange(e);let a={value:t,confidence:n,isTrusted:r};this._activeShellIntegrations.get(e)?.startShellExecution(a,this._convertCwdToUri(i))}$shellExecutionEnd(e,t,n,r,i){let a={value:t,confidence:n,isTrusted:r};this._activeShellIntegrations.get(e)?.endShellExecution(a,i)}$shellExecutionData(e,t){this._activeShellIntegrations.get(e)?.emitData(t)}$shellEnvChange(e,t,n,r){this._activeShellIntegrations.get(e)?.setEnv(t,n,r)}$cwdChange(e,t){this._activeShellIntegrations.get(e)?.setCwd(this._convertCwdToUri(t))}$closeTerminal(e){this._activeShellIntegrations.get(e)?.dispose(),this._activeShellIntegrations.delete(e)}_convertCwdToUri(e){return e?w.file(e):void 0}};fR=A([j(0,Is),j(1,rN)],fR);var pR=class extends y{get currentExecution(){return this._currentExecution}constructor(e,t){super(),this._terminal=e,this._onDidStartTerminalShellExecution=t,this._pendingExecutions=[],this.store=this._register(new v),this._onDidRequestChangeShellIntegration=this._register(new x),this.onDidRequestChangeShellIntegration=this._onDidRequestChangeShellIntegration.event,this._onDidRequestShellExecution=this._register(new x),this.onDidRequestShellExecution=this._onDidRequestShellExecution.event,this._onDidRequestEndExecution=this._register(new x),this.onDidRequestEndExecution=this._onDidRequestEndExecution.event,this._onDidRequestNewExecution=this._register(new x),this.onDidRequestNewExecution=this._onDidRequestNewExecution.event;let n=this;this.value={get cwd(){return n._cwd},get env(){if(n._env)return Object.freeze({isTrusted:n._env.isTrusted,value:Object.freeze({...n._env.value})})},executeCommand(e,t){let r=e;if(t)for(let e of t){let t=!e.match(/["'`]/)&&e.match(/\s/);t?r+=` "${e}"`:r+=` ${e}`}n._onDidRequestShellExecution.fire(r);let i={value:r,confidence:nS.High,isTrusted:!0},a=n.requestNewShellExecution(i,n._cwd).value;return a}}}requestNewShellExecution(e,t){let n=new mR(e,t??this._cwd),r=gR(e.value);return r.length>1&&(this._currentExecutionProperties={isMultiLine:!0,unresolvedCommandLines:gR(e.value)}),this._pendingExecutions.push(n),this._onDidRequestNewExecution.fire(e.value),n}startShellExecution(e,t){if(this._pendingEndingExecution&&=(this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._pendingEndingExecution.value,exitCode:void 0}),void 0),this._currentExecution){if(this._currentExecutionProperties?.isMultiLine&&this._currentExecutionProperties.unresolvedCommandLines){let t=_R(this._currentExecutionProperties.unresolvedCommandLines,e);if(t){this._currentExecutionProperties.unresolvedCommandLines=t.unresolvedCommandLines;return}}this._currentExecution.endExecution(void 0),this._currentExecution.flush(),this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value,exitCode:void 0})}let n;if(e.confidence===nS.High)for(let[t,r]of this._pendingExecutions.entries())if(r.value.commandLine.value===e.value){n=r,this._currentExecutionProperties={isMultiLine:!1,unresolvedCommandLines:void 0},n=r,this._pendingExecutions.splice(t,1);break}else{let i=_R(gR(r.value.commandLine.value),e);if(i){this._currentExecutionProperties={isMultiLine:!0,unresolvedCommandLines:i.unresolvedCommandLines},n=r,this._pendingExecutions.splice(t,1);break}}else n=this._pendingExecutions.shift();n||=new mR(e,t??this._cwd),this._currentExecution=n,this._onDidStartTerminalShellExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value})}emitData(e){this.currentExecution?.emitData(e)}endShellExecution(e,t){if(!(this._currentExecutionProperties?.isMultiLine&&this._currentExecutionProperties.unresolvedCommandLines&&this._currentExecutionProperties.unresolvedCommandLines.length>0)&&this._currentExecution){let n=this._currentExecutionProperties?.isMultiLine?this._currentExecution.value.commandLine:e;this._currentExecution.endExecution(n);let r=this._currentExecution;this._pendingEndingExecution=r,this._currentExecution=void 0,r.flush().then(()=>{this._pendingEndingExecution===r&&(this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:r.value,exitCode:t}),this._pendingEndingExecution=void 0)})}}setEnv(e,t,n){let r={};for(let n=0;n<e.length;n++)r[e[n]]=t[n];this._env={value:r,isTrusted:n},this._fireChangeEvent()}setCwd(e){let t=!1;w.isUri(this._cwd)?t=!w.isUri(e)||this._cwd.toString()!==e.toString():this._cwd!==e&&(t=!0),t&&(this._cwd=e,this._fireChangeEvent())}_fireChangeEvent(){this._onDidRequestChangeShellIntegration.fire({terminal:this._terminal,shellIntegration:this.value})}},mR=class{constructor(e,t){this._commandLine=e,this.cwd=t,this._isEnded=!1;let n=this;this.value={get commandLine(){return n._commandLine},get cwd(){return n.cwd},read(){return n._createDataStream()}}}_createDataStream(){if(!this._dataStream){if(this._isEnded)return Io.EMPTY;this._dataStream=new hR}return this._dataStream.createIterable()}emitData(e){this._isEnded||this._dataStream?.emitData(e)}endExecution(e){e&&(this._commandLine=e),this._dataStream?.endExecution(),this._isEnded=!0}async flush(){this._dataStream&&=(await this._dataStream.flush(),this._dataStream.dispose(),void 0)}},hR=class extends y{constructor(){super(...arguments),this._iterables=[],this._emitters=[]}createIterable(){this._barrier||=new bo;let e=this._barrier,t=new Io(async t=>{this._emitters.push(t),await e.wait()});return this._iterables.push(t),t}emitData(e){for(let t of this._emitters)t.emitOne(e)}endExecution(){this._barrier?.open()}async flush(){await Promise.all(this._iterables.map(e=>e.toPromise()))}};function gR(e){return e.split(`
`).map(e=>e.trim()).filter(e=>e.length>0)}function _R(e,t){if(e.length===0)return!1;let n=[...e],r=gR(t.value);if(n&&n.length>0){for(;n.length>0&&n[0]===r[0];)n.shift(),r.shift();if(r.length===0)return{unresolvedCommandLines:n}}return!1}var vR;(function(e){e[e.CR=13]=`CR`,e[e.LF=10]=`LF`,e[e.COLON=58]=`COLON`,e[e.SPACE=32]=`SPACE`})(vR||={});var yR=class{constructor(e){this.dataBuffer=``,this.eventTypeBuffer=``,this.buffer=[],this.endedOnCR=!1,this.onEventHandler=e,this.decoder=new TextDecoder(`utf-8`)}getLastEventId(){return this.lastEventIdBuffer}getReconnectionTime(){return this.reconnectionTime}feed(e){if(e.length===0)return;let t=0;for(this.endedOnCR&&e[0]===vR.LF&&t++,this.endedOnCR=!1;t<e.length;){let n=e.indexOf(vR.CR,t),r=e.indexOf(vR.LF,t),i=n===-1?r:r===-1?n:Math.min(n,r);if(i===-1)break;let a=``;for(let e of this.buffer)a+=this.decoder.decode(e,{stream:!0});a+=this.decoder.decode(e.subarray(t,i)),this.processLine(a),this.buffer.length=0,t=i+(e[i]===vR.CR&&e[i+1]===vR.LF?2:1)}t<e.length?this.buffer.push(e.subarray(t)):this.endedOnCR=e[e.length-1]===vR.CR}processLine(e){if(!e.length){this.dispatchEvent();return}if(e.startsWith(`:`))return;let t,n,r=e.indexOf(`:`);r===-1?(t=e,n=``):(t=e.substring(0,r),n=e.substring(r+1),n.startsWith(` `)&&(n=n.substring(1))),this.processField(t,n)}processField(e,t){switch(e){case`event`:this.eventTypeBuffer=t;break;case`data`:this.dataBuffer+=t,this.dataBuffer+=`
`;break;case`id`:t.includes(`\0`)?this.currentEventId=void 0:this.currentEventId=this.lastEventIdBuffer=t;break;case`retry`:/^\d+$/.test(t)&&(this.reconnectionTime=parseInt(t,10));break}}dispatchEvent(){if(this.dataBuffer===``){this.dataBuffer=``,this.eventTypeBuffer=``;return}this.dataBuffer.endsWith(`
`)&&(this.dataBuffer=this.dataBuffer.substring(0,this.dataBuffer.length-1));let e={type:this.eventTypeBuffer||`message`,data:this.dataBuffer};this.currentEventId!==void 0&&(e.id=this.currentEventId),this.reconnectionTime!==void 0&&(e.retry=this.reconnectionTime),this.onEventHandler(e),this.reset()}reset(){this.dataBuffer=``,this.eventTypeBuffer=``,this.currentEventId=void 0}};const bR=k(`IExtHostMpcService`);let xR=class extends y{constructor(e,t,n){super(),this._logService=t,this._extHostInitData=n,this._initialProviderPromises=new Set,this._sseEventSources=this._register(new St),this._unresolvedMcpServers=new Map,this._proxy=e.getProxy(E.MainThreadMcp)}$startMcp(e,t){this._startMcp(e,dD.fromSerialized(t))}_startMcp(e,t){if(t.type===uD.HTTP){this._sseEventSources.set(e,new wR(e,t,this._proxy,this._logService));return}throw Error(`not implemented`)}$stopMcp(e){this._sseEventSources.has(e)&&(this._sseEventSources.deleteAndDispose(e),this._proxy.$onDidChangeState(e,{state:fD.Kind.Stopped}))}$sendMessage(e,t){this._sseEventSources.get(e)?.send(t)}async $waitForInitialCollectionProviders(){await Promise.all(this._initialProviderPromises)}async $resolveMcpLaunch(e,t){let n=this._unresolvedMcpServers.get(e);if(!n)return;let r=n.servers.find(e=>e.label===t);if(!r)return;if(!n.provider.resolveMcpServerDefinition)return Gk.from(r);let i=await n.provider.resolveMcpServerDefinition(r,Oi.None);return i?Gk.from(i):void 0}registerMcpConfigurationProvider(e,t,n){let r=new v,i=e.contributes?.mcpServerDefinitionProviders?.find(e=>e.id===t);if(!i)throw Error(`MCP configuration providers must be registered in the contributes.mcpServerDefinitionProviders array within your package.json, but "${t}" was not`);let a={id:nD(e.identifier,t),isTrustedByDefault:!0,label:i?.label??e.displayName??e.name,scope:kh.WORKSPACE,canResolveLaunch:typeof n.resolveMcpServerDefinition==`function`,extensionId:e.identifier.value,configTarget:this._extHostInitData.remote.isRemote?Fh.USER_REMOTE:Fh.USER},o=async()=>{let t=await n.provideMcpServerDefinitions(Oi.None);this._unresolvedMcpServers.set(a.id,{servers:t??[],provider:n});let r=[];for(let n of t??[]){let t=ms.toKey(e.identifier)+`/`+n.label;if(r.some(e=>e.id===t)){let e=2;for(;r.some(n=>n.id===t+e);)e++;t+=e}r.push({id:t,label:n.label,cacheNonce:n.version||`$$NONE`,launch:Gk.from(n)})}this._proxy.$upsertMcpCollection(a,r)};r.add(_(()=>{this._unresolvedMcpServers.delete(a.id),this._proxy.$deleteMcpCollection(a.id)})),n.onDidChangeMcpServerDefinitions&&r.add(n.onDidChangeMcpServerDefinitions(o)),n.onDidChangeServerDefinitions&&r.add(n.onDidChangeServerDefinitions(o)),n.onDidChange&&r.add(n.onDidChange(o));let s=new Promise(e=>{setTimeout(()=>o().finally(()=>{this._initialProviderPromises.delete(s),e()}),0)});return this._initialProviderPromises.add(s),r}};xR=A([j(0,Is),j(1,xs),j(2,ks)],xR);var SR;(function(e){e[e.Unknown=0]=`Unknown`,e[e.Http=1]=`Http`,e[e.SSE=2]=`SSE`})(SR||={});const CR=[301,302,303,307,308];var wR=class extends y{constructor(e,t,n,r){super(),this._id=e,this._launch=t,this._proxy=n,this._logService=r,this._requestSequencer=new mo,this._postEndpoint=new No,this._mode={value:SR.Unknown},this._cts=new Ai,this._abortCtrl=new AbortController,this._register(_(()=>{this._abortCtrl.abort(),this._cts.dispose(!0)})),this._proxy.$onDidChangeState(this._id,{state:fD.Kind.Running})}async send(e){try{this._mode.value===SR.Unknown?await this._requestSequencer.queue(()=>this._send(e)):await this._send(e)}catch(e){let t=`Error sending message to ${this._launch.uri}: ${String(e)}`;this._proxy.$onDidChangeState(this._id,{state:fD.Kind.Error,message:t})}}_send(e){return this._mode.value===SR.SSE?this._sendLegacySSE(this._mode.endpoint,e):this._sendStreamableHttp(e,this._mode.value===SR.Http?this._mode.sessionId:void 0)}async _sendStreamableHttp(e,t){let n=new TextEncoder().encode(e),r={...Object.fromEntries(this._launch.headers),"Content-Type":`application/json`,"Content-Length":String(n.length),Accept:`text/event-stream, application/json`};t&&(r[`Mcp-Session-Id`]=t),await this._addAuthHeader(r);let i=await this._fetchWithAuthRetry(this._launch.uri.toString(!0),{method:`POST`,headers:r,body:n},r),a=this._mode.value===SR.Unknown,o=i.headers.get(`Mcp-Session-Id`);if(o&&(this._mode={value:SR.Http,sessionId:o}),this._mode.value===SR.Unknown&&i.status>=400&&i.status<500&&i.status!==401&&i.status!==403){this._log(eF.Info,`${i.status} status sending message to ${this._launch.uri}, will attempt to fall back to legacy SSE`),this._sseFallbackWithMessage(e);return}if(i.status>=300){let e=this._mode.value===SR.Http&&!!this._mode.sessionId&&(i.status===400||i.status===404);this._proxy.$onDidChangeState(this._id,{state:fD.Kind.Error,message:`${i.status} status sending message to ${this._launch.uri}: ${await this._getErrText(i)}`+(e?`; will retry with new session ID`:``),shouldRetry:e});return}this._mode.value===SR.Unknown&&(this._mode={value:SR.Http,sessionId:void 0}),a&&this._attachStreamableBackchannel(),await this._handleSuccessfulStreamableHttp(i,e)}async _sseFallbackWithMessage(e){let t=await this._attachSSE();t&&(this._mode={value:SR.SSE,endpoint:t},await this._sendLegacySSE(t,e))}async _populateAuthMetadata(e,t){let n;if(t.headers.has(`WWW-Authenticate`)){let e=t.headers.get(`WWW-Authenticate`),{scheme:r,params:i}=AN(e);r===`Bearer`&&i.resource_metadata&&(n=i.resource_metadata)}let r,i,a;if(n){let t=await this._getResourceMetadata(n);if(new URL(t.resource).toString()!==new URL(e).toString())throw Error(`Protected Resource Metadata resource "${t.resource}" does not match MCP server resolved resource "${e}". The MCP server must follow OAuth spec https://datatracker.ietf.org/doc/html/rfc9728#PRConfigurationValidation`);r=t.authorization_servers?.[0],i=t.scopes_supported,a=t}let o=new URL(t.url).origin,s={};r||(r=o,s={...Object.fromEntries(this._launch.headers)});try{let e=await this._getAuthorizationServerMetadata(r,s);this._authMetadata={authorizationServer:w.parse(r),serverMetadata:e,resourceMetadata:a};return}catch(e){this._log(eF.Warning,`Error populating auth metadata: ${String(e)}`)}let c=EN(new URL(o));c.scopes_supported=i??c.scopes_supported??[],this._authMetadata={authorizationServer:w.parse(r),serverMetadata:c,resourceMetadata:a}}async _getResourceMetadata(e){let t=new URL(e),n=new URL(this._launch.uri.toString(!0)),r={};t.origin===n.origin&&(r={...Object.fromEntries(this._launch.headers)});let i=await this._fetch(e,{method:`GET`,headers:{...r,Accept:`application/json`,"MCP-Protocol-Version":tD.LATEST_PROTOCOL_VERSION}});if(i.status!==200)throw Error(`Failed to fetch resource metadata: ${i.status} ${await this._getErrText(i)}`);let a=await i.json();if(bN(a))return a;throw Error(`Invalid resource metadata: ${JSON.stringify(a)}`)}async _getAuthorizationServerMetadata(e,t){let n=new URL(e),r=n.pathname===`/`?``:n.pathname,i=new URL(hN,e).toString()+r,a=await this._fetch(i,{method:`GET`,headers:{...t,Accept:`application/json`,"MCP-Protocol-Version":tD.LATEST_PROTOCOL_VERSION}});if(a.status!==200){let n=new URL(gN,e).toString()+r;if(a=await this._fetch(n,{method:`GET`,headers:{...t,Accept:`application/json`,"MCP-Protocol-Version":tD.LATEST_PROTOCOL_VERSION}}),a.status!==200&&(a=await this._fetch(w.joinPath(w.parse(e),gN).toString(!0),{method:`GET`,headers:{...t,Accept:`application/json`,"MCP-Protocol-Version":tD.LATEST_PROTOCOL_VERSION}}),a.status!==200))throw Error(`Failed to fetch authorization server metadata: ${a.status} ${await this._getErrText(a)}`)}let o=await a.json();if(xN(o))return o;throw Error(`Invalid authorization server metadata: ${JSON.stringify(o)}`)}async _handleSuccessfulStreamableHttp(e,t){if(e.status!==202)switch(e.headers.get(`Content-Type`)?.toLowerCase()){case`text/event-stream`:{let n=new yR(e=>{if(e.type===`message`)this._proxy.$onDidReceiveMessage(this._id,e.data);else if(e.type===`endpoint`)throw this._log(eF.Warning,`Received SSE endpoint from a POST to ${this._launch.uri}, will fall back to legacy SSE`),this._sseFallbackWithMessage(t),new oe});try{await this._doSSE(n,e)}catch(e){this._log(eF.Warning,`Error reading SSE stream: ${String(e)}`)}break}case`application/json`:this._proxy.$onDidReceiveMessage(this._id,await e.text());break;default:{let t=await e.text();TR(t)?this._proxy.$onDidReceiveMessage(this._id,t):this._log(eF.Warning,`Unexpected ${e.status} response for request: ${t}`)}}}async _attachStreamableBackchannel(){let e;for(let t=0;!this._store.isDisposed;t++){await xo(Math.min(t*1e3,3e4),this._cts.token);let n;try{let t={...Object.fromEntries(this._launch.headers),Accept:`text/event-stream`};await this._addAuthHeader(t),this._mode.value===SR.Http&&this._mode.sessionId!==void 0&&(t[`Mcp-Session-Id`]=this._mode.sessionId),e&&(t[`Last-Event-ID`]=e),n=await this._fetchWithAuthRetry(this._launch.uri.toString(!0),{method:`GET`,headers:t},t)}catch{this._log(eF.Info,`Error connecting to ${this._launch.uri} for async notifications, will retry`);continue}if(n.status>=400){this._log(eF.Debug,`${n.status} status connecting to ${this._launch.uri} for async notifications; they will be disabled: ${await this._getErrText(n)}`);return}n.headers.get(`content-type`)?.toLowerCase().includes(`text/event-stream`)&&(t=0);let r=new yR(t=>{t.type===`message`&&this._proxy.$onDidReceiveMessage(this._id,t.data),t.id&&(e=t.id)});try{await this._doSSE(r,n)}catch(e){this._log(eF.Info,`Error reading from async stream, we will reconnect: ${e}`)}}}async _attachSSE(){let e=new No,t={...Object.fromEntries(this._launch.headers),Accept:`text/event-stream`};await this._addAuthHeader(t);let n;try{if(n=await this._fetchWithAuthRetry(this._launch.uri.toString(!0),{method:`GET`,headers:t},t),n.status>=300){this._proxy.$onDidChangeState(this._id,{state:fD.Kind.Error,message:`${n.status} status connecting to ${this._launch.uri} as SSE: ${await this._getErrText(n)}`});return}}catch(e){this._proxy.$onDidChangeState(this._id,{state:fD.Kind.Error,message:`Error connecting to ${this._launch.uri} as SSE: ${e}`});return}let r=new yR(t=>{t.type===`message`?this._proxy.$onDidReceiveMessage(this._id,t.data):t.type===`endpoint`&&e.complete(new URL(t.data,this._launch.uri.toString(!0)).toString())});return this._register(_(()=>e.cancel())),this._doSSE(r,n).catch(e=>{this._proxy.$onDidChangeState(this._id,{state:fD.Kind.Error,message:`Error reading SSE stream: ${String(e)}`})}),e.p}async _sendLegacySSE(e,t){let n=new TextEncoder().encode(t),r={...Object.fromEntries(this._launch.headers),"Content-Type":`application/json`,"Content-Length":String(n.length)};await this._addAuthHeader(r);let i=await this._fetch(e,{method:`POST`,headers:r,body:n});i.status>=300&&this._log(eF.Warning,`${i.status} status sending message to ${this._postEndpoint}: ${await this._getErrText(i)}`)}async _doSSE(e,t){if(!t.body)return;let n=t.body.getReader(),r;do{try{r=await lo(n.read(),this._cts.token)}catch(e){if(n.cancel(),this._store.isDisposed)return;throw e}r.value&&e.feed(r.value)}while(!r.done)}async _addAuthHeader(e){if(this._authMetadata)try{let t=await this._proxy.$getTokenFromServerMetadata(this._id,this._authMetadata.authorizationServer,this._authMetadata.serverMetadata,this._authMetadata.resourceMetadata);t&&(e.Authorization=`Bearer ${t}`)}catch(e){this._log(eF.Warning,`Error getting token from server metadata: ${String(e)}`)}return e}_log(e,t){this._store.isDisposed||this._proxy.$onDidPublishLog(this._id,e,t)}async _getErrText(e){try{return await e.text()}catch{return e.statusText}}async _fetchWithAuthRetry(e,t,n){let r=()=>this._fetch(e,t),i=await r();return i.status===401&&(this._authMetadata||(await this._populateAuthMetadata(e,i),await this._addAuthHeader(n),n.Authorization&&(t.headers=n,i=await r()))),i}async _fetch(e,t){if(nF(this._logService.getLevel(),eF.Trace)){let n={...t,headers:{...t.headers}};n.body&&=new TextDecoder().decode(n.body),n.headers?.Authorization&&(n.headers.Authorization=`***`),this._log(eF.Trace,`Fetching ${e} with options: ${JSON.stringify(n)}`)}let n=e,r;for(let e=0;e<5&&(r=await fetch(n,{...t,signal:this._abortCtrl.signal,redirect:`manual`}),CR.includes(r.status));e++){let e=r.headers.get(`location`);if(!e)break;let i=new URL(e,n).toString();this._log(eF.Trace,`Redirect (${r.status}) from ${n} to ${i}`),n=i,(r.status===303||(r.status===301||r.status===302)&&t.method===`POST`)&&(t.method=`GET`,delete t.body)}if(nF(this._logService.getLevel(),eF.Trace)){let e={};r.headers.forEach((t,n)=>{e[n]=t}),this._log(eF.Trace,`Fetched ${n}: ${JSON.stringify({status:r.status,headers:e})}`)}return r}};function TR(e){try{return JSON.parse(e),!0}catch{return!1}}const ER=k(`IExtHostDataChannels`);var DR=class{constructor(){this._channels=new Map}createDataChannel(e,t){U(e,`dataChannels`);let n=this._channels.get(t);return n||(n=new OR(t),this._channels.set(t,n)),n}$onDidReceiveData(e,t){let n=this._channels.get(e);n&&n._fireDidReceiveData(t)}},OR=class extends y{constructor(e){super(),this.channelId=e,this._onDidReceiveData=new x,this.onDidReceiveData=this._onDidReceiveData.event,this._register(this._onDidReceiveData)}_fireDidReceiveData(e){this._onDidReceiveData.fire({data:e})}toString(){return`DataChannel(${this.channelId})`}};Es(IP,FP,Ts.Delayed),Es(Ss,dF,Ts.Delayed),Es(QP,$P,Ts.Delayed),Es($M,QM,Ts.Eager),Es(VN,HN,Ts.Eager),Es(QN,tP,Ts.Eager),Es(kj,Dj,Ts.Eager),Es(Xj,Yj,Ts.Eager),Es(hL,gL,Ts.Eager),Es(IL,HL,Ts.Eager),Es(kF,OF,Ts.Eager),Es(GF,WF,Ts.Eager),Es(LP,RP,Ts.Eager),Es(Mc,jc,Ts.Eager),Es(EF,TF,Ts.Delayed),Es(sR,cR,Ts.Eager),Es(Gj,Wj,Ts.Eager),Es(JI,qI,Ts.Eager),Es(rN,uN,Ts.Eager),Es(dR,fR,Ts.Eager),Es(fM,pM,Ts.Eager),Es(PN,NN,Ts.Eager),Es(LN,IN,Ts.Eager),Es(nj,tj,Ts.Eager),Es(NP,MP,Ts.Eager),Es(iL,sL,Ts.Eager),Es(NL,FL,Ts.Eager),Es(bR,xR,Ts.Eager),Es(ER,DR,Ts.Eager);function kR(e,t,n,r,i,a){if(Array.isArray(e)){let o=0;for(let s of e){let e=kR(s,t,n,r,i,a);if(e===10)return e;e>o&&(o=e)}return o}else if(typeof e==`string`)return r?e===`*`?5:e===n?10:0:0;else if(e){let{language:o,pattern:s,scheme:c,hasAccessToAllModels:l,notebookType:u}=e;if(!r&&!l)return 0;u&&i&&(t=i);let d=0;if(c)if(c===t.scheme)d=10;else if(c===`*`)d=5;else return 0;if(o)if(o===n)d=10;else if(o===`*`)d=Math.max(d,5);else return 0;if(u)if(u===a)d=10;else if(u===`*`&&a!==void 0)d=Math.max(d,5);else return 0;if(s){let e;if(e=typeof s==`string`?s:{...s,base:Rr(s.base)},e===t.fsPath||Ov(e,t.fsPath))d=10;else return 0}return d}else return 0}function AR(e){return typeof e==`string`?!1:Array.isArray(e)?e.some(AR):!!e.notebookType}var jR;(function(e){e[e.None=0]=`None`,e[e.Indent=1]=`Indent`,e[e.IndentOutdent=2]=`IndentOutdent`,e[e.Outdent=3]=`Outdent`})(jR||={});var MR;(function(e){e[e.Complete=100]=`Complete`,e[e.Partial=50]=`Partial`,e[e.None=0]=`None`})(MR||={});var NR=class{constructor(e){this._relatedInformationProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(E.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,t,n){if(this._relatedInformationProviders.size===0)throw Error(`No related information providers registered`);let r=this._relatedInformationProviders.get(e);if(!r)throw Error(`related information provider not found`);let i=await r.provideRelatedInformation(t,n)??[];return i}getRelatedInformation(e,t,n){return this._proxy.$getAiRelatedInformation(t,n)}registerRelatedInformationProvider(e,t,n){let r=this._nextHandle;return this._nextHandle++,this._relatedInformationProviders.set(r,n),this._proxy.$registerAiRelatedInformationProvider(r,t),new Pb(()=>{this._proxy.$unregisterAiRelatedInformationProvider(r),this._relatedInformationProviders.delete(r)})}},PR;(function(e){e[e.Full=1]=`Full`,e[e.Delta=2]=`Delta`})(PR||={});function FR(e){for(let t=0,n=e.length;t<n;t+=4){let n=e[t+0],r=e[t+1],i=e[t+2],a=e[t+3];e[t+0]=a,e[t+1]=i,e[t+2]=r,e[t+3]=n}}function IR(e){let t=new Uint8Array(e.buffer,e.byteOffset,e.length*4);return hr()||FR(t),b.wrap(t)}function LR(e){let t=e.buffer;if(hr()||FR(t),t.byteOffset%4==0)return new Uint32Array(t.buffer,t.byteOffset,t.length/4);{let e=new Uint8Array(t.byteLength);return e.set(t),new Uint32Array(e.buffer,e.byteOffset,e.length/4)}}function RR(e){let t=new Uint32Array(zR(e)),n=0;if(t[n++]=e.id,e.type===`full`)t[n++]=PR.Full,t[n++]=e.data.length,t.set(e.data,n),n+=e.data.length;else{t[n++]=PR.Delta,t[n++]=e.deltas.length;for(let r of e.deltas)t[n++]=r.start,t[n++]=r.deleteCount,r.data?(t[n++]=r.data.length,t.set(r.data,n),n+=r.data.length):t[n++]=0}return IR(t)}function zR(e){let t=0;if(t+=2,e.type===`full`)t+=1+e.data.length;else{t+=1,t+=3*e.deltas.length;for(let n of e.deltas)n.data&&(t+=n.data.length)}return t}function BR(e){let t=LR(e),n=0,r=t[n++],i=t[n++];if(i===PR.Full){let e=t[n++],i=t.subarray(n,n+e);return n+=e,{id:r,type:`full`,data:i}}let a=t[n++],o=[];for(let e=0;e<a;e++){let r=t[n++],i=t[n++],a=t[n++],s;a>0&&(s=t.subarray(n,n+a),n+=a),o[e]={start:r,deleteCount:i,data:s}}return{id:r,type:`delta`,deltas:o}}const VR=[new nN(`vscode.executeDocumentHighlights`,`_executeDocumentHighlights`,`Execute document highlight provider.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of DocumentHighlight-instances.`,UR($D.to))),new nN(`vscode.executeDocumentSymbolProvider`,`_executeDocumentSymbolProvider`,`Execute document symbol provider.`,[Y.Uri],new tN(`A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.`,(e,t)=>{if(Se(e))return;class n extends dx{constructor(){super(...arguments),this.containerName=``}static to(e){let r=new n(e.name,BD.to(e.kind),e.containerName||``,new ex(t[0],K.to(e.range)));return r.detail=e.detail,r.range=r.location.range,r.selectionRange=K.to(e.selectionRange),r.children=e.children?e.children.map(n.to):[],r}}return e.map(n.to)})),new nN(`vscode.executeFormatDocumentProvider`,`_executeFormatDocumentProvider`,`Execute document format provider.`,[Y.Uri,new Y(`options`,`Formatting options`,e=>!0,e=>e)],new tN(`A promise that resolves to an array of TextEdits.`,UR(RD.to))),new nN(`vscode.executeFormatRangeProvider`,`_executeFormatRangeProvider`,`Execute range format provider.`,[Y.Uri,Y.Range,new Y(`options`,`Formatting options`,e=>!0,e=>e)],new tN(`A promise that resolves to an array of TextEdits.`,UR(RD.to))),new nN(`vscode.executeFormatOnTypeProvider`,`_executeFormatOnTypeProvider`,`Execute format on type provider.`,[Y.Uri,Y.Position,new Y(`ch`,`Trigger character`,e=>typeof e==`string`,e=>e),new Y(`options`,`Formatting options`,e=>!0,e=>e)],new tN(`A promise that resolves to an array of TextEdits.`,UR(RD.to))),new nN(`vscode.executeDefinitionProvider`,`_executeDefinitionProvider`,`Execute all definition providers.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of Location or LocationLink instances.`,WR)),new nN(`vscode.experimental.executeDefinitionProvider_recursive`,`_executeDefinitionProvider_recursive`,`Execute all definition providers.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of Location or LocationLink instances.`,WR)),new nN(`vscode.executeTypeDefinitionProvider`,`_executeTypeDefinitionProvider`,`Execute all type definition providers.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of Location or LocationLink instances.`,WR)),new nN(`vscode.experimental.executeTypeDefinitionProvider_recursive`,`_executeTypeDefinitionProvider_recursive`,`Execute all type definition providers.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of Location or LocationLink instances.`,WR)),new nN(`vscode.executeDeclarationProvider`,`_executeDeclarationProvider`,`Execute all declaration providers.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of Location or LocationLink instances.`,WR)),new nN(`vscode.experimental.executeDeclarationProvider_recursive`,`_executeDeclarationProvider_recursive`,`Execute all declaration providers.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of Location or LocationLink instances.`,WR)),new nN(`vscode.executeImplementationProvider`,`_executeImplementationProvider`,`Execute all implementation providers.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of Location or LocationLink instances.`,WR)),new nN(`vscode.experimental.executeImplementationProvider_recursive`,`_executeImplementationProvider_recursive`,`Execute all implementation providers.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of Location or LocationLink instances.`,WR)),new nN(`vscode.executeReferenceProvider`,`_executeReferenceProvider`,`Execute all reference providers.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of Location-instances.`,UR(qD.to))),new nN(`vscode.experimental.executeReferenceProvider`,`_executeReferenceProvider_recursive`,`Execute all reference providers.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of Location-instances.`,UR(qD.to))),new nN(`vscode.executeHoverProvider`,`_executeHoverProvider`,`Execute all hover providers.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of Hover-instances.`,UR(YD.to))),new nN(`vscode.experimental.executeHoverProvider_recursive`,`_executeHoverProvider_recursive`,`Execute all hover providers.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of Hover-instances.`,UR(YD.to))),new nN(`vscode.executeSelectionRangeProvider`,`_executeSelectionRangeProvider`,`Execute selection range provider.`,[Y.Uri,new Y(`position`,`A position in a text document`,e=>Array.isArray(e)&&e.every(e=>Fb.isPosition(e)),e=>e.map(SD.from))],new tN(`A promise that resolves to an array of ranges.`,e=>e.map(e=>{let t;for(let n of e.reverse())t=new gx(K.to(n),t);return t}))),new nN(`vscode.executeWorkspaceSymbolProvider`,`_executeWorkspaceSymbolProvider`,`Execute all workspace symbol providers.`,[Y.String.with(`query`,`Search string`)],new tN(`A promise that resolves to an array of SymbolInformation-instances.`,e=>e.map(HD.to))),new nN(`vscode.prepareCallHierarchy`,`_executePrepareCallHierarchy`,`Prepare call hierarchy at a position inside a document`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of CallHierarchyItem-instances`,e=>e.map(WD.to))),new nN(`vscode.provideIncomingCalls`,`_executeProvideIncomingCalls`,`Compute incoming calls for an item`,[Y.CallHierarchyItem],new tN(`A promise that resolves to an array of CallHierarchyIncomingCall-instances`,e=>e.map(GD.to))),new nN(`vscode.provideOutgoingCalls`,`_executeProvideOutgoingCalls`,`Compute outgoing calls for an item`,[Y.CallHierarchyItem],new tN(`A promise that resolves to an array of CallHierarchyOutgoingCall-instances`,e=>e.map(KD.to))),new nN(`vscode.prepareRename`,`_executePrepareRename`,`Execute the prepareRename of rename provider.`,[Y.Uri,Y.Position],new tN(`A promise that resolves to a range and placeholder text.`,e=>{if(e)return{range:K.to(e.range),placeholder:e.text}})),new nN(`vscode.executeDocumentRenameProvider`,`_executeDocumentRenameProvider`,`Execute rename provider.`,[Y.Uri,Y.Position,Y.String.with(`newName`,`The new symbol name`)],new tN(`A promise that resolves to a WorkspaceEdit.`,e=>{if(e){if(e.rejectReason)throw Error(e.rejectReason);return zD.to(e)}})),new nN(`vscode.executeLinkProvider`,`_executeLinkProvider`,`Execute document link provider.`,[Y.Uri,Y.Number.with(`linkResolveCount`,`Number of links that should be resolved, only when links are unresolved.`).optional()],new tN(`A promise that resolves to an array of DocumentLink-instances.`,e=>e.map(pO.to))),new nN(`vscode.provideDocumentSemanticTokensLegend`,`_provideDocumentSemanticTokensLegend`,`Provide semantic tokens legend for a document`,[Y.Uri],new tN(`A promise that resolves to SemanticTokensLegend.`,e=>{if(e)return new yC(e.tokenTypes,e.tokenModifiers)})),new nN(`vscode.provideDocumentSemanticTokens`,`_provideDocumentSemanticTokens`,`Provide semantic tokens for a document`,[Y.Uri],new tN(`A promise that resolves to SemanticTokens.`,e=>{if(!e)return;let t=BR(e);if(t.type===`full`)return new SC(t.data,void 0)})),new nN(`vscode.provideDocumentRangeSemanticTokensLegend`,`_provideDocumentRangeSemanticTokensLegend`,`Provide semantic tokens legend for a document range`,[Y.Uri,Y.Range.optional()],new tN(`A promise that resolves to SemanticTokensLegend.`,e=>{if(e)return new yC(e.tokenTypes,e.tokenModifiers)})),new nN(`vscode.provideDocumentRangeSemanticTokens`,`_provideDocumentRangeSemanticTokens`,`Provide semantic tokens for a document range`,[Y.Uri,Y.Range],new tN(`A promise that resolves to SemanticTokens.`,e=>{if(!e)return;let t=BR(e);if(t.type===`full`)return new SC(t.data,void 0)})),new nN(`vscode.executeCompletionItemProvider`,`_executeCompletionItemProvider`,`Execute completion item provider.`,[Y.Uri,Y.Position,Y.String.with(`triggerCharacter`,"Trigger completion when the user types the character, like `,` or `(`").optional(),Y.Number.with(`itemResolveCount`,`Number of completions to resolve (too large numbers slow down completions)`).optional()],new tN(`A promise that resolves to a CompletionList-instance.`,(e,t,n)=>{if(!e)return new Nx([]);let r=e.suggestions.map(e=>oO.to(e,n));return new Nx(r,e.incomplete)})),new nN(`vscode.executeSignatureHelpProvider`,`_executeSignatureHelpProvider`,`Execute signature help provider.`,[Y.Uri,Y.Position,Y.String.with(`triggerCharacter`,"Trigger signature help when the user types the character, like `,` or `(`").optional()],new tN(`A promise that resolves to SignatureHelp.`,e=>{if(e)return lO.to(e)})),new nN(`vscode.executeCodeLensProvider`,`_executeCodeLensProvider`,`Execute code lens provider.`,[Y.Uri,Y.Number.with(`itemResolveCount`,`Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)`).optional()],new tN(`A promise that resolves to an array of CodeLens-instances.`,(e,t,n)=>UR(e=>new xx(K.to(e.range),e.command&&n.fromInternal(e.command)))(e))),new nN(`vscode.executeCodeActionProvider`,`_executeCodeActionProvider`,`Execute code action provider.`,[Y.Uri,new Y(`rangeOrSelection`,`Range in a text document. Some refactoring provider requires Selection object.`,e=>Ib.isRange(e),e=>Lb.isSelection(e)?yD.from(e):K.from(e)),Y.String.with(`kind`,`Code action kind to return code actions for`).optional(),Y.Number.with(`itemResolveCount`,`Number of code actions to resolve (too large numbers slow down code actions)`).optional()],new tN(`A promise that resolves to an array of Command-instances.`,(e,t,n)=>UR(e=>{if(e._isSynthetic){if(!e.command)throw Error(`Synthetic code actions must have a command`);return n.fromInternal(e.command)}else{let t=new mx(e.title,e.kind?new hx(e.kind):void 0);return e.edit&&(t.edit=zD.to(e.edit)),e.command&&(t.command=n.fromInternal(e.command)),t.isPreferred=e.isPreferred,t}})(e))),new nN(`vscode.executeDocumentColorProvider`,`_executeDocumentColorProvider`,`Execute document color provider.`,[Y.Uri],new tN(`A promise that resolves to an array of ColorInformation objects.`,e=>e?e.map(e=>new Zx(K.to(e.range),hO.to(e.color))):[])),new nN(`vscode.executeColorPresentationProvider`,`_executeColorPresentationProvider`,`Execute color presentation provider.`,[new Y(`color`,`The color to show and insert`,e=>e instanceof Xx,hO.from),new Y(`context`,`Context object with uri and range`,e=>!0,e=>({uri:e.uri,range:K.from(e.range)}))],new tN(`A promise that resolves to an array of ColorPresentation objects.`,e=>e?e.map(mO.to):[])),new nN(`vscode.executeInlayHintProvider`,`_executeInlayHintProvider`,`Execute inlay hints provider`,[Y.Uri,Y.Range],new tN(`A promise that resolves to an array of Inlay objects`,(e,t,n)=>e.map(uO.to.bind(void 0,n)))),new nN(`vscode.executeFoldingRangeProvider`,`_executeFoldingRangeProvider`,`Execute folding range provider`,[Y.Uri],new tN(`A promise that resolves to an array of FoldingRange objects`,(e,t)=>{if(e)return e.map(xO.to)})),new nN(`vscode.resolveNotebookContentProviders`,`_resolveNotebookContentProvider`,`Resolve Notebook Content Providers`,[],new tN(`A promise that resolves to an array of NotebookContentProvider static info objects.`,UR(e=>({viewType:e.viewType,displayName:e.displayName,options:{transientOutputs:e.options.transientOutputs,transientCellMetadata:e.options.transientCellMetadata,transientDocumentMetadata:e.options.transientDocumentMetadata},filenamePattern:e.filenamePattern.map(e=>NO.to(e))})))),new nN(`vscode.executeInlineValueProvider`,`_executeInlineValueProvider`,`Execute inline value provider`,[Y.Uri,Y.Range,new Y(`context`,`An InlineValueContext`,e=>e&&typeof e.frameId==`number`&&e.stoppedLocation instanceof Ib,e=>QD.from(e))],new tN(`A promise that resolves to an array of InlineValue objects`,e=>e.map(ZD.to))),new nN(`vscode.open`,`_workbench.open`,`Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.`,[new Y(`uriOrString`,`Uri-instance or string (only http/https)`,e=>w.isUri(e)||typeof e==`string`&&La(e,O.http,O.https),e=>e),new Y(`columnOrOptions`,`Either the column in which to open or editor options, see vscode.TextDocumentShowOptions`,e=>e===void 0||typeof e==`number`||typeof e==`object`,e=>e&&(typeof e==`number`?[OD.from(e),void 0]:[OD.from(e.viewColumn),CO.from(e)])).optional(),Y.String.with(`label`,``).optional()],tN.Void),new nN(`vscode.openWith`,`_workbench.openWith`,`Opens the provided resource with a specific editor.`,[Y.Uri.with(`resource`,`Resource to open`),Y.String.with(`viewId`,`Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use VS Code's default text editor`),new Y(`columnOrOptions`,`Either the column in which to open or editor options, see vscode.TextDocumentShowOptions`,e=>e===void 0||typeof e==`number`||typeof e==`object`,e=>e&&(typeof e==`number`?[OD.from(e),void 0]:[OD.from(e.viewColumn),CO.from(e)])).optional()],tN.Void),new nN(`vscode.diff`,`_workbench.diff`,`Opens the provided resources in the diff editor to compare their contents.`,[Y.Uri.with(`left`,`Left-hand side resource of the diff editor`),Y.Uri.with(`right`,`Right-hand side resource of the diff editor`),Y.String.with(`title`,`Human readable title for the diff editor`).optional(),new Y(`columnOrOptions`,`Either the column in which to open or editor options, see vscode.TextDocumentShowOptions`,e=>e===void 0||typeof e==`object`,e=>e&&[OD.from(e.viewColumn),CO.from(e)]).optional()],tN.Void),new nN(`vscode.changes`,`_workbench.changes`,`Opens a list of resources in the changes editor to compare their contents.`,[Y.String.with(`title`,`Human readable title for the changes editor`),new Y(`resourceList`,`List of resources to compare`,e=>{for(let t of e){if(t.length!==3)return!1;let[e,n,r]=t;if(!w.isUri(e)||!w.isUri(n)&&n!=null||!w.isUri(r)&&r!=null)return!1}return!0},e=>e)],tN.Void),new nN(`vscode.prepareTypeHierarchy`,`_executePrepareTypeHierarchy`,`Prepare type hierarchy at a position inside a document`,[Y.Uri,Y.Position],new tN(`A promise that resolves to an array of TypeHierarchyItem-instances`,e=>e.map(KO.to))),new nN(`vscode.provideSupertypes`,`_executeProvideSupertypes`,`Compute supertypes for an item`,[Y.TypeHierarchyItem],new tN(`A promise that resolves to an array of TypeHierarchyItem-instances`,e=>e.map(KO.to))),new nN(`vscode.provideSubtypes`,`_executeProvideSubtypes`,`Compute subtypes for an item`,[Y.TypeHierarchyItem],new tN(`A promise that resolves to an array of TypeHierarchyItem-instances`,e=>e.map(KO.to))),new nN(`vscode.revealTestInExplorer`,`_revealTestInExplorer`,`Reveals a test instance in the explorer`,[Y.TestItem],tN.Void),new nN(`vscode.startContinuousTestRun`,`testing.startContinuousRunFromExtension`,`Starts running the given tests with continuous run mode.`,[Y.TestProfile,Y.Arr(Y.TestItem)],tN.Void),new nN(`vscode.stopContinuousTestRun`,`testing.stopContinuousRunFromExtension`,`Stops running the given tests with continuous run mode.`,[Y.Arr(Y.TestItem)],tN.Void),new nN(`vscode.experimental.editSession.continue`,`_workbench.editSessions.actions.continueEditSession`,`Continue the current edit session in a different workspace`,[Y.Uri.with(`workspaceUri`,`The target workspace to continue the current edit session in`)],tN.Void),new nN(`setContext`,`_setContext`,`Set a custom context key value that can be used in when clauses.`,[Y.String.with(`name`,`The context key name`),new Y(`value`,`The context key value`,()=>!0,e=>e)],tN.Void),new nN(`vscode.editorChat.start`,`inlineChat.start`,`Invoke a new editor chat session`,[new Y(`Run arguments`,``,e=>!0,e=>{if(e)return{initialRange:e.initialRange?K.from(e.initialRange):void 0,initialSelection:Lb.isSelection(e.initialSelection)?yD.from(e.initialSelection):void 0,message:e.message,attachments:e.attachments,autoSend:e.autoSend,position:e.position?SD.from(e.position):void 0}})],tN.Void)];var HR=class{static register(e){VR.forEach(e.registerApiCommand,e),this._registerValidateWhenClausesCommand(e)}static _registerValidateWhenClausesCommand(e){e.registerCommand(!1,`_validateWhenClauses`,Ed)}};function UR(e){return t=>{if(Array.isArray(t))return t.map(e)}}function WR(e){if(!Array.isArray(e))return;let t=[];for(let n of e)Rp(n)?t.push(JD.to(n)):t.push(qD.to(n));return t}let GR=class{constructor(e,t){this._proxy=e.getProxy(E.MainThreadBulkEdits),this._versionInformationProvider={getTextDocumentVersion:e=>t.getDocument(e)?.version,getNotebookDocumentVersion:()=>void 0}}applyWorkspaceEdit(e,t,n){let r=new hi(zD.from(e,this._versionInformationProvider));return this._proxy.$tryApplyWorkspaceEdit(r,void 0,n?.isRefactoring??!1)}};GR=A([j(0,Is)],GR);function KR(e){return!!e&&typeof e.sessionId==`string`&&e.$mid===Dn.ChatViewContext}var qR;(function(e){e[e.Info=0]=`Info`,e[e.Warning=1]=`Warning`,e[e.Error=2]=`Error`})(qR||={});var JR;(function(e){e[e.Complete=1]=`Complete`,e[e.Partial=2]=`Partial`,e[e.Omitted=3]=`Omitted`})(JR||={});var YR;(function(e){e[e.NoReason=0]=`NoReason`,e[e.FilteredContentRetry=1]=`FilteredContentRetry`,e[e.CopyrightContentRetry=2]=`CopyrightContentRetry`})(YR||={});var XR;(function(e){e[e.Down=0]=`Down`,e[e.Up=1]=`Up`})(XR||={});var ZR;(function(e){e.IncorrectCode=`incorrectCode`,e.DidNotFollowInstructions=`didNotFollowInstructions`,e.IncompleteCode=`incompleteCode`,e.MissingContext=`missingContext`,e.PoorlyWrittenOrFormatted=`poorlyWrittenOrFormatted`,e.RefusedAValidRequest=`refusedAValidRequest`,e.OffensiveOrUnsafe=`offensiveOrUnsafe`,e.Other=`other`,e.WillReportIssue=`willReportIssue`})(ZR||={});var QR;(function(e){e[e.Action=1]=`Action`,e[e.Toolbar=2]=`Toolbar`})(QR||={});var $R=class{constructor(e,t,n,r,i){this._extension=e,this._request=t,this._proxy=n,this._commandsConverter=r,this._sessionDisposables=i,this._stopWatch=$t.create(!1),this._isClosed=!1}close(){this._isClosed=!0}get timings(){return{firstProgress:this._firstProgress,totalElapsed:this._stopWatch.elapsed()}}get apiObject(){if(!this._apiObject){let e=this;this._stopWatch.reset();let t=0;function n(t){if(e._isClosed){let e=Error(`Response stream has been closed`);throw Error.captureStackTrace(e,t),e}}let r=[],i=[];function a(t,n){let a=r.push(n===void 0?t:[t,n]);if(a===1&&queueMicrotask(()=>{e._proxy.$handleProgressChunk(e._request.requestId,r).finally(()=>{i.forEach(e=>e()),i.length=0}),r.length=0}),n!==void 0)return new Promise(e=>{i.push(e)})}let o=(e,n)=>{if(this._firstProgress===void 0&&(e.kind===`markdownContent`||e.kind===`markdownVuln`||e.kind===`prepareToolInvocation`)&&(this._firstProgress=this._stopWatch.elapsed()),n){let r=t++,i=a(e,r),o={report:e=>{i.then(()=>{Sx.isMarkdownString(e.value)?a(lk.from(e),r):a(xk.from(e),r)})}};Promise.all([i,n(o)]).then(([e,t])=>{a(gk.from(t),r)})}else a(e)};this._apiObject=Object.freeze({clearToPreviousToolInvocation(e){return n(this.markdown),a({kind:`clearToPreviousToolInvocation`,reason:e}),this},markdown(e){n(this.markdown);let t=new zw(e),r=tk.from(t);return o(r),this},markdownWithVulnerabilities(t,r){n(this.markdown),r&&U(e._extension,`chatParticipantAdditions`);let i=new Bw(t,r),a=rk.from(i);return o(a),this},codeblockUri(t,r){n(this.codeblockUri),U(e._extension,`chatParticipantAdditions`);let i=new Xw(t,r),a=nk.from(i);return o(a),this},filetree(e,t){n(this.filetree);let r=new Hw(e,t),i=ak.from(r);return o(i),this},anchor(e,t){let n=new Ww(e,t);return this.push(n)},button(t){n(this.anchor);let r=new Jw(t),i=_k.from(r,e._commandsConverter,e._sessionDisposables);return o(i),this},progress(e,t){n(this.progress);let r=new Kw(e,t),i=t?hk.from(r):ck.from(r);return o(i,t),this},warning(t){n(this.progress),U(e._extension,`chatParticipantAdditions`);let r=new qw(t),i=lk.from(r);return o(i),this},reference(e,t){return this.reference2(e,t)},reference2(t,r,i){if(n(this.reference),typeof t==`object`&&`variableName`in t&&U(e._extension,`chatParticipantAdditions`),typeof t==`object`&&`variableName`in t&&!t.value){let n=e._request.variables.variables.find(e=>e.name===t.variableName);if(n){let e;if(n.references?.length)e=n.references.map(e=>({kind:`reference`,reference:{variableName:t.variableName,value:e.reference}}));else{let n=new Yw(t,r,i),a=xk.from(n);e=[a]}return e.forEach(e=>o(e)),this}}else{let e=new Yw(t,r,i),n=xk.from(e);o(n)}return this},codeCitation(t,r,i){n(this.codeCitation),U(e._extension,`chatParticipantAdditions`);let a=new Zw(t,r,i),s=Sk.from(a);o(s)},textEdit(t,r){n(this.textEdit),U(e._extension,`chatParticipantAdditions`);let i=new tT(t,r);i.isDone=r===!0?!0:void 0;let a=vk.from(i);return o(a),this},notebookEdit(t,r){n(this.notebookEdit),U(e._extension,`chatParticipantAdditions`);let i=new nT(t,r),a=bk.from(i);return o(a),this},confirmation(t,r,i,a){n(this.confirmation),U(e._extension,`chatParticipantAdditions`);let s=new Vw(t,r,i,a),c=ik.from(s);return o(c),this},prepareToolInvocation(t){n(this.prepareToolInvocation),U(e._extension,`chatParticipantAdditions`);let r=new rT(t),i=pk.from(r);return o(i),this},push(t){if(n(this.push),(t instanceof tT||t instanceof nT||t instanceof Bw||t instanceof qw||t instanceof Vw||t instanceof Zw||t instanceof Qw||t instanceof $w||t instanceof eT||t instanceof Kw)&&U(e._extension,`chatParticipantAdditions`),t instanceof Yw)this.reference2(t.value,t.iconPath,t.options);else if(t instanceof Kw){let e=t.task?hk.from(t):ck.from(t);o(e,t.task)}else if(t instanceof Ww){let n=sk.from(t);if(t.resolve){U(e._extension,`chatParticipantAdditions`),n.resolveId=Nc();let r=new Ai;t.resolve(r.token).then(()=>{let r=sk.from(t);e._proxy.$handleAnchorResolve(e._request.requestId,n.resolveId,r)}).then(()=>r.dispose(),()=>r.dispose()),e._sessionDisposables.add(_(()=>r.dispose(!0)))}o(n)}else if(t instanceof rT){U(e._extension,`chatParticipantAdditions`);let n=pk.from(t);return o(n),this}else{let n=Ck.from(t,e._commandsConverter,e._sessionDisposables);o(n)}return this}})}return this._apiObject}},ez=class e extends y{static{this._idPool=0}static{this._participantDetectionProviderIdPool=0}static{this._relatedFilesProviderIdPool=0}constructor(e,t,n,r,i,a,o){super(),this._logService=t,this._commands=n,this._documents=r,this._languageModels=i,this._diagnostics=a,this._tools=o,this._agents=new Map,this._participantDetectionProviders=new Map,this._relatedFilesProviders=new Map,this._sessionDisposables=this._register(new St),this._completionDisposables=this._register(new St),this._inFlightRequests=new Set,this._onDidChangeChatRequestTools=this._register(new x),this.onDidChangeChatRequestTools=this._onDidChangeChatRequestTools.event,this._onDidDisposeChatSession=this._register(new x),this.onDidDisposeChatSession=this._onDidDisposeChatSession.event,this._proxy=e.getProxy(E.MainThreadChatAgents2),n.registerArgumentProcessor({processArgument:e=>KR(e)?null:e})}transferActiveChat(e){this._proxy.$transferActiveChatSession(e)}createChatAgent(t,n,r){let i=e._idPool++,a=new rz(t,n,this._proxy,i,r);return this._agents.set(i,a),this._proxy.$registerAgent(i,t.identifier,n,{},void 0),a.apiAgent}createDynamicChatAgent(t,n,r,i){let a=e._idPool++,o=new rz(t,n,this._proxy,a,i);return this._agents.set(a,o),this._proxy.$registerAgent(a,t.identifier,n,{isSticky:!0},r),o.apiAgent}registerChatParticipantDetectionProvider(t,n){let r=e._participantDetectionProviderIdPool++;return this._participantDetectionProviders.set(r,new tz(t,n)),this._proxy.$registerChatParticipantDetectionProvider(r),_(()=>{this._participantDetectionProviders.delete(r),this._proxy.$unregisterChatParticipantDetectionProvider(r)})}registerRelatedFilesProvider(t,n,r){let i=e._relatedFilesProviderIdPool++;return this._relatedFilesProviders.set(i,new nz(t,n)),this._proxy.$registerRelatedFilesProvider(i,r),_(()=>{this._relatedFilesProviders.delete(i),this._proxy.$unregisterRelatedFilesProvider(i)})}async $provideRelatedFiles(e,t,n){let r=this._relatedFilesProviders.get(e);if(!r)return Promise.resolve([]);let i=Tk.to(t);return await r.provider.provideRelatedFiles(i,n)??void 0}async $detectChatParticipant(e,t,n,r,i){let a=this._participantDetectionProviders.get(e);if(!a)return;let{request:o,location:s,history:c}=await this._createRequest(t,n,a.extension),l=await this.getModelForRequest(o,a.extension),u=wk.to(o,s,l,this.getDiagnosticsWhenEnabled(a.extension),this.getToolsForRequest(a.extension,o),a.extension,this._logService);return a.provider.provideParticipantDetection(u,{history:c},{participants:r.participants,location:Ek.to(r.location)},i)}async _createRequest(e,t,n){let r=Gu(e),i=await this.prepareHistoryTurns(n,r.agentId,t),a;if(r.locationData?.type===R_.Editor){let e=this._documents.getDocument(r.locationData.document);a=new dT(e,yD.to(r.locationData.selection),K.to(r.locationData.wholeRange))}else if(r.locationData?.type===R_.Notebook){let e=this._documents.getDocument(r.locationData.sessionInputUri);a=new fT(e)}return{request:r,location:a,history:i}}async getModelForRequest(e,t){let n;if(e.userSelectedModelId&&(n=await this._languageModels.getLanguageModelByIdentifier(t,e.userSelectedModelId)),!n&&(n=await this._languageModels.getDefaultLanguageModel(t),!n))throw Error(`Language model unavailable`);return n}async $setRequestPaused(e,t,n){let r=this._agents.get(e);if(!r)return;let i=pt.find(this._inFlightRequests,e=>e.requestId===t);i&&r.setChatRequestPauseState({request:i.extRequest,isPaused:n})}async $setRequestTools(e,t){let n=[...this._inFlightRequests].find(t=>t.requestId===e);if(n){n.extRequest.tools.clear();for(let[e,r]of this.getToolsForRequest(n.extension,t))n.extRequest.tools.set(e,r);this._onDidChangeChatRequestTools.fire(n.extRequest)}}async $invokeAgent(e,t,n,r){let i=this._agents.get(e);if(!i)throw Error(`[CHAT](${e}) CANNOT invoke agent because the agent is not registered`);let a,o;try{let{request:e,location:s,history:c}=await this._createRequest(t,n,i.extension),l=this._sessionDisposables.get(e.sessionId);l||(l=new v,this._sessionDisposables.set(e.sessionId,l)),a=new $R(i.extension,e,this._proxy,this._commands.converter,l);let u=await this.getModelForRequest(e,i.extension),d=wk.to(e,s,u,this.getDiagnosticsWhenEnabled(i.extension),this.getToolsForRequest(i.extension,e),i.extension,this._logService);o={requestId:t.requestId,extRequest:d,extension:i.extension},this._inFlightRequests.add(o);let f=i.invoke(d,{history:c},a.apiObject,r);return await iz(1e3,Promise.resolve(f).then(e=>{if(e?.metadata)try{JSON.stringify(e.metadata)}catch(t){let n=`result.metadata MUST be JSON.stringify-able. Got error: ${t.message}`;return this._logService.error(`[${i.extension.identifier.value}] [@${i.id}] ${n}`,i.extension),{errorDetails:{message:n},timings:a?.timings,nextQuestion:e.nextQuestion}}let t;return e?.errorDetails&&(t={...e.errorDetails,responseIsIncomplete:!0}),(t?.responseIsRedacted||t?.isQuotaExceeded||t?.confirmationButtons)&&U(i.extension,`chatParticipantPrivate`),{errorDetails:t,timings:a?.timings,metadata:e?.metadata,nextQuestion:e?.nextQuestion,details:e?.details}}),r)}catch(e){this._logService.error(e,i.extension),e instanceof DT&&e.cause&&(e=e.cause);let t=e instanceof Error&&e.name===`ChatQuotaExceeded`;return{errorDetails:{message:Em(e),responseIsIncomplete:!0,isQuotaExceeded:t}}}finally{o&&this._inFlightRequests.delete(o),a?.close()}}getDiagnosticsWhenEnabled(e){return Hg(e,`chatReferenceDiagnostic`)?this._diagnostics.getDiagnostics():[]}getToolsForRequest(e,t){if(!t.userSelectedTools)return new Map;let n=new Map;for(let r of this._tools.getTools(e))typeof t.userSelectedTools[r.name]==`boolean`&&n.set(r.name,t.userSelectedTools[r.name]);return n}async prepareHistoryTurns(e,t,n){let r=[];for(let i of n.history){let n=Ak.to(i.result),a=t===i.request.agentId?n:{...n,metadata:void 0},o=[],s=[];for(let t of i.request.variables.variables)if(t.kind===`tool`)s.push(Ok.to(t));else if(t.kind===`toolset`)s.push(...t.value.map(Ok.to));else{let n=Dk.to(t,this.getDiagnosticsWhenEnabled(e),this._logService);n&&o.push(n)}let c=Hg(e,`chatParticipantPrivate`)?i.request.editedFileEvents:void 0,l=new aT(i.request.message,i.request.command,o,i.request.agentId,s,c);r.push(l);let u=be(i.response.map(e=>Ck.toContent(e,this._commands.converter)));r.push(new oT(u,a,i.request.agentId,i.request.command))}return r}$releaseSession(e){this._sessionDisposables.deleteAndDispose(e),this._onDidDisposeChatSession.fire(e)}async $provideFollowups(e,t,n,r,i){let a=this._agents.get(t);if(!a)return Promise.resolve([]);let o=Gu(e),s=await this.prepareHistoryTurns(a.extension,a.id,r),c=Ak.to(n);return(await a.provideFollowups(c,{history:s},i)).filter(e=>{let t=!e.participant||pt.some(this._agents.values(),t=>t.id===e.participant&&ms.equals(t.extension.identifier,a.extension.identifier));return t||this._logService.warn(`[@${a.id}] ChatFollowup refers to an unknown participant: ${e.participant}`),t}).map(e=>XO.from(e,o))}$acceptFeedback(e,t,n){let r=this._agents.get(e);if(!r)return;let i=Ak.to(t),a;switch(n.direction){case XR.Down:a=Rw.Unhelpful;break;case XR.Up:a=Rw.Helpful;break}let o={result:i,kind:a,unhelpfulReason:Hg(r.extension,`chatParticipantAdditions`)?n.reason:void 0};r.acceptFeedback(Object.freeze(o))}$acceptAction(e,t,n){let r=this._agents.get(e);if(!r||n.action.kind===`vote`)return;let i=jk.to(t,n,this._commands.converter);i&&r.acceptAction(Object.freeze(i))}async $invokeCompletionProvider(e,t,n){let r=this._agents.get(e);if(!r)return[];let i=this._completionDisposables.get(e);i?i.clear():(i=new v,this._completionDisposables.set(e,i));let a=await r.invokeCompletionProvider(t,n);return a.map(e=>kk.from(e,this._commands.converter,i))}async $provideChatTitle(e,t,n){let r=this._agents.get(e);if(!r)return;let i=await this.prepareHistoryTurns(r.extension,r.id,{history:t});return await r.provideTitle({history:i},n)}async $provideChatSummary(e,t,n){let r=this._agents.get(e);if(!r)return;let i=await this.prepareHistoryTurns(r.extension,r.id,{history:t});return await r.provideSummary({history:i},n)}},tz=class{constructor(e,t){this.extension=e,this.provider=t}},nz=class{constructor(e,t){this.extension=e,this.provider=t}},rz=class{constructor(e,t,n,r,i){this.extension=e,this.id=t,this._proxy=n,this._handle=r,this._requestHandler=i,this._onDidReceiveFeedback=new x,this._onDidPerformAction=new x,this._pauseStateEmitter=new x}acceptFeedback(e){this._onDidReceiveFeedback.fire(e)}acceptAction(e){this._onDidPerformAction.fire(e)}setChatRequestPauseState(e){this._pauseStateEmitter.fire(e)}async invokeCompletionProvider(e,t){return this._agentVariableProvider?await this._agentVariableProvider.provider.provideCompletionItems(e,t)??[]:[]}async provideFollowups(e,t,n){if(!this._followupProvider)return[];let r=await this._followupProvider.provideFollowups(e,t,n);return r?r.filter(e=>!(e&&`commandId`in e)).filter(e=>!(e&&`message`in e)):[]}async provideTitle(e,t){if(this._titleProvider)return await this._titleProvider.provideChatTitle(e,t)??void 0}async provideSummary(e,t){if(this._summarizer)return await this._summarizer.provideChatSummary(e,t)??void 0}get apiAgent(){let e=!1,t=!1,n=()=>{e||t||(t=!0,queueMicrotask(()=>{this._proxy.$updateAgent(this._handle,{icon:this._iconPath?this._iconPath instanceof w?this._iconPath:`light`in this._iconPath?this._iconPath.light:void 0:void 0,iconDark:this._iconPath&&`dark`in this._iconPath?this._iconPath.dark:void 0,themeIcon:this._iconPath instanceof LS?this._iconPath:void 0,hasFollowups:this._followupProvider!==void 0,helpTextPrefix:!this._helpTextPrefix||typeof this._helpTextPrefix==`string`?this._helpTextPrefix:jD.from(this._helpTextPrefix),helpTextVariablesPrefix:!this._helpTextVariablesPrefix||typeof this._helpTextVariablesPrefix==`string`?this._helpTextVariablesPrefix:jD.from(this._helpTextVariablesPrefix),helpTextPostfix:!this._helpTextPostfix||typeof this._helpTextPostfix==`string`?this._helpTextPostfix:jD.from(this._helpTextPostfix),supportIssueReporting:this._supportIssueReporting,requester:this._requester,additionalWelcomeMessage:!this._additionalWelcomeMessage||typeof this._additionalWelcomeMessage==`string`?this._additionalWelcomeMessage:jD.from(this._additionalWelcomeMessage)}),t=!1}))},r=this;return{get id(){return r.id},get iconPath(){return r._iconPath},set iconPath(e){r._iconPath=e,n()},get requestHandler(){return r._requestHandler},set requestHandler(e){ot(typeof e==`function`,`Invalid request handler`),r._requestHandler=e},get followupProvider(){return r._followupProvider},set followupProvider(e){r._followupProvider=e,n()},get helpTextPrefix(){return U(r.extension,`defaultChatParticipant`),r._helpTextPrefix},set helpTextPrefix(e){U(r.extension,`defaultChatParticipant`),r._helpTextPrefix=e,n()},get helpTextVariablesPrefix(){return U(r.extension,`defaultChatParticipant`),r._helpTextVariablesPrefix},set helpTextVariablesPrefix(e){U(r.extension,`defaultChatParticipant`),r._helpTextVariablesPrefix=e,n()},get helpTextPostfix(){return U(r.extension,`defaultChatParticipant`),r._helpTextPostfix},set helpTextPostfix(e){U(r.extension,`defaultChatParticipant`),r._helpTextPostfix=e,n()},get supportIssueReporting(){return U(r.extension,`chatParticipantPrivate`),r._supportIssueReporting},set supportIssueReporting(e){U(r.extension,`chatParticipantPrivate`),r._supportIssueReporting=e,n()},get onDidReceiveFeedback(){return r._onDidReceiveFeedback.event},set participantVariableProvider(e){if(U(r.extension,`chatParticipantAdditions`),r._agentVariableProvider=e,e){if(!e.triggerCharacters.length)throw Error(`triggerCharacters are required`);r._proxy.$registerAgentCompletionsProvider(r._handle,r.id,e.triggerCharacters)}else r._proxy.$unregisterAgentCompletionsProvider(r._handle,r.id)},get participantVariableProvider(){return U(r.extension,`chatParticipantAdditions`),r._agentVariableProvider},set additionalWelcomeMessage(e){U(r.extension,`defaultChatParticipant`),r._additionalWelcomeMessage=e,n()},get additionalWelcomeMessage(){return U(r.extension,`defaultChatParticipant`),r._additionalWelcomeMessage},set titleProvider(e){U(r.extension,`defaultChatParticipant`),r._titleProvider=e,n()},get titleProvider(){return U(r.extension,`defaultChatParticipant`),r._titleProvider},set summarizer(e){U(r.extension,`defaultChatParticipant`),r._summarizer=e},get summarizer(){return U(r.extension,`defaultChatParticipant`),r._summarizer},get onDidChangePauseState(){return U(r.extension,`chatParticipantAdditions`),r._pauseStateEmitter.event},onDidPerformAction:Hg(this.extension,`chatParticipantAdditions`)?this._onDidPerformAction.event:void 0,set requester(e){r._requester=e,n()},get requester(){return r._requester},dispose(){e=!0,r._followupProvider=void 0,r._onDidReceiveFeedback.dispose(),r._proxy.$unregisterAgent(r._handle)}}}invoke(e,t,n,r){return this._requestHandler(e,t,n,r)}};function iz(e,t,n){return new Promise((r,i)=>{let a=n.onCancellationRequested(async()=>{a.dispose(),await xo(e),r(void 0)});t.then(r,i).finally(()=>a.dispose())})}var az=class{constructor(e){this._items=new Map,this._proxy=e.getProxy(E.MainThreadChatStatus)}createChatStatusItem(e,t){let n=oz(e.identifier,t);if(this._items.has(n))throw Error(`Chat status item '${t}' already exists`);let r={id:n,title:``,description:``,detail:``},i=!1,a=!1,o=()=>{if(i)throw Error(`Chat status item is disposed`);a&&this._proxy.$setEntry(t,r)},s=Object.freeze({id:t,get title(){return r.title},set title(e){r.title=e,o()},get description(){return r.description},set description(e){r.description=e,o()},get detail(){return r.detail},set detail(e){r.detail=e,o()},show:()=>{a=!0,o()},hide:()=>{a=!1,this._proxy.$disposeEntry(t)},dispose:()=>{i=!0,this._proxy.$disposeEntry(t),this._items.delete(n)}});return this._items.set(n,s),s}};function oz(e,t){return`${ms.toKey(e)}.${t}`}var sz=class{constructor(e){let t=e.getProxy(E.MainThreadClipboard);this.value=Object.freeze({readText(){return t.$readText()},writeText(e){return t.$writeText(e)}})}};const cz=`vscode-cdn.net`,lz=`vscode-resource.${cz}`,uz=`'self' https://*.${cz}`;function dz(e,t){return e.scheme===O.http||e.scheme===O.https?e:(t&&t.authority&&t.isRemote&&e.scheme===O.file&&(e=w.from({scheme:O.vscodeRemote,authority:t.authority,path:e.path})),w.from({scheme:O.https,authority:`${e.scheme}+${fz(e.authority)}.${lz}`,path:e.path,fragment:e.fragment,query:e.query}))}function fz(e){return e.replace(/./g,e=>{let t=e.charCodeAt(0);return t>=S.a&&t<=S.z||t>=S.A&&t<=S.Z||t>=S.Digit0&&t<=S.Digit9?e:`-`+t.toString(16).padStart(4,`0`)})}var pz=class{constructor(e,t,n){this._proxy=e,this._editors=t,this._remoteInfo=n,this._handlePool=0,this._disposables=new v,this._insets=new Map,this._disposables.add(t.onDidChangeVisibleTextEditors(()=>{let e=t.getVisibleTextEditors();for(let t of this._insets.values())e.indexOf(t.editor)<0&&t.inset.dispose()}))}dispose(){this._insets.forEach(e=>e.inset.dispose()),this._disposables.dispose()}createWebviewEditorInset(e,t,n,r,i){let a;for(let t of this._editors.getVisibleTextEditors(!0))if(t.value===e){a=t;break}if(!a)throw Error(`not a visible editor`);let o=this,s=this._handlePool++,c=new x,l=new x,u=new class{constructor(){this._html=``,this._options=Object.create(null)}asWebviewUri(e){return dz(e,o._remoteInfo)}get cspSource(){return uz}set options(e){this._options=e,o._proxy.$setOptions(s,e)}get options(){return this._options}set html(e){this._html=e,o._proxy.$setHtml(s,e)}get html(){return this._html}get onDidReceiveMessage(){return c.event}postMessage(e){return o._proxy.$postMessage(s,e)}},d=new class{constructor(){this.editor=e,this.line=t,this.height=n,this.webview=u,this.onDidDispose=l.event}dispose(){o._insets.has(s)&&(o._insets.delete(s),o._proxy.$disposeEditorInset(s),l.fire(),l.dispose(),c.dispose())}};return this._proxy.$createEditorInset(s,a.id,a.value.document.uri,t+1,n,r||{},i.identifier,i.extensionLocation),this._insets.set(s,{editor:e,inset:d,onDidReceiveMessage:c}),d}$onDidDispose(e){let t=this._insets.get(e);t&&t.inset.dispose()}$onDidReceiveMessage(e,t){let n=this._insets.get(e);n?.onDidReceiveMessage.fire(t)}},mz=class e{static{this._providerHandlePool=0}constructor(e){this.providers=new Map,this._proxy=e.getProxy(E.MainThreadCodeMapper)}async $mapCode(e,t,n){let r=this.providers.get(e);if(!r)throw Error(`Received request to map code for unknown provider handle ${e}`);let i={textEdit:(e,n)=>{n=De(n),this._proxy.$handleProgress(t.requestId,{uri:e,edits:n.map(RD.from)})},notebookEdit:(e,n)=>{n=De(n),this._proxy.$handleProgress(t.requestId,{uri:e,edits:n.map(yk.from)})}},a={location:t.location,chatRequestId:t.chatRequestId,chatRequestModel:t.chatRequestModel,chatSessionId:t.chatSessionId,codeBlocks:t.codeBlocks.map(e=>({code:e.code,resource:w.revive(e.resource),markdownBeforeBlock:e.markdownBeforeBlock}))},o=await r.provideMappedEdits(a,i,n);return o??null}registerMappedEditsProvider(t,n){let r=e._providerHandlePool++;return this._proxy.$registerCodeMapperProvider(r,t.displayName??t.name),this.providers.set(r,n),{dispose:()=>this._proxy.$unregisterCodeMapperProvider(r)}}};function hz(e,t,n){let r=e.getProxy(E.MainThreadComments);class i{static{this.handlePool=0}constructor(){this._commentControllers=new Map,this._commentControllersByExtension=new gs,t.registerArgumentProcessor({processArgument:e=>{if(e&&e.$mid===Dn.CommentController){let t=this._commentControllers.get(e.handle);return t?t.value:e}else if(e&&e.$mid===Dn.CommentThread){let t=e,n=this._commentControllers.get(t.commentControlHandle);if(!n)return t;let r=n.getCommentThread(t.commentThreadHandle);return r?r.value:t}else if(e&&(e.$mid===Dn.CommentThreadReply||e.$mid===Dn.CommentThreadInstance)){let t=this._commentControllers.get(e.thread.commentControlHandle);if(!t)return e;let n=t.getCommentThread(e.thread.commentThreadHandle);return n?e.$mid===Dn.CommentThreadInstance?n.value:{thread:n.value,text:e.text}:e}else if(e&&e.$mid===Dn.CommentNode){let t=this._commentControllers.get(e.thread.commentControlHandle);if(!t)return e;let n=t.getCommentThread(e.thread.commentThreadHandle);if(!n)return e;let r=e.commentUniqueId,i=n.getCommentByUniqueId(r);return i||e}else if(e&&e.$mid===Dn.CommentThreadNode){let t=this._commentControllers.get(e.thread.commentControlHandle);if(!t)return e;let n=t.getCommentThread(e.thread.commentThreadHandle);if(!n)return e;let r=e.text,i=e.commentUniqueId,a=n.getCommentByUniqueId(i);return a?(typeof a.body==`string`?a.body=r:a.body=new Sx(r),a):e}return e}})}createCommentController(e,t,n){let r=i.handlePool++,a=new o(e,r,t,n);this._commentControllers.set(a.handle,a);let s=this._commentControllersByExtension.get(e.identifier)||[];return s.push(a),this._commentControllersByExtension.set(e.identifier,s),a.value}async $createCommentThreadTemplate(e,t,n,r){let i=this._commentControllers.get(e);i&&i.$createCommentThreadTemplate(t,n,r)}async $setActiveComment(e,t){let n=this._commentControllers.get(e);n&&n.$setActiveComment(t??void 0)}async $updateCommentThreadTemplate(e,t,n){let r=this._commentControllers.get(e);r&&r.$updateCommentThreadTemplate(t,n)}$deleteCommentThread(e,t){let n=this._commentControllers.get(e);n?.$deleteCommentThread(t)}async $updateCommentThread(e,t,n){let r=this._commentControllers.get(e);r?.$updateCommentThread(t,n)}async $provideCommentingRanges(e,t,r){let i=this._commentControllers.get(e);if(!i||!i.commentingRangeProvider)return Promise.resolve(void 0);let a=await n.ensureDocumentData(w.revive(t));return uo(async()=>{let e=await i.commentingRangeProvider?.provideCommentingRanges(a.document,r),t;return t=Array.isArray(e)?{ranges:e,fileComments:!1}:e?{ranges:e.ranges||[],fileComments:e.enableFileComments||!1}:e??void 0,t}).then(e=>{let t;return e&&(t={ranges:e.ranges.map(e=>K.from(e)),fileComments:e.fileComments}),t})}$toggleReaction(e,t,n,r,i){let a=this._commentControllers.get(e);return!a||!a.reactionHandler?Promise.resolve(void 0):uo(()=>{let e=a.getCommentThread(t);if(e){let t=e.getCommentByUniqueId(r.uniqueIdInThread);if(a!==void 0&&t&&a.reactionHandler)return a.reactionHandler(t,l(i))}return Promise.resolve(void 0)})}}class a{static{this._handlePool=0}set threadId(e){this._id=e}get threadId(){return this._id}get id(){return this._id}get resource(){return this._uri}get uri(){return this._uri}set range(e){(e===void 0!=(this._range===void 0)||!e||!this._range||!e.isEqual(this._range))&&(this._range=e,this.modifications.range=e,this._onDidUpdateCommentThread.fire())}get range(){return this._range}set canReply(e){this._canReply!==e&&(this._canReply=e,this.modifications.canReply=e,this._onDidUpdateCommentThread.fire())}get canReply(){return this._canReply}get label(){return this._label}set label(e){this._label=e,this.modifications.label=e,this._onDidUpdateCommentThread.fire()}get contextValue(){return this._contextValue}set contextValue(e){this._contextValue=e,this.modifications.contextValue=e,this._onDidUpdateCommentThread.fire()}get comments(){return this._comments}set comments(e){this._comments=e,this.modifications.comments=e,this._onDidUpdateCommentThread.fire()}get collapsibleState(){return this._collapseState}set collapsibleState(e){this._collapseState!==e&&(this._collapseState=e,this.modifications.collapsibleState=e,this._onDidUpdateCommentThread.fire())}get state(){return this._state}set state(e){this._state=e,typeof e==`object`?(U(this.extensionDescription,`commentThreadApplicability`),this.modifications.state=e.resolved,this.modifications.applicability=e.applicability):this.modifications.state=e,this._onDidUpdateCommentThread.fire()}get isDisposed(){return this._isDiposed}constructor(e,t,n,i,o,c,l,u,d){this._commentControllerHandle=t,this._id=n,this._uri=i,this._range=o,this._comments=c,this.extensionDescription=l,this._isTemplate=u,this.handle=a._handlePool++,this.commentHandle=0,this.modifications=Object.create(null),this._onDidUpdateCommentThread=new x,this.onDidUpdateCommentThread=this._onDidUpdateCommentThread.event,this._canReply=!0,this._commentsMap=new Map,this._acceptInputDisposables=new xt,this._acceptInputDisposables.value=new v,this._id===void 0&&(this._id=`${e}.${this.handle}`),r.$createCommentThread(t,this.handle,this._id,this._uri,K.from(this._range),this._comments.map(e=>s(this,e,this._commentsMap,this.extensionDescription)),l.identifier,this._isTemplate,d),this._localDisposables=[],this._isDiposed=!1,this._localDisposables.push(this.onDidUpdateCommentThread(()=>{this.eventuallyUpdateCommentThread()})),this._localDisposables.push({dispose:()=>{r.$deleteCommentThread(t,this.handle)}});let f=this;this.value={get uri(){return f.uri},get range(){return f.range},set range(e){f.range=e},get comments(){return f.comments},set comments(e){f.comments=e},get collapsibleState(){return f.collapsibleState},set collapsibleState(e){f.collapsibleState=e},get canReply(){return f.canReply},set canReply(e){f.canReply=e},get contextValue(){return f.contextValue},set contextValue(e){f.contextValue=e},get label(){return f.label},set label(e){f.label=e},get state(){return f.state},set state(e){f.state=e},reveal:(e,t)=>f.reveal(e,t),hide:()=>f.hide(),dispose:()=>{f.dispose()}}}updateIsTemplate(){this._isTemplate&&(this._isTemplate=!1,this.modifications.isTemplate=!1)}eventuallyUpdateCommentThread(){if(this._isDiposed)return;this.updateIsTemplate(),this._acceptInputDisposables.value||(this._acceptInputDisposables.value=new v);let e=e=>Object.prototype.hasOwnProperty.call(this.modifications,e),t={};e(`range`)&&(t.range=K.from(this._range)),e(`label`)&&(t.label=this.label),e(`contextValue`)&&(t.contextValue=this.contextValue??null),e(`comments`)&&(t.comments=this._comments.map(e=>s(this,e,this._commentsMap,this.extensionDescription))),e(`collapsibleState`)&&(t.collapseState=u(this._collapseState)),e(`canReply`)&&(t.canReply=this.canReply),e(`state`)&&(t.state=d(this._state)),e(`applicability`)&&(t.applicability=f(this._state)),e(`isTemplate`)&&(t.isTemplate=this._isTemplate),this.modifications={},r.$updateCommentThread(this._commentControllerHandle,this.handle,this._id,this._uri,t)}getCommentByUniqueId(e){for(let t of this._commentsMap){let n=t[0],r=t[1];if(e===r)return n}}async reveal(e,t){U(this.extensionDescription,`commentReveal`);let n;e&&e.body!==void 0?n=e:t??=e;let i=n?this._commentsMap.get(n):void 0;i??=this._commentsMap.get(this._comments[0]);let a=!0,o=!1;return t?.focus===vC.Reply?(o=!0,a=!1):t?.focus===vC.Comment&&(a=!1),r.$revealCommentThread(this._commentControllerHandle,this.handle,i,{preserveFocus:a,focusReply:o})}async hide(){return r.$hideCommentThread(this._commentControllerHandle,this.handle)}dispose(){this._isDiposed=!0,this._acceptInputDisposables.dispose(),this._localDisposables.forEach(e=>e.dispose())}}class o{get id(){return this._id}get label(){return this._label}get handle(){return this._handle}get commentingRangeProvider(){return this._commentingRangeProvider}set commentingRangeProvider(e){this._commentingRangeProvider=e,e?.resourceHints&&U(this._extension,`commentingRangeHint`),r.$updateCommentingRanges(this.handle,e?.resourceHints)}get reactionHandler(){return this._reactionHandler}set reactionHandler(e){this._reactionHandler=e,r.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!e})}get options(){return this._options}set options(e){this._options=e,r.$updateCommentControllerFeatures(this.handle,{options:this._options})}get activeComment(){return U(this._extension,`activeComment`),this._activeComment}get activeCommentThread(){return U(this._extension,`activeComment`),this._activeThread?.value}constructor(e,t,n,i){this._extension=e,this._handle=t,this._id=n,this._label=i,this._threads=new Map,r.$registerCommentController(this.handle,n,i,this._extension.identifier.value);let a=this;this.value=Object.freeze({id:a.id,label:a.label,get options(){return a.options},set options(e){a.options=e},get commentingRangeProvider(){return a.commentingRangeProvider},set commentingRangeProvider(e){a.commentingRangeProvider=e},get reactionHandler(){return a.reactionHandler},set reactionHandler(e){a.reactionHandler=e},get activeCommentThread(){return a.activeCommentThread},createCommentThread(e,t,n){return a.createCommentThread(e,t,n).value},dispose:()=>{a.dispose()}}),this._localDisposables=[],this._localDisposables.push({dispose:()=>{r.$unregisterCommentController(this.handle)}})}createCommentThread(e,t,n){let r=new a(this.id,this.handle,void 0,e,t,n,this._extension,!1);return this._threads.set(r.handle,r),r}$setActiveComment(e){if(!e){this._activeComment=void 0,this._activeThread=void 0;return}let t=this._threads.get(e.commentThreadHandle);t&&(this._activeComment=e.uniqueIdInThread?t.getCommentByUniqueId(e.uniqueIdInThread):void 0,this._activeThread=t)}$createCommentThreadTemplate(e,t,n){let r=new a(this.id,this.handle,void 0,w.revive(e),K.to(t),[],this._extension,!0,n);return r.collapsibleState=Kp.Expanded,this._threads.set(r.handle,r),r}$updateCommentThreadTemplate(e,t){let n=this._threads.get(e);n&&(n.range=K.to(t))}$updateCommentThread(e,t){let n=this._threads.get(e);if(!n)return;let r=e=>Object.prototype.hasOwnProperty.call(t,e);r(`collapseState`)&&(n.collapsibleState=u(t.collapseState))}$deleteCommentThread(e){let t=this._threads.get(e);t?.dispose(),this._threads.delete(e)}getCommentThread(e){return this._threads.get(e)}dispose(){this._threads.forEach(e=>{e.dispose()}),this._localDisposables.forEach(e=>e.dispose())}}function s(e,t,n,r){let i=n.get(t);return i||(i=++e.commentHandle,n.set(t,i)),t.state!==void 0&&U(r,`commentsDraftState`),t.reactions?.some(e=>e.reactors!==void 0)&&U(r,`commentReactor`),{mode:t.mode,contextValue:t.contextValue,uniqueIdInThread:i,body:typeof t.body==`string`?t.body:jD.from(t.body),userName:t.author.name,userIconPath:t.author.iconPath,label:t.label,commentReactions:t.reactions?t.reactions.map(e=>c(e)):void 0,state:t.state,timestamp:t.timestamp?.toJSON()}}function c(e){return{label:e.label,iconPath:e.iconPath?ND(e.iconPath):void 0,count:e.count,hasReacted:e.authorHasReacted,reactors:e.reactors&&e.reactors.length>0&&typeof e.reactors[0]!=`string`?e.reactors.map(e=>e.name):e.reactors}}function l(e){return{label:e.label||``,count:e.count||0,iconPath:e.iconPath?w.revive(e.iconPath):``,authorHasReacted:e.hasReacted||!1,reactors:e.reactors?.map(e=>({name:e}))}}function u(e){if(e!==void 0)switch(e){case pC.Expanded:return Kp.Expanded;case pC.Collapsed:return Kp.Collapsed}return Kp.Collapsed}function d(e){let t;if(t=typeof e==`object`?e.resolved:e,t!==void 0)switch(t){case gC.Unresolved:return qp.Unresolved;case gC.Resolved:return qp.Resolved}return qp.Unresolved}function f(e){let t;if(typeof e==`object`&&(t=e.applicability),t!==void 0)switch(t){case _C.Current:return Jp.Current;case _C.Outdated:return Jp.Outdated}return Jp.Current}return new i}var gz={exports:{}},_z;function vz(){return _z?gz.exports:(_z=1,(function(e,exports){exports=e.exports=g;var n;n=typeof process==`object`&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift(`SEMVER`),console.log.apply(console,e)}:function(){},exports.SEMVER_SPEC_VERSION=`2.0.0`;var r=256,i=2**53-1||9007199254740991,a=16,o=exports.re=[],s=exports.src=[],c=0,l=c++;s[l]=`0|[1-9]\\d*`;var u=c++;s[u]=`[0-9]+`;var d=c++;s[d]=`\\d*[a-zA-Z-][a-zA-Z0-9-]*`;var f=c++;s[f]=`(`+s[l]+`)\\.(`+s[l]+`)\\.(`+s[l]+`)`;var p=c++;s[p]=`(`+s[u]+`)\\.(`+s[u]+`)\\.(`+s[u]+`)`;var ee=c++;s[ee]=`(?:`+s[l]+`|`+s[d]+`)`;var m=c++;s[m]=`(?:`+s[u]+`|`+s[d]+`)`;var te=c++;s[te]=`(?:-(`+s[ee]+`(?:\\.`+s[ee]+`)*))`;var ne=c++;s[ne]=`(?:-?(`+s[m]+`(?:\\.`+s[m]+`)*))`;var re=c++;s[re]=`[0-9A-Za-z-]+`;var ie=c++;s[ie]=`(?:\\+(`+s[re]+`(?:\\.`+s[re]+`)*))`;var ae=c++,oe=`v?`+s[f]+s[te]+`?`+s[ie]+`?`;s[ae]=`^`+oe+`$`;var se=`[v=\\s]*`+s[p]+s[ne]+`?`+s[ie]+`?`,ce=c++;s[ce]=`^`+se+`$`;var h=c++;s[h]=`((?:<|>)?=?)`;var le=c++;s[le]=s[u]+`|x|X|\\*`;var ue=c++;s[ue]=s[l]+`|x|X|\\*`;var de=c++;s[de]=`[v=\\s]*(`+s[ue]+`)(?:\\.(`+s[ue]+`)(?:\\.(`+s[ue]+`)(?:`+s[te]+`)?`+s[ie]+`?)?)?`;var fe=c++;s[fe]=`[v=\\s]*(`+s[le]+`)(?:\\.(`+s[le]+`)(?:\\.(`+s[le]+`)(?:`+s[ne]+`)?`+s[ie]+`?)?)?`;var pe=c++;s[pe]=`^`+s[h]+`\\s*`+s[de]+`$`;var me=c++;s[me]=`^`+s[h]+`\\s*`+s[fe]+`$`;var he=c++;s[he]=`(?:^|[^\\d])(\\d{1,`+a+`})(?:\\.(\\d{1,`+a+`}))?(?:\\.(\\d{1,`+a+`}))?(?:$|[^\\d])`;var ge=c++;s[ge]=`(?:~>?)`;var _e=c++;s[_e]=`(\\s*)`+s[ge]+`\\s+`,o[_e]=new RegExp(s[_e],`g`);var ve=`$1~`,ye=c++;s[ye]=`^`+s[ge]+s[de]+`$`;var be=c++;s[be]=`^`+s[ge]+s[fe]+`$`;var xe=c++;s[xe]=`(?:\\^)`;var Se=c++;s[Se]=`(\\s*)`+s[xe]+`\\s+`,o[Se]=new RegExp(s[Se],`g`);var Ce=`$1^`,we=c++;s[we]=`^`+s[xe]+s[de]+`$`;var Te=c++;s[Te]=`^`+s[xe]+s[fe]+`$`;var Ee=c++;s[Ee]=`^`+s[h]+`\\s*(`+se+`)$|^$`;var De=c++;s[De]=`^`+s[h]+`\\s*(`+oe+`)$|^$`;var Oe=c++;s[Oe]=`(\\s*)`+s[h]+`\\s*(`+se+`|`+s[de]+`)`,o[Oe]=new RegExp(s[Oe],`g`);var ke=`$1$2$3`,Ae=c++;s[Ae]=`^\\s*(`+s[de]+`)\\s+-\\s+(`+s[de]+`)\\s*$`;var je=c++;s[je]=`^\\s*(`+s[fe]+`)\\s+-\\s+(`+s[fe]+`)\\s*$`;var Me=c++;s[Me]=`(<|>)?=?\\s*\\*`;for(var Ne=0;Ne<c;Ne++)n(Ne,s[Ne]),o[Ne]||(o[Ne]=new RegExp(s[Ne]));exports.parse=Pe;function Pe(e,t){if(e instanceof g)return e;if(typeof e!=`string`||e.length>r)return null;var n=t?o[ce]:o[ae];if(!n.test(e))return null;try{return new g(e,t)}catch{return null}}exports.valid=Fe;function Fe(e,t){var n=Pe(e,t);return n?n.version:null}exports.clean=Ie;function Ie(e,t){var n=Pe(e.trim().replace(/^[=v]+/,``),t);return n?n.version:null}exports.SemVer=g;function g(e,t){if(e instanceof g){if(e.loose===t)return e;e=e.version}else if(typeof e!=`string`)throw TypeError(`Invalid Version: `+e);if(e.length>r)throw TypeError(`version is longer than `+r+` characters`);if(!(this instanceof g))return new g(e,t);n(`SemVer`,e,t),this.loose=t;var a=e.trim().match(t?o[ce]:o[ae]);if(!a)throw TypeError(`Invalid Version: `+e);if(this.raw=e,this.major=+a[1],this.minor=+a[2],this.patch=+a[3],this.major>i||this.major<0)throw TypeError(`Invalid major version`);if(this.minor>i||this.minor<0)throw TypeError(`Invalid minor version`);if(this.patch>i||this.patch<0)throw TypeError(`Invalid patch version`);a[4]?this.prerelease=a[4].split(`.`).map(function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<i)return t}return e}):this.prerelease=[],this.build=a[5]?a[5].split(`.`):[],this.format()}g.prototype.format=function(){return this.version=this.major+`.`+this.minor+`.`+this.patch,this.prerelease.length&&(this.version+=`-`+this.prerelease.join(`.`)),this.version},g.prototype.toString=function(){return this.version},g.prototype.compare=function(e){return n(`SemVer.compare`,this.version,this.loose,e),e instanceof g||(e=new g(e,this.loose)),this.compareMain(e)||this.comparePre(e)},g.prototype.compareMain=function(e){return e instanceof g||(e=new g(e,this.loose)),Be(this.major,e.major)||Be(this.minor,e.minor)||Be(this.patch,e.patch)},g.prototype.comparePre=function(e){if(e instanceof g||(e=new g(e,this.loose)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],i=e.prerelease[t];if(n(`prerelease compare`,t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Be(r,i)}while(++t)},g.prototype.inc=function(e,t){switch(e){case`premajor`:this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc(`pre`,t);break;case`preminor`:this.prerelease.length=0,this.patch=0,this.minor++,this.inc(`pre`,t);break;case`prepatch`:this.prerelease.length=0,this.inc(`patch`,t),this.inc(`pre`,t);break;case`prerelease`:this.prerelease.length===0&&this.inc(`patch`,t),this.inc(`pre`,t);break;case`major`:(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case`minor`:(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case`patch`:this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case`pre`:if(this.prerelease.length===0)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)typeof this.prerelease[n]==`number`&&(this.prerelease[n]++,n=-2);n===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw Error(`invalid increment argument: `+e)}return this.format(),this.raw=this.version,this},exports.inc=Le;function Le(e,t,n,r){typeof n==`string`&&(r=n,n=void 0);try{return new g(e,n).inc(t,r).version}catch{return null}}exports.diff=Re;function Re(e,t){if(Qe(e,t))return null;var n=Pe(e),r=Pe(t);if(n.prerelease.length||r.prerelease.length){for(var i in n)if((i===`major`||i===`minor`||i===`patch`)&&n[i]!==r[i])return`pre`+i;return`prerelease`}for(var i in n)if((i===`major`||i===`minor`||i===`patch`)&&n[i]!==r[i])return i}exports.compareIdentifiers=Be;var ze=/^[0-9]+$/;function Be(e,t){var n=ze.test(e),r=ze.test(t);return n&&r&&(e=+e,t=+t),n&&!r?-1:r&&!n?1:e<t?-1:e>t?1:0}exports.rcompareIdentifiers=Ve;function Ve(e,t){return Be(t,e)}exports.major=He;function He(e,t){return new g(e,t).major}exports.minor=Ue;function Ue(e,t){return new g(e,t).minor}exports.patch=We;function We(e,t){return new g(e,t).patch}exports.compare=Ge;function Ge(e,t,n){return new g(e,n).compare(new g(t,n))}exports.compareLoose=Ke;function Ke(e,t){return Ge(e,t,!0)}exports.rcompare=qe;function qe(e,t,n){return Ge(t,e,n)}exports.sort=Je;function Je(e,n){return e.sort(function(e,r){return exports.compare(e,r,n)})}exports.rsort=Ye;function Ye(e,n){return e.sort(function(e,r){return exports.rcompare(e,r,n)})}exports.gt=Xe;function Xe(e,t,n){return Ge(e,t,n)>0}exports.lt=Ze;function Ze(e,t,n){return Ge(e,t,n)<0}exports.eq=Qe;function Qe(e,t,n){return Ge(e,t,n)===0}exports.neq=$e;function $e(e,t,n){return Ge(e,t,n)!==0}exports.gte=et;function et(e,t,n){return Ge(e,t,n)>=0}exports.lte=tt;function tt(e,t,n){return Ge(e,t,n)<=0}exports.cmp=nt;function nt(e,t,n,r){var i;switch(t){case`===`:typeof e==`object`&&(e=e.version),typeof n==`object`&&(n=n.version),i=e===n;break;case`!==`:typeof e==`object`&&(e=e.version),typeof n==`object`&&(n=n.version),i=e!==n;break;case``:case`=`:case`==`:i=Qe(e,n,r);break;case`!=`:i=$e(e,n,r);break;case`>`:i=Xe(e,n,r);break;case`>=`:i=et(e,n,r);break;case`<`:i=Ze(e,n,r);break;case`<=`:i=tt(e,n,r);break;default:throw TypeError(`Invalid operator: `+t)}return i}exports.Comparator=rt;function rt(e,t){if(e instanceof rt){if(e.loose===t)return e;e=e.value}if(!(this instanceof rt))return new rt(e,t);n(`comparator`,e,t),this.loose=t,this.parse(e),this.semver===it?this.value=``:this.value=this.operator+this.semver.version,n(`comp`,this)}var it={};rt.prototype.parse=function(e){var t=this.loose?o[Ee]:o[De],n=e.match(t);if(!n)throw TypeError(`Invalid comparator: `+e);this.operator=n[1],this.operator===`=`&&(this.operator=``),n[2]?this.semver=new g(n[2],this.loose):this.semver=it},rt.prototype.toString=function(){return this.value},rt.prototype.test=function(e){return n(`Comparator.test`,e,this.loose),this.semver===it?!0:(typeof e==`string`&&(e=new g(e,this.loose)),nt(e,this.operator,this.semver,this.loose))},rt.prototype.intersects=function(e,t){if(!(e instanceof rt))throw TypeError(`a Comparator is required`);var n;if(this.operator===``)return n=new at(e.value,t),vt(this.value,n,t);if(e.operator===``)return n=new at(this.value,t),vt(e.semver,n,t);var r=(this.operator===`>=`||this.operator===`>`)&&(e.operator===`>=`||e.operator===`>`),i=(this.operator===`<=`||this.operator===`<`)&&(e.operator===`<=`||e.operator===`<`),a=this.semver.version===e.semver.version,o=(this.operator===`>=`||this.operator===`<=`)&&(e.operator===`>=`||e.operator===`<=`),s=nt(this.semver,`<`,e.semver,t)&&(this.operator===`>=`||this.operator===`>`)&&(e.operator===`<=`||e.operator===`<`),c=nt(this.semver,`>`,e.semver,t)&&(this.operator===`<=`||this.operator===`<`)&&(e.operator===`>=`||e.operator===`>`);return r||i||a&&o||s||c},exports.Range=at;function at(e,t){if(e instanceof at)return e.loose===t?e:new at(e.raw,t);if(e instanceof rt)return new at(e.value,t);if(!(this instanceof at))return new at(e,t);if(this.loose=t,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw TypeError(`Invalid SemVer Range: `+e);this.format()}at.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(` `).trim()}).join(`||`).trim(),this.range},at.prototype.toString=function(){return this.range},at.prototype.parseRange=function(e){var t=this.loose;e=e.trim(),n(`range`,e,t);var r=t?o[je]:o[Ae];e=e.replace(r,gt),n(`hyphen replace`,e),e=e.replace(o[Oe],ke),n(`comparator trim`,e,o[Oe]),e=e.replace(o[_e],ve),e=e.replace(o[Se],Ce),e=e.split(/\s+/).join(` `);var i=t?o[Ee]:o[De],a=e.split(` `).map(function(e){return st(e,t)}).join(` `).split(/\s+/);return this.loose&&(a=a.filter(function(e){return!!e.match(i)})),a=a.map(function(e){return new rt(e,t)}),a},at.prototype.intersects=function(e,t){if(!(e instanceof at))throw TypeError(`a Range is required`);return this.set.some(function(n){return n.every(function(n){return e.set.some(function(e){return e.every(function(e){return n.intersects(e,t)})})})})},exports.toComparators=ot;function ot(e,t){return new at(e,t).set.map(function(e){return e.map(function(e){return e.value}).join(` `).trim().split(` `)})}function st(e,t){return n(`comp`,e),e=dt(e,t),n(`caret`,e),e=lt(e,t),n(`tildes`,e),e=pt(e,t),n(`xrange`,e),e=ht(e,t),n(`stars`,e),e}function ct(e){return!e||e.toLowerCase()===`x`||e===`*`}function lt(e,t){return e.trim().split(/\s+/).map(function(e){return ut(e,t)}).join(` `)}function ut(e,t){var r=t?o[be]:o[ye];return e.replace(r,function(t,r,i,a,o){n(`tilde`,e,t,r,i,a,o);var s;return ct(r)?s=``:ct(i)?s=`>=`+r+`.0.0 <`+(+r+1)+`.0.0`:ct(a)?s=`>=`+r+`.`+i+`.0 <`+r+`.`+(+i+1)+`.0`:o?(n(`replaceTilde pr`,o),o.charAt(0)!==`-`&&(o=`-`+o),s=`>=`+r+`.`+i+`.`+a+o+` <`+r+`.`+(+i+1)+`.0`):s=`>=`+r+`.`+i+`.`+a+` <`+r+`.`+(+i+1)+`.0`,n(`tilde return`,s),s})}function dt(e,t){return e.trim().split(/\s+/).map(function(e){return ft(e,t)}).join(` `)}function ft(e,t){n(`caret`,e,t);var r=t?o[Te]:o[we];return e.replace(r,function(t,r,i,a,o){n(`caret`,e,t,r,i,a,o);var s;return ct(r)?s=``:ct(i)?s=`>=`+r+`.0.0 <`+(+r+1)+`.0.0`:ct(a)?s=r===`0`?`>=`+r+`.`+i+`.0 <`+r+`.`+(+i+1)+`.0`:`>=`+r+`.`+i+`.0 <`+(+r+1)+`.0.0`:o?(n(`replaceCaret pr`,o),o.charAt(0)!==`-`&&(o=`-`+o),s=r===`0`?i===`0`?`>=`+r+`.`+i+`.`+a+o+` <`+r+`.`+i+`.`+(+a+1):`>=`+r+`.`+i+`.`+a+o+` <`+r+`.`+(+i+1)+`.0`:`>=`+r+`.`+i+`.`+a+o+` <`+(+r+1)+`.0.0`):(n(`no pr`),s=r===`0`?i===`0`?`>=`+r+`.`+i+`.`+a+` <`+r+`.`+i+`.`+(+a+1):`>=`+r+`.`+i+`.`+a+` <`+r+`.`+(+i+1)+`.0`:`>=`+r+`.`+i+`.`+a+` <`+(+r+1)+`.0.0`),n(`caret return`,s),s})}function pt(e,t){return n(`replaceXRanges`,e,t),e.split(/\s+/).map(function(e){return mt(e,t)}).join(` `)}function mt(e,t){e=e.trim();var r=t?o[me]:o[pe];return e.replace(r,function(t,r,i,a,o,s){n(`xRange`,e,t,r,i,a,o,s);var c=ct(i),l=c||ct(a),u=l||ct(o),d=u;return r===`=`&&d&&(r=``),c?t=r===`>`||r===`<`?`<0.0.0`:`*`:r&&d?(l&&(a=0),u&&(o=0),r===`>`?(r=`>=`,l?(i=+i+1,a=0,o=0):u&&(a=+a+1,o=0)):r===`<=`&&(r=`<`,l?i=+i+1:a=+a+1),t=r+i+`.`+a+`.`+o):l?t=`>=`+i+`.0.0 <`+(+i+1)+`.0.0`:u&&(t=`>=`+i+`.`+a+`.0 <`+i+`.`+(+a+1)+`.0`),n(`xRange return`,t),t})}function ht(e,t){return n(`replaceStars`,e,t),e.trim().replace(o[Me],``)}function gt(e,t,n,r,i,a,o,s,c,l,u,d,f){return t=ct(n)?``:ct(r)?`>=`+n+`.0.0`:ct(i)?`>=`+n+`.`+r+`.0`:`>=`+t,s=ct(c)?``:ct(l)?`<`+(+c+1)+`.0.0`:ct(u)?`<`+c+`.`+(+l+1)+`.0`:d?`<=`+c+`.`+l+`.`+u+`-`+d:`<=`+s,(t+` `+s).trim()}at.prototype.test=function(e){if(!e)return!1;typeof e==`string`&&(e=new g(e,this.loose));for(var t=0;t<this.set.length;t++)if(_t(this.set[t],e))return!0;return!1};function _t(e,t){for(var r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length){for(var r=0;r<e.length;r++)if(n(e[r].semver),e[r].semver!==it&&e[r].semver.prerelease.length>0){var i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}exports.satisfies=vt;function vt(e,t,n){try{t=new at(t,n)}catch{return!1}return t.test(e)}exports.maxSatisfying=yt;function yt(e,t,n){var r=null,i=null;try{var a=new at(t,n)}catch{return null}return e.forEach(function(e){a.test(e)&&(!r||i.compare(e)===-1)&&(r=e,i=new g(r,n))}),r}exports.minSatisfying=bt;function bt(e,t,n){var r=null,i=null;try{var a=new at(t,n)}catch{return null}return e.forEach(function(e){a.test(e)&&(!r||i.compare(e)===1)&&(r=e,i=new g(r,n))}),r}exports.validRange=_;function _(e,t){try{return new at(e,t).range||`*`}catch{return null}}exports.ltr=v;function v(e,t,n){return xt(e,t,`<`,n)}exports.gtr=y;function y(e,t,n){return xt(e,t,`>`,n)}exports.outside=xt;function xt(e,t,n,r){e=new g(e,r),t=new at(t,r);var i,a,o,s,c;switch(n){case`>`:i=Xe,a=tt,o=Ze,s=`>`,c=`>=`;break;case`<`:i=Ze,a=et,o=Xe,s=`<`,c=`<=`;break;default:throw TypeError(`Must provide a hilo val of "<" or ">"`)}if(vt(e,t,r))return!1;for(var l=0;l<t.set.length;++l){var u=t.set[l],d=null,f=null;if(u.forEach(function(e){e.semver===it&&(e=new rt(`>=0.0.0`)),d||=e,f||=e,i(e.semver,d.semver,r)?d=e:o(e.semver,f.semver,r)&&(f=e)}),d.operator===s||d.operator===c||(!f.operator||f.operator===s)&&a(e,f.semver)||f.operator===c&&o(e,f.semver))return!1}return!0}exports.prerelease=St;function St(e,t){var n=Pe(e,t);return n&&n.prerelease.length?n.prerelease:null}exports.intersects=Ct;function Ct(e,t,n){return e=new at(e,n),t=new at(t,n),e.intersects(t)}exports.coerce=wt;function wt(e){if(e instanceof g)return e;if(typeof e!=`string`)return null;var t=e.match(o[he]);return t==null?null:Pe((t[1]||`0`)+`.`+(t[2]||`0`)+`.`+(t[3]||`0`))}})(gz,gz.exports),gz.exports)}vz();const yz=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/,bz=/^-(\d{4})(\d{2})(\d{2})$/;function xz(e){return e=e.trim(),e===`*`||yz.test(e)}function Sz(e){if(!xz(e))return null;if(e=e.trim(),e===`*`)return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};let t=e.match(yz);return t?{hasCaret:t[1]===`^`,hasGreaterEquals:t[1]===`>=`,majorBase:t[2]===`x`?0:parseInt(t[2],10),majorMustEqual:t[2]!==`x`,minorBase:t[4]===`x`?0:parseInt(t[4],10),minorMustEqual:t[4]!==`x`,patchBase:t[6]===`x`?0:parseInt(t[6],10),patchMustEqual:t[6]!==`x`,preRelease:t[8]||null}:null}function Cz(e){if(!e)return null;let t=e.majorBase,n=e.majorMustEqual,r=e.minorBase,i=e.minorMustEqual,a=e.patchBase,o=e.patchMustEqual;e.hasCaret&&(t===0||(i=!1),o=!1);let s=0;if(e.preRelease){let t=bz.exec(e.preRelease);if(t){let[,e,n,r]=t;s=Date.UTC(Number(e),Number(n)-1,Number(r))}}return{majorBase:t,majorMustEqual:n,minorBase:r,minorMustEqual:i,patchBase:a,patchMustEqual:o,isMinimum:e.hasGreaterEquals,notBefore:s}}var wz=class{constructor(){this.buffers=[]}add(e){let t=this.buffers.indexOf(e);return t<0&&(t=this.buffers.length,this.buffers.push(e)),t}};function Tz(e,t){if(t.serializeBuffersForPostMessage){let t=new wz,n=(e,n)=>{if(n instanceof ArrayBuffer){let e=t.add(n);return{$$vscode_array_buffer_reference$$:!0,index:e}}else if(ArrayBuffer.isView(n)){let e=Ez(n);if(e){let r=t.add(n.buffer);return{$$vscode_array_buffer_reference$$:!0,index:r,view:{type:e,byteLength:n.byteLength,byteOffset:n.byteOffset}}}}return n},r=JSON.stringify(e,n),i=t.buffers.map(e=>{let t=new Uint8Array(e);return b.wrap(t)});return{message:r,buffers:i}}else return{message:JSON.stringify(e),buffers:[]}}function Ez(e){switch(e.constructor.name){case`Int8Array`:return bi.Int8Array;case`Uint8Array`:return bi.Uint8Array;case`Uint8ClampedArray`:return bi.Uint8ClampedArray;case`Int16Array`:return bi.Int16Array;case`Uint16Array`:return bi.Uint16Array;case`Int32Array`:return bi.Int32Array;case`Uint32Array`:return bi.Uint32Array;case`Float32Array`:return bi.Float32Array;case`Float64Array`:return bi.Float64Array;case`BigInt64Array`:return bi.BigInt64Array;case`BigUint64Array`:return bi.BigUint64Array}}function Dz(e,t){let n=t.map(e=>{let t=new ArrayBuffer(e.byteLength),n=new Uint8Array(t);return n.set(e.buffer),t}),r=t.length?(e,t)=>{if(t&&typeof t==`object`&&t.$$vscode_array_buffer_reference$$){let e=t,{index:r}=e,i=n[r];if(e.view)switch(e.view.type){case bi.Int8Array:return new Int8Array(i,e.view.byteOffset,e.view.byteLength/Int8Array.BYTES_PER_ELEMENT);case bi.Uint8Array:return new Uint8Array(i,e.view.byteOffset,e.view.byteLength/Uint8Array.BYTES_PER_ELEMENT);case bi.Uint8ClampedArray:return new Uint8ClampedArray(i,e.view.byteOffset,e.view.byteLength/Uint8ClampedArray.BYTES_PER_ELEMENT);case bi.Int16Array:return new Int16Array(i,e.view.byteOffset,e.view.byteLength/Int16Array.BYTES_PER_ELEMENT);case bi.Uint16Array:return new Uint16Array(i,e.view.byteOffset,e.view.byteLength/Uint16Array.BYTES_PER_ELEMENT);case bi.Int32Array:return new Int32Array(i,e.view.byteOffset,e.view.byteLength/Int32Array.BYTES_PER_ELEMENT);case bi.Uint32Array:return new Uint32Array(i,e.view.byteOffset,e.view.byteLength/Uint32Array.BYTES_PER_ELEMENT);case bi.Float32Array:return new Float32Array(i,e.view.byteOffset,e.view.byteLength/Float32Array.BYTES_PER_ELEMENT);case bi.Float64Array:return new Float64Array(i,e.view.byteOffset,e.view.byteLength/Float64Array.BYTES_PER_ELEMENT);case bi.BigInt64Array:return new BigInt64Array(i,e.view.byteOffset,e.view.byteLength/BigInt64Array.BYTES_PER_ELEMENT);case bi.BigUint64Array:return new BigUint64Array(i,e.view.byteOffset,e.view.byteLength/BigUint64Array.BYTES_PER_ELEMENT);default:throw Error(`Unknown array buffer view type`)}return i}return t}:void 0,i=JSON.parse(e,r);return{message:i,arrayBuffers:n}}var Oz=class{#handle;#proxy;#deprecationService;#remoteInfo;#workspace;#extension;#html;#options;#isDisposed;#hasCalledAsWebviewUri;#serializeBuffersForPostMessage;#shouldRewriteOldResourceUris;constructor(e,t,n,r,i,a,o){this.#html=``,this.#isDisposed=!1,this.#hasCalledAsWebviewUri=!1,this._onMessageEmitter=new x,this.onDidReceiveMessage=this._onMessageEmitter.event,this.#onDidDisposeEmitter=new x,this._onDidDispose=this.#onDidDisposeEmitter.event,this.#handle=e,this.#proxy=t,this.#options=n,this.#remoteInfo=r,this.#workspace=i,this.#extension=a,this.#serializeBuffersForPostMessage=kz(a),this.#shouldRewriteOldResourceUris=Az(a),this.#deprecationService=o}#onDidDisposeEmitter;dispose(){this.#isDisposed=!0,this.#onDidDisposeEmitter.fire(),this.#onDidDisposeEmitter.dispose(),this._onMessageEmitter.dispose()}asWebviewUri(e){return this.#hasCalledAsWebviewUri=!0,dz(e,this.#remoteInfo)}get cspSource(){let e=this.#extension.extensionLocation;if(e.scheme===O.https||e.scheme===O.http){let t=e.toString();return t.endsWith(`/`)||(t+=`/`),t+` `+uz}return uz}get html(){return this.assertNotDisposed(),this.#html}set html(e){this.assertNotDisposed(),this.#html!==e&&(this.#html=e,this.#shouldRewriteOldResourceUris&&!this.#hasCalledAsWebviewUri&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)&&(this.#hasCalledAsWebviewUri=!0,this.#deprecationService.report(`Webview vscode-resource: uris`,this.#extension,`Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri`)),this.#proxy.$setHtml(this.#handle,this.rewriteOldResourceUrlsIfNeeded(e)))}get options(){return this.assertNotDisposed(),this.#options}set options(e){this.assertNotDisposed(),tc(this.#options,e)||this.#proxy.$setOptions(this.#handle,Nz(this.#extension,this.#workspace,e)),this.#options=e}async postMessage(e){if(this.#isDisposed)return!1;let t=Tz(e,{serializeBuffersForPostMessage:this.#serializeBuffersForPostMessage});return this.#proxy.$postMessage(this.#handle,t.message,...t.buffers)}assertNotDisposed(){if(this.#isDisposed)throw Error(`Webview is disposed`)}rewriteOldResourceUrlsIfNeeded(e){if(!this.#shouldRewriteOldResourceUris)return e;let t=this.#extension.extensionLocation?.scheme===O.vscodeRemote,n=this.#extension.extensionLocation.scheme===O.vscodeRemote?this.#extension.extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(e,r,i,a,o,s)=>{let c=w.from({scheme:a||`file`,path:decodeURIComponent(o)}),l=dz(c,{isRemote:t,authority:n}).toString();return`${r}${l}${s}`}).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(e,r,i,a,o,s)=>{let c=w.from({scheme:a||`file`,path:decodeURIComponent(o)}),l=dz(c,{isRemote:t,authority:n}).toString();return`${r}${l}${s}`})}};function kz(e){try{let t=Cz(Sz(e.engines.vscode));return!!t&&t.majorBase>=1&&t.minorBase>=57}catch{return!1}}function Az(e){try{let t=Cz(Sz(e.engines.vscode));return t?t.majorBase<1||t.majorBase===1&&t.minorBase<60:!1}catch{return!1}}var jz=class extends y{constructor(e,t,n,r,i){super(),this.remoteInfo=t,this.workspace=n,this._logService=r,this._deprecationService=i,this._webviews=new Map,this._webviewProxy=e.getProxy(E.MainThreadWebviews)}dispose(){super.dispose();for(let e of this._webviews.values())e.dispose();this._webviews.clear()}$onMessage(e,t,n){let r=this.getWebview(e);if(r){let{message:e}=Dz(t,n.value);r._onMessageEmitter.fire(e)}}$onMissingCsp(e,t){this._logService.warn(`${t} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,t,n){let r=new Oz(e,this._webviewProxy,Pz(t),this.remoteInfo,this.workspace,n,this._deprecationService);this._webviews.set(e,r);let i=r._onDidDispose(()=>{i.dispose(),this.deleteWebview(e)});return r}deleteWebview(e){this._webviews.delete(e)}getWebview(e){return this._webviews.get(e)}};function Mz(e){return{id:e.identifier,location:e.extensionLocation}}function Nz(e,t,n){return{enableCommandUris:n.enableCommandUris,enableScripts:n.enableScripts,enableForms:n.enableForms,portMapping:n.portMapping,localResourceRoots:n.localResourceRoots||Fz(e,t)}}function Pz(e){return{enableCommandUris:e.enableCommandUris,enableScripts:e.enableScripts,enableForms:e.enableForms,portMapping:e.portMapping,localResourceRoots:e.localResourceRoots?.map(e=>w.from(e))}}function Fz(e,t){return[...(t?.getWorkspaceFolders()||[]).map(e=>e.uri),e.extensionLocation]}var Iz=class e{static{this.enableDebugLogging=!1}constructor(e){this.id=e,this._data=new Map,this._idPool=1}add(e){let t=this._idPool++;return this._data.set(t,e),this.logDebugInfo(),t}get(e,t){return this._data.has(e)?this._data.get(e)[t]:void 0}delete(e){this._data.delete(e),this.logDebugInfo()}logDebugInfo(){e.enableDebugLogging&&console.log(`${this.id} cache size - ${this._data.size}`)}},Lz=class{constructor(e,t){this.document=e,this._storagePath=t,this._backupCounter=1,this._edits=new Iz(`custom documents`)}addEdit(e){return this._edits.add([e])}async undo(e,t){await this.getEdit(e).undo(),t||this.disposeBackup()}async redo(e,t){await this.getEdit(e).redo(),t||this.disposeBackup()}disposeEdits(e){for(let t of e)this._edits.delete(t)}getNewBackupUri(){if(!this._storagePath)throw Error(`Backup requires a valid storage path`);let e=Gz(this.document.uri)+ this._backupCounter++;return $a(this._storagePath,e)}updateBackup(e){this._backup?.delete(),this._backup=e}disposeBackup(){this._backup?.delete(),this._backup=void 0}getEdit(e){let t=this._edits.get(e,0);if(!t)throw Error(`No edit found`);return t}},Rz=class{constructor(){this._documents=new Map}get(e,t){return this._documents.get(this.key(e,t))}add(e,t,n){let r=this.key(e,t.uri);if(this._documents.has(r))throw Error(`Document already exists for viewType:${e} resource:${t.uri}`);let i=new Lz(t,n);return this._documents.set(r,i),i}delete(e,t){let n=this.key(e,t.uri);this._documents.delete(n)}key(e,t){return`${e}@@@${t}`}},zz;(function(e){e[e.Text=0]=`Text`,e[e.Custom=1]=`Custom`})(zz||={});var Bz=class{constructor(){this._providers=new Map}addTextProvider(e,t,n){return this.add(e,{type:zz.Text,extension:t,provider:n})}addCustomProvider(e,t,n){return this.add(e,{type:zz.Custom,extension:t,provider:n})}get(e){return this._providers.get(e)}add(e,t){if(this._providers.has(e))throw Error(`Provider for viewType:${e} already registered`);return this._providers.set(e,t),new Pb(()=>this._providers.delete(e))}},Vz=class{constructor(e,t,n,r,i){this._extHostDocuments=t,this._extensionStoragePaths=n,this._extHostWebview=r,this._extHostWebviewPanels=i,this._editorProviders=new Bz,this._documents=new Rz,this._proxy=e.getProxy(E.MainThreadCustomEditors)}registerCustomEditorProvider(e,t,n,r){let i=new v;return Uz(n)?(i.add(this._editorProviders.addTextProvider(t,e,n)),this._proxy.$registerTextEditorProvider(Mz(e),t,r.webviewOptions||{},{supportsMove:!!n.moveCustomTextEditor},kz(e))):(i.add(this._editorProviders.addCustomProvider(t,e,n)),Hz(n)&&i.add(n.onDidChangeCustomDocument(e=>{let n=this.getCustomDocumentEntry(t,e.document.uri);if(Wz(e)){let r=n.addEdit(e);this._proxy.$onDidEdit(e.document.uri,t,r,e.label)}else this._proxy.$onContentChange(e.document.uri,t)})),this._proxy.$registerCustomEditorProvider(Mz(e),t,r.webviewOptions||{},!!r.supportsMultipleEditorsPerDocument,kz(e))),Pb.from(i,new Pb(()=>{this._proxy.$unregisterEditorProvider(t)}))}async $createCustomDocument(e,t,n,r,i){let a=this._editorProviders.get(t);if(!a)throw Error(`No provider found for '${t}'`);if(a.type!==zz.Custom)throw Error(`Invalid provide type for '${t}'`);let o=w.revive(e),s=await a.provider.openCustomDocument(o,{backupId:n,untitledDocumentData:r?.buffer},i),c;return Hz(a.provider)&&this._extensionStoragePaths&&(c=this._extensionStoragePaths.workspaceValue(a.extension)??this._extensionStoragePaths.globalValue(a.extension)),this._documents.add(t,s,c),{editable:Hz(a.provider)}}async $disposeCustomDocument(e,t){let n=this._editorProviders.get(t);if(!n)throw Error(`No provider found for '${t}'`);if(n.type!==zz.Custom)throw Error(`Invalid provider type for '${t}'`);let r=w.revive(e),{document:i}=this.getCustomDocumentEntry(t,r);this._documents.delete(t,i),i.dispose()}async $resolveCustomEditor(e,t,n,r,i,a){let o=this._editorProviders.get(n);if(!o)throw Error(`No provider found for '${n}'`);let s=OD.to(i),c=this._extHostWebview.createNewWebview(t,r.contentOptions,o.extension),l=this._extHostWebviewPanels.createNewWebviewPanel(t,n,r.title,s,r.options,c,r.active),u=w.revive(e);switch(o.type){case zz.Custom:{let{document:e}=this.getCustomDocumentEntry(n,u);return o.provider.resolveCustomEditor(e,l,a)}case zz.Text:{let e=this._extHostDocuments.getDocument(u);return o.provider.resolveCustomTextEditor(e,l,a)}default:throw Error(`Unknown webview provider type`)}}$disposeEdits(e,t,n){let r=this.getCustomDocumentEntry(t,e);r.disposeEdits(n)}async $onMoveCustomEditor(e,t,n){let r=this._editorProviders.get(n);if(!r)throw Error(`No provider found for '${n}'`);if(!r.provider.moveCustomTextEditor)throw Error(`Provider does not implement move '${n}'`);let i=this._extHostWebviewPanels.getWebviewPanel(e);if(!i)throw Error(`No webview found`);let a=w.revive(t),o=this._extHostDocuments.getDocument(a);await r.provider.moveCustomTextEditor(o,i,Oi.None)}async $undo(e,t,n,r){let i=this.getCustomDocumentEntry(t,e);return i.undo(n,r)}async $redo(e,t,n,r){let i=this.getCustomDocumentEntry(t,e);return i.redo(n,r)}async $revert(e,t,n){let r=this.getCustomDocumentEntry(t,e),i=this.getCustomEditorProvider(t);await i.revertCustomDocument(r.document,n),r.disposeBackup()}async $onSave(e,t,n){let r=this.getCustomDocumentEntry(t,e),i=this.getCustomEditorProvider(t);await i.saveCustomDocument(r.document,n),r.disposeBackup()}async $onSaveAs(e,t,n,r){let i=this.getCustomDocumentEntry(t,e),a=this.getCustomEditorProvider(t);return a.saveCustomDocumentAs(i.document,w.revive(n),r)}async $backup(e,t,n){let r=this.getCustomDocumentEntry(t,e),i=this.getCustomEditorProvider(t),a=await i.backupCustomDocument(r.document,{destination:r.getNewBackupUri()},n);return r.updateBackup(a),a.id}getCustomDocumentEntry(e,t){let n=this._documents.get(e,w.revive(t));if(!n)throw Error(`No custom document found`);return n}getCustomEditorProvider(e){let t=this._editorProviders.get(e),n=t?.provider;if(!n||!Hz(n))throw Error(`Custom document is not editable`);return n}};function Hz(e){return!!e.onDidChangeCustomDocument}function Uz(e){return typeof e.resolveCustomTextEditor==`function`}function Wz(e){return typeof e.undo==`function`&&typeof e.redo==`function`}function Gz(e){let t=e.scheme===O.file||e.scheme===O.untitled?e.fsPath:e.toString();return uh(t)+``}var Kz,qz=class e{#proxy;#onDidChangeDiagnostics;#data;constructor(e,t,n,r,i,a,o,s){this._name=e,this._owner=t,this._maxDiagnosticsTotal=n,this._maxDiagnosticsPerFile=r,this._modelVersionIdProvider=i,this._isDisposed=!1,this._maxDiagnosticsTotal=Math.max(r,n),this.#data=new ze(e=>a.getComparisonKey(e)),this.#proxy=o,this.#onDidChangeDiagnostics=s}dispose(){this._isDisposed||=(this.#onDidChangeDiagnostics.fire([...this.#data.keys()]),this.#proxy?.$clear(this._owner),this.#data.clear(),!0)}get name(){return this._checkDisposed(),this._name}set(t,n){if(!t){this.clear();return}this._checkDisposed();let r=[];if(w.isUri(t)){if(!n){this.delete(t);return}this.#data.set(t,n.slice()),r=[t]}else if(Array.isArray(t)){r=[];let n;t=[...t].sort(e._compareIndexedTuplesByUri);for(let e of t){let[t,i]=e;if((!n||t.toString()!==n.toString())&&(n&&this.#data.get(n).length===0&&this.#data.delete(n),n=t,r.push(t),this.#data.set(t,[])),i){let e=this.#data.get(t);e?.push(...i)}else{let e=this.#data.get(t);e&&(e.length=0)}}}if(this.#onDidChangeDiagnostics.fire(r),!this.#proxy)return;let i=[],a=0;for(let e of r){let t=[],n=this.#data.get(e);if(n)if(n.length>this._maxDiagnosticsPerFile){t=[];let r=[$b.Error,$b.Warning,$b.Information,$b.Hint];orderLoop:for(let i=0;i<4;i++)for(let a of n)if(a.severity===r[i]){let n=t.push({...TD.from(a),modelVersionId:this._modelVersionIdProvider(e)});if(n===this._maxDiagnosticsPerFile)break orderLoop}t.push({severity:hm.Info,message:C(2622,`Not showing {0} further errors and warnings.`,n.length-this._maxDiagnosticsPerFile),startLineNumber:t[t.length-1].startLineNumber,startColumn:t[t.length-1].startColumn,endLineNumber:t[t.length-1].endLineNumber,endColumn:t[t.length-1].endColumn})}else t=n.map(t=>({...TD.from(t),modelVersionId:this._modelVersionIdProvider(e)}));if(i.push([e,t]),a+=t.length,a>this._maxDiagnosticsTotal)break}this.#proxy.$changeMany(this._owner,i)}delete(e){this._checkDisposed(),this.#onDidChangeDiagnostics.fire([e]),this.#data.delete(e),this.#proxy?.$changeMany(this._owner,[[e,void 0]])}clear(){this._checkDisposed(),this.#onDidChangeDiagnostics.fire([...this.#data.keys()]),this.#data.clear(),this.#proxy?.$clear(this._owner)}forEach(e,t){this._checkDisposed();for(let[n,r]of this)e.call(t,n,r,this)}*[Symbol.iterator](){this._checkDisposed();for(let e of this.#data.keys())yield[e,this.get(e)]}get(e){this._checkDisposed();let t=this.#data.get(e);return Array.isArray(t)?Object.freeze(t.slice(0)):[]}has(e){return this._checkDisposed(),Array.isArray(this.#data.get(e))}_checkDisposed(){if(this._isDisposed)throw Error(`illegal state - object is disposed`)}static _compareIndexedTuplesByUri(e,t){return e[0].toString()<t[0].toString()?-1:e[0].toString()>t[0].toString()?1:0}};let Jz=class{static{Kz=this}static{this._idPool=0}static{this._maxDiagnosticsPerFile=1e3}static{this._maxDiagnosticsTotal=1.1*this._maxDiagnosticsPerFile}static _mapper(e){let t=new ze;for(let n of e)t.set(n,n);return{uris:Object.freeze(Array.from(t.values()))}}constructor(e,t,n,r){this._logService=t,this._fileSystemInfoService=n,this._extHostDocumentsAndEditors=r,this._collections=new Map,this._onDidChangeDiagnostics=new pn({merge:e=>e.flat(),delay:50}),this.onDidChangeDiagnostics=en.map(this._onDidChangeDiagnostics.event,Kz._mapper),this._proxy=e.getProxy(E.MainThreadDiagnostics)}createDiagnosticCollection(e,t){let{_collections:n,_proxy:r,_onDidChangeDiagnostics:i,_logService:a,_fileSystemInfoService:o,_extHostDocumentsAndEditors:s}=this,c=new class{$changeMany(t,n){r.$changeMany(t,n),a.trace(`[DiagnosticCollection] change many (extension, owner, uris)`,e.value,t,n.length===0?`CLEARING`:n)}$clear(t){r.$clear(t),a.trace(`[DiagnosticCollection] remove all (extension, owner)`,e.value,t)}dispose(){r.dispose()}},l;if(!t)t=`_generated_diagnostic_collection_name_#`+ Kz._idPool++,l=t;else if(!n.has(t))l=t;else{this._logService.warn(`DiagnosticCollection with name '${t}' does already exist.`);do l=t+ Kz._idPool++;while(n.has(l))}let u=new class extends qz{constructor(){super(t,l,Kz._maxDiagnosticsTotal,Kz._maxDiagnosticsPerFile,e=>s.getDocument(e)?.version,o.extUri,c,i),n.set(l,this)}dispose(){super.dispose(),n.delete(l)}};return u}getDiagnostics(e){if(e)return this._getDiagnostics(e);{let e=new Map,t=[];for(let n of this._collections.values())n.forEach((n,r)=>{let i=e.get(n.toString());i===void 0&&(i=t.length,e.set(n.toString(),i),t.push([n,[]])),t[i][1]=t[i][1].concat(...r)});return t}}_getDiagnostics(e){let t=[];for(let n of this._collections.values())n.has(e)&&(t=t.concat(n.get(e)));return t}$acceptMarkersChange(e){if(!this._mirrorCollection){let e=`_generated_mirror`,t=new qz(e,e,2**53-1,2**53-1,e=>void 0,this._fileSystemInfoService.extUri,void 0,this._onDidChangeDiagnostics);this._collections.set(e,t),this._mirrorCollection=t}for(let[t,n]of e)this._mirrorCollection.set(w.revive(t),n.map(TD.to))}};Jz=Kz=A([j(1,xs),j(2,Mc)],Jz);var Yz=class{constructor(e){this._proxy=e.getProxy(E.MainThreadDialogs)}showOpenDialog(e){return this._proxy.$showOpenDialog(e).then(e=>e?e.map(e=>w.revive(e)):void 0)}showSaveDialog(e){return this._proxy.$showSaveDialog(e).then(e=>e?w.revive(e):void 0)}},Xz=class e{static{this._handlePool=0}constructor(e,t,n){this._documentsAndEditors=t,this._logService=n,this._documentContentProviders=new Map,this._proxy=e.getProxy(E.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(t,n){if(Object.keys(O).indexOf(t)>=0)throw Error(`scheme '${t}' already registered`);let r=e._handlePool++;this._documentContentProviders.set(r,n),this._proxy.$registerTextContentProvider(r,t);let i;if(typeof n.onDidChange==`function`){let e;i=n.onDidChange(async n=>{if(n.scheme!==t){this._logService.warn(`Provider for scheme '${t}' is firing event for schema '${n.scheme}' which will be IGNORED`);return}if(!this._documentsAndEditors.getDocument(n))return;e&&await e;let i=this.$provideTextDocumentContent(r,n).then(async e=>{if(!e&&typeof e!=`string`)return;let t=this._documentsAndEditors.getDocument(n);if(!t)return;let r=Gi(e);if(!t.equalLines(r))return this._proxy.$onVirtualDocumentChange(n,e)}).catch(m).finally(()=>{e===i&&(e=void 0)});e=i})}return new Pb(()=>{this._documentContentProviders.delete(r)&&this._proxy.$unregisterTextContentProvider(r),i&&=(i.dispose(),void 0)})}$provideTextDocumentContent(e,t){let n=this._documentContentProviders.get(e);return n?Promise.resolve(n.provideTextDocumentContent(w.revive(t),Oi.None)):Promise.reject(Error(`unsupported uri-scheme: ${t.scheme}`))}},Zz=class{constructor(e,t,n,r={timeout:1500,errors:3}){this._logService=e,this._documents=t,this._mainThreadBulkEdits=n,this._thresholds=r,this._callbacks=new Zt,this._badListeners=new WeakMap}dispose(){this._callbacks.clear()}getOnWillSaveTextDocumentEvent(e){return(t,n,r)=>{let i=this._callbacks.push([t,n,e]),a={dispose:i};return Array.isArray(r)&&r.push(a),a}}async $participateInSave(e,t){let n=w.revive(e),r=!1,i=setTimeout(()=>r=!0,this._thresholds.timeout),a=[];try{for(let e of[...this._callbacks]){if(r)break;let i=this._documents.getDocument(n),o=await this._deliverEventAsyncAndBlameBadListeners(e,{document:i,reason:_O.to(t)});a.push(o)}}finally{clearTimeout(i)}return a}_deliverEventAsyncAndBlameBadListeners([e,t,n],r){let i=this._badListeners.get(e);return typeof i==`number`&&i>this._thresholds.errors?Promise.resolve(!1):this._deliverEventAsync(n,e,t,r).then(()=>!0,t=>{if(this._logService.error(`onWillSaveTextDocument-listener from extension '${n.identifier.value}' threw ERROR`),this._logService.error(t),!(t instanceof Error)||t.message!==`concurrent_edits`){let t=this._badListeners.get(e);this._badListeners.set(e,t?t+1:1),typeof t==`number`&&t>this._thresholds.errors&&this._logService.info(`onWillSaveTextDocument-listener from extension '${n.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}return!1})}_deliverEventAsync(e,t,n,r){let i=[],a=Date.now(),{document:o,reason:s}=r,{version:c}=o,l=Object.freeze({document:o,reason:s,waitUntil(e){if(Object.isFrozen(i))throw le(`waitUntil can not be called async`);i.push(Promise.resolve(e))}});try{t.apply(n,[l])}catch(e){return Promise.reject(e)}return new Promise((t,n)=>{let r=setTimeout(()=>n(Error(`timeout`)),this._thresholds.timeout);return Promise.all(i).then(n=>{this._logService.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-a}ms`),clearTimeout(r),t(n)}).catch(e=>{clearTimeout(r),n(e)})}).then(e=>{let t={edits:[]};for(let n of e)if(Array.isArray(n)&&n.every(e=>e instanceof Kb))for(let{newText:e,newEol:r,range:i}of n)t.edits.push({resource:o.uri,versionId:void 0,textEdit:{range:i&&K.from(i),text:e,eol:r&&yO.from(r)}});if(t.edits.length!==0)return c===o.version?this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new hi(t)):Promise.reject(Error(`concurrent_edits`))})}},Qz=class{constructor(e,t){this._onDidAddDocument=new x,this._onDidRemoveDocument=new x,this._onDidChangeDocument=new x,this._onDidChangeDocumentWithReason=new x,this._onDidSaveDocument=new x,this.onDidAddDocument=this._onDidAddDocument.event,this.onDidRemoveDocument=this._onDidRemoveDocument.event,this.onDidChangeDocument=this._onDidChangeDocument.event,this.onDidChangeDocumentWithReason=this._onDidChangeDocumentWithReason.event,this.onDidSaveDocument=this._onDidSaveDocument.event,this._toDispose=new v,this._documentLoader=new Map,this._proxy=e.getProxy(E.MainThreadDocuments),this._documentsAndEditors=t,this._documentsAndEditors.onDidRemoveDocuments(e=>{for(let t of e)this._onDidRemoveDocument.fire(t.document)},void 0,this._toDispose),this._documentsAndEditors.onDidAddDocuments(e=>{for(let t of e)this._onDidAddDocument.fire(t.document)},void 0,this._toDispose)}dispose(){this._toDispose.dispose()}getAllDocumentData(){return[...this._documentsAndEditors.allDocuments()]}getDocumentData(e){if(!e)return;let t=this._documentsAndEditors.getDocument(e);if(t)return t}getDocument(e){let t=this.getDocumentData(e);if(!t?.document)throw Error(`Unable to retrieve document from URI '${e}'`);return t.document}ensureDocumentData(e,t){let n=this._documentsAndEditors.getDocument(e);if(n&&(!t?.encoding||n.document.encoding===t.encoding))return Promise.resolve(n);let r=this._documentLoader.get(e.toString());return r?t?.encoding&&(r=r.then(n=>n.document.encoding===t.encoding?n:this.ensureDocumentData(e,t))):(r=this._proxy.$tryOpenDocument(e,t).then(t=>{this._documentLoader.delete(e.toString());let n=w.revive(t);return st(this._documentsAndEditors.getDocument(n))},t=>(this._documentLoader.delete(e.toString()),Promise.reject(t))),this._documentLoader.set(e.toString(),r)),r}createDocumentData(e){return this._proxy.$tryCreateDocument(e).then(e=>w.revive(e))}$acceptModelLanguageChanged(e,t){let n=w.revive(e),r=this._documentsAndEditors.getDocument(n);if(!r)throw Error(`unknown document`);this._onDidRemoveDocument.fire(r.document),r._acceptLanguageId(t),this._onDidAddDocument.fire(r.document)}$acceptModelSaved(e){let t=w.revive(e),n=this._documentsAndEditors.getDocument(t);if(!n)throw Error(`unknown document`);this.$acceptDirtyStateChanged(e,!1),this._onDidSaveDocument.fire(n.document)}$acceptDirtyStateChanged(e,t){let n=w.revive(e),r=this._documentsAndEditors.getDocument(n);if(!r)throw Error(`unknown document`);r._acceptIsDirty(t),this._onDidChangeDocument.fire({document:r.document,contentChanges:[],reason:void 0}),this._onDidChangeDocumentWithReason.fire({document:r.document,contentChanges:[],reason:void 0,detailedReason:void 0})}$acceptEncodingChanged(e,t){let n=w.revive(e),r=this._documentsAndEditors.getDocument(n);if(!r)throw Error(`unknown document`);r._acceptEncoding(t),this._onDidChangeDocument.fire({document:r.document,contentChanges:[],reason:void 0}),this._onDidChangeDocumentWithReason.fire({document:r.document,contentChanges:[],reason:void 0,detailedReason:void 0})}$acceptModelChanged(e,t,n){let r=w.revive(e),i=this._documentsAndEditors.getDocument(r);if(!i)throw Error(`unknown document`);i._acceptIsDirty(n),i.onEvents(t);let a;t.isUndoing?a=Kx.Undo:t.isRedoing&&(a=Kx.Redo),this._onDidChangeDocument.fire(Xs({document:i.document,contentChanges:t.changes.map(e=>({range:K.to(e.range),rangeOffset:e.rangeOffset,rangeLength:e.rangeLength,text:e.text})),reason:a})),this._onDidChangeDocumentWithReason.fire(Xs({document:i.document,contentChanges:t.changes.map(e=>({range:K.to(e.range),rangeOffset:e.rangeOffset,rangeLength:e.rangeLength,text:e.text})),reason:a,detailedReason:t.detailedReason?{source:t.detailedReason.source,metadata:t.detailedReason}:void 0}))}setWordDefinitionFor(e,t){PF(e,t)}},$z=class{constructor(e){this._provider=new Map,this._onDidChange=new x,this.onDidChange=this._onDidChange.event,this._allKnownModels=new Set,this._handlePool=0,this._proxy=e.getProxy(E.MainThreadEmbeddings)}registerEmbeddingsProvider(e,t,n){if(this._allKnownModels.has(t))throw Error(`An embeddings provider for this model is already registered`);let r=this._handlePool++;return this._proxy.$registerEmbeddingProvider(r,t),this._provider.set(r,{id:t,provider:n}),_(()=>{this._allKnownModels.delete(t),this._proxy.$unregisterEmbeddingProvider(r),this._provider.delete(r)})}async computeEmbeddings(e,t,n){n??=Oi.None;let r=!1;typeof t==`string`&&(t=[t],r=!0);let i=await this._proxy.$computeEmbeddings(e,t,n);if(i.length!==t.length)throw Error();if(r){if(i.length!==1)throw Error();return i[0]}return i}async $provideEmbeddings(e,t,n){let r=this._provider.get(e);if(!r)return[];let i=await r.provider.provideEmbeddings(t,n);return i||[]}get embeddingsModels(){return Array.from(this._allKnownModels)}$acceptEmbeddingModels(e){this._allKnownModels=new Set(e),this._onDidChange.fire()}},eB=class{constructor(e){this._AiEmbeddingVectorProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(E.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,t,n){if(this._AiEmbeddingVectorProviders.size===0)throw Error(`No embedding vector providers registered`);let r=this._AiEmbeddingVectorProviders.get(e);if(!r)throw Error(`Embedding vector provider not found`);let i=await r.provideEmbeddingVector(t,n);if(!i)throw Error(`Embedding vector provider returned undefined`);return i}registerEmbeddingVectorProvider(e,t,n){let r=this._nextHandle;return this._nextHandle++,this._AiEmbeddingVectorProviders.set(r,n),this._proxy.$registerAiEmbeddingVectorProvider(t,r),new Pb(()=>{this._proxy.$unregisterAiEmbeddingVectorProvider(r),this._AiEmbeddingVectorProviders.delete(r)})}},X;(function(e){e[e.Invalid=0]=`Invalid`,e[e.Start=1]=`Start`,e[e.H=2]=`H`,e[e.HT=3]=`HT`,e[e.HTT=4]=`HTT`,e[e.HTTP=5]=`HTTP`,e[e.F=6]=`F`,e[e.FI=7]=`FI`,e[e.FIL=8]=`FIL`,e[e.BeforeColon=9]=`BeforeColon`,e[e.AfterColon=10]=`AfterColon`,e[e.AlmostThere=11]=`AlmostThere`,e[e.End=12]=`End`,e[e.Accept=13]=`Accept`,e[e.LastKnownState=14]=`LastKnownState`})(X||={});var tB=class{constructor(e,t,n){let r=new Uint8Array(e*t);for(let i=0,a=e*t;i<a;i++)r[i]=n;this._data=r,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,n){this._data[e*this.cols+t]=n}},nB=class{constructor(e){let t=0,n=X.Invalid;for(let r=0,i=e.length;r<i;r++){let[i,a,o]=e[r];a>t&&(t=a),i>n&&(n=i),o>n&&(n=o)}t++,n++;let r=new tB(n,t,X.Invalid);for(let t=0,n=e.length;t<n;t++){let[n,i,a]=e[t];r.set(n,i,a)}this._states=r,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?X.Invalid:this._states.get(e,t)}};let rB=null;function iB(){return rB===null&&(rB=new nB([[X.Start,S.h,X.H],[X.Start,S.H,X.H],[X.Start,S.f,X.F],[X.Start,S.F,X.F],[X.H,S.t,X.HT],[X.H,S.T,X.HT],[X.HT,S.t,X.HTT],[X.HT,S.T,X.HTT],[X.HTT,S.p,X.HTTP],[X.HTT,S.P,X.HTTP],[X.HTTP,S.s,X.BeforeColon],[X.HTTP,S.S,X.BeforeColon],[X.HTTP,S.Colon,X.AfterColon],[X.F,S.i,X.FI],[X.F,S.I,X.FI],[X.FI,S.l,X.FIL],[X.FI,S.L,X.FIL],[X.FIL,S.e,X.BeforeColon],[X.FIL,S.E,X.BeforeColon],[X.BeforeColon,S.Colon,X.AfterColon],[X.AfterColon,S.Slash,X.AlmostThere],[X.AlmostThere,S.Slash,X.End]])),rB}var aB;(function(e){e[e.None=0]=`None`,e[e.ForceTermination=1]=`ForceTermination`,e[e.CannotEndIn=2]=`CannotEndIn`})(aB||={});let oB=null;function sB(){if(oB===null){oB=new aP(aB.None);for(let e=0;e<36;e++)oB.set(` 	<>'"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…|`.charCodeAt(e),aB.ForceTermination);for(let e=0;e<4;e++)oB.set(`.,;:`.charCodeAt(e),aB.CannotEndIn)}return oB}var cB=class e{static _createLink(e,t,n,r,i){let a=i-1;do{let n=t.charCodeAt(a),r=e.get(n);if(r!==aB.CannotEndIn)break;a--}while(a>r);if(r>0){let e=t.charCodeAt(r-1),n=t.charCodeAt(a);(e===S.OpenParen&&n===S.CloseParen||e===S.OpenSquareBracket&&n===S.CloseSquareBracket||e===S.OpenCurlyBrace&&n===S.CloseCurlyBrace)&&a--}return{range:{startLineNumber:n,startColumn:r+1,endLineNumber:n,endColumn:a+2},url:t.substring(r,a+1)}}static computeLinks(t,n=iB()){let r=sB(),i=[];for(let a=1,o=t.getLineCount();a<=o;a++){let o=t.getLineContent(a),s=o.length,c=0,l=0,u=0,d=X.Start,f=!1,p=!1,ee=!1,m=!1;for(;c<s;){let t=!1,s=o.charCodeAt(c);if(d===X.Accept){let n;switch(s){case S.OpenParen:f=!0,n=aB.None;break;case S.CloseParen:n=f?aB.None:aB.ForceTermination;break;case S.OpenSquareBracket:ee=!0,p=!0,n=aB.None;break;case S.CloseSquareBracket:ee=!1,n=p?aB.None:aB.ForceTermination;break;case S.OpenCurlyBrace:m=!0,n=aB.None;break;case S.CloseCurlyBrace:n=m?aB.None:aB.ForceTermination;break;case S.SingleQuote:case S.DoubleQuote:case S.BackTick:n=u===s?aB.ForceTermination:u===S.SingleQuote||u===S.DoubleQuote||u===S.BackTick?aB.None:aB.ForceTermination;break;case S.Asterisk:n=u===S.Asterisk?aB.ForceTermination:aB.None;break;case S.Space:n=ee?aB.None:aB.ForceTermination;break;default:n=r.get(s)}n===aB.ForceTermination&&(i.push(e._createLink(r,o,a,l,c)),t=!0)}else if(d===X.End){let e;s===S.OpenSquareBracket?(p=!0,e=aB.None):e=r.get(s),e===aB.ForceTermination?t=!0:d=X.Accept}else d=n.nextState(d,s),d===X.Invalid&&(t=!0);t&&(d=X.Start,f=!1,p=!1,m=!1,l=c+1,u=s),c++}d===X.Accept&&i.push(e._createLink(r,o,a,l,s))}return i}},lB=class{constructor(){this._schemes=[]}add(e){this._stateMachine=void 0,this._schemes.push(e)}delete(e){let t=this._schemes.indexOf(e);t>=0&&(this._schemes.splice(t,1),this._stateMachine=void 0)}_initStateMachine(){if(!this._stateMachine){let e=this._schemes.sort(),t=[],n,r,i=X.LastKnownState,a=X.LastKnownState;for(let o of e){let e=n?ta(n,o):0;for(r=e===0?X.Start:a;e<o.length;e++)e+1===o.length?(i=a,a=X.BeforeColon):a+=1,t.push([r,o.toUpperCase().charCodeAt(e),a]),t.push([r,o.toLowerCase().charCodeAt(e),a]),r=a;n=o,a=i}t.push([X.BeforeColon,S.Colon,X.AfterColon]),t.push([X.AfterColon,S.Slash,X.End]),this._stateMachine=new nB(t)}}provideDocumentLinks(e){this._initStateMachine();let t=[],n=cB.computeLinks({getLineContent(t){return e.lineAt(t-1).text},getLineCount(){return e.lineCount}},this._stateMachine);for(let e of n){let n=pO.to(e);n.target&&t.push(n)}return t}},uB=class e{constructor(e,t){this._extHostLanguageFeatures=t,this._linkProvider=new lB,this._fsProvider=new Map,this._registeredSchemes=new Set,this._watches=new Map,this._handlePool=0,this._proxy=e.getProxy(E.MainThreadFileSystem)}dispose(){this._linkProviderRegistration?.dispose()}registerFileSystemProvider(t,n,r,i={}){if(e._validateFileSystemProvider(r),this._registeredSchemes.has(n))throw Error(`a provider for the scheme '${n}' is already registered`);this._linkProviderRegistration||=this._extHostLanguageFeatures.registerDocumentLinkProvider(t,`*`,this._linkProvider);let a=this._handlePool++;this._linkProvider.add(n),this._registeredSchemes.add(n),this._fsProvider.set(a,r);let o=cc.FileReadWrite;i.isCaseSensitive&&(o+=cc.PathCaseSensitive),i.isReadonly&&(o+=cc.Readonly),typeof r.copy==`function`&&(o+=cc.FileFolderCopy),typeof r.open==`function`&&typeof r.close==`function`&&typeof r.read==`function`&&typeof r.write==`function`&&(U(t,`fsChunks`),o+=cc.FileOpenReadWriteClose);let s;i.isReadonly&&vl(i.isReadonly)&&i.isReadonly.value!==``&&(s={value:i.isReadonly.value,isTrusted:i.isReadonly.isTrusted,supportThemeIcons:i.isReadonly.supportThemeIcons,supportHtml:i.isReadonly.supportHtml,baseUri:i.isReadonly.baseUri,uris:i.isReadonly.uris}),this._proxy.$registerFileSystemProvider(a,n,o,s).catch(e=>{console.error(`FAILED to register filesystem provider of ${t.identifier.value}-extension for the scheme ${n}`),console.error(e)});let c=r.onDidChangeFile(e=>{let t=[];for(let r of e){let{uri:e,type:i}=r;if(e.scheme!==n)continue;let a;switch(i){case lC.Changed:a=hc.UPDATED;break;case lC.Created:a=hc.ADDED;break;case lC.Deleted:a=hc.DELETED;break;default:throw Error(`Unknown FileChangeType`)}t.push({resource:e,type:a})}this._proxy.$onFileSystemChange(a,t)});return _(()=>{c.dispose(),this._linkProvider.delete(n),this._registeredSchemes.delete(n),this._fsProvider.delete(a),this._proxy.$unregisterProvider(a)})}static _validateFileSystemProvider(e){if(!e)throw Error(`MISSING provider`);if(typeof e.watch!=`function`)throw Error(`Provider does NOT implement watch`);if(typeof e.stat!=`function`)throw Error(`Provider does NOT implement stat`);if(typeof e.readDirectory!=`function`)throw Error(`Provider does NOT implement readDirectory`);if(typeof e.createDirectory!=`function`)throw Error(`Provider does NOT implement createDirectory`);if(typeof e.readFile!=`function`)throw Error(`Provider does NOT implement readFile`);if(typeof e.writeFile!=`function`)throw Error(`Provider does NOT implement writeFile`);if(typeof e.delete!=`function`)throw Error(`Provider does NOT implement delete`);if(typeof e.rename!=`function`)throw Error(`Provider does NOT implement rename`)}static _asIStat(e){let{type:t,ctime:n,mtime:r,size:i,permissions:a}=e;return{type:t,ctime:n,mtime:r,size:i,permissions:a}}$stat(t,n){return Promise.resolve(this._getFsProvider(t).stat(w.revive(n))).then(t=>e._asIStat(t))}$readdir(e,t){return Promise.resolve(this._getFsProvider(e).readDirectory(w.revive(t)))}$readFile(e,t){return Promise.resolve(this._getFsProvider(e).readFile(w.revive(t))).then(e=>b.wrap(e))}$writeFile(e,t,n,r){return Promise.resolve(this._getFsProvider(e).writeFile(w.revive(t),n.buffer,r))}$delete(e,t,n){return Promise.resolve(this._getFsProvider(e).delete(w.revive(t),n))}$rename(e,t,n,r){return Promise.resolve(this._getFsProvider(e).rename(w.revive(t),w.revive(n),r))}$copy(e,t,n,r){let i=this._getFsProvider(e);if(!i.copy)throw Error(`FileSystemProvider does not implement "copy"`);return Promise.resolve(i.copy(w.revive(t),w.revive(n),r))}$mkdir(e,t){return Promise.resolve(this._getFsProvider(e).createDirectory(w.revive(t)))}$watch(e,t,n,r){let i=this._getFsProvider(e).watch(w.revive(n),r);this._watches.set(t,i)}$unwatch(e,t){let n=this._watches.get(t);n&&(n.dispose(),this._watches.delete(t))}$open(e,t,n){let r=this._getFsProvider(e);if(!r.open)throw Error(`FileSystemProvider does not implement "open"`);return Promise.resolve(r.open(w.revive(t),n))}$close(e,t){let n=this._getFsProvider(e);if(!n.close)throw Error(`FileSystemProvider does not implement "close"`);return Promise.resolve(n.close(t))}$read(e,t,n,r){let i=this._getFsProvider(e);if(!i.read)throw Error(`FileSystemProvider does not implement "read"`);let a=b.alloc(r);return Promise.resolve(i.read(t,n,a.buffer,0,r)).then(e=>a.slice(0,e))}$write(e,t,n,r){let i=this._getFsProvider(e);if(!i.write)throw Error(`FileSystemProvider does not implement "write"`);return Promise.resolve(i.write(t,n,r.buffer,0,r.byteLength))}_getFsProvider(e){let t=this._fsProvider.get(e);if(!t){let e=Error();throw e.name=`ENOPRO`,e.message=`no provider`,e}return t}};(class e extends y{static{this.MAX_RESTARTS=5}constructor(e,t,n,r){super(),this.onFileChanges=e,this.onLogMessage=t,this.verboseLogging=n,this.options=r,this.watcherDisposables=this._register(new xt),this.requests=void 0,this.restartCounter=0}init(){let e=new v;this.watcherDisposables.value=e,this.watcher=this.createWatcher(e),this.watcher.setVerboseLogging(this.verboseLogging),e.add(this.watcher.onDidChangeFile(e=>this.onFileChanges(e))),e.add(this.watcher.onDidLogMessage(e=>this.onLogMessage(e))),e.add(this.watcher.onDidError(e=>this.onError(e.error,e.request)))}onError(t,n){this.canRestart(t,n)?this.restartCounter<e.MAX_RESTARTS&&this.requests?(this.error(`restarting watcher after unexpected error: ${t}`),this.restart(this.requests)):this.error(`gave up attempting to restart watcher after unexpected error: ${t}`):this.error(t)}canRestart(e,t){return!(!this.options.restartOnError||t||e.indexOf(`No space left on device`)!==-1||e.indexOf(`EMFILE`)!==-1)}restart(e){this.restartCounter++,this.init(),this.watch(e)}async watch(e){this.requests=e,await this.watcher?.watch(e)}async setVerboseLogging(e){this.verboseLogging=e,await this.watcher?.setVerboseLogging(e)}error(e){this.onLogMessage({type:`error`,message:`[File Watcher (${this.options.type})] ${e}`})}trace(e){this.onLogMessage({type:`trace`,message:`[File Watcher (${this.options.type})] ${e}`})}dispose(){return this.watcher=void 0,super.dispose()}});function dB(e,t){return typeof t==`string`&&!t.startsWith(`**`)&&!zr(t)?{base:e,pattern:t}:t}var fB=class{get ignoreCreateEvents(){return!!(this._config&1)}get ignoreChangeEvents(){return!!(this._config&2)}get ignoreDeleteEvents(){return!!(this._config&4)}constructor(e,t,n,r,i,a,o){this.session=Math.random(),this._onDidCreate=new x,this._onDidChange=new x,this._onDidDelete=new x,this._config=0,o.ignoreCreateEvents&&(this._config+=1),o.ignoreChangeEvents&&(this._config+=2),o.ignoreDeleteEvents&&(this._config+=4);let s=kv(a),c=typeof a==`string`,l=i(e=>{if(!(typeof e.session==`number`&&e.session!==this.session)){if(!o.ignoreCreateEvents)for(let t of e.created){let e=w.revive(t);s(e.fsPath)&&(!c||n.getWorkspaceFolder(e))&&this._onDidCreate.fire(e)}if(!o.ignoreChangeEvents)for(let t of e.changed){let e=w.revive(t);s(e.fsPath)&&(!c||n.getWorkspaceFolder(e))&&this._onDidChange.fire(e)}if(!o.ignoreDeleteEvents)for(let t of e.deleted){let e=w.revive(t);s(e.fsPath)&&(!c||n.getWorkspaceFolder(e))&&this._onDidDelete.fire(e)}}});this._disposable=Pb.from(this.ensureWatching(e,n,t,r,a,o,!1),this._onDidCreate,this._onDidChange,this._onDidDelete,l)}ensureWatching(e,t,n,r,i,a,o){let s=Pb.from();if(typeof i==`string`||a.ignoreChangeEvents&&a.ignoreCreateEvents&&a.ignoreDeleteEvents)return s;let c=e.getProxy(E.MainThreadFileSystemEventService),l=!1;(i.pattern.includes(`**`)||i.pattern.includes(`/`))&&(l=!0);let u=[],d,f;if(o)(a.ignoreChangeEvents||a.ignoreCreateEvents||a.ignoreDeleteEvents)&&(f=sc.UPDATED|sc.ADDED|sc.DELETED,a.ignoreChangeEvents&&(f&=~sc.UPDATED),a.ignoreCreateEvents&&(f&=~sc.ADDED),a.ignoreDeleteEvents&&(f&=~sc.DELETED));else if(l&&u.length===0){let e=t.getWorkspaceFolder(w.revive(i.baseUri)),r=n.getConfiguration(`files`,e).get(`watcherExclude`);if(r)for(let e in r)e&&r[e]===!0&&u.push(e)}else if(!l){let e=t.getWorkspaceFolder(w.revive(i.baseUri));if(e){let t=n.getConfiguration(`files`,e).get(`watcherExclude`);if(t){for(let n in t)if(n&&t[n]===!0){let t=`${Hi(n,`/`)}/**`;d||=[],d.push(dB(e.uri.fsPath,t))}}if(!d||d.length===0)return s}}return c.$watch(r.identifier.value,this.session,i.baseUri,{recursive:l,excludes:u,includes:d,filter:f},!!o),Pb.from({dispose:()=>c.$unwatch(this.session)})}dispose(){this._disposable.dispose()}get onDidCreate(){return this._onDidCreate.event}get onDidChange(){return this._onDidChange.event}get onDidDelete(){return this._onDidDelete.event}},pB=class{get created(){return this._created.value}get changed(){return this._changed.value}get deleted(){return this._deleted.value}constructor(e){this._events=e,this._created=new u(()=>this._events.created.map(w.revive)),this._changed=new u(()=>this._events.changed.map(w.revive)),this._deleted=new u(()=>this._events.deleted.map(w.revive)),this.session=this._events.session}},mB=class{constructor(e,t,n){this._mainContext=e,this._logService=t,this._extHostDocumentsAndEditors=n,this._onFileSystemEvent=new x,this._onDidRenameFile=new x,this._onDidCreateFile=new x,this._onDidDeleteFile=new x,this._onWillRenameFile=new dn,this._onWillCreateFile=new dn,this._onWillDeleteFile=new dn,this.onDidRenameFile=this._onDidRenameFile.event,this.onDidCreateFile=this._onDidCreateFile.event,this.onDidDeleteFile=this._onDidDeleteFile.event}createFileSystemWatcher(e,t,n,r,i){return new fB(this._mainContext,t,e,n,this._onFileSystemEvent.event,wO.from(r),i)}$onFileEvent(e){this._onFileSystemEvent.fire(new pB(e))}$onDidRunFileOperation(e,t){switch(e){case mc.MOVE:this._onDidRenameFile.fire(Object.freeze({files:t.map(e=>({oldUri:w.revive(e.source),newUri:w.revive(e.target)}))}));break;case mc.DELETE:this._onDidDeleteFile.fire(Object.freeze({files:t.map(e=>w.revive(e.target))}));break;case mc.CREATE:case mc.COPY:this._onDidCreateFile.fire(Object.freeze({files:t.map(e=>w.revive(e.target))}));break}}getOnWillRenameFileEvent(e){return this._createWillExecuteEvent(e,this._onWillRenameFile)}getOnWillCreateFileEvent(e){return this._createWillExecuteEvent(e,this._onWillCreateFile)}getOnWillDeleteFileEvent(e){return this._createWillExecuteEvent(e,this._onWillDeleteFile)}_createWillExecuteEvent(e,t){return(n,r,i)=>{let a=function(e){n.call(r,e)};return a.extension=e,t.event(a,void 0,i)}}async $onWillRunFileOperation(e,t,n,r){switch(e){case mc.MOVE:return await this._fireWillEvent(this._onWillRenameFile,{files:t.map(e=>({oldUri:w.revive(e.source),newUri:w.revive(e.target)}))},n,r);case mc.DELETE:return await this._fireWillEvent(this._onWillDeleteFile,{files:t.map(e=>w.revive(e.target))},n,r);case mc.CREATE:case mc.COPY:return await this._fireWillEvent(this._onWillCreateFile,{files:t.map(e=>w.revive(e.target))},n,r)}}async _fireWillEvent(e,t,n,r){let i=new Set,a=[];if(await e.fireAsync(t,r,async(e,t)=>{let r=Date.now(),o=await Promise.resolve(e);o instanceof Xb&&(a.push([t.extension,o]),i.add(t.extension.displayName??t.extension.identifier.value)),Date.now()-r>n&&this._logService.warn(`SLOW file-participant`,t.extension.identifier)}),r.isCancellationRequested||a.length===0)return;let o={edits:[]};for(let[,e]of a){let{edits:t}=zD.from(e,{getTextDocumentVersion:e=>this._extHostDocumentsAndEditors.getDocument(e)?.version,getNotebookDocumentVersion:()=>void 0});o.edits=o.edits.concat(t)}return{edit:o,extensionNames:Array.from(i)}}},hB=class{constructor(e,t,n,r,i){this._extHostNotebooks=t,this._textDocumentsAndEditors=n,this._commands=r;let a=new nN(`interactive.open`,`_interactive.open`,`Open interactive window and return notebook editor and input URI`,[new Y(`showOptions`,`Show Options`,e=>!0,e=>e),new Y(`resource`,`Interactive resource Uri`,e=>!0,e=>e),new Y(`controllerId`,`Notebook controller Id`,e=>!0,e=>e),new Y(`title`,`Interactive editor title`,e=>!0,e=>e)],new tN(`Notebook and input URI`,e=>{if(i.debug(`[ExtHostInteractive] open iw with notebook editor id`,e.notebookEditorId),e.notebookEditorId!==void 0){let t=this._extHostNotebooks.getEditorById(e.notebookEditorId);return i.debug(`[ExtHostInteractive] notebook editor found`,t.id),{notebookUri:w.revive(e.notebookUri),inputUri:w.revive(e.inputUri),notebookEditor:t.apiEditor}}return i.debug(`[ExtHostInteractive] notebook editor not found, uris for the interactive document`,e.notebookUri,e.inputUri),{notebookUri:w.revive(e.notebookUri),inputUri:w.revive(e.inputUri)}}));this._commands.registerApiCommand(a)}$willAddInteractiveDocument(e,t,n,r){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:t,lines:[``],languageId:n,uri:e,isDirty:!1,versionId:1,encoding:`utf8`}]})}$willRemoveInteractiveDocument(e,t){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}},gB=class{constructor(e){this._handlePool=0,this._proxy=e.getProxy(E.MainThreadLabelService)}$registerResourceLabelFormatter(e){let t=this._handlePool++;return this._proxy.$registerResourceLabelFormatter(t,e),_(()=>{this._proxy.$unregisterResourceLabelFormatter(t)})}},_B;(function(e){e[e.LTR=0]=`LTR`,e[e.RTL=1]=`RTL`})(_B||={});var vB=class e extends vp{constructor(e,t,n,r){super(e,t,n,r),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=n,this.positionColumn=r}toString(){return`[`+this.selectionStartLineNumber+`,`+this.selectionStartColumn+` -> `+this.positionLineNumber+`,`+this.positionColumn+`]`}equalsSelection(t){return e.selectionsEqual(this,t)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?_B.LTR:_B.RTL}setEndPosition(t,n){return this.getDirection()===_B.LTR?new e(this.startLineNumber,this.startColumn,t,n):new e(t,n,this.startLineNumber,this.startColumn)}getPosition(){return new _p(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new _p(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(t,n){return this.getDirection()===_B.LTR?new e(t,n,this.endLineNumber,this.endColumn):new e(this.endLineNumber,this.endColumn,t,n)}static fromPositions(t,n=t){return new e(t.lineNumber,t.column,n.lineNumber,n.column)}static fromRange(t,n){return n===_B.LTR?new e(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):new e(t.endLineNumber,t.endColumn,t.startLineNumber,t.startColumn)}static liftSelection(t){return new e(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(!this.selectionsEqual(e[n],t[n]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber==`number`&&typeof e.selectionStartColumn==`number`&&typeof e.positionLineNumber==`number`&&typeof e.positionColumn==`number`}static createWithDirection(t,n,r,i,a){return a===_B.LTR?new e(t,n,r,i):new e(r,i,t,n)}},yB=class e{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentSymbols(t,n){let r=this._documents.getDocument(t),i=await this._provider.provideDocumentSymbols(r,n);if(!Se(i))return i[0]instanceof fx?i.map(UD.from):e._asDocumentSymbolTree(i)}static _asDocumentSymbolTree(e){e=e.slice(0).sort((e,t)=>{let n=e.location.range.start.compareTo(t.location.range.start);return n===0&&(n=t.location.range.end.compareTo(e.location.range.end)),n});let t=[],n=[];for(let r of e){let e={name:r.name||`!!MISSING: name!!`,kind:BD.from(r.kind),tags:r.tags?.map(VD.from)||[],detail:``,containerName:r.containerName,range:K.from(r.location.range),selectionRange:K.from(r.location.range),children:[]};for(;;){if(n.length===0){n.push(e),t.push(e);break}let r=n[n.length-1];if(vp.containsRange(r.range,e.range)&&!vp.equalsRange(r.range,e.range)){r.children?.push(e),n.push(e);break}n.pop()}}return t}},bB=class{constructor(e,t,n,r,i,a){this._documents=e,this._commands=t,this._provider=n,this._extension=r,this._extTelemetry=i,this._logService=a,this._cache=new Iz(`CodeLens`),this._disposables=new Map}async provideCodeLenses(e,t){let n=this._documents.getDocument(e),r=await this._provider.provideCodeLenses(n,t);if(!r||t.isCancellationRequested)return;let i=this._cache.add(r),a=new v;this._disposables.set(i,a);let o={cacheId:i,lenses:[]};for(let e=0;e<r.length;e++){if(!Ib.isRange(r[e].range)){console.warn(`INVALID code lens, range is not defined`,this._extension.identifier.value);continue}o.lenses.push({cacheId:[i,e],range:K.from(r[e].range),command:this._commands.toInternal(r[e].command,a)})}return o}async resolveCodeLens(e,t){let n=e.cacheId&&this._cache.get(...e.cacheId);if(!n)return;let r;if(r=typeof this._provider.resolveCodeLens!=`function`||n.isResolved?n:await this._provider.resolveCodeLens(n,t),r||=n,t.isCancellationRequested)return;let i=e.cacheId&&this._disposables.get(e.cacheId[0]);if(i){if(!r.command){let e=Error(`INVALID code lens resolved, lacks command: `+this._extension.identifier.value);this._extTelemetry.onExtensionError(this._extension.identifier,e),this._logService.error(e);return}return e.command=this._commands.toInternal(r.command,i),e}}releaseCodeLenses(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}};function xB(e){return Array.isArray(e)?e.map(JD.from):e?[JD.from(e)]:[]}var SB=class{constructor(e,t){this._documents=e,this._provider=t}async provideDefinition(e,t,n){let r=this._documents.getDocument(e),i=SD.to(t),a=await this._provider.provideDefinition(r,i,n);return xB(a)}},CB=class{constructor(e,t){this._documents=e,this._provider=t}async provideDeclaration(e,t,n){let r=this._documents.getDocument(e),i=SD.to(t),a=await this._provider.provideDeclaration(r,i,n);return xB(a)}},wB=class{constructor(e,t){this._documents=e,this._provider=t}async provideImplementation(e,t,n){let r=this._documents.getDocument(e),i=SD.to(t),a=await this._provider.provideImplementation(r,i,n);return xB(a)}},TB=class{constructor(e,t){this._documents=e,this._provider=t}async provideTypeDefinition(e,t,n){let r=this._documents.getDocument(e),i=SD.to(t),a=await this._provider.provideTypeDefinition(r,i,n);return xB(a)}},EB=class e{static{this.HOVER_MAP_MAX_SIZE=10}constructor(e,t){this._documents=e,this._provider=t,this._hoverCounter=0,this._hoverMap=new Map}async provideHover(t,n,r,i){let a=this._documents.getDocument(t),o=SD.to(n),s;if(r&&r.verbosityRequest){let e=r.verbosityRequest.previousHover.id,t=this._hoverMap.get(e);if(!t)throw Error(`Hover with id ${e} not found`);let n={verbosityDelta:r.verbosityRequest.verbosityDelta,previousHover:t};s=await this._provider.provideHover(a,o,i,n)}else s=await this._provider.provideHover(a,o,i);if(!s||Se(s.contents))return;s.range||=a.getWordRangeAtPosition(o),s.range||=new Ib(o,o);let c=YD.from(s),l=this._hoverCounter;if(this._hoverMap.size===e.HOVER_MAP_MAX_SIZE){let e=Math.min(...this._hoverMap.keys());this._hoverMap.delete(e)}this._hoverMap.set(l,s),this._hoverCounter+=1;let u={...c,id:l};return u}releaseHover(e){this._hoverMap.delete(e)}},DB=class{constructor(e,t){this._documents=e,this._provider=t}async provideEvaluatableExpression(e,t,n){let r=this._documents.getDocument(e),i=SD.to(t),a=await this._provider.provideEvaluatableExpression(r,i,n);if(a)return XD.from(a)}},OB=class{constructor(e,t){this._documents=e,this._provider=t}async provideInlineValues(e,t,n,r){let i=this._documents.getDocument(e),a=await this._provider.provideInlineValues(i,K.to(t),QD.to(n),r);if(Array.isArray(a))return a.map(e=>ZD.from(e))}},kB=class{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentHighlights(e,t,n){let r=this._documents.getDocument(e),i=SD.to(t),a=await this._provider.provideDocumentHighlights(r,i,n);if(Array.isArray(a))return a.map($D.from)}},AB=class{constructor(e,t,n){this._documents=e,this._provider=t,this._logService=n}async provideMultiDocumentHighlights(e,t,n,r){let i=this._documents.getDocument(e),a=n.map(e=>{try{return this._documents.getDocument(e)}catch(t){this._logService.error(`Error: Unable to retrieve document from URI: `+e+`. Error message: `+t);return}}).filter(e=>e!==void 0),o=SD.to(t),s=await this._provider.provideMultiDocumentHighlights(i,o,a,r);if(Array.isArray(s))return s.map(eO.from)}},jB=class{constructor(e,t){this._documents=e,this._provider=t}async provideLinkedEditingRanges(e,t,n){let r=this._documents.getDocument(e),i=SD.to(t),a=await this._provider.provideLinkedEditingRanges(r,i,n);if(a&&Array.isArray(a.ranges))return{ranges:be(a.ranges.map(K.from)),wordPattern:a.wordPattern}}},MB=class{constructor(e,t){this._documents=e,this._provider=t}async provideReferences(e,t,n,r){let i=this._documents.getDocument(e),a=SD.to(t),o=await this._provider.provideReferences(i,a,n,r);if(Array.isArray(o))return o.map(qD.from)}},NB=class e{static{this._maxCodeActionsPerFile=1e3}constructor(e,t,n,r,i,a,o){this._documents=e,this._commands=t,this._diagnostics=n,this._provider=r,this._logService=i,this._extension=a,this._apiDeprecation=o,this._cache=new Iz(`CodeAction`),this._disposables=new Map}async provideCodeActions(t,n,r,i){let a=this._documents.getDocument(t),o=vB.isISelection(n)?yD.to(n):K.to(n),s=[];for(let n of this._diagnostics.getDiagnostics(t))if(o.intersection(n.range)){let t=s.push(n);if(t>e._maxCodeActionsPerFile)break}let c={diagnostics:s,only:r.only?new hx(r.only):void 0,triggerKind:GO.to(r.trigger)},l=await this._provider.provideCodeActions(a,o,c,i);if(!Ce(l)||i.isCancellationRequested)return;let u=this._cache.add(l),d=new v;this._disposables.set(u,d);let f=[];for(let t=0;t<l.length;t++){let n=l[t];if(n)if(e._isCommand(n)&&!(n instanceof mx))this._apiDeprecation.report(`CodeActionProvider.provideCodeActions - return commands`,this._extension,`Return 'CodeAction' instances instead.`),f.push({_isSynthetic:!0,title:n.title,command:this._commands.toInternal(n,d)});else{let e=n;c.only&&(e.kind?c.only.contains(e.kind)||this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${c.only.value}' requested but returned code action is of kind '${e.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`):this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${c.only.value}' requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`));let r=e.ranges??[];f.push({cacheId:[u,t],title:e.title,command:e.command&&this._commands.toInternal(e.command,d),diagnostics:e.diagnostics&&e.diagnostics.map(TD.from),edit:e.edit&&zD.from(e.edit,void 0),kind:e.kind&&e.kind.value,isPreferred:e.isPreferred,isAI:Hg(this._extension,`codeActionAI`)?e.isAI:!1,ranges:Hg(this._extension,`codeActionRanges`)?be(r.map(K.from)):void 0,disabled:e.disabled?.reason})}}return{cacheId:u,actions:f}}async resolveCodeAction(t,n){let[r,i]=t,a=this._cache.get(r,i);if(!a||e._isCommand(a)||!this._provider.resolveCodeAction)return{};let o=await this._provider.resolveCodeAction(a,n)??a,s;o.edit&&(s=zD.from(o.edit,void 0));let c;if(o.command){let e=this._disposables.get(r);e&&(c=this._commands.toInternal(o.command,e))}return{edit:s,command:c}}releaseCodeActions(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}static _isCommand(e){return typeof e.command==`string`&&typeof e.title==`string`}},PB=class{constructor(e,t,n,r,i){this._proxy=e,this._documents=t,this._provider=n,this._handle=r,this._extension=i,this._editsCache=new Iz(`DocumentPasteEdit.edits`)}async prepareDocumentPaste(e,t,n,r){if(!this._provider.prepareDocumentPaste)return;this._cachedPrepare=void 0;let i=this._documents.getDocument(e),a=t.map(e=>K.to(e)),o=YO.toDataTransfer(n,()=>{throw new de});if(await this._provider.prepareDocumentPaste(i,a,o,r),r.isCancellationRequested)return;let s=Array.from(o).filter(([,e])=>!(e instanceof kS)),c=new Map,l=await Promise.all(Array.from(s,async([e,t])=>{let n=Nc();return c.set(n,t),[e,await JO.from(e,t,n)]}));return this._cachedPrepare=c,{items:l}}async providePasteEdits(e,t,n,r,i,a){if(!this._provider.provideDocumentPasteEdits)return[];let o=this._documents.getDocument(t),s=n.map(e=>K.to(e)),c=r.items.map(([t,n])=>{let r=this._cachedPrepare?.get(n.id);return r?[t,r]:[t,JO.to(t,n,async t=>(await this._proxy.$resolvePasteFileData(this._handle,e,t)).buffer)]}),l=new MS(c),u=await this._provider.provideDocumentPasteEdits(o,s,l,{only:i.only?new FS(i.only):void 0,triggerKind:i.triggerKind},a);if(!u||a.isCancellationRequested)return[];let d=this._editsCache.add(u);return u.map((e,t)=>({_cacheId:[d,t],title:e.title??C(2625,`Paste using '{0}' extension`,this._extension.displayName||this._extension.name),kind:e.kind,yieldTo:e.yieldTo?.map(e=>e.value),insertText:typeof e.insertText==`string`?e.insertText:{snippet:e.insertText.value},additionalEdit:e.additionalEdit?zD.from(e.additionalEdit,void 0):void 0}))}async resolvePasteEdit(e,t){let[n,r]=e,i=this._editsCache.get(n,r);if(!i||!this._provider.resolveDocumentPasteEdit)return{};let a=await this._provider.resolveDocumentPasteEdit(i,t)??i;return{insertText:a.insertText,additionalEdit:a.additionalEdit?zD.from(a.additionalEdit,void 0):void 0}}releasePasteEdits(e){this._editsCache.delete(e)}},FB=class{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentFormattingEdits(e,t,n){let r=this._documents.getDocument(e),i=await this._provider.provideDocumentFormattingEdits(r,t,n);if(Array.isArray(i))return i.map(RD.from)}},IB=class{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeFormattingEdits(e,t,n,r){let i=this._documents.getDocument(e),a=K.to(t),o=await this._provider.provideDocumentRangeFormattingEdits(i,a,n,r);if(Array.isArray(o))return o.map(RD.from)}async provideDocumentRangesFormattingEdits(e,t,n,r){ot(typeof this._provider.provideDocumentRangesFormattingEdits==`function`,"INVALID invocation of `provideDocumentRangesFormattingEdits`");let i=this._documents.getDocument(e),a=t.map(K.to),o=await this._provider.provideDocumentRangesFormattingEdits(i,a,n,r);if(Array.isArray(o))return o.map(RD.from)}},LB=class{constructor(e,t){this._documents=e,this._provider=t,this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,t,n,r,i){let a=this._documents.getDocument(e),o=SD.to(t),s=await this._provider.provideOnTypeFormattingEdits(a,o,n,r,i);if(Array.isArray(s))return s.map(RD.from)}},RB=class{constructor(e,t){this._provider=e,this._logService=t,this._cache=new Iz(`WorkspaceSymbols`)}async provideWorkspaceSymbols(e,t){let n=await this._provider.provideWorkspaceSymbols(e,t);if(!Ce(n))return{symbols:[]};let r=this._cache.add(n),i={cacheId:r,symbols:[]};for(let e=0;e<n.length;e++){let t=n[e];if(!t||!t.name){this._logService.warn(`INVALID SymbolInformation`,t);continue}i.symbols.push({...HD.from(t),cacheId:[r,e]})}return i}async resolveWorkspaceSymbol(e,t){if(typeof this._provider.resolveWorkspaceSymbol!=`function`||!e.cacheId)return e;let n=this._cache.get(...e.cacheId);if(n){let r=await this._provider.resolveWorkspaceSymbol(n,t);return r&&ec(e,HD.from(r),!0)}}releaseWorkspaceSymbols(e){this._cache.delete(e)}},zB=class e{static supportsResolving(e){return typeof e.prepareRename==`function`}constructor(e,t,n){this._documents=e,this._provider=t,this._logService=n}async provideRenameEdits(t,n,r,i){let a=this._documents.getDocument(t),o=SD.to(n);try{let e=await this._provider.provideRenameEdits(a,o,r,i);return e?zD.from(e):void 0}catch(t){let n=e._asMessage(t);return n?{rejectReason:n,edits:void 0}:Promise.reject(t)}}async resolveRenameLocation(t,n,r){if(typeof this._provider.prepareRename!=`function`)return Promise.resolve(void 0);let i=this._documents.getDocument(t),a=SD.to(n);try{let e=await this._provider.prepareRename(i,a,r),t,n;if(Ib.isRange(e)?(t=e,n=i.getText(e)):$e(e)&&(t=e.range,n=e.placeholder),!t||!n)return;if(t.start.line>a.line||t.end.line<a.line){this._logService.warn(`INVALID rename location: position line must be within range start/end lines`);return}return{range:K.from(t),text:n}}catch(t){let n=e._asMessage(t);return n?{rejectReason:n,range:void 0,text:void 0}:Promise.reject(t)}}static _asMessage(e){if(typeof e==`string`)return e;if(e instanceof Error&&typeof e.message==`string`)return e.message}},BB=class e{static{this.languageTriggerKindToVSCodeTriggerKind={[Wp.Invoke]:sC.Invoke,[Wp.Automatic]:sC.Automatic}}constructor(e,t,n){this._documents=e,this._provider=t,this._logService=n}async supportsAutomaticNewSymbolNamesTriggerKind(){return this._provider.supportsAutomaticTriggerKind}async provideNewSymbolNames(t,n,r,i){let a=this._documents.getDocument(t),o=K.to(n);try{let t=e.languageTriggerKindToVSCodeTriggerKind[r],n=await this._provider.provideNewSymbolNames(a,o,t,i);return n?n.map(e=>typeof e==`string`?{newSymbolName:e}:{newSymbolName:e.newSymbolName,tags:e.tags}):void 0}catch(t){this._logService.error(e._asMessage(t)??JSON.stringify(t,null,`	`));return}}static _asMessage(e){if(typeof e==`string`)return e;if(e instanceof Error&&typeof e.message==`string`)return e.message}},VB=class{constructor(e,t){this.resultId=e,this.tokens=t}},HB=class e{constructor(e,t){this._documents=e,this._provider=t,this._nextResultId=1,this._previousResults=new Map}async provideDocumentSemanticTokens(t,n,r){let i=this._documents.getDocument(t),a=n===0?null:this._previousResults.get(n),o=typeof a?.resultId==`string`&&typeof this._provider.provideDocumentSemanticTokensEdits==`function`?await this._provider.provideDocumentSemanticTokensEdits(i,a.resultId,r):await this._provider.provideDocumentSemanticTokens(i,r);return a&&this._previousResults.delete(n),o?(o=e._fixProvidedSemanticTokens(o),this._send(e._convertToEdits(a,o),o)):null}async releaseDocumentSemanticColoring(e){this._previousResults.delete(e)}static _fixProvidedSemanticTokens(t){return e._isSemanticTokens(t)?e._isCorrectSemanticTokens(t)?t:new SC(new Uint32Array(t.data),t.resultId):e._isSemanticTokensEdits(t)?e._isCorrectSemanticTokensEdits(t)?t:new wC(t.edits.map(e=>new CC(e.start,e.deleteCount,e.data?new Uint32Array(e.data):e.data)),t.resultId):t}static _isSemanticTokens(e){return e&&!!e.data}static _isCorrectSemanticTokens(e){return e.data instanceof Uint32Array}static _isSemanticTokensEdits(e){return e&&Array.isArray(e.edits)}static _isCorrectSemanticTokensEdits(e){for(let t of e.edits)if(!(t.data instanceof Uint32Array))return!1;return!0}static _convertToEdits(t,n){if(!e._isSemanticTokens(n)||!t||!t.tokens)return n;let r=t.tokens,i=r.length,a=n.data,o=a.length,s=0,c=Math.min(i,o);for(;s<c&&r[s]===a[s];)s++;if(s===i&&s===o)return new wC([],n.resultId);let l=0,u=c-s;for(;l<u&&r[i-l-1]===a[o-l-1];)l++;return new wC([{start:s,deleteCount:i-s-l,data:a.subarray(s,o-l)}],n.resultId)}_send(t,n){if(e._isSemanticTokens(t)){let e=this._nextResultId++;return this._previousResults.set(e,new VB(t.resultId,t.data)),RR({id:e,type:`full`,data:t.data})}if(e._isSemanticTokensEdits(t)){let r=this._nextResultId++;return e._isSemanticTokens(n)?this._previousResults.set(r,new VB(n.resultId,n.data)):this._previousResults.set(r,new VB(t.resultId)),RR({id:r,type:`delta`,deltas:(t.edits||[]).map(e=>({start:e.start,deleteCount:e.deleteCount,data:e.data}))})}return null}},UB=class{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeSemanticTokens(e,t,n){let r=this._documents.getDocument(e),i=await this._provider.provideDocumentRangeSemanticTokens(r,K.to(t),n);return i?this._send(i):null}_send(e){return RR({id:0,type:`full`,data:e.data})}},WB=class e{static supportsResolving(e){return typeof e.resolveCompletionItem==`function`}constructor(e,t,n,r,i){this._documents=e,this._commands=t,this._provider=n,this._apiDeprecation=r,this._extension=i,this._cache=new Iz(`CompletionItem`),this._disposables=new Map}async provideCompletionItems(t,n,r,i){let a=this._documents.getDocument(t),o=SD.to(n),s=a.getWordRangeAtPosition(o)||new Ib(o,o),c=s.with({end:o}),l=new $t,u=await this._provider.provideCompletionItems(a,o,i,nO.to(r));if(!u||i.isCancellationRequested)return;let d=Array.isArray(u)?new Nx(u):u,f=e.supportsResolving(this._provider)?this._cache.add(d.items):this._cache.add([]),p=new v;this._disposables.set(f,p);let ee=[],m={x:f,[Ti.completions]:ee,[Ti.defaultRanges]:{replace:K.from(s),insert:K.from(c)},[Ti.isIncomplete]:d.isIncomplete||void 0,[Ti.duration]:l.elapsed()};for(let e=0;e<d.items.length;e++){let t=d.items[e],n=this._convertCompletionItem(t,[f,e],c,s);ee.push(n)}return m}async resolveCompletionItem(e,t){if(typeof this._provider.resolveCompletionItem!=`function`)return;let n=this._cache.get(...e);if(!n)return;let r=this._convertCompletionItem(n,e),i=await this._provider.resolveCompletionItem(n,t);if(!i)return;let a=this._convertCompletionItem(i,e);return(r[wi.insertText]!==a[wi.insertText]||r[wi.insertTextRules]!==a[wi.insertTextRules])&&this._apiDeprecation.report(`CompletionItem.insertText`,this._extension,`extension MAY NOT change 'insertText' of a CompletionItem during resolve`),(r[wi.commandIdent]!==a[wi.commandIdent]||r[wi.commandId]!==a[wi.commandId]||!tc(r[wi.commandArguments],a[wi.commandArguments]))&&this._apiDeprecation.report(`CompletionItem.command`,this._extension,`extension MAY NOT change 'command' of a CompletionItem during resolve`),{...r,[wi.documentation]:a[wi.documentation],[wi.detail]:a[wi.detail],[wi.additionalTextEdits]:a[wi.additionalTextEdits],[wi.insertText]:a[wi.insertText],[wi.insertTextRules]:a[wi.insertTextRules],[wi.commandIdent]:a[wi.commandIdent],[wi.commandId]:a[wi.commandId],[wi.commandArguments]:a[wi.commandArguments]}}releaseCompletionItems(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}_convertCompletionItem(e,t,n,r){let i=this._disposables.get(t[0]);if(!i)throw Error(`DisposableStore is missing...`);let a=this._commands.toInternal(e.command,i),o={x:t,[wi.label]:e.label,[wi.kind]:e.kind===void 0?void 0:aO.from(e.kind),[wi.kindModifier]:e.tags&&e.tags.map(rO.from),[wi.detail]:e.detail,[wi.documentation]:e.documentation===void 0?void 0:jD.fromStrict(e.documentation),[wi.sortText]:e.sortText===e.label?void 0:e.sortText,[wi.filterText]:e.filterText===e.label?void 0:e.filterText,[wi.preselect]:e.preselect||void 0,[wi.insertTextRules]:e.keepWhitespace?kp.KeepWhitespace:kp.None,[wi.commitCharacters]:e.commitCharacters?.join(``),[wi.additionalTextEdits]:e.additionalTextEdits&&e.additionalTextEdits.map(RD.from),[wi.commandIdent]:a?.$ident,[wi.commandId]:a?.id,[wi.commandArguments]:a?.$ident?void 0:a?.arguments};e.textEdit?(this._apiDeprecation.report(`CompletionItem.textEdit`,this._extension,`Use 'CompletionItem.insertText' and 'CompletionItem.range' instead.`),o[wi.insertText]=e.textEdit.newText):typeof e.insertText==`string`?o[wi.insertText]=e.insertText:e.insertText instanceof Zb&&(o[wi.insertText]=e.insertText.value,o[wi.insertTextRules]|=kp.InsertAsSnippet);let s;return e.textEdit?s=e.textEdit.range:e.range&&(s=e.range),Ib.isRange(s)?o[wi.range]=K.from(s):s&&(!n?.isEqual(s.inserting)||!r?.isEqual(s.replacing))&&(o[wi.range]={insert:K.from(s.inserting),replace:K.from(s.replacing)}),o}},GB=class{constructor(e,t,n,r){this._extension=e,this._documents=t,this._provider=n,this._commands=r,this._references=new KB,this.languageTriggerKindToVSCodeTriggerKind={[Mp.Automatic]:eC.Automatic,[Mp.Explicit]:eC.Invoke},this._isAdditionsProposedApiEnabled=Hg(this._extension,`inlineCompletionsAdditions`)}get supportsHandleEvents(){return Hg(this._extension,`inlineCompletionsAdditions`)&&(typeof this._provider.handleDidShowCompletionItem==`function`||typeof this._provider.handleDidPartiallyAcceptCompletionItem==`function`||typeof this._provider.handleDidRejectCompletionItem==`function`||typeof this._provider.handleEndOfLifetime==`function`)}async provideInlineCompletions(e,t,n,r){let i=this._documents.getDocument(e),a=SD.to(t),o=await this._provider.provideInlineCompletionItems(i,a,{selectedCompletionInfo:n.selectedSuggestionInfo?{range:K.to(n.selectedSuggestionInfo.range),text:n.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[n.triggerKind],requestUuid:n.requestUuid,requestIssuedDateTime:n.requestIssuedDateTime},r);if(!o)return;let{resultItems:s,list:c}=Array.isArray(o)?{resultItems:o,list:void 0}:{resultItems:o.items,list:o},l=this._isAdditionsProposedApiEnabled?Array.isArray(o)?[]:o.commands||[]:[],u=this._isAdditionsProposedApiEnabled&&!Array.isArray(o)?o.enableForwardStability:void 0,d,f=this._references.createReferenceId({dispose(){d?.dispose()},items:s,list:c});return{pid:f,items:s.map((e,t)=>{let n;e.command&&(d||=new v,n=this._commands.toInternal(e.command,d));let r;e.action&&(d||=new v,r=this._commands.toInternal(e.action,d));let i=e.insertText;return{insertText:typeof i==`string`?i:{snippet:i.value},filterText:e.filterText,range:e.range?K.from(e.range):void 0,showRange:this._isAdditionsProposedApiEnabled&&e.showRange?K.from(e.showRange):void 0,command:n,action:r,idx:t,completeBracketPairs:this._isAdditionsProposedApiEnabled?e.completeBracketPairs:!1,isInlineEdit:this._isAdditionsProposedApiEnabled?e.isInlineEdit:!1,showInlineEditMenu:this._isAdditionsProposedApiEnabled?e.showInlineEditMenu:!1,displayLocation:e.displayLocation&&this._isAdditionsProposedApiEnabled?{range:K.from(e.displayLocation.range),label:e.displayLocation.label}:void 0,warning:e.warning&&this._isAdditionsProposedApiEnabled?{message:jD.from(e.warning.message),icon:e.warning.icon?Uk.fromThemeIcon(e.warning.icon):void 0}:void 0}}),commands:l.map(e=>(d||=new v,iO.from(e,this._commands,d))),suppressSuggestions:!1,enableForwardStability:u}}disposeCompletions(e,t){let n=this._references.get(e);if(this._provider.handleListEndOfLifetime&&this._isAdditionsProposedApiEnabled&&n?.list){function e(e){switch(e.kind){case`lostRace`:return{kind:tC.LostRace};case`tokenCancellation`:return{kind:tC.TokenCancellation};case`other`:return{kind:tC.Other};case`empty`:return{kind:tC.Empty};case`notTaken`:return{kind:tC.NotTaken};default:return{kind:tC.Other}}}this._provider.handleListEndOfLifetime(n.list,e(t))}let r=this._references.disposeReferenceId(e);r?.dispose()}handleDidShowCompletionItem(e,t,n){let r=this._references.get(e)?.items[t];r&&this._provider.handleDidShowCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidShowCompletionItem(r,n)}handlePartialAccept(e,t,n,r){let i=this._references.get(e)?.items[t];i&&this._provider.handleDidPartiallyAcceptCompletionItem&&this._isAdditionsProposedApiEnabled&&(this._provider.handleDidPartiallyAcceptCompletionItem(i,n),this._provider.handleDidPartiallyAcceptCompletionItem(i,Ik.to(r)))}handleEndOfLifetime(e,t,n){let r=this._references.get(e)?.items[t];if(r&&this._provider.handleEndOfLifetime&&this._isAdditionsProposedApiEnabled){let e=Rk.to(n,e=>this._references.get(e.pid)?.items[e.idx]);this._provider.handleEndOfLifetime(r,e)}}handleRejection(e,t){let n=this._references.get(e)?.items[t];n&&this._provider.handleDidRejectCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidRejectCompletionItem(n)}},KB=class{constructor(){this._references=new Map,this._idPool=1}createReferenceId(e){let t=this._idPool++;return this._references.set(t,e),t}disposeReferenceId(e){let t=this._references.get(e);return this._references.delete(e),t}get(e){return this._references.get(e)}},qB=class{constructor(e,t){this._documents=e,this._provider=t,this._cache=new Iz(`SignatureHelp`)}async provideSignatureHelp(e,t,n,r){let i=this._documents.getDocument(e),a=SD.to(t),o=this.reviveContext(n),s=await this._provider.provideSignatureHelp(i,a,r,o);if(s){let e=this._cache.add([s]);return{...lO.from(s),id:e}}}reviveContext(e){let t;if(e.activeSignatureHelp){let n=lO.to(e.activeSignatureHelp),r=this._cache.get(e.activeSignatureHelp.id,0);r?(t=r,t.activeSignature=n.activeSignature,t.activeParameter=n.activeParameter):t=n}return{...e,activeSignatureHelp:t}}releaseSignatureHelp(e){this._cache.delete(e)}},JB=class{constructor(e,t,n,r,i){this._documents=e,this._commands=t,this._provider=n,this._logService=r,this._extension=i,this._cache=new Iz(`InlayHints`),this._disposables=new Map}async provideInlayHints(e,t,n){let r=this._documents.getDocument(e),i=K.to(t),a=await this._provider.provideInlayHints(r,i,n);if(!Array.isArray(a)||a.length===0){this._logService.trace(`[InlayHints] NO inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`);return}if(n.isCancellationRequested)return;let o=this._cache.add(a);this._disposables.set(o,new v);let s={hints:[],cacheId:o};for(let e=0;e<a.length;e++)this._isValidInlayHint(a[e],i)&&s.hints.push(this._convertInlayHint(a[e],[o,e]));return this._logService.trace(`[InlayHints] ${s.hints.length} inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`),s}async resolveInlayHint(e,t){if(typeof this._provider.resolveInlayHint!=`function`)return;let n=this._cache.get(...e);if(!n)return;let r=await this._provider.resolveInlayHint(n,t);if(r&&this._isValidInlayHint(r))return this._convertInlayHint(r,e)}releaseHints(e){this._disposables.get(e)?.dispose(),this._disposables.delete(e),this._cache.delete(e)}_isValidInlayHint(e,t){return e.label.length===0||Array.isArray(e.label)&&e.label.every(e=>e.value.length===0)?(console.log(`INVALID inlay hint, empty label`,e),!1):!(t&&!t.contains(e.position))}_convertInlayHint(e,t){let n=this._disposables.get(t[0]);if(!n)throw Error(`DisposableStore is missing...`);let r={label:``,cacheId:t,tooltip:jD.fromStrict(e.tooltip),position:SD.from(e.position),textEdits:e.textEdits&&e.textEdits.map(RD.from),kind:e.kind&&fO.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if(typeof e.label==`string`)r.label=e.label;else{let t=[];r.label=t;for(let r of e.label){if(!r.value){console.warn(`INVALID inlay hint, empty label part`,this._extension.identifier.value);continue}let e={label:r.value,tooltip:jD.fromStrict(r.tooltip)};ex.isLocation(r.location)&&(e.location=qD.from(r.location)),r.command&&(e.command=this._commands.toInternal(r.command,n)),t.push(e)}}return r}},YB=class e{constructor(e,t){this._documents=e,this._provider=t,this._cache=new Iz(`DocumentLink`)}async provideLinks(t,n){let r=this._documents.getDocument(t),i=await this._provider.provideDocumentLinks(r,n);if(!(!Array.isArray(i)||i.length===0)&&!n.isCancellationRequested){if(typeof this._provider.resolveDocumentLink!=`function`)return{links:i.filter(e._validateLink).map(pO.from)};{let t=this._cache.add(i),n={links:[],cacheId:t};for(let r=0;r<i.length;r++){if(!e._validateLink(i[r]))continue;let a=pO.from(i[r]);a.cacheId=[t,r],n.links.push(a)}return n}}}static _validateLink(e){return e.target&&e.target.path.length>5e4?(console.warn(`DROPPING link because it is too long`),!1):!0}async resolveLink(t,n){if(typeof this._provider.resolveDocumentLink!=`function`)return;let r=this._cache.get(...t);if(!r)return;let i=await this._provider.resolveDocumentLink(r,n);if(!(!i||!e._validateLink(i)))return pO.from(i)}releaseLinks(e){this._cache.delete(e)}},XB=class{constructor(e,t){this._documents=e,this._provider=t}async provideColors(e,t){let n=this._documents.getDocument(e),r=await this._provider.provideDocumentColors(n,t);if(!Array.isArray(r))return[];let i=r.map(e=>({color:hO.from(e.color),range:K.from(e.range)}));return i}async provideColorPresentations(e,t,n){let r=this._documents.getDocument(e),i=K.to(t.range),a=hO.to(t.color),o=await this._provider.provideColorPresentations(a,{document:r,range:i},n);if(Array.isArray(o))return o.map(mO.from)}},ZB=class{constructor(e,t){this._documents=e,this._provider=t}async provideFoldingRanges(e,t,n){let r=this._documents.getDocument(e),i=await this._provider.provideFoldingRanges(r,t,n);if(Array.isArray(i))return i.map(xO.from)}},QB=class{constructor(e,t,n){this._documents=e,this._provider=t,this._logService=n}async provideSelectionRanges(e,t,n){let r=this._documents.getDocument(e),i=t.map(SD.to),a=await this._provider.provideSelectionRanges(r,i,n);if(!Ce(a))return[];if(a.length!==i.length)return this._logService.warn(`BAD selection ranges, provider must return ranges for each position`),[];let o=[];for(let e=0;e<i.length;e++){let t=[];o.push(t);let n=i[e],r=a[e];for(;;){if(!r.range.contains(n))throw Error(`INVALID selection range, must contain the previous range`);if(t.push(gO.from(r)),!r.parent)break;n=r.range,r=r.parent}}return o}},$B=class{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new RF(``),this._cache=new Map}async prepareSession(e,t,n){let r=this._documents.getDocument(e),i=SD.to(t),a=await this._provider.prepareCallHierarchy(r,i,n);if(!a)return;let o=this._idPool.nextId();return this._cache.set(o,new Map),Array.isArray(a)?a.map(e=>this._cacheAndConvertItem(o,e)):[this._cacheAndConvertItem(o,a)]}async provideCallsTo(e,t,n){let r=this._itemFromCache(e,t);if(!r)throw Error(`missing call hierarchy item`);let i=await this._provider.provideCallHierarchyIncomingCalls(r,n);if(i)return i.map(t=>({from:this._cacheAndConvertItem(e,t.from),fromRanges:t.fromRanges.map(e=>K.from(e))}))}async provideCallsFrom(e,t,n){let r=this._itemFromCache(e,t);if(!r)throw Error(`missing call hierarchy item`);let i=await this._provider.provideCallHierarchyOutgoingCalls(r,n);if(i)return i.map(t=>({to:this._cacheAndConvertItem(e,t.to),fromRanges:t.fromRanges.map(e=>K.from(e))}))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){let n=this._cache.get(e),r=WD.from(t,e,n.size.toString(36));return n.set(r._itemId,t),r}_itemFromCache(e,t){let n=this._cache.get(e);return n?.get(t)}},eV=class{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new RF(``),this._cache=new Map}async prepareSession(e,t,n){let r=this._documents.getDocument(e),i=SD.to(t),a=await this._provider.prepareTypeHierarchy(r,i,n);if(!a)return;let o=this._idPool.nextId();return this._cache.set(o,new Map),Array.isArray(a)?a.map(e=>this._cacheAndConvertItem(o,e)):[this._cacheAndConvertItem(o,a)]}async provideSupertypes(e,t,n){let r=this._itemFromCache(e,t);if(!r)throw Error(`missing type hierarchy item`);let i=await this._provider.provideTypeHierarchySupertypes(r,n);if(i)return i.map(t=>this._cacheAndConvertItem(e,t))}async provideSubtypes(e,t,n){let r=this._itemFromCache(e,t);if(!r)throw Error(`missing type hierarchy item`);let i=await this._provider.provideTypeHierarchySubtypes(r,n);if(i)return i.map(t=>this._cacheAndConvertItem(e,t))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){let n=this._cache.get(e),r=KO.from(t,e,n.size.toString(36));return n.set(r._itemId,t),r}_itemFromCache(e,t){let n=this._cache.get(e);return n?.get(t)}},tV=class{constructor(e,t,n,r,i){this._proxy=e,this._documents=t,this._provider=n,this._handle=r,this._extension=i,this._cache=new Iz(`DocumentDropEdit`)}async provideDocumentOnDropEdits(e,t,n,r,i){let a=this._documents.getDocument(t),o=SD.to(n),s=YO.toDataTransfer(r,async t=>(await this._proxy.$resolveDocumentOnDropFileData(this._handle,e,t)).buffer),c=await this._provider.provideDocumentDropEdits(a,o,s,i);if(!c)return;let l=De(c),u=this._cache.add(l);return l.map((e,t)=>({_cacheId:[u,t],title:e.title??C(2626,`Drop using '{0}' extension`,this._extension.displayName||this._extension.name),kind:e.kind?.value,yieldTo:e.yieldTo?.map(e=>e.value),insertText:typeof e.insertText==`string`?e.insertText:{snippet:e.insertText.value},additionalEdit:e.additionalEdit?zD.from(e.additionalEdit,void 0):void 0}))}async resolveDropEdit(e,t){let[n,r]=e,i=this._cache.get(n,r);if(!i||!this._provider.resolveDocumentDropEdit)return{};let a=await this._provider.resolveDocumentDropEdit(i,t)??i,o=a.additionalEdit?zD.from(a.additionalEdit,void 0):void 0;return{additionalEdit:o}}releaseDropEdits(e){this._cache.delete(e)}},nV=class{constructor(e,t){this.adapter=e,this.extension=t}},rV=class e{static{this._handlePool=0}constructor(e,t,n,r,i,a,o,s){this._uriTransformer=t,this._documents=n,this._commands=r,this._diagnostics=i,this._logService=a,this._apiDeprecation=o,this._extensionTelemetry=s,this._adapter=new Map,this._proxy=e.getProxy(E.MainThreadLanguageFeatures)}_transformDocumentSelector(e,t){return CD.from(e,this._uriTransformer,t)}_createDisposable(e){return new Pb(()=>{this._adapter.delete(e),this._proxy.$unregister(e)})}_nextHandle(){return e._handlePool++}async _withAdapter(e,t,n,r,i,a=!1){let o=this._adapter.get(e);if(!o||!(o.adapter instanceof t))return r;let s=Date.now();a||this._logService.trace(`[${o.extension.identifier.value}] INVOKE provider '${n.toString().replace(/[\r\n]/g,``)}'`);let c=n(o.adapter,o.extension);return Promise.resolve(c).catch(e=>{ae(e)||(this._logService.error(`[${o.extension.identifier.value}] provider FAILED`),this._logService.error(e),this._extensionTelemetry.onExtensionError(o.extension.identifier,e))}).finally(()=>{a||this._logService.trace(`[${o.extension.identifier.value}] provider DONE after ${Date.now()-s}ms`)}),Oi.isCancellationToken(i)?lo(c,i):c}_addNewAdapter(e,t){let n=this._nextHandle();return this._adapter.set(n,new nV(e,t)),n}static _extLabel(e){return e.displayName||e.name}static _extId(e){return e.identifier.value}registerDocumentSymbolProvider(t,n,r,i){let a=this._addNewAdapter(new yB(this._documents,r),t),o=i&&i.label||e._extLabel(t);return this._proxy.$registerDocumentSymbolProvider(a,this._transformDocumentSelector(n,t),o),this._createDisposable(a)}$provideDocumentSymbols(e,t,n){return this._withAdapter(e,yB,e=>e.provideDocumentSymbols(w.revive(t),n),void 0,n)}registerCodeLensProvider(e,t,n){let r=this._nextHandle(),i=typeof n.onDidChangeCodeLenses==`function`?this._nextHandle():void 0;this._adapter.set(r,new nV(new bB(this._documents,this._commands.converter,n,e,this._extensionTelemetry,this._logService),e)),this._proxy.$registerCodeLensSupport(r,this._transformDocumentSelector(t,e),i);let a=this._createDisposable(r);if(i!==void 0){let e=n.onDidChangeCodeLenses(e=>this._proxy.$emitCodeLensEvent(i));a=Pb.from(a,e)}return a}$provideCodeLenses(e,t,n){return this._withAdapter(e,bB,e=>e.provideCodeLenses(w.revive(t),n),void 0,n,t.scheme===`output`)}$resolveCodeLens(e,t,n){return this._withAdapter(e,bB,e=>e.resolveCodeLens(t,n),void 0,void 0,!0)}$releaseCodeLenses(e,t){this._withAdapter(e,bB,e=>Promise.resolve(e.releaseCodeLenses(t)),void 0,void 0,!0)}registerDefinitionProvider(e,t,n){let r=this._addNewAdapter(new SB(this._documents,n),e);return this._proxy.$registerDefinitionSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDefinition(e,t,n,r){return this._withAdapter(e,SB,e=>e.provideDefinition(w.revive(t),n,r),[],r)}registerDeclarationProvider(e,t,n){let r=this._addNewAdapter(new CB(this._documents,n),e);return this._proxy.$registerDeclarationSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDeclaration(e,t,n,r){return this._withAdapter(e,CB,e=>e.provideDeclaration(w.revive(t),n,r),[],r)}registerImplementationProvider(e,t,n){let r=this._addNewAdapter(new wB(this._documents,n),e);return this._proxy.$registerImplementationSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideImplementation(e,t,n,r){return this._withAdapter(e,wB,e=>e.provideImplementation(w.revive(t),n,r),[],r)}registerTypeDefinitionProvider(e,t,n){let r=this._addNewAdapter(new TB(this._documents,n),e);return this._proxy.$registerTypeDefinitionSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideTypeDefinition(e,t,n,r){return this._withAdapter(e,TB,e=>e.provideTypeDefinition(w.revive(t),n,r),[],r)}registerHoverProvider(e,t,n,r){let i=this._addNewAdapter(new EB(this._documents,n),e);return this._proxy.$registerHoverProvider(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$provideHover(e,t,n,r,i){return this._withAdapter(e,EB,e=>e.provideHover(w.revive(t),n,r,i),void 0,i)}$releaseHover(e,t){this._withAdapter(e,EB,e=>Promise.resolve(e.releaseHover(t)),void 0,void 0)}registerEvaluatableExpressionProvider(e,t,n,r){let i=this._addNewAdapter(new DB(this._documents,n),e);return this._proxy.$registerEvaluatableExpressionProvider(i,this._transformDocumentSelector(t,e)),this._createDisposable(i)}$provideEvaluatableExpression(e,t,n,r){return this._withAdapter(e,DB,e=>e.provideEvaluatableExpression(w.revive(t),n,r),void 0,r)}registerInlineValuesProvider(e,t,n,r){let i=typeof n.onDidChangeInlineValues==`function`?this._nextHandle():void 0,a=this._addNewAdapter(new OB(this._documents,n),e);this._proxy.$registerInlineValuesProvider(a,this._transformDocumentSelector(t,e),i);let o=this._createDisposable(a);if(i!==void 0){let e=n.onDidChangeInlineValues(e=>this._proxy.$emitInlineValuesEvent(i));o=Pb.from(o,e)}return o}$provideInlineValues(e,t,n,r,i){return this._withAdapter(e,OB,e=>e.provideInlineValues(w.revive(t),n,r,i),void 0,i)}registerDocumentHighlightProvider(e,t,n){let r=this._addNewAdapter(new kB(this._documents,n),e);return this._proxy.$registerDocumentHighlightProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}registerMultiDocumentHighlightProvider(e,t,n){let r=this._addNewAdapter(new AB(this._documents,n,this._logService),e);return this._proxy.$registerMultiDocumentHighlightProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDocumentHighlights(e,t,n,r){return this._withAdapter(e,kB,e=>e.provideDocumentHighlights(w.revive(t),n,r),void 0,r)}$provideMultiDocumentHighlights(e,t,n,r,i){return this._withAdapter(e,AB,e=>e.provideMultiDocumentHighlights(w.revive(t),n,r.map(e=>w.revive(e)),i),void 0,i)}registerLinkedEditingRangeProvider(e,t,n){let r=this._addNewAdapter(new jB(this._documents,n),e);return this._proxy.$registerLinkedEditingRangeProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideLinkedEditingRanges(t,n,r,i){return this._withAdapter(t,jB,async t=>{let a=await t.provideLinkedEditingRanges(w.revive(n),r,i);if(a)return{ranges:a.ranges,wordPattern:a.wordPattern?e._serializeRegExp(a.wordPattern):void 0}},void 0,i)}registerReferenceProvider(e,t,n){let r=this._addNewAdapter(new MB(this._documents,n),e);return this._proxy.$registerReferenceSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideReferences(e,t,n,r,i){return this._withAdapter(e,MB,e=>e.provideReferences(w.revive(t),n,r,i),void 0,i)}registerCodeActionProvider(t,n,r,i){let a=new v,o=this._addNewAdapter(new NB(this._documents,this._commands.converter,this._diagnostics,r,this._logService,t,this._apiDeprecation),t);return this._proxy.$registerCodeActionSupport(o,this._transformDocumentSelector(n,t),{providedKinds:i?.providedCodeActionKinds?.map(e=>e.value),documentation:i?.documentation?.map(e=>({kind:e.kind.value,command:this._commands.converter.toInternal(e.command,a)}))},e._extLabel(t),e._extId(t),!!r.resolveCodeAction),a.add(this._createDisposable(o)),a}$provideCodeActions(e,t,n,r,i){return this._withAdapter(e,NB,e=>e.provideCodeActions(w.revive(t),n,r,i),void 0,i)}$resolveCodeAction(e,t,n){return this._withAdapter(e,NB,e=>e.resolveCodeAction(t,n),{},void 0)}$releaseCodeActions(e,t){this._withAdapter(e,NB,e=>Promise.resolve(e.releaseCodeActions(t)),void 0,void 0)}registerDocumentFormattingEditProvider(e,t,n){let r=this._addNewAdapter(new FB(this._documents,n),e);return this._proxy.$registerDocumentFormattingSupport(r,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name),this._createDisposable(r)}$provideDocumentFormattingEdits(e,t,n,r){return this._withAdapter(e,FB,e=>e.provideDocumentFormattingEdits(w.revive(t),n,r),void 0,r)}registerDocumentRangeFormattingEditProvider(e,t,n){let r=typeof n.provideDocumentRangesFormattingEdits==`function`,i=this._addNewAdapter(new IB(this._documents,n),e);return this._proxy.$registerRangeFormattingSupport(i,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name,r),this._createDisposable(i)}$provideDocumentRangeFormattingEdits(e,t,n,r,i){return this._withAdapter(e,IB,e=>e.provideDocumentRangeFormattingEdits(w.revive(t),n,r,i),void 0,i)}$provideDocumentRangesFormattingEdits(e,t,n,r,i){return this._withAdapter(e,IB,e=>e.provideDocumentRangesFormattingEdits(w.revive(t),n,r,i),void 0,i)}registerOnTypeFormattingEditProvider(e,t,n,r){let i=this._addNewAdapter(new LB(this._documents,n),e);return this._proxy.$registerOnTypeFormattingSupport(i,this._transformDocumentSelector(t,e),r,e.identifier),this._createDisposable(i)}$provideOnTypeFormattingEdits(e,t,n,r,i,a){return this._withAdapter(e,LB,e=>e.provideOnTypeFormattingEdits(w.revive(t),n,r,i,a),void 0,a)}registerWorkspaceSymbolProvider(e,t){let n=this._addNewAdapter(new RB(t,this._logService),e);return this._proxy.$registerNavigateTypeSupport(n,typeof t.resolveWorkspaceSymbol==`function`),this._createDisposable(n)}$provideWorkspaceSymbols(e,t,n){return this._withAdapter(e,RB,e=>e.provideWorkspaceSymbols(t,n),{symbols:[]},n)}$resolveWorkspaceSymbol(e,t,n){return this._withAdapter(e,RB,e=>e.resolveWorkspaceSymbol(t,n),void 0,void 0)}$releaseWorkspaceSymbols(e,t){this._withAdapter(e,RB,e=>e.releaseWorkspaceSymbols(t),void 0,void 0)}registerRenameProvider(e,t,n){let r=this._addNewAdapter(new zB(this._documents,n,this._logService),e);return this._proxy.$registerRenameSupport(r,this._transformDocumentSelector(t,e),zB.supportsResolving(n)),this._createDisposable(r)}$provideRenameEdits(e,t,n,r,i){return this._withAdapter(e,zB,e=>e.provideRenameEdits(w.revive(t),n,r,i),void 0,i)}$resolveRenameLocation(e,t,n,r){return this._withAdapter(e,zB,e=>e.resolveRenameLocation(w.revive(t),n,r),void 0,r)}registerNewSymbolNamesProvider(e,t,n){let r=this._addNewAdapter(new BB(this._documents,n,this._logService),e);return this._proxy.$registerNewSymbolNamesProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$supportsAutomaticNewSymbolNamesTriggerKind(e){return this._withAdapter(e,BB,e=>e.supportsAutomaticNewSymbolNamesTriggerKind(),!1,void 0)}$provideNewSymbolNames(e,t,n,r,i){return this._withAdapter(e,BB,e=>e.provideNewSymbolNames(w.revive(t),n,r,i),void 0,i)}registerDocumentSemanticTokensProvider(e,t,n,r){let i=this._addNewAdapter(new HB(this._documents,n),e),a=typeof n.onDidChangeSemanticTokens==`function`?this._nextHandle():void 0;this._proxy.$registerDocumentSemanticTokensProvider(i,this._transformDocumentSelector(t,e),r,a);let o=this._createDisposable(i);if(a){let e=n.onDidChangeSemanticTokens(e=>this._proxy.$emitDocumentSemanticTokensEvent(a));o=Pb.from(o,e)}return o}$provideDocumentSemanticTokens(e,t,n,r){return this._withAdapter(e,HB,e=>e.provideDocumentSemanticTokens(w.revive(t),n,r),null,r)}$releaseDocumentSemanticTokens(e,t){this._withAdapter(e,HB,e=>e.releaseDocumentSemanticColoring(t),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(e,t,n,r){let i=this._addNewAdapter(new UB(this._documents,n),e);return this._proxy.$registerDocumentRangeSemanticTokensProvider(i,this._transformDocumentSelector(t,e),r),this._createDisposable(i)}$provideDocumentRangeSemanticTokens(e,t,n,r){return this._withAdapter(e,UB,e=>e.provideDocumentRangeSemanticTokens(w.revive(t),n,r),null,r)}registerCompletionItemProvider(e,t,n,r){let i=this._addNewAdapter(new WB(this._documents,this._commands.converter,n,this._apiDeprecation,e),e);return this._proxy.$registerCompletionsProvider(i,this._transformDocumentSelector(t,e),r,WB.supportsResolving(n),e.identifier),this._createDisposable(i)}$provideCompletionItems(e,t,n,r,i){return this._withAdapter(e,WB,e=>e.provideCompletionItems(w.revive(t),n,r,i),void 0,i)}$resolveCompletionItem(e,t,n){return this._withAdapter(e,WB,e=>e.resolveCompletionItem(t,n),void 0,n)}$releaseCompletionItems(e,t){this._withAdapter(e,WB,e=>e.releaseCompletionItems(t),void 0,void 0)}registerInlineCompletionsProvider(e,t,n,r){let i=typeof n.onDidChange==`function`&&Hg(e,`inlineCompletionsAdditions`)?this._nextHandle():void 0,a=new GB(e,this._documents,n,this._commands.converter),o=this._addNewAdapter(a,e),s=this._createDisposable(o);if(i!==void 0){let e=n.onDidChange(e=>this._proxy.$emitInlineCompletionsChange(i));s=Pb.from(s,e)}return this._proxy.$registerInlineCompletionsSupport(o,this._transformDocumentSelector(t,e),a.supportsHandleEvents,ms.toKey(e.identifier.value),e.version,r?.groupId?ms.toKey(r.groupId):void 0,r?.yieldTo?.map(e=>ms.toKey(e))||[],r?.displayName,r?.debounceDelayMs,i),s}$provideInlineCompletions(e,t,n,r,i){return this._withAdapter(e,GB,e=>e.provideInlineCompletions(w.revive(t),n,r,i),void 0,void 0)}$handleInlineCompletionDidShow(e,t,n,r){this._withAdapter(e,GB,async e=>{e.handleDidShowCompletionItem(t,n,r)},void 0,void 0)}$handleInlineCompletionPartialAccept(e,t,n,r,i){this._withAdapter(e,GB,async e=>{e.handlePartialAccept(t,n,r,i)},void 0,void 0)}$handleInlineCompletionEndOfLifetime(e,t,n,r){this._withAdapter(e,GB,async e=>{e.handleEndOfLifetime(t,n,r)},void 0,void 0)}$handleInlineCompletionRejection(e,t,n){this._withAdapter(e,GB,async e=>{e.handleRejection(t,n)},void 0,void 0)}$freeInlineCompletionsList(e,t,n){this._withAdapter(e,GB,async e=>{e.disposeCompletions(t,n)},void 0,void 0)}registerSignatureHelpProvider(e,t,n,r){let i=Array.isArray(r)?{triggerCharacters:r,retriggerCharacters:[]}:r,a=this._addNewAdapter(new qB(this._documents,n),e);return this._proxy.$registerSignatureHelpProvider(a,this._transformDocumentSelector(t,e),i),this._createDisposable(a)}$provideSignatureHelp(e,t,n,r,i){return this._withAdapter(e,qB,e=>e.provideSignatureHelp(w.revive(t),n,r,i),void 0,i)}$releaseSignatureHelp(e,t){this._withAdapter(e,qB,e=>e.releaseSignatureHelp(t),void 0,void 0)}registerInlayHintsProvider(t,n,r){let i=typeof r.onDidChangeInlayHints==`function`?this._nextHandle():void 0,a=this._addNewAdapter(new JB(this._documents,this._commands.converter,r,this._logService,t),t);this._proxy.$registerInlayHintsProvider(a,this._transformDocumentSelector(n,t),typeof r.resolveInlayHint==`function`,i,e._extLabel(t));let o=this._createDisposable(a);if(i!==void 0){let e=r.onDidChangeInlayHints(e=>this._proxy.$emitInlayHintsEvent(i));o=Pb.from(o,e)}return o}$provideInlayHints(e,t,n,r){return this._withAdapter(e,JB,e=>e.provideInlayHints(w.revive(t),n,r),void 0,r)}$resolveInlayHint(e,t,n){return this._withAdapter(e,JB,e=>e.resolveInlayHint(t,n),void 0,n)}$releaseInlayHints(e,t){this._withAdapter(e,JB,e=>e.releaseHints(t),void 0,void 0)}registerDocumentLinkProvider(e,t,n){let r=this._addNewAdapter(new YB(this._documents,n),e);return this._proxy.$registerDocumentLinkProvider(r,this._transformDocumentSelector(t,e),typeof n.resolveDocumentLink==`function`),this._createDisposable(r)}$provideDocumentLinks(e,t,n){return this._withAdapter(e,YB,e=>e.provideLinks(w.revive(t),n),void 0,n,t.scheme===`output`)}$resolveDocumentLink(e,t,n){return this._withAdapter(e,YB,e=>e.resolveLink(t,n),void 0,void 0,!0)}$releaseDocumentLinks(e,t){this._withAdapter(e,YB,e=>e.releaseLinks(t),void 0,void 0,!0)}registerColorProvider(e,t,n){let r=this._addNewAdapter(new XB(this._documents,n),e);return this._proxy.$registerDocumentColorProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDocumentColors(e,t,n){return this._withAdapter(e,XB,e=>e.provideColors(w.revive(t),n),[],n)}$provideColorPresentations(e,t,n,r){return this._withAdapter(e,XB,e=>e.provideColorPresentations(w.revive(t),n,r),void 0,r)}registerFoldingRangeProvider(e,t,n){let r=this._nextHandle(),i=typeof n.onDidChangeFoldingRanges==`function`?this._nextHandle():void 0;this._adapter.set(r,new nV(new ZB(this._documents,n),e)),this._proxy.$registerFoldingRangeProvider(r,this._transformDocumentSelector(t,e),e.identifier,i);let a=this._createDisposable(r);if(i!==void 0){let e=n.onDidChangeFoldingRanges(()=>this._proxy.$emitFoldingRangeEvent(i));a=Pb.from(a,e)}return a}$provideFoldingRanges(e,t,n,r){return this._withAdapter(e,ZB,e=>e.provideFoldingRanges(w.revive(t),n,r),void 0,r)}registerSelectionRangeProvider(e,t,n){let r=this._addNewAdapter(new QB(this._documents,n,this._logService),e);return this._proxy.$registerSelectionRangeProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideSelectionRanges(e,t,n,r){return this._withAdapter(e,QB,e=>e.provideSelectionRanges(w.revive(t),n,r),[],r)}registerCallHierarchyProvider(e,t,n){let r=this._addNewAdapter(new $B(this._documents,n),e);return this._proxy.$registerCallHierarchyProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$prepareCallHierarchy(e,t,n,r){return this._withAdapter(e,$B,e=>Promise.resolve(e.prepareSession(w.revive(t),n,r)),void 0,r)}$provideCallHierarchyIncomingCalls(e,t,n,r){return this._withAdapter(e,$B,e=>e.provideCallsTo(t,n,r),void 0,r)}$provideCallHierarchyOutgoingCalls(e,t,n,r){return this._withAdapter(e,$B,e=>e.provideCallsFrom(t,n,r),void 0,r)}$releaseCallHierarchy(e,t){this._withAdapter(e,$B,e=>Promise.resolve(e.releaseSession(t)),void 0,void 0)}registerTypeHierarchyProvider(e,t,n){let r=this._addNewAdapter(new eV(this._documents,n),e);return this._proxy.$registerTypeHierarchyProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$prepareTypeHierarchy(e,t,n,r){return this._withAdapter(e,eV,e=>Promise.resolve(e.prepareSession(w.revive(t),n,r)),void 0,r)}$provideTypeHierarchySupertypes(e,t,n,r){return this._withAdapter(e,eV,e=>e.provideSupertypes(t,n,r),void 0,r)}$provideTypeHierarchySubtypes(e,t,n,r){return this._withAdapter(e,eV,e=>e.provideSubtypes(t,n,r),void 0,r)}$releaseTypeHierarchy(e,t){this._withAdapter(e,eV,e=>Promise.resolve(e.releaseSession(t)),void 0,void 0)}registerDocumentOnDropEditProvider(e,t,n,r){let i=this._nextHandle();return this._adapter.set(i,new nV(new tV(this._proxy,this._documents,n,i,e),e)),this._proxy.$registerDocumentOnDropEditProvider(i,this._transformDocumentSelector(t,e),r?{supportsResolve:!!n.resolveDocumentDropEdit,dropMimeTypes:r.dropMimeTypes,providedDropKinds:r.providedDropEditKinds?.map(e=>e.value)}:void 0),this._createDisposable(i)}$provideDocumentOnDropEdits(e,t,n,r,i,a){return this._withAdapter(e,tV,e=>Promise.resolve(e.provideDocumentOnDropEdits(t,w.revive(n),r,i,a)),void 0,void 0)}$resolveDropEdit(e,t,n){return this._withAdapter(e,tV,e=>e.resolveDropEdit(t,n),{},void 0)}$releaseDocumentOnDropEdits(e,t){this._withAdapter(e,tV,e=>Promise.resolve(e.releaseDropEdits(t)),void 0,void 0)}registerDocumentPasteEditProvider(e,t,n,r){let i=this._nextHandle();return this._adapter.set(i,new nV(new PB(this._proxy,this._documents,n,i,e),e)),this._proxy.$registerPasteEditProvider(i,this._transformDocumentSelector(t,e),{supportsCopy:!!n.prepareDocumentPaste,supportsPaste:!!n.provideDocumentPasteEdits,supportsResolve:!!n.resolveDocumentPasteEdit,providedPasteEditKinds:r.providedPasteEditKinds?.map(e=>e.value),copyMimeTypes:r.copyMimeTypes,pasteMimeTypes:r.pasteMimeTypes}),this._createDisposable(i)}$prepareDocumentPaste(e,t,n,r,i){return this._withAdapter(e,PB,e=>e.prepareDocumentPaste(w.revive(t),n,r,i),void 0,i)}$providePasteEdits(e,t,n,r,i,a,o){return this._withAdapter(e,PB,e=>e.providePasteEdits(t,w.revive(n),r,i,a,o),void 0,o)}$resolvePasteEdit(e,t,n){return this._withAdapter(e,PB,e=>e.resolvePasteEdit(t,n),{},void 0)}$releasePasteEdits(e,t){this._withAdapter(e,PB,e=>Promise.resolve(e.releasePasteEdits(t)),void 0,void 0)}static _serializeRegExp(e){return{pattern:e.source,flags:e.flags}}static _serializeIndentationRule(t){return{decreaseIndentPattern:e._serializeRegExp(t.decreaseIndentPattern),increaseIndentPattern:e._serializeRegExp(t.increaseIndentPattern),indentNextLinePattern:t.indentNextLinePattern?e._serializeRegExp(t.indentNextLinePattern):void 0,unIndentedLinePattern:t.unIndentedLinePattern?e._serializeRegExp(t.unIndentedLinePattern):void 0}}static _serializeOnEnterRule(t){return{beforeText:e._serializeRegExp(t.beforeText),afterText:t.afterText?e._serializeRegExp(t.afterText):void 0,previousLineText:t.previousLineText?e._serializeRegExp(t.previousLineText):void 0,action:t.action}}static _serializeOnEnterRules(t){return t.map(e._serializeOnEnterRule)}static _serializeAutoClosingPair(e){return{open:e.open,close:e.close,notIn:e.notIn?e.notIn.map(e=>Jx.toString(e)):void 0}}static _serializeAutoClosingPairs(t){return t.map(e._serializeAutoClosingPair)}setLanguageConfiguration(t,n,r){let{wordPattern:i}=r;if(i&&Wi(i))throw Error(`Invalid language configuration: wordPattern '${i}' is not allowed to match the empty string.`);i?this._documents.setWordDefinitionFor(n,i):this._documents.setWordDefinitionFor(n,void 0),r.__electricCharacterSupport&&this._apiDeprecation.report(`LanguageConfiguration.__electricCharacterSupport`,t,`Do not use.`),r.__characterPairSupport&&this._apiDeprecation.report(`LanguageConfiguration.__characterPairSupport`,t,`Do not use.`);let a=this._nextHandle(),o={comments:r.comments,brackets:r.brackets,wordPattern:r.wordPattern?e._serializeRegExp(r.wordPattern):void 0,indentationRules:r.indentationRules?e._serializeIndentationRule(r.indentationRules):void 0,onEnterRules:r.onEnterRules?e._serializeOnEnterRules(r.onEnterRules):void 0,__electricCharacterSupport:r.__electricCharacterSupport,__characterPairSupport:r.__characterPairSupport,autoClosingPairs:r.autoClosingPairs?e._serializeAutoClosingPairs(r.autoClosingPairs):void 0};return this._proxy.$setLanguageConfiguration(a,n,o),this._createDisposable(a)}$setWordDefinitions(e){for(let t of e)this._documents.setWordDefinitionFor(t.languageId,new RegExp(t.regexSource,t.regexFlags))}};Symbol.iterator,Symbol.toStringTag;var iV;(function(e){e.Internal={type:`internal`,label:`Built-In`};function t(e){switch(e.type){case`extension`:return`extension:${e.extensionId.value}`;case`mcp`:return`mcp:${e.collectionId}:${e.definitionId}`;case`user`:return`user:${e.file.toString()}`;case`internal`:return`internal`}}e.toKey=t;function n(e,n){return t(e)===t(n)}e.equals=n;function r(e){return e.type===`internal`?{ordinal:1,label:C(5425,`Built-In`)}:e.type===`mcp`?{ordinal:2,label:C(5426,`MCP Server: {0}`,e.label)}:e.type===`user`?{ordinal:0,label:C(5427,`User Defined`)}:{ordinal:3,label:C(5428,`Extension: {0}`,e.label)}}e.classify=r})(iV||={});function aV(e){return typeof e==`object`&&typeof e.sessionId==`string`}const oV=k(`notebookService`),sV=k(`codeMapperService`),cV=k(`IChatService`),lV=`vscode_editFile`,uV=`vscode_editFile_internal`,dV={id:uV,displayName:``,modelDescription:``,source:iV.Internal};let fV=class{constructor(e,t,n){this.chatService=e,this.codeMapperService=t,this.notebookService=n}async invoke(e,t,n,r){if(!e.context)throw Error(`toolInvocationToken is required for this tool`);let i=e.parameters,a=w.revive(i.uri),o=Zv.parse(a)?.notebook||a,s=this.chatService.getSession(e.context?.sessionId),c=s.getRequests().at(-1);s.acceptResponseProgress(c,{kind:`markdownContent`,content:new _l("\n````\n")}),s.acceptResponseProgress(c,{kind:`codeblockUri`,uri:o,isEdit:!0}),s.acceptResponseProgress(c,{kind:`markdownContent`,content:new _l("\n````\n")}),this.notebookService.hasSupportedNotebooks(o)&&this.notebookService.getNotebookTextModel(o)?s.acceptResponseProgress(c,{kind:`notebookEdit`,edits:[],uri:o}):s.acceptResponseProgress(c,{kind:`textEdit`,edits:[],uri:o});let l=s.editingSession;if(!l)throw Error(`This tool must be called from within an editing session`);let u=await this.codeMapperService.mapCode({codeBlocks:[{code:i.code,resource:o,markdownBeforeBlock:i.explanation}],location:`tool`,chatRequestId:e.chatRequestId,chatRequestModel:e.modelId,chatSessionId:e.context.sessionId},{textEdit:(e,t)=>{s.acceptResponseProgress(c,{kind:`textEdit`,uri:e,edits:t})},notebookEdit(e,t){s.acceptResponseProgress(c,{kind:`notebookEdit`,uri:e,edits:t})}},r);if(this.notebookService.hasSupportedNotebooks(o)&&this.notebookService.getNotebookTextModel(o)?s.acceptResponseProgress(c,{kind:`notebookEdit`,uri:o,edits:[],done:!0}):s.acceptResponseProgress(c,{kind:`textEdit`,uri:o,edits:[],done:!0}),u?.errorMessage)throw Error(u.errorMessage);let d;return await new Promise(e=>{let t=!1;d=xE(n=>{let r=l.entries.read(n),i=r?.find(e=>e.modifiedURI.toString()===o.toString());i&&(i.isCurrentlyBeingModifiedBy.read(n)?t=!0:t&&e(!0))})}).finally(()=>{d.dispose()}),{content:[{kind:`text`,value:`The file was edited successfully`}]}}async prepareToolInvocation(e,t){return{presentation:`hidden`}}};fV=A([j(0,cV),j(1,sV),j(2,oV)],fV);const pV=k(`ILanguageModelToolsService`),mV=k(`chatTodoListService`),hV={id:`manage_todo_list`,toolReferenceName:`todos`,when:Td.equals(`config.chat.todoListTool.enabled`,!0),canBeReferencedInPrompt:!0,icon:fl.fromId(P.checklist.id),displayName:`Update Todo List`,userDescription:`Manage and track todo items for task planning`,modelDescription:`Manage a structured todo list to track progress and plan tasks throughout your coding session. Use this tool VERY frequently to ensure task visibility and proper planning.

When to use this tool:
- Complex multi-step work requiring planning and tracking
- When user provides multiple tasks or requests (numbered/comma-separated)
- After receiving new instructions that require multiple steps
- BEFORE starting work on any todo (mark as in-progress)
- IMMEDIATELY after completing each todo (mark completed individually)
- When breaking down larger tasks into smaller actionable steps
- To give users visibility into your progress and planning

When NOT to use:
- Single, trivial tasks that can be completed in one step
- Purely conversational/informational requests
- When just reading files or performing simple searches

CRITICAL workflow:
1. Plan tasks by writing todo list with specific, actionable items
2. Mark ONE todo as in-progress before starting work
3. Complete the work for that specific todo
4. Mark that todo as completed IMMEDIATELY
5. Move to next todo and repeat

Todo states:
- not-started: Todo not yet begun
- in-progress: Currently working (limit ONE at a time)
- completed: Finished successfully

IMPORTANT: Mark todos completed as soon as they are done. Do not batch completions.`,source:iV.Internal,inputSchema:{type:`object`,properties:{operation:{type:`string`,enum:[`write`,`read`],description:`write: Replace entire todo list with new content. read: Retrieve current todo list. ALWAYS provide complete list when writing - partial updates not supported.`},todoList:{type:`array`,description:`Complete array of all todo items (required for write operation, ignored for read). Must include ALL items - both existing and new.`,items:{type:`object`,properties:{id:{type:`number`,description:`Unique identifier for the todo. Use sequential numbers starting from 1.`},title:{type:`string`,description:`Concise action-oriented todo label (3-7 words). Displayed in UI.`},description:{type:`string`,description:`Detailed context, requirements, or implementation notes. Include file paths, specific methods, or acceptance criteria.`},status:{type:`string`,enum:[`not-started`,`in-progress`,`completed`],description:`not-started: Not begun | in-progress: Currently working (max 1) | completed: Fully finished with no blockers`}},required:[`id`,`title`,`description`,`status`]}}},required:[`operation`]}};let gV=class extends y{constructor(e,t){super(),this.chatTodoListService=e,this.logService=t}async invoke(e,t,n,r){let i=e.context?.sessionId;if(i===void 0)throw Error(`A chat session ID is required for this tool`);let a=e.parameters;this.logService.debug(`ManageTodoListTool: Invoking with options ${JSON.stringify(a)}`);try{let e=this.chatTodoListService.getChatTodoListStorage();switch(a.operation){case`read`:{let t=this.handleRead(e,i);return{content:[{kind:`text`,value:t}]}}case`write`:{let t=a.todoList.map(e=>({id:e.id,title:e.title,description:e.description,status:e.status}));return e.setTodoList(i,t),{content:[{kind:`text`,value:`Successfully wrote todo list`}]}}default:return{content:[{kind:`text`,value:`Error: Unknown operation`}]}}}catch(e){let t=`Error: ${e instanceof Error?e.message:`Unknown error`}`;return{content:[{kind:`text`,value:t}]}}}async prepareToolInvocation(e,t){if(!e.chatSessionId)throw Error(`chatSessionId undefined`);let n=this.chatTodoListService.getChatTodoListStorage(),r=n.getTodoList(e.chatSessionId),i=e.parameters,a;switch(i.operation){case`write`:i.todoList&&(a=this.generatePastTenseMessage(r,i.todoList));break;case`read`:a=`Read todo list`;break}let o=i.todoList??r,s=o.map(e=>({id:e.id.toString(),title:e.title,description:e.description,status:e.status}));return{pastTenseMessage:new _l(a??`Updated todo list`),toolSpecificData:{kind:`todoList`,sessionId:e.chatSessionId,todoList:s}}}generatePastTenseMessage(e,t){if(e.length===0)return`Created ${t.length} todo${t.length===1?``:`s`}`;let n=new Map(e.map(e=>[e.id,e])),r=t.filter(e=>{let t=n.get(e.id);return t&&t.status!==`in-progress`&&e.status===`in-progress`});if(r.length>0){let e=r[0],n=t.length,i=t.findIndex(t=>t.id===e.id)+1;return`Starting (${i}/${n}) *${e.title}*`}let i=t.filter(e=>{let t=n.get(e.id);return t&&t.status!==`completed`&&e.status===`completed`});if(i.length>0){let e=i[0],n=t.length,r=t.findIndex(t=>t.id===e.id)+1;return`Completed (${r}/${n}) *${e.title}*`}let a=t.filter(e=>!n.has(e.id));return a.length>0?`Added ${a.length} todo${a.length===1?``:`s`}`:`Updated todo list`}handleRead(e,t){let n=e.getTodoList(t);if(n.length===0)return`No todo list found.`;let r=this.formatTodoListAsMarkdownTaskList(n);return`# Task List\n\n${r}`}formatTodoListAsMarkdownTaskList(e){return e.length===0?``:e.map(e=>{let t;switch(e.status){case`completed`:t=`[x]`;break;case`in-progress`:t=`[-]`;break;case`not-started`:default:t=`[ ]`;break}let n=[`- ${t} ${e.title}`];return e.description&&e.description.trim()&&n.push(`  - ${e.description.trim()}`),n.join(`
`)}).join(`
`)}};gV=A([j(0,mV),j(1,xs)],gV);let _V=class extends y{static{this.ID=`chat.builtinTools`}constructor(e,t){super();let n=t.createInstance(fV);this._register(e.registerToolData(dV)),this._register(e.registerToolImplementation(dV.id,n));let r=t.createInstance(gV);this._register(e.registerToolData(hV)),this._register(e.registerToolImplementation(hV.id,r))}};_V=A([j(0,pV),j(1,ys)],_V);const vV=k(`commandService`),yV=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new x,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(e,t){if(!e)throw Error(`invalid command`);if(typeof e==`string`){if(!t)throw Error(`invalid command`);return this.registerCommand({id:e,handler:t})}if(e.metadata&&Array.isArray(e.metadata.args)){let t=[];for(let n of e.metadata.args)t.push(n.constraint);let n=e.handler;e.handler=function(e,...r){return dt(r,t),n(e,...r)}}let{id:n}=e,r=(this._commands.get(n));r||(r=new Zt,this._commands.set(n,r));let i=(r.unshift(e)),a=(_(()=>{i();let e=this._commands.get(n);e?.isEmpty()&&this._commands.delete(n)}));return this._onDidRegisterCommand.fire(n),_t(a)}registerCommandAlias(e,t){return yV.registerCommand(e,(e,...n)=>e.get(vV).executeCommand(t,...n))}getCommand(e){let t=(this._commands.get(e));if(!(!t||t.isEmpty()))return pt.first(t)}getCommands(){let e=new Map;for(let t of this._commands.keys()){let n=(this.getCommand(t));n&&e.set(t,n)}return e}};yV.registerCommand(`noop`,()=>{});var Z;(function(e){e[e.DependsOnKbLayout=-1]=`DependsOnKbLayout`,e[e.Unknown=0]=`Unknown`,e[e.Backspace=1]=`Backspace`,e[e.Tab=2]=`Tab`,e[e.Enter=3]=`Enter`,e[e.Shift=4]=`Shift`,e[e.Ctrl=5]=`Ctrl`,e[e.Alt=6]=`Alt`,e[e.PauseBreak=7]=`PauseBreak`,e[e.CapsLock=8]=`CapsLock`,e[e.Escape=9]=`Escape`,e[e.Space=10]=`Space`,e[e.PageUp=11]=`PageUp`,e[e.PageDown=12]=`PageDown`,e[e.End=13]=`End`,e[e.Home=14]=`Home`,e[e.LeftArrow=15]=`LeftArrow`,e[e.UpArrow=16]=`UpArrow`,e[e.RightArrow=17]=`RightArrow`,e[e.DownArrow=18]=`DownArrow`,e[e.Insert=19]=`Insert`,e[e.Delete=20]=`Delete`,e[e.Digit0=21]=`Digit0`,e[e.Digit1=22]=`Digit1`,e[e.Digit2=23]=`Digit2`,e[e.Digit3=24]=`Digit3`,e[e.Digit4=25]=`Digit4`,e[e.Digit5=26]=`Digit5`,e[e.Digit6=27]=`Digit6`,e[e.Digit7=28]=`Digit7`,e[e.Digit8=29]=`Digit8`,e[e.Digit9=30]=`Digit9`,e[e.KeyA=31]=`KeyA`,e[e.KeyB=32]=`KeyB`,e[e.KeyC=33]=`KeyC`,e[e.KeyD=34]=`KeyD`,e[e.KeyE=35]=`KeyE`,e[e.KeyF=36]=`KeyF`,e[e.KeyG=37]=`KeyG`,e[e.KeyH=38]=`KeyH`,e[e.KeyI=39]=`KeyI`,e[e.KeyJ=40]=`KeyJ`,e[e.KeyK=41]=`KeyK`,e[e.KeyL=42]=`KeyL`,e[e.KeyM=43]=`KeyM`,e[e.KeyN=44]=`KeyN`,e[e.KeyO=45]=`KeyO`,e[e.KeyP=46]=`KeyP`,e[e.KeyQ=47]=`KeyQ`,e[e.KeyR=48]=`KeyR`,e[e.KeyS=49]=`KeyS`,e[e.KeyT=50]=`KeyT`,e[e.KeyU=51]=`KeyU`,e[e.KeyV=52]=`KeyV`,e[e.KeyW=53]=`KeyW`,e[e.KeyX=54]=`KeyX`,e[e.KeyY=55]=`KeyY`,e[e.KeyZ=56]=`KeyZ`,e[e.Meta=57]=`Meta`,e[e.ContextMenu=58]=`ContextMenu`,e[e.F1=59]=`F1`,e[e.F2=60]=`F2`,e[e.F3=61]=`F3`,e[e.F4=62]=`F4`,e[e.F5=63]=`F5`,e[e.F6=64]=`F6`,e[e.F7=65]=`F7`,e[e.F8=66]=`F8`,e[e.F9=67]=`F9`,e[e.F10=68]=`F10`,e[e.F11=69]=`F11`,e[e.F12=70]=`F12`,e[e.F13=71]=`F13`,e[e.F14=72]=`F14`,e[e.F15=73]=`F15`,e[e.F16=74]=`F16`,e[e.F17=75]=`F17`,e[e.F18=76]=`F18`,e[e.F19=77]=`F19`,e[e.F20=78]=`F20`,e[e.F21=79]=`F21`,e[e.F22=80]=`F22`,e[e.F23=81]=`F23`,e[e.F24=82]=`F24`,e[e.NumLock=83]=`NumLock`,e[e.ScrollLock=84]=`ScrollLock`,e[e.Semicolon=85]=`Semicolon`,e[e.Equal=86]=`Equal`,e[e.Comma=87]=`Comma`,e[e.Minus=88]=`Minus`,e[e.Period=89]=`Period`,e[e.Slash=90]=`Slash`,e[e.Backquote=91]=`Backquote`,e[e.BracketLeft=92]=`BracketLeft`,e[e.Backslash=93]=`Backslash`,e[e.BracketRight=94]=`BracketRight`,e[e.Quote=95]=`Quote`,e[e.OEM_8=96]=`OEM_8`,e[e.IntlBackslash=97]=`IntlBackslash`,e[e.Numpad0=98]=`Numpad0`,e[e.Numpad1=99]=`Numpad1`,e[e.Numpad2=100]=`Numpad2`,e[e.Numpad3=101]=`Numpad3`,e[e.Numpad4=102]=`Numpad4`,e[e.Numpad5=103]=`Numpad5`,e[e.Numpad6=104]=`Numpad6`,e[e.Numpad7=105]=`Numpad7`,e[e.Numpad8=106]=`Numpad8`,e[e.Numpad9=107]=`Numpad9`,e[e.NumpadMultiply=108]=`NumpadMultiply`,e[e.NumpadAdd=109]=`NumpadAdd`,e[e.NUMPAD_SEPARATOR=110]=`NUMPAD_SEPARATOR`,e[e.NumpadSubtract=111]=`NumpadSubtract`,e[e.NumpadDecimal=112]=`NumpadDecimal`,e[e.NumpadDivide=113]=`NumpadDivide`,e[e.KEY_IN_COMPOSITION=114]=`KEY_IN_COMPOSITION`,e[e.ABNT_C1=115]=`ABNT_C1`,e[e.ABNT_C2=116]=`ABNT_C2`,e[e.AudioVolumeMute=117]=`AudioVolumeMute`,e[e.AudioVolumeUp=118]=`AudioVolumeUp`,e[e.AudioVolumeDown=119]=`AudioVolumeDown`,e[e.BrowserSearch=120]=`BrowserSearch`,e[e.BrowserHome=121]=`BrowserHome`,e[e.BrowserBack=122]=`BrowserBack`,e[e.BrowserForward=123]=`BrowserForward`,e[e.MediaTrackNext=124]=`MediaTrackNext`,e[e.MediaTrackPrevious=125]=`MediaTrackPrevious`,e[e.MediaStop=126]=`MediaStop`,e[e.MediaPlayPause=127]=`MediaPlayPause`,e[e.LaunchMediaPlayer=128]=`LaunchMediaPlayer`,e[e.LaunchMail=129]=`LaunchMail`,e[e.LaunchApp2=130]=`LaunchApp2`,e[e.Clear=131]=`Clear`,e[e.MAX_VALUE=132]=`MAX_VALUE`})(Z||={});var Q;(function(e){e[e.DependsOnKbLayout=-1]=`DependsOnKbLayout`,e[e.None=0]=`None`,e[e.Hyper=1]=`Hyper`,e[e.Super=2]=`Super`,e[e.Fn=3]=`Fn`,e[e.FnLock=4]=`FnLock`,e[e.Suspend=5]=`Suspend`,e[e.Resume=6]=`Resume`,e[e.Turbo=7]=`Turbo`,e[e.Sleep=8]=`Sleep`,e[e.WakeUp=9]=`WakeUp`,e[e.KeyA=10]=`KeyA`,e[e.KeyB=11]=`KeyB`,e[e.KeyC=12]=`KeyC`,e[e.KeyD=13]=`KeyD`,e[e.KeyE=14]=`KeyE`,e[e.KeyF=15]=`KeyF`,e[e.KeyG=16]=`KeyG`,e[e.KeyH=17]=`KeyH`,e[e.KeyI=18]=`KeyI`,e[e.KeyJ=19]=`KeyJ`,e[e.KeyK=20]=`KeyK`,e[e.KeyL=21]=`KeyL`,e[e.KeyM=22]=`KeyM`,e[e.KeyN=23]=`KeyN`,e[e.KeyO=24]=`KeyO`,e[e.KeyP=25]=`KeyP`,e[e.KeyQ=26]=`KeyQ`,e[e.KeyR=27]=`KeyR`,e[e.KeyS=28]=`KeyS`,e[e.KeyT=29]=`KeyT`,e[e.KeyU=30]=`KeyU`,e[e.KeyV=31]=`KeyV`,e[e.KeyW=32]=`KeyW`,e[e.KeyX=33]=`KeyX`,e[e.KeyY=34]=`KeyY`,e[e.KeyZ=35]=`KeyZ`,e[e.Digit1=36]=`Digit1`,e[e.Digit2=37]=`Digit2`,e[e.Digit3=38]=`Digit3`,e[e.Digit4=39]=`Digit4`,e[e.Digit5=40]=`Digit5`,e[e.Digit6=41]=`Digit6`,e[e.Digit7=42]=`Digit7`,e[e.Digit8=43]=`Digit8`,e[e.Digit9=44]=`Digit9`,e[e.Digit0=45]=`Digit0`,e[e.Enter=46]=`Enter`,e[e.Escape=47]=`Escape`,e[e.Backspace=48]=`Backspace`,e[e.Tab=49]=`Tab`,e[e.Space=50]=`Space`,e[e.Minus=51]=`Minus`,e[e.Equal=52]=`Equal`,e[e.BracketLeft=53]=`BracketLeft`,e[e.BracketRight=54]=`BracketRight`,e[e.Backslash=55]=`Backslash`,e[e.IntlHash=56]=`IntlHash`,e[e.Semicolon=57]=`Semicolon`,e[e.Quote=58]=`Quote`,e[e.Backquote=59]=`Backquote`,e[e.Comma=60]=`Comma`,e[e.Period=61]=`Period`,e[e.Slash=62]=`Slash`,e[e.CapsLock=63]=`CapsLock`,e[e.F1=64]=`F1`,e[e.F2=65]=`F2`,e[e.F3=66]=`F3`,e[e.F4=67]=`F4`,e[e.F5=68]=`F5`,e[e.F6=69]=`F6`,e[e.F7=70]=`F7`,e[e.F8=71]=`F8`,e[e.F9=72]=`F9`,e[e.F10=73]=`F10`,e[e.F11=74]=`F11`,e[e.F12=75]=`F12`,e[e.PrintScreen=76]=`PrintScreen`,e[e.ScrollLock=77]=`ScrollLock`,e[e.Pause=78]=`Pause`,e[e.Insert=79]=`Insert`,e[e.Home=80]=`Home`,e[e.PageUp=81]=`PageUp`,e[e.Delete=82]=`Delete`,e[e.End=83]=`End`,e[e.PageDown=84]=`PageDown`,e[e.ArrowRight=85]=`ArrowRight`,e[e.ArrowLeft=86]=`ArrowLeft`,e[e.ArrowDown=87]=`ArrowDown`,e[e.ArrowUp=88]=`ArrowUp`,e[e.NumLock=89]=`NumLock`,e[e.NumpadDivide=90]=`NumpadDivide`,e[e.NumpadMultiply=91]=`NumpadMultiply`,e[e.NumpadSubtract=92]=`NumpadSubtract`,e[e.NumpadAdd=93]=`NumpadAdd`,e[e.NumpadEnter=94]=`NumpadEnter`,e[e.Numpad1=95]=`Numpad1`,e[e.Numpad2=96]=`Numpad2`,e[e.Numpad3=97]=`Numpad3`,e[e.Numpad4=98]=`Numpad4`,e[e.Numpad5=99]=`Numpad5`,e[e.Numpad6=100]=`Numpad6`,e[e.Numpad7=101]=`Numpad7`,e[e.Numpad8=102]=`Numpad8`,e[e.Numpad9=103]=`Numpad9`,e[e.Numpad0=104]=`Numpad0`,e[e.NumpadDecimal=105]=`NumpadDecimal`,e[e.IntlBackslash=106]=`IntlBackslash`,e[e.ContextMenu=107]=`ContextMenu`,e[e.Power=108]=`Power`,e[e.NumpadEqual=109]=`NumpadEqual`,e[e.F13=110]=`F13`,e[e.F14=111]=`F14`,e[e.F15=112]=`F15`,e[e.F16=113]=`F16`,e[e.F17=114]=`F17`,e[e.F18=115]=`F18`,e[e.F19=116]=`F19`,e[e.F20=117]=`F20`,e[e.F21=118]=`F21`,e[e.F22=119]=`F22`,e[e.F23=120]=`F23`,e[e.F24=121]=`F24`,e[e.Open=122]=`Open`,e[e.Help=123]=`Help`,e[e.Select=124]=`Select`,e[e.Again=125]=`Again`,e[e.Undo=126]=`Undo`,e[e.Cut=127]=`Cut`,e[e.Copy=128]=`Copy`,e[e.Paste=129]=`Paste`,e[e.Find=130]=`Find`,e[e.AudioVolumeMute=131]=`AudioVolumeMute`,e[e.AudioVolumeUp=132]=`AudioVolumeUp`,e[e.AudioVolumeDown=133]=`AudioVolumeDown`,e[e.NumpadComma=134]=`NumpadComma`,e[e.IntlRo=135]=`IntlRo`,e[e.KanaMode=136]=`KanaMode`,e[e.IntlYen=137]=`IntlYen`,e[e.Convert=138]=`Convert`,e[e.NonConvert=139]=`NonConvert`,e[e.Lang1=140]=`Lang1`,e[e.Lang2=141]=`Lang2`,e[e.Lang3=142]=`Lang3`,e[e.Lang4=143]=`Lang4`,e[e.Lang5=144]=`Lang5`,e[e.Abort=145]=`Abort`,e[e.Props=146]=`Props`,e[e.NumpadParenLeft=147]=`NumpadParenLeft`,e[e.NumpadParenRight=148]=`NumpadParenRight`,e[e.NumpadBackspace=149]=`NumpadBackspace`,e[e.NumpadMemoryStore=150]=`NumpadMemoryStore`,e[e.NumpadMemoryRecall=151]=`NumpadMemoryRecall`,e[e.NumpadMemoryClear=152]=`NumpadMemoryClear`,e[e.NumpadMemoryAdd=153]=`NumpadMemoryAdd`,e[e.NumpadMemorySubtract=154]=`NumpadMemorySubtract`,e[e.NumpadClear=155]=`NumpadClear`,e[e.NumpadClearEntry=156]=`NumpadClearEntry`,e[e.ControlLeft=157]=`ControlLeft`,e[e.ShiftLeft=158]=`ShiftLeft`,e[e.AltLeft=159]=`AltLeft`,e[e.MetaLeft=160]=`MetaLeft`,e[e.ControlRight=161]=`ControlRight`,e[e.ShiftRight=162]=`ShiftRight`,e[e.AltRight=163]=`AltRight`,e[e.MetaRight=164]=`MetaRight`,e[e.BrightnessUp=165]=`BrightnessUp`,e[e.BrightnessDown=166]=`BrightnessDown`,e[e.MediaPlay=167]=`MediaPlay`,e[e.MediaRecord=168]=`MediaRecord`,e[e.MediaFastForward=169]=`MediaFastForward`,e[e.MediaRewind=170]=`MediaRewind`,e[e.MediaTrackNext=171]=`MediaTrackNext`,e[e.MediaTrackPrevious=172]=`MediaTrackPrevious`,e[e.MediaStop=173]=`MediaStop`,e[e.Eject=174]=`Eject`,e[e.MediaPlayPause=175]=`MediaPlayPause`,e[e.MediaSelect=176]=`MediaSelect`,e[e.LaunchMail=177]=`LaunchMail`,e[e.LaunchApp2=178]=`LaunchApp2`,e[e.LaunchApp1=179]=`LaunchApp1`,e[e.SelectTask=180]=`SelectTask`,e[e.LaunchScreenSaver=181]=`LaunchScreenSaver`,e[e.BrowserSearch=182]=`BrowserSearch`,e[e.BrowserHome=183]=`BrowserHome`,e[e.BrowserBack=184]=`BrowserBack`,e[e.BrowserForward=185]=`BrowserForward`,e[e.BrowserStop=186]=`BrowserStop`,e[e.BrowserRefresh=187]=`BrowserRefresh`,e[e.BrowserFavorites=188]=`BrowserFavorites`,e[e.ZoomToggle=189]=`ZoomToggle`,e[e.MailReply=190]=`MailReply`,e[e.MailForward=191]=`MailForward`,e[e.MailSend=192]=`MailSend`,e[e.MAX_VALUE=193]=`MAX_VALUE`})(Q||={});var bV=class{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||Z.Unknown}};const xV=new bV,SV=new bV,CV=new bV,wV=Array(230),TV={},EV=[],DV=Object.create(null),OV=Object.create(null),kV=[],AV=[];for(let e=0;e<=Q.MAX_VALUE;e++)kV[e]=Z.DependsOnKbLayout;for(let e=0;e<=Z.MAX_VALUE;e++)AV[e]=Q.DependsOnKbLayout;(function(){let e=[[1,Q.None,`None`,Z.Unknown,`unknown`,0,`VK_UNKNOWN`,``,``],[1,Q.Hyper,`Hyper`,Z.Unknown,``,0,``,``,``],[1,Q.Super,`Super`,Z.Unknown,``,0,``,``,``],[1,Q.Fn,`Fn`,Z.Unknown,``,0,``,``,``],[1,Q.FnLock,`FnLock`,Z.Unknown,``,0,``,``,``],[1,Q.Suspend,`Suspend`,Z.Unknown,``,0,``,``,``],[1,Q.Resume,`Resume`,Z.Unknown,``,0,``,``,``],[1,Q.Turbo,`Turbo`,Z.Unknown,``,0,``,``,``],[1,Q.Sleep,`Sleep`,Z.Unknown,``,0,`VK_SLEEP`,``,``],[1,Q.WakeUp,`WakeUp`,Z.Unknown,``,0,``,``,``],[0,Q.KeyA,`KeyA`,Z.KeyA,`A`,65,`VK_A`,``,``],[0,Q.KeyB,`KeyB`,Z.KeyB,`B`,66,`VK_B`,``,``],[0,Q.KeyC,`KeyC`,Z.KeyC,`C`,67,`VK_C`,``,``],[0,Q.KeyD,`KeyD`,Z.KeyD,`D`,68,`VK_D`,``,``],[0,Q.KeyE,`KeyE`,Z.KeyE,`E`,69,`VK_E`,``,``],[0,Q.KeyF,`KeyF`,Z.KeyF,`F`,70,`VK_F`,``,``],[0,Q.KeyG,`KeyG`,Z.KeyG,`G`,71,`VK_G`,``,``],[0,Q.KeyH,`KeyH`,Z.KeyH,`H`,72,`VK_H`,``,``],[0,Q.KeyI,`KeyI`,Z.KeyI,`I`,73,`VK_I`,``,``],[0,Q.KeyJ,`KeyJ`,Z.KeyJ,`J`,74,`VK_J`,``,``],[0,Q.KeyK,`KeyK`,Z.KeyK,`K`,75,`VK_K`,``,``],[0,Q.KeyL,`KeyL`,Z.KeyL,`L`,76,`VK_L`,``,``],[0,Q.KeyM,`KeyM`,Z.KeyM,`M`,77,`VK_M`,``,``],[0,Q.KeyN,`KeyN`,Z.KeyN,`N`,78,`VK_N`,``,``],[0,Q.KeyO,`KeyO`,Z.KeyO,`O`,79,`VK_O`,``,``],[0,Q.KeyP,`KeyP`,Z.KeyP,`P`,80,`VK_P`,``,``],[0,Q.KeyQ,`KeyQ`,Z.KeyQ,`Q`,81,`VK_Q`,``,``],[0,Q.KeyR,`KeyR`,Z.KeyR,`R`,82,`VK_R`,``,``],[0,Q.KeyS,`KeyS`,Z.KeyS,`S`,83,`VK_S`,``,``],[0,Q.KeyT,`KeyT`,Z.KeyT,`T`,84,`VK_T`,``,``],[0,Q.KeyU,`KeyU`,Z.KeyU,`U`,85,`VK_U`,``,``],[0,Q.KeyV,`KeyV`,Z.KeyV,`V`,86,`VK_V`,``,``],[0,Q.KeyW,`KeyW`,Z.KeyW,`W`,87,`VK_W`,``,``],[0,Q.KeyX,`KeyX`,Z.KeyX,`X`,88,`VK_X`,``,``],[0,Q.KeyY,`KeyY`,Z.KeyY,`Y`,89,`VK_Y`,``,``],[0,Q.KeyZ,`KeyZ`,Z.KeyZ,`Z`,90,`VK_Z`,``,``],[0,Q.Digit1,`Digit1`,Z.Digit1,`1`,49,`VK_1`,``,``],[0,Q.Digit2,`Digit2`,Z.Digit2,`2`,50,`VK_2`,``,``],[0,Q.Digit3,`Digit3`,Z.Digit3,`3`,51,`VK_3`,``,``],[0,Q.Digit4,`Digit4`,Z.Digit4,`4`,52,`VK_4`,``,``],[0,Q.Digit5,`Digit5`,Z.Digit5,`5`,53,`VK_5`,``,``],[0,Q.Digit6,`Digit6`,Z.Digit6,`6`,54,`VK_6`,``,``],[0,Q.Digit7,`Digit7`,Z.Digit7,`7`,55,`VK_7`,``,``],[0,Q.Digit8,`Digit8`,Z.Digit8,`8`,56,`VK_8`,``,``],[0,Q.Digit9,`Digit9`,Z.Digit9,`9`,57,`VK_9`,``,``],[0,Q.Digit0,`Digit0`,Z.Digit0,`0`,48,`VK_0`,``,``],[1,Q.Enter,`Enter`,Z.Enter,`Enter`,13,`VK_RETURN`,``,``],[1,Q.Escape,`Escape`,Z.Escape,`Escape`,27,`VK_ESCAPE`,``,``],[1,Q.Backspace,`Backspace`,Z.Backspace,`Backspace`,8,`VK_BACK`,``,``],[1,Q.Tab,`Tab`,Z.Tab,`Tab`,9,`VK_TAB`,``,``],[1,Q.Space,`Space`,Z.Space,`Space`,32,`VK_SPACE`,``,``],[0,Q.Minus,`Minus`,Z.Minus,`-`,189,`VK_OEM_MINUS`,`-`,`OEM_MINUS`],[0,Q.Equal,`Equal`,Z.Equal,`=`,187,`VK_OEM_PLUS`,`=`,`OEM_PLUS`],[0,Q.BracketLeft,`BracketLeft`,Z.BracketLeft,`[`,219,`VK_OEM_4`,`[`,`OEM_4`],[0,Q.BracketRight,`BracketRight`,Z.BracketRight,`]`,221,`VK_OEM_6`,`]`,`OEM_6`],[0,Q.Backslash,`Backslash`,Z.Backslash,`\\`,220,`VK_OEM_5`,`\\`,`OEM_5`],[0,Q.IntlHash,`IntlHash`,Z.Unknown,``,0,``,``,``],[0,Q.Semicolon,`Semicolon`,Z.Semicolon,`;`,186,`VK_OEM_1`,`;`,`OEM_1`],[0,Q.Quote,`Quote`,Z.Quote,`'`,222,`VK_OEM_7`,`'`,`OEM_7`],[0,Q.Backquote,`Backquote`,Z.Backquote,"`",192,`VK_OEM_3`,"`",`OEM_3`],[0,Q.Comma,`Comma`,Z.Comma,`,`,188,`VK_OEM_COMMA`,`,`,`OEM_COMMA`],[0,Q.Period,`Period`,Z.Period,`.`,190,`VK_OEM_PERIOD`,`.`,`OEM_PERIOD`],[0,Q.Slash,`Slash`,Z.Slash,`/`,191,`VK_OEM_2`,`/`,`OEM_2`],[1,Q.CapsLock,`CapsLock`,Z.CapsLock,`CapsLock`,20,`VK_CAPITAL`,``,``],[1,Q.F1,`F1`,Z.F1,`F1`,112,`VK_F1`,``,``],[1,Q.F2,`F2`,Z.F2,`F2`,113,`VK_F2`,``,``],[1,Q.F3,`F3`,Z.F3,`F3`,114,`VK_F3`,``,``],[1,Q.F4,`F4`,Z.F4,`F4`,115,`VK_F4`,``,``],[1,Q.F5,`F5`,Z.F5,`F5`,116,`VK_F5`,``,``],[1,Q.F6,`F6`,Z.F6,`F6`,117,`VK_F6`,``,``],[1,Q.F7,`F7`,Z.F7,`F7`,118,`VK_F7`,``,``],[1,Q.F8,`F8`,Z.F8,`F8`,119,`VK_F8`,``,``],[1,Q.F9,`F9`,Z.F9,`F9`,120,`VK_F9`,``,``],[1,Q.F10,`F10`,Z.F10,`F10`,121,`VK_F10`,``,``],[1,Q.F11,`F11`,Z.F11,`F11`,122,`VK_F11`,``,``],[1,Q.F12,`F12`,Z.F12,`F12`,123,`VK_F12`,``,``],[1,Q.PrintScreen,`PrintScreen`,Z.Unknown,``,0,``,``,``],[1,Q.ScrollLock,`ScrollLock`,Z.ScrollLock,`ScrollLock`,145,`VK_SCROLL`,``,``],[1,Q.Pause,`Pause`,Z.PauseBreak,`PauseBreak`,19,`VK_PAUSE`,``,``],[1,Q.Insert,`Insert`,Z.Insert,`Insert`,45,`VK_INSERT`,``,``],[1,Q.Home,`Home`,Z.Home,`Home`,36,`VK_HOME`,``,``],[1,Q.PageUp,`PageUp`,Z.PageUp,`PageUp`,33,`VK_PRIOR`,``,``],[1,Q.Delete,`Delete`,Z.Delete,`Delete`,46,`VK_DELETE`,``,``],[1,Q.End,`End`,Z.End,`End`,35,`VK_END`,``,``],[1,Q.PageDown,`PageDown`,Z.PageDown,`PageDown`,34,`VK_NEXT`,``,``],[1,Q.ArrowRight,`ArrowRight`,Z.RightArrow,`RightArrow`,39,`VK_RIGHT`,`Right`,``],[1,Q.ArrowLeft,`ArrowLeft`,Z.LeftArrow,`LeftArrow`,37,`VK_LEFT`,`Left`,``],[1,Q.ArrowDown,`ArrowDown`,Z.DownArrow,`DownArrow`,40,`VK_DOWN`,`Down`,``],[1,Q.ArrowUp,`ArrowUp`,Z.UpArrow,`UpArrow`,38,`VK_UP`,`Up`,``],[1,Q.NumLock,`NumLock`,Z.NumLock,`NumLock`,144,`VK_NUMLOCK`,``,``],[1,Q.NumpadDivide,`NumpadDivide`,Z.NumpadDivide,`NumPad_Divide`,111,`VK_DIVIDE`,``,``],[1,Q.NumpadMultiply,`NumpadMultiply`,Z.NumpadMultiply,`NumPad_Multiply`,106,`VK_MULTIPLY`,``,``],[1,Q.NumpadSubtract,`NumpadSubtract`,Z.NumpadSubtract,`NumPad_Subtract`,109,`VK_SUBTRACT`,``,``],[1,Q.NumpadAdd,`NumpadAdd`,Z.NumpadAdd,`NumPad_Add`,107,`VK_ADD`,``,``],[1,Q.NumpadEnter,`NumpadEnter`,Z.Enter,``,0,``,``,``],[1,Q.Numpad1,`Numpad1`,Z.Numpad1,`NumPad1`,97,`VK_NUMPAD1`,``,``],[1,Q.Numpad2,`Numpad2`,Z.Numpad2,`NumPad2`,98,`VK_NUMPAD2`,``,``],[1,Q.Numpad3,`Numpad3`,Z.Numpad3,`NumPad3`,99,`VK_NUMPAD3`,``,``],[1,Q.Numpad4,`Numpad4`,Z.Numpad4,`NumPad4`,100,`VK_NUMPAD4`,``,``],[1,Q.Numpad5,`Numpad5`,Z.Numpad5,`NumPad5`,101,`VK_NUMPAD5`,``,``],[1,Q.Numpad6,`Numpad6`,Z.Numpad6,`NumPad6`,102,`VK_NUMPAD6`,``,``],[1,Q.Numpad7,`Numpad7`,Z.Numpad7,`NumPad7`,103,`VK_NUMPAD7`,``,``],[1,Q.Numpad8,`Numpad8`,Z.Numpad8,`NumPad8`,104,`VK_NUMPAD8`,``,``],[1,Q.Numpad9,`Numpad9`,Z.Numpad9,`NumPad9`,105,`VK_NUMPAD9`,``,``],[1,Q.Numpad0,`Numpad0`,Z.Numpad0,`NumPad0`,96,`VK_NUMPAD0`,``,``],[1,Q.NumpadDecimal,`NumpadDecimal`,Z.NumpadDecimal,`NumPad_Decimal`,110,`VK_DECIMAL`,``,``],[0,Q.IntlBackslash,`IntlBackslash`,Z.IntlBackslash,`OEM_102`,226,`VK_OEM_102`,``,``],[1,Q.ContextMenu,`ContextMenu`,Z.ContextMenu,`ContextMenu`,93,``,``,``],[1,Q.Power,`Power`,Z.Unknown,``,0,``,``,``],[1,Q.NumpadEqual,`NumpadEqual`,Z.Unknown,``,0,``,``,``],[1,Q.F13,`F13`,Z.F13,`F13`,124,`VK_F13`,``,``],[1,Q.F14,`F14`,Z.F14,`F14`,125,`VK_F14`,``,``],[1,Q.F15,`F15`,Z.F15,`F15`,126,`VK_F15`,``,``],[1,Q.F16,`F16`,Z.F16,`F16`,127,`VK_F16`,``,``],[1,Q.F17,`F17`,Z.F17,`F17`,128,`VK_F17`,``,``],[1,Q.F18,`F18`,Z.F18,`F18`,129,`VK_F18`,``,``],[1,Q.F19,`F19`,Z.F19,`F19`,130,`VK_F19`,``,``],[1,Q.F20,`F20`,Z.F20,`F20`,131,`VK_F20`,``,``],[1,Q.F21,`F21`,Z.F21,`F21`,132,`VK_F21`,``,``],[1,Q.F22,`F22`,Z.F22,`F22`,133,`VK_F22`,``,``],[1,Q.F23,`F23`,Z.F23,`F23`,134,`VK_F23`,``,``],[1,Q.F24,`F24`,Z.F24,`F24`,135,`VK_F24`,``,``],[1,Q.Open,`Open`,Z.Unknown,``,0,``,``,``],[1,Q.Help,`Help`,Z.Unknown,``,0,``,``,``],[1,Q.Select,`Select`,Z.Unknown,``,0,``,``,``],[1,Q.Again,`Again`,Z.Unknown,``,0,``,``,``],[1,Q.Undo,`Undo`,Z.Unknown,``,0,``,``,``],[1,Q.Cut,`Cut`,Z.Unknown,``,0,``,``,``],[1,Q.Copy,`Copy`,Z.Unknown,``,0,``,``,``],[1,Q.Paste,`Paste`,Z.Unknown,``,0,``,``,``],[1,Q.Find,`Find`,Z.Unknown,``,0,``,``,``],[1,Q.AudioVolumeMute,`AudioVolumeMute`,Z.AudioVolumeMute,`AudioVolumeMute`,173,`VK_VOLUME_MUTE`,``,``],[1,Q.AudioVolumeUp,`AudioVolumeUp`,Z.AudioVolumeUp,`AudioVolumeUp`,175,`VK_VOLUME_UP`,``,``],[1,Q.AudioVolumeDown,`AudioVolumeDown`,Z.AudioVolumeDown,`AudioVolumeDown`,174,`VK_VOLUME_DOWN`,``,``],[1,Q.NumpadComma,`NumpadComma`,Z.NUMPAD_SEPARATOR,`NumPad_Separator`,108,`VK_SEPARATOR`,``,``],[0,Q.IntlRo,`IntlRo`,Z.ABNT_C1,`ABNT_C1`,193,`VK_ABNT_C1`,``,``],[1,Q.KanaMode,`KanaMode`,Z.Unknown,``,0,``,``,``],[0,Q.IntlYen,`IntlYen`,Z.Unknown,``,0,``,``,``],[1,Q.Convert,`Convert`,Z.Unknown,``,0,``,``,``],[1,Q.NonConvert,`NonConvert`,Z.Unknown,``,0,``,``,``],[1,Q.Lang1,`Lang1`,Z.Unknown,``,0,``,``,``],[1,Q.Lang2,`Lang2`,Z.Unknown,``,0,``,``,``],[1,Q.Lang3,`Lang3`,Z.Unknown,``,0,``,``,``],[1,Q.Lang4,`Lang4`,Z.Unknown,``,0,``,``,``],[1,Q.Lang5,`Lang5`,Z.Unknown,``,0,``,``,``],[1,Q.Abort,`Abort`,Z.Unknown,``,0,``,``,``],[1,Q.Props,`Props`,Z.Unknown,``,0,``,``,``],[1,Q.NumpadParenLeft,`NumpadParenLeft`,Z.Unknown,``,0,``,``,``],[1,Q.NumpadParenRight,`NumpadParenRight`,Z.Unknown,``,0,``,``,``],[1,Q.NumpadBackspace,`NumpadBackspace`,Z.Unknown,``,0,``,``,``],[1,Q.NumpadMemoryStore,`NumpadMemoryStore`,Z.Unknown,``,0,``,``,``],[1,Q.NumpadMemoryRecall,`NumpadMemoryRecall`,Z.Unknown,``,0,``,``,``],[1,Q.NumpadMemoryClear,`NumpadMemoryClear`,Z.Unknown,``,0,``,``,``],[1,Q.NumpadMemoryAdd,`NumpadMemoryAdd`,Z.Unknown,``,0,``,``,``],[1,Q.NumpadMemorySubtract,`NumpadMemorySubtract`,Z.Unknown,``,0,``,``,``],[1,Q.NumpadClear,`NumpadClear`,Z.Clear,`Clear`,12,`VK_CLEAR`,``,``],[1,Q.NumpadClearEntry,`NumpadClearEntry`,Z.Unknown,``,0,``,``,``],[1,Q.None,``,Z.Ctrl,`Ctrl`,17,`VK_CONTROL`,``,``],[1,Q.None,``,Z.Shift,`Shift`,16,`VK_SHIFT`,``,``],[1,Q.None,``,Z.Alt,`Alt`,18,`VK_MENU`,``,``],[1,Q.None,``,Z.Meta,`Meta`,91,`VK_COMMAND`,``,``],[1,Q.ControlLeft,`ControlLeft`,Z.Ctrl,``,0,`VK_LCONTROL`,``,``],[1,Q.ShiftLeft,`ShiftLeft`,Z.Shift,``,0,`VK_LSHIFT`,``,``],[1,Q.AltLeft,`AltLeft`,Z.Alt,``,0,`VK_LMENU`,``,``],[1,Q.MetaLeft,`MetaLeft`,Z.Meta,``,0,`VK_LWIN`,``,``],[1,Q.ControlRight,`ControlRight`,Z.Ctrl,``,0,`VK_RCONTROL`,``,``],[1,Q.ShiftRight,`ShiftRight`,Z.Shift,``,0,`VK_RSHIFT`,``,``],[1,Q.AltRight,`AltRight`,Z.Alt,``,0,`VK_RMENU`,``,``],[1,Q.MetaRight,`MetaRight`,Z.Meta,``,0,`VK_RWIN`,``,``],[1,Q.BrightnessUp,`BrightnessUp`,Z.Unknown,``,0,``,``,``],[1,Q.BrightnessDown,`BrightnessDown`,Z.Unknown,``,0,``,``,``],[1,Q.MediaPlay,`MediaPlay`,Z.Unknown,``,0,``,``,``],[1,Q.MediaRecord,`MediaRecord`,Z.Unknown,``,0,``,``,``],[1,Q.MediaFastForward,`MediaFastForward`,Z.Unknown,``,0,``,``,``],[1,Q.MediaRewind,`MediaRewind`,Z.Unknown,``,0,``,``,``],[1,Q.MediaTrackNext,`MediaTrackNext`,Z.MediaTrackNext,`MediaTrackNext`,176,`VK_MEDIA_NEXT_TRACK`,``,``],[1,Q.MediaTrackPrevious,`MediaTrackPrevious`,Z.MediaTrackPrevious,`MediaTrackPrevious`,177,`VK_MEDIA_PREV_TRACK`,``,``],[1,Q.MediaStop,`MediaStop`,Z.MediaStop,`MediaStop`,178,`VK_MEDIA_STOP`,``,``],[1,Q.Eject,`Eject`,Z.Unknown,``,0,``,``,``],[1,Q.MediaPlayPause,`MediaPlayPause`,Z.MediaPlayPause,`MediaPlayPause`,179,`VK_MEDIA_PLAY_PAUSE`,``,``],[1,Q.MediaSelect,`MediaSelect`,Z.LaunchMediaPlayer,`LaunchMediaPlayer`,181,`VK_MEDIA_LAUNCH_MEDIA_SELECT`,``,``],[1,Q.LaunchMail,`LaunchMail`,Z.LaunchMail,`LaunchMail`,180,`VK_MEDIA_LAUNCH_MAIL`,``,``],[1,Q.LaunchApp2,`LaunchApp2`,Z.LaunchApp2,`LaunchApp2`,183,`VK_MEDIA_LAUNCH_APP2`,``,``],[1,Q.LaunchApp1,`LaunchApp1`,Z.Unknown,``,0,`VK_MEDIA_LAUNCH_APP1`,``,``],[1,Q.SelectTask,`SelectTask`,Z.Unknown,``,0,``,``,``],[1,Q.LaunchScreenSaver,`LaunchScreenSaver`,Z.Unknown,``,0,``,``,``],[1,Q.BrowserSearch,`BrowserSearch`,Z.BrowserSearch,`BrowserSearch`,170,`VK_BROWSER_SEARCH`,``,``],[1,Q.BrowserHome,`BrowserHome`,Z.BrowserHome,`BrowserHome`,172,`VK_BROWSER_HOME`,``,``],[1,Q.BrowserBack,`BrowserBack`,Z.BrowserBack,`BrowserBack`,166,`VK_BROWSER_BACK`,``,``],[1,Q.BrowserForward,`BrowserForward`,Z.BrowserForward,`BrowserForward`,167,`VK_BROWSER_FORWARD`,``,``],[1,Q.BrowserStop,`BrowserStop`,Z.Unknown,``,0,`VK_BROWSER_STOP`,``,``],[1,Q.BrowserRefresh,`BrowserRefresh`,Z.Unknown,``,0,`VK_BROWSER_REFRESH`,``,``],[1,Q.BrowserFavorites,`BrowserFavorites`,Z.Unknown,``,0,`VK_BROWSER_FAVORITES`,``,``],[1,Q.ZoomToggle,`ZoomToggle`,Z.Unknown,``,0,``,``,``],[1,Q.MailReply,`MailReply`,Z.Unknown,``,0,``,``,``],[1,Q.MailForward,`MailForward`,Z.Unknown,``,0,``,``,``],[1,Q.MailSend,`MailSend`,Z.Unknown,``,0,``,``,``],[1,Q.None,``,Z.KEY_IN_COMPOSITION,`KeyInComposition`,229,``,``,``],[1,Q.None,``,Z.ABNT_C2,`ABNT_C2`,194,`VK_ABNT_C2`,``,``],[1,Q.None,``,Z.OEM_8,`OEM_8`,223,`VK_OEM_8`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_KANA`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_HANGUL`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_JUNJA`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_FINAL`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_HANJA`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_KANJI`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_CONVERT`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_NONCONVERT`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_ACCEPT`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_MODECHANGE`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_SELECT`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_PRINT`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_EXECUTE`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_SNAPSHOT`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_HELP`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_APPS`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_PROCESSKEY`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_PACKET`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_DBE_SBCSCHAR`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_DBE_DBCSCHAR`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_ATTN`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_CRSEL`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_EXSEL`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_EREOF`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_PLAY`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_ZOOM`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_NONAME`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_PA1`,``,``],[1,Q.None,``,Z.Unknown,``,0,`VK_OEM_CLEAR`,``,``]],t=[],n=[];for(let r of e){let[e,i,a,o,s,c,l,u,d]=r;if(n[i]||(n[i]=!0,EV[i]=a,DV[a]=i,OV[a.toLowerCase()]=i,e&&(kV[i]=o,o!==Z.Unknown&&o!==Z.Enter&&o!==Z.Ctrl&&o!==Z.Shift&&o!==Z.Alt&&o!==Z.Meta&&(AV[o]=i))),!t[o]){if(t[o]=!0,!s)throw Error(`String representation missing for key code ${o} around scan code ${a}`);xV.define(o,s),SV.define(o,u||s),CV.define(o,d||u||s)}c&&(wV[c]=o),l&&(TV[l]=o)}AV[Z.Enter]=Q.Enter})();var jV;(function(e){function t(e){return xV.keyCodeToStr(e)}e.toString=t;function n(e){return xV.strToKeyCode(e)}e.fromString=n;function r(e){return SV.keyCodeToStr(e)}e.toUserSettingsUS=r;function i(e){return CV.keyCodeToStr(e)}e.toUserSettingsGeneral=i;function a(e){return SV.strToKeyCode(e)||CV.strToKeyCode(e)}e.fromUserSettings=a;function o(e){if(e>=Z.Numpad0&&e<=Z.NumpadDivide)return null;switch(e){case Z.UpArrow:return`Up`;case Z.DownArrow:return`Down`;case Z.LeftArrow:return`Left`;case Z.RightArrow:return`Right`}return xV.keyCodeToStr(e)}e.toElectronAccelerator=o})(jV||={});var MV;(function(e){e[e.CtrlCmd=2048]=`CtrlCmd`,e[e.Shift=1024]=`Shift`,e[e.Alt=512]=`Alt`,e[e.WinCtrl=256]=`WinCtrl`})(MV||={});var NV;(function(e){e[e.CtrlCmd=2048]=`CtrlCmd`,e[e.Shift=1024]=`Shift`,e[e.Alt=512]=`Alt`,e[e.WinCtrl=256]=`WinCtrl`,e[e.KeyCode=255]=`KeyCode`})(NV||={});function PV(e,t){if(typeof e==`number`){if(e===0)return null;let n=(e&65535)>>>0,r=(e&4294901760)>>>16;return r===0?new LV([FV(n,t)]):new LV([FV(n,t),FV(r,t)])}else{let n=[];for(let r=0;r<e.length;r++)n.push(FV(e[r],t));return new LV(n)}}function FV(e,t){let n=!!(e&NV.CtrlCmd),r=!!(e&NV.WinCtrl),i=t===dr.Macintosh?r:n,a=!!(e&NV.Shift),o=!!(e&NV.Alt),s=t===dr.Macintosh?n:r,c=e&NV.KeyCode;return new IV(i,a,o,s,c)}var IV=class e{constructor(e,t,n,r,i){this.ctrlKey=e,this.shiftKey=t,this.altKey=n,this.metaKey=r,this.keyCode=i}equals(t){return t instanceof e&&this.ctrlKey===t.ctrlKey&&this.shiftKey===t.shiftKey&&this.altKey===t.altKey&&this.metaKey===t.metaKey&&this.keyCode===t.keyCode}getHashCode(){let e=this.ctrlKey?`1`:`0`,t=this.shiftKey?`1`:`0`,n=this.altKey?`1`:`0`,r=this.metaKey?`1`:`0`;return`K${e}${t}${n}${r}${this.keyCode}`}isModifierKey(){return this.keyCode===Z.Unknown||this.keyCode===Z.Ctrl||this.keyCode===Z.Meta||this.keyCode===Z.Alt||this.keyCode===Z.Shift}toKeybinding(){return new LV([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===Z.Ctrl||this.shiftKey&&this.keyCode===Z.Shift||this.altKey&&this.keyCode===Z.Alt||this.metaKey&&this.keyCode===Z.Meta}},LV=class{constructor(e){if(e.length===0)throw h(`chords`);this.chords=e}getHashCode(){let e=``;for(let t=0,n=this.chords.length;t<n;t++)t!==0&&(e+=`;`),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}},RV;(function(e){e[e.EditorCore=0]=`EditorCore`,e[e.EditorContrib=100]=`EditorContrib`,e[e.WorkbenchContrib=200]=`WorkbenchContrib`,e[e.BuiltinExtension=300]=`BuiltinExtension`,e[e.ExternalExtension=400]=`ExternalExtension`})(RV||={});var zV=class e{constructor(){this._coreKeybindings=new Zt,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(fr===dr.Windows){if(e&&e.win)return e.win}else if(fr===dr.Macintosh){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(t){let n=e.bindToCurrentPlatform(t),r=new v;if(n&&n.primary){let e=PV(n.primary,fr);e&&r.add(this._registerDefaultKeybinding(e,t.id,t.args,t.weight,0,t.when))}if(n&&Array.isArray(n.secondary))for(let e=0,i=n.secondary.length;e<i;e++){let i=n.secondary[e],a=PV(i,fr);a&&r.add(this._registerDefaultKeybinding(a,t.id,t.args,t.weight,-e-1,t.when))}return r}setExtensionKeybindings(e){let t=[],n=0;for(let r of e)r.keybinding&&(t[n++]={keybinding:r.keybinding,command:r.id,commandArgs:r.args,when:r.when,weight1:r.weight,weight2:0,extensionId:r.extensionId||null,isBuiltinExtension:r.isBuiltinExtension||!1});this._extensionKeybindings=t,this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(e){return bt(this.registerKeybindingRule(e),yV.registerCommand(e))}_registerDefaultKeybinding(e,t,n,r,i,a){let o=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:n,when:a,weight1:r,weight2:i,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,_(()=>{o(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(HV)),this._cachedMergedKeybindings.slice(0)}};const BV=new zV,VV={EditorModes:`platform.keybindingsRegistry`};Sm.add(VV.EditorModes,BV);function HV(e,t){if(e.weight1!==t.weight1)return e.weight1-t.weight1;if(e.command&&t.command){if(e.command<t.command)return-1;if(e.command>t.command)return 1}return e.weight2-t.weight2}var UV;function WV(e){return e.command!==void 0}var GV=class e{static{this._instances=new Map}static{this.CommandPalette=new e(`CommandPalette`)}static{this.DebugBreakpointsContext=new e(`DebugBreakpointsContext`)}static{this.DebugCallStackContext=new e(`DebugCallStackContext`)}static{this.DebugConsoleContext=new e(`DebugConsoleContext`)}static{this.DebugVariablesContext=new e(`DebugVariablesContext`)}static{this.NotebookVariablesContext=new e(`NotebookVariablesContext`)}static{this.DebugHoverContext=new e(`DebugHoverContext`)}static{this.DebugWatchContext=new e(`DebugWatchContext`)}static{this.DebugToolBar=new e(`DebugToolBar`)}static{this.DebugToolBarStop=new e(`DebugToolBarStop`)}static{this.DebugDisassemblyContext=new e(`DebugDisassemblyContext`)}static{this.DebugCallStackToolbar=new e(`DebugCallStackToolbar`)}static{this.DebugCreateConfiguration=new e(`DebugCreateConfiguration`)}static{this.EditorContext=new e(`EditorContext`)}static{this.SimpleEditorContext=new e(`SimpleEditorContext`)}static{this.EditorContent=new e(`EditorContent`)}static{this.EditorLineNumberContext=new e(`EditorLineNumberContext`)}static{this.EditorContextCopy=new e(`EditorContextCopy`)}static{this.EditorContextPeek=new e(`EditorContextPeek`)}static{this.EditorContextShare=new e(`EditorContextShare`)}static{this.EditorTitle=new e(`EditorTitle`)}static{this.CompactWindowEditorTitle=new e(`CompactWindowEditorTitle`)}static{this.EditorTitleRun=new e(`EditorTitleRun`)}static{this.EditorTitleContext=new e(`EditorTitleContext`)}static{this.EditorTitleContextShare=new e(`EditorTitleContextShare`)}static{this.EmptyEditorGroup=new e(`EmptyEditorGroup`)}static{this.EmptyEditorGroupContext=new e(`EmptyEditorGroupContext`)}static{this.EditorTabsBarContext=new e(`EditorTabsBarContext`)}static{this.EditorTabsBarShowTabsSubmenu=new e(`EditorTabsBarShowTabsSubmenu`)}static{this.EditorTabsBarShowTabsZenModeSubmenu=new e(`EditorTabsBarShowTabsZenModeSubmenu`)}static{this.EditorActionsPositionSubmenu=new e(`EditorActionsPositionSubmenu`)}static{this.EditorSplitMoveSubmenu=new e(`EditorSplitMoveSubmenu`)}static{this.ExplorerContext=new e(`ExplorerContext`)}static{this.ExplorerContextShare=new e(`ExplorerContextShare`)}static{this.ExtensionContext=new e(`ExtensionContext`)}static{this.ExtensionEditorContextMenu=new e(`ExtensionEditorContextMenu`)}static{this.GlobalActivity=new e(`GlobalActivity`)}static{this.CommandCenter=new e(`CommandCenter`)}static{this.CommandCenterCenter=new e(`CommandCenterCenter`)}static{this.LayoutControlMenuSubmenu=new e(`LayoutControlMenuSubmenu`)}static{this.LayoutControlMenu=new e(`LayoutControlMenu`)}static{this.MenubarMainMenu=new e(`MenubarMainMenu`)}static{this.MenubarAppearanceMenu=new e(`MenubarAppearanceMenu`)}static{this.MenubarDebugMenu=new e(`MenubarDebugMenu`)}static{this.MenubarEditMenu=new e(`MenubarEditMenu`)}static{this.MenubarCopy=new e(`MenubarCopy`)}static{this.MenubarFileMenu=new e(`MenubarFileMenu`)}static{this.MenubarGoMenu=new e(`MenubarGoMenu`)}static{this.MenubarHelpMenu=new e(`MenubarHelpMenu`)}static{this.MenubarLayoutMenu=new e(`MenubarLayoutMenu`)}static{this.MenubarNewBreakpointMenu=new e(`MenubarNewBreakpointMenu`)}static{this.PanelAlignmentMenu=new e(`PanelAlignmentMenu`)}static{this.PanelPositionMenu=new e(`PanelPositionMenu`)}static{this.ActivityBarPositionMenu=new e(`ActivityBarPositionMenu`)}static{this.MenubarPreferencesMenu=new e(`MenubarPreferencesMenu`)}static{this.MenubarRecentMenu=new e(`MenubarRecentMenu`)}static{this.MenubarSelectionMenu=new e(`MenubarSelectionMenu`)}static{this.MenubarShare=new e(`MenubarShare`)}static{this.MenubarSwitchEditorMenu=new e(`MenubarSwitchEditorMenu`)}static{this.MenubarSwitchGroupMenu=new e(`MenubarSwitchGroupMenu`)}static{this.MenubarTerminalMenu=new e(`MenubarTerminalMenu`)}static{this.MenubarTerminalSuggestStatusMenu=new e(`MenubarTerminalSuggestStatusMenu`)}static{this.MenubarViewMenu=new e(`MenubarViewMenu`)}static{this.MenubarHomeMenu=new e(`MenubarHomeMenu`)}static{this.OpenEditorsContext=new e(`OpenEditorsContext`)}static{this.OpenEditorsContextShare=new e(`OpenEditorsContextShare`)}static{this.ProblemsPanelContext=new e(`ProblemsPanelContext`)}static{this.SCMInputBox=new e(`SCMInputBox`)}static{this.SCMChangeContext=new e(`SCMChangeContext`)}static{this.SCMResourceContext=new e(`SCMResourceContext`)}static{this.SCMResourceContextShare=new e(`SCMResourceContextShare`)}static{this.SCMResourceFolderContext=new e(`SCMResourceFolderContext`)}static{this.SCMResourceGroupContext=new e(`SCMResourceGroupContext`)}static{this.SCMSourceControl=new e(`SCMSourceControl`)}static{this.SCMSourceControlInline=new e(`SCMSourceControlInline`)}static{this.SCMSourceControlTitle=new e(`SCMSourceControlTitle`)}static{this.SCMHistoryTitle=new e(`SCMHistoryTitle`)}static{this.SCMHistoryItemContext=new e(`SCMHistoryItemContext`)}static{this.SCMHistoryItemChangeContext=new e(`SCMHistoryItemChangeContext`)}static{this.SCMHistoryItemHover=new e(`SCMHistoryItemHover`)}static{this.SCMHistoryItemRefContext=new e(`SCMHistoryItemRefContext`)}static{this.SCMQuickDiffDecorations=new e(`SCMQuickDiffDecorations`)}static{this.SCMTitle=new e(`SCMTitle`)}static{this.SearchContext=new e(`SearchContext`)}static{this.SearchActionMenu=new e(`SearchActionContext`)}static{this.StatusBarWindowIndicatorMenu=new e(`StatusBarWindowIndicatorMenu`)}static{this.StatusBarRemoteIndicatorMenu=new e(`StatusBarRemoteIndicatorMenu`)}static{this.StickyScrollContext=new e(`StickyScrollContext`)}static{this.TestItem=new e(`TestItem`)}static{this.TestItemGutter=new e(`TestItemGutter`)}static{this.TestProfilesContext=new e(`TestProfilesContext`)}static{this.TestMessageContext=new e(`TestMessageContext`)}static{this.TestMessageContent=new e(`TestMessageContent`)}static{this.TestPeekElement=new e(`TestPeekElement`)}static{this.TestPeekTitle=new e(`TestPeekTitle`)}static{this.TestCallStack=new e(`TestCallStack`)}static{this.TestCoverageFilterItem=new e(`TestCoverageFilterItem`)}static{this.TouchBarContext=new e(`TouchBarContext`)}static{this.TitleBar=new e(`TitleBar`)}static{this.TitleBarContext=new e(`TitleBarContext`)}static{this.TitleBarTitleContext=new e(`TitleBarTitleContext`)}static{this.TunnelContext=new e(`TunnelContext`)}static{this.TunnelPrivacy=new e(`TunnelPrivacy`)}static{this.TunnelProtocol=new e(`TunnelProtocol`)}static{this.TunnelPortInline=new e(`TunnelInline`)}static{this.TunnelTitle=new e(`TunnelTitle`)}static{this.TunnelLocalAddressInline=new e(`TunnelLocalAddressInline`)}static{this.TunnelOriginInline=new e(`TunnelOriginInline`)}static{this.ViewItemContext=new e(`ViewItemContext`)}static{this.ViewContainerTitle=new e(`ViewContainerTitle`)}static{this.ViewContainerTitleContext=new e(`ViewContainerTitleContext`)}static{this.ViewTitle=new e(`ViewTitle`)}static{this.ViewTitleContext=new e(`ViewTitleContext`)}static{this.CommentEditorActions=new e(`CommentEditorActions`)}static{this.CommentThreadTitle=new e(`CommentThreadTitle`)}static{this.CommentThreadActions=new e(`CommentThreadActions`)}static{this.CommentThreadAdditionalActions=new e(`CommentThreadAdditionalActions`)}static{this.CommentThreadTitleContext=new e(`CommentThreadTitleContext`)}static{this.CommentThreadCommentContext=new e(`CommentThreadCommentContext`)}static{this.CommentTitle=new e(`CommentTitle`)}static{this.CommentActions=new e(`CommentActions`)}static{this.CommentsViewThreadActions=new e(`CommentsViewThreadActions`)}static{this.InteractiveToolbar=new e(`InteractiveToolbar`)}static{this.InteractiveCellTitle=new e(`InteractiveCellTitle`)}static{this.InteractiveCellDelete=new e(`InteractiveCellDelete`)}static{this.InteractiveCellExecute=new e(`InteractiveCellExecute`)}static{this.InteractiveInputExecute=new e(`InteractiveInputExecute`)}static{this.InteractiveInputConfig=new e(`InteractiveInputConfig`)}static{this.ReplInputExecute=new e(`ReplInputExecute`)}static{this.IssueReporter=new e(`IssueReporter`)}static{this.NotebookToolbar=new e(`NotebookToolbar`)}static{this.NotebookToolbarContext=new e(`NotebookToolbarContext`)}static{this.NotebookStickyScrollContext=new e(`NotebookStickyScrollContext`)}static{this.NotebookCellTitle=new e(`NotebookCellTitle`)}static{this.NotebookCellDelete=new e(`NotebookCellDelete`)}static{this.NotebookCellInsert=new e(`NotebookCellInsert`)}static{this.NotebookCellBetween=new e(`NotebookCellBetween`)}static{this.NotebookCellListTop=new e(`NotebookCellTop`)}static{this.NotebookCellExecute=new e(`NotebookCellExecute`)}static{this.NotebookCellExecuteGoTo=new e(`NotebookCellExecuteGoTo`)}static{this.NotebookCellExecutePrimary=new e(`NotebookCellExecutePrimary`)}static{this.NotebookDiffCellInputTitle=new e(`NotebookDiffCellInputTitle`)}static{this.NotebookDiffDocumentMetadata=new e(`NotebookDiffDocumentMetadata`)}static{this.NotebookDiffCellMetadataTitle=new e(`NotebookDiffCellMetadataTitle`)}static{this.NotebookDiffCellOutputsTitle=new e(`NotebookDiffCellOutputsTitle`)}static{this.NotebookOutputToolbar=new e(`NotebookOutputToolbar`)}static{this.NotebookOutlineFilter=new e(`NotebookOutlineFilter`)}static{this.NotebookOutlineActionMenu=new e(`NotebookOutlineActionMenu`)}static{this.NotebookEditorLayoutConfigure=new e(`NotebookEditorLayoutConfigure`)}static{this.NotebookKernelSource=new e(`NotebookKernelSource`)}static{this.BulkEditTitle=new e(`BulkEditTitle`)}static{this.BulkEditContext=new e(`BulkEditContext`)}static{this.TimelineItemContext=new e(`TimelineItemContext`)}static{this.TimelineTitle=new e(`TimelineTitle`)}static{this.TimelineTitleContext=new e(`TimelineTitleContext`)}static{this.TimelineFilterSubMenu=new e(`TimelineFilterSubMenu`)}static{this.AccountsContext=new e(`AccountsContext`)}static{this.SidebarTitle=new e(`SidebarTitle`)}static{this.PanelTitle=new e(`PanelTitle`)}static{this.AuxiliaryBarTitle=new e(`AuxiliaryBarTitle`)}static{this.TerminalInstanceContext=new e(`TerminalInstanceContext`)}static{this.TerminalEditorInstanceContext=new e(`TerminalEditorInstanceContext`)}static{this.TerminalNewDropdownContext=new e(`TerminalNewDropdownContext`)}static{this.TerminalTabContext=new e(`TerminalTabContext`)}static{this.TerminalTabEmptyAreaContext=new e(`TerminalTabEmptyAreaContext`)}static{this.TerminalStickyScrollContext=new e(`TerminalStickyScrollContext`)}static{this.WebviewContext=new e(`WebviewContext`)}static{this.InlineCompletionsActions=new e(`InlineCompletionsActions`)}static{this.InlineEditsActions=new e(`InlineEditsActions`)}static{this.NewFile=new e(`NewFile`)}static{this.MergeInput1Toolbar=new e(`MergeToolbar1Toolbar`)}static{this.MergeInput2Toolbar=new e(`MergeToolbar2Toolbar`)}static{this.MergeBaseToolbar=new e(`MergeBaseToolbar`)}static{this.MergeInputResultToolbar=new e(`MergeToolbarResultToolbar`)}static{this.InlineSuggestionToolbar=new e(`InlineSuggestionToolbar`)}static{this.InlineEditToolbar=new e(`InlineEditToolbar`)}static{this.ChatContext=new e(`ChatContext`)}static{this.ChatCodeBlock=new e(`ChatCodeblock`)}static{this.ChatCompareBlock=new e(`ChatCompareBlock`)}static{this.ChatMessageTitle=new e(`ChatMessageTitle`)}static{this.ChatMessageFooter=new e(`ChatMessageFooter`)}static{this.ChatExecute=new e(`ChatExecute`)}static{this.ChatExecuteSecondary=new e(`ChatExecuteSecondary`)}static{this.ChatInput=new e(`ChatInput`)}static{this.ChatInputSide=new e(`ChatInputSide`)}static{this.ChatModePicker=new e(`ChatModePicker`)}static{this.ChatEditingWidgetToolbar=new e(`ChatEditingWidgetToolbar`)}static{this.ChatEditingEditorContent=new e(`ChatEditingEditorContent`)}static{this.ChatEditingEditorHunk=new e(`ChatEditingEditorHunk`)}static{this.ChatEditingDeletedNotebookCell=new e(`ChatEditingDeletedNotebookCell`)}static{this.ChatInputAttachmentToolbar=new e(`ChatInputAttachmentToolbar`)}static{this.ChatEditingWidgetModifiedFilesToolbar=new e(`ChatEditingWidgetModifiedFilesToolbar`)}static{this.ChatInputResourceAttachmentContext=new e(`ChatInputResourceAttachmentContext`)}static{this.ChatInputSymbolAttachmentContext=new e(`ChatInputSymbolAttachmentContext`)}static{this.ChatInlineResourceAnchorContext=new e(`ChatInlineResourceAnchorContext`)}static{this.ChatInlineSymbolAnchorContext=new e(`ChatInlineSymbolAnchorContext`)}static{this.ChatMessageCheckpoint=new e(`ChatMessageCheckpoint`)}static{this.ChatMessageRestoreCheckpoint=new e(`ChatMessageRestoreCheckpoint`)}static{this.ChatEditingCodeBlockContext=new e(`ChatEditingCodeBlockContext`)}static{this.ChatTitleBarMenu=new e(`ChatTitleBarMenu`)}static{this.ChatAttachmentsContext=new e(`ChatAttachmentsContext`)}static{this.ChatToolOutputResourceToolbar=new e(`ChatToolOutputResourceToolbar`)}static{this.ChatTextEditorMenu=new e(`ChatTextEditorMenu`)}static{this.ChatTerminalMenu=new e(`ChatTerminalMenu`)}static{this.ChatToolOutputResourceContext=new e(`ChatToolOutputResourceContext`)}static{this.ChatSessionsMenu=new e(`ChatSessionsMenu`)}static{this.AccessibleView=new e(`AccessibleView`)}static{this.MultiDiffEditorFileToolbar=new e(`MultiDiffEditorFileToolbar`)}static{this.DiffEditorHunkToolbar=new e(`DiffEditorHunkToolbar`)}static{this.DiffEditorSelectionToolbar=new e(`DiffEditorSelectionToolbar`)}static for(t){return e._instances.get(t)??new e(t)}constructor(t){if(e._instances.has(t))throw TypeError(`MenuId with identifier '${t}' already exists. Use MenuId.for(ident) or a unique identifier`);e._instances.set(t,this),this.id=t}},KV=class e{static{this._all=new Map}static for(t){let n=this._all.get(t);return n||(n=new e(t),this._all.set(t,n)),n}static merge(t){let n=new Set;for(let r of t)r instanceof e&&n.add(r.id);return n}constructor(e){this.id=e,this.has=t=>t===e}};new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new mn({merge:KV.merge}),this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(e){return this._commands.set(e.id,e),this._onDidChangeMenu.fire(KV.for(GV.CommandPalette)),_t(_(()=>{this._commands.delete(e.id)&&this._onDidChangeMenu.fire(KV.for(GV.CommandPalette))}))}getCommand(e){return this._commands.get(e)}getCommands(){let e=new Map;return this._commands.forEach((t,n)=>e.set(n,t)),e}appendMenuItem(e,t){let n=(this._menuItems.get(e));n||(n=new Zt,this._menuItems.set(e,n));let r=(n.push(t));return this._onDidChangeMenu.fire(KV.for(e)),_t(_(()=>{r(),this._onDidChangeMenu.fire(KV.for(e))}))}appendMenuItems(e){let t=new v;for(let{id:n,item:r}of e)t.add(this.appendMenuItem(n,r));return t}getMenuItems(e){let t;return t=this._menuItems.has(e)?[...this._menuItems.get(e)]:[],e===GV.CommandPalette&&this._appendImplicitItems(t),t}_appendImplicitItems(e){let t=new Set;for(let n of e)WV(n)&&(t.add(n.command.id),n.alt&&t.add(n.alt.id));this._commands.forEach((n,r)=>{t.has(r)||e.push({command:n})})}};let qV=UV=class{static label(e,t){return t?.renderShortTitle&&e.shortTitle?typeof e.shortTitle==`string`?e.shortTitle:e.shortTitle.value:typeof e.title==`string`?e.title:e.title.value}constructor(e,t,n,r,i,a,o){this.hideActions=r,this.menuKeybinding=i,this._commandService=o,this.id=e.id,this.label=UV.label(e,n),this.tooltip=(typeof e.tooltip==`string`?e.tooltip:e.tooltip?.value)??``,this.enabled=!e.precondition||a.contextMatchesRules(e.precondition),this.checked=void 0;let s;if(e.toggled){let t=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=a.contextMatchesRules(t.condition),this.checked&&t.tooltip&&(this.tooltip=typeof t.tooltip==`string`?t.tooltip:t.tooltip.value),this.checked&&fl.isThemeIcon(t.icon)&&(s=t.icon),this.checked&&t.title&&(this.label=typeof t.title==`string`?t.title:t.title.value)}s||=fl.isThemeIcon(e.icon)?e.icon:void 0,this.item=e,this.alt=t?new UV(t,void 0,n,r,void 0,a,o):void 0,this._options=n,this.class=s&&fl.asClassName(s)}run(...e){let t=[];return this._options?.arg&&(t=[...t,this._options.arg]),this._options?.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};qV=UV=A([j(5,sh),j(6,vV)],qV);var JV;(function(e){e.ExtensionQueryService=`ExtensionQueryService`,e.ExtensionLatestVersionUri=`ExtensionLatestVersionUriTemplate`,e.ExtensionStatisticsUri=`ExtensionStatisticsUriTemplate`,e.WebExtensionStatisticsUri=`WebExtensionStatisticsUriTemplate`,e.PublisherViewUri=`PublisherViewUriTemplate`,e.ExtensionDetailsViewUri=`ExtensionDetailsViewUriTemplate`,e.ExtensionRatingViewUri=`ExtensionRatingViewUriTemplate`,e.ExtensionResourceUri=`ExtensionResourceUriTemplate`,e.ContactSupportUri=`ContactSupportUri`})(JV||={});var YV;(function(e){e.None=`None`,e.IncludeVersions=`IncludeVersions`,e.IncludeFiles=`IncludeFiles`,e.IncludeCategoryAndTags=`IncludeCategoryAndTags`,e.IncludeSharedAccounts=`IncludeSharedAccounts`,e.IncludeVersionProperties=`IncludeVersionProperties`,e.ExcludeNonValidated=`ExcludeNonValidated`,e.IncludeInstallationTargets=`IncludeInstallationTargets`,e.IncludeAssetUri=`IncludeAssetUri`,e.IncludeStatistics=`IncludeStatistics`,e.IncludeLatestVersionOnly=`IncludeLatestVersionOnly`,e.Unpublished=`Unpublished`,e.IncludeNameConflictInfo=`IncludeNameConflictInfo`,e.IncludeLatestPrereleaseAndStableVersionOnly=`IncludeLatestPrereleaseAndStableVersionOnly`})(YV||={});var XV;(function(e){e.Available=`available`,e.RequiresSignIn=`requiresSignIn`,e.AccessDenied=`accessDenied`,e.Unavailable=`unavailable`})(XV||={});const ZV=k(`extensionsWorkbenchService`);Nn(7210,`Extensions`);var QV;(function(e){e[e.Installing=0]=`Installing`,e[e.Installed=1]=`Installed`,e[e.Uninstalling=2]=`Uninstalling`,e[e.Uninstalled=3]=`Uninstalled`})(QV||={});var $V;(function(e){e.ReloadWindow=`reloadWindow`,e.RestartExtensions=`restartExtensions`,e.DownloadUpdate=`downloadUpdate`,e.ApplyUpdate=`applyUpdate`,e.QuitAndInstall=`quitAndInstall`})($V||={});var eH;(function(e){e.Readme=`readme`,e.Features=`features`,e.Changelog=`changelog`,e.Dependencies=`dependencies`,e.ExtensionPack=`extensionPack`})(eH||={});let tH=class extends y{constructor(e,t){super(),this.containers=e,this._register(t.onChange(this.update,this))}set extension(e){this.containers.forEach(t=>t.extension=e)}update(e){for(let t of this.containers)e&&t.extension?Ig(t.extension.identifier,e.identifier)&&(t.extension.server&&e.server&&t.extension.server!==e.server?t.updateWhenCounterExtensionChanges&&t.update():t.extension=e):t.update()}};tH=A([j(1,ZV)],tH),new I(`defaultExtensionViews`,!0),new I(`hasOutdatedExtensions`,!1),new I(`hasGallery`,!1),new I(`extensionsGalleryStatus`,XV.Unavailable),new I(`extensionResultListFocused `,!0),new I(`searchMcpServers`,!1),new GV(`extensionsSearchActionsMenu`),new GV(`extensionsFilterSubMenu`),fl.fromId(P.extensions.id),C(7223,`Search Extensions`),C(7224,`This is a tool for browsing Visual Studio Code Extensions Marketplace. It allows the model to search for extensions and retrieve detailed information about them. The model should use this tool whenever it needs to discover extensions or resolve information about known ones. To use the tool, the model has to provide the category of the extensions, relevant search keywords, or known extension IDs. Note that search results may include false positives, so reviewing and filtering is recommended.`),C(7225,`Search for extensions in the Visual Studio Code Extensions Marketplace`),iV.Internal;let nH=class{constructor(e){this.extensionWorkbenchService=e}async invoke(e,t,n,r){let i=e.parameters;if(!i.keywords?.length&&!i.category&&!i.ids?.length)return{content:[{kind:`text`,value:C(7226,`Please provide a category or keywords or ids to search for.`)}]};let a=new Map,o=e=>{for(let t of e){if(t.deprecationInfo||t.isMalicious)continue;a.set(t.identifier.id.toLowerCase(),{id:t.identifier.id,name:t.displayName,description:t.description,installed:t.state===QV.Installed,installCount:t.installCount??0,rating:t.rating??0,categories:t.categories??[],tags:t.gallery?.tags??[]})}},s=async e=>{let t=await this.extensionWorkbenchService.queryGallery({text:e,pageSize:10,sortBy:vg.InstallCount},r);t.firstPage.length&&o(t.firstPage)};if(i.ids?.length){let e=await this.extensionWorkbenchService.getExtensions(i.ids.map(e=>({id:e})),r);o(e)}if(i.keywords?.length)for(let e of i.keywords??[])if(e===`featured`)await s(`featured`);else{let t=i.category?`category:"${i.category}"`:``;t=e?`${t} ${e}`.trim():t,await s(t)}else await s(`category:"${i.category}"`);let c=Array.from(a.values());return{content:[{kind:`text`,value:`Here are the list of extensions:\n${JSON.stringify(c)}\n. Important: Use the following format to display extensions to the user because there is a renderer available to parse these extensions in this format and display them with all details. So, do not describe about the extensions to the user.\n\`\`\`vscode-extensions\nextensionId1,extensionId2\n\`\`\`\n.`}],toolResultDetails:{input:JSON.stringify(i),output:[{type:`embed`,isText:!0,value:JSON.stringify(c.map(e=>e.id))}]}}}};nH=A([j(0,ZV)],nH);var rH=class{constructor(e){this._apiObject=new u(()=>{let e=this;return Object.freeze({get name(){return e._data.id},get description(){return e._data.modelDescription},get inputSchema(){return e._data.inputSchema},get tags(){return e._data.tags??[]},get source(){}})}),this._apiObjectWithChatParticipantAdditions=new u(()=>{let e=this,t=Bk.to(e._data.source);return Object.freeze({get name(){return e._data.id},get description(){return e._data.modelDescription},get inputSchema(){return e._data.inputSchema},get tags(){return e._data.tags??[]},get source(){return t}})}),this._data=e}update(e){this._data=e}get data(){return this._data}get apiObject(){return this._apiObject.value}get apiObjectWithChatParticipantAdditions(){return this._apiObjectWithChatParticipantAdditions.value}},iH=class{constructor(e,t){this._languageModels=t,this._registeredTools=new Map,this._tokenCountFuncs=new Map,this._allTools=new Map,this._proxy=e.getProxy(E.MainThreadLanguageModelTools),this._proxy.$getTools().then(e=>{for(let t of e)this._allTools.set(t.id,new rH(Gu(t)))})}async $countTokensForInvocation(e,t,n){let r=this._tokenCountFuncs.get(e);if(!r)throw Error(`Tool invocation call ${e} not found`);return await r(t,n)}async invokeTool(e,t,n,r){let i=Nc();n.tokenizationOptions&&this._tokenCountFuncs.set(i,n.tokenizationOptions.countTokens);try{if(n.toolInvocationToken&&!aV(n.toolInvocationToken))throw Error(`Invalid tool invocation token`);if((t===uV||t===lV)&&!Hg(e,`chatParticipantPrivate`))throw Error(`Invalid tool: ${t}`);let a=await this._proxy.$invokeTool({toolId:t,callId:i,parameters:n.input,tokenBudget:n.tokenizationOptions?.tokenBudget,context:n.toolInvocationToken,chatRequestId:Hg(e,`chatParticipantPrivate`)?n.chatRequestId:void 0,chatInteractionId:Hg(e,`chatParticipantPrivate`)?n.chatInteractionId:void 0},r),o=a instanceof hi?a.value:a;return Hk.to(Gu(o))}finally{this._tokenCountFuncs.delete(i)}}$onDidChangeTools(e){let t=new Set(this._registeredTools.keys());for(let n of e){t.delete(n.id);let e=this._allTools.get(n.id);e?e.update(n):this._allTools.set(n.id,new rH(Gu(n)))}for(let e of t)this._allTools.delete(e)}getTools(e){let t=Hg(e,`chatParticipantPrivate`);return Array.from(this._allTools.values()).map(e=>t?e.apiObjectWithChatParticipantAdditions:e.apiObject).filter(t=>{switch(t.name){case uV:case lV:case`vscode_fetchWebPage_internal`:case`vscode_searchExtensions_internal`:return Hg(e,`chatParticipantPrivate`);default:return!0}})}async $invokeTool(e,t){let n=this._registeredTools.get(e.toolId);if(!n)throw Error(`Unknown tool ${e.toolId}`);let r={input:e.parameters,toolInvocationToken:e.context};Hg(n.extension,`chatParticipantPrivate`)&&(r.chatRequestId=e.chatRequestId,r.chatInteractionId=e.chatInteractionId,r.chatSessionId=e.context?.sessionId),Hg(n.extension,`chatParticipantAdditions`)&&e.modelId&&(r.model=await this.getModel(e.modelId,n.extension)),e.tokenBudget!==void 0&&(r.tokenizationOptions={tokenBudget:e.tokenBudget,countTokens:this._tokenCountFuncs.get(e.callId)||((t,n=Oi.None)=>this._proxy.$countTokensForInvocation(e.callId,t,n))});let i;Hg(n.extension,`toolProgress`)&&(i={report:t=>{this._proxy.$acceptToolProgress(e.callId,{message:jD.fromStrict(t.message),increment:t.increment,total:100})}});let a=await co(Promise.resolve(n.tool.invoke(r,t,i)),t);if(!a)throw new oe;return Hk.from(a,n.extension)}async getModel(e,t){let n;if(e&&(n=await this._languageModels.getLanguageModelByIdentifier(t,e)),!n&&(n=await this._languageModels.getDefaultLanguageModel(t),!n))throw Error(`Language model unavailable`);return n}async $prepareToolInvocation(e,t,n){let r=this._registeredTools.get(e);if(!r)throw Error(`Unknown tool ${e}`);let i={input:t.parameters,chatRequestId:t.chatRequestId,chatSessionId:t.chatSessionId,chatInteractionId:t.chatInteractionId};if(r.tool.prepareInvocation){let e=await r.tool.prepareInvocation(i,n);return e?((e.pastTenseMessage||e.presentation)&&U(r.extension,`chatParticipantPrivate`),{confirmationMessages:e.confirmationMessages?{title:typeof e.confirmationMessages.title==`string`?e.confirmationMessages.title:jD.from(e.confirmationMessages.title),message:typeof e.confirmationMessages.message==`string`?e.confirmationMessages.message:jD.from(e.confirmationMessages.message)}:void 0,invocationMessage:jD.fromStrict(e.invocationMessage),pastTenseMessage:jD.fromStrict(e.pastTenseMessage),presentation:e.presentation}):void 0}}registerTool(e,t,n){return this._registeredTools.set(t,{extension:e,tool:n}),this._proxy.$registerTool(t),_(()=>{this._registeredTools.delete(t),this._proxy.$unregisterTool(t)})}},aH=class{constructor(e,t,n,r){this._documents=t,this._commands=n,this._uriTransformer=r,this._languageIds=[],this._handlePool=0,this._ids=new Set,this._proxy=e.getProxy(E.MainThreadLanguages)}$acceptLanguageIds(e){this._languageIds=e}async getLanguages(){return this._languageIds.slice(0)}async changeLanguage(e,t){await this._proxy.$changeLanguage(e,t);let n=this._documents.getDocumentData(e);if(!n)throw Error(`document '${e.toString()}' NOT found`);return n.document}async tokenAtPosition(e,t){let n=e.version,r=SD.from(t),i=await this._proxy.$tokensAtPosition(e.uri,r),a={type:ew.Other,range:e.getWordRangeAtPosition(t)??new Ib(t.line,t.character,t.line,t.character)};if(!i)return a;let o={range:K.to(i.range),type:xD.to(i.type)};return!o.range.contains(t)||n!==e.version?a:o}createLanguageStatusItem(e,t,n){let r=this._handlePool++,i=this._proxy,a=this._ids,o=`${e.identifier.value}/${t}`;if(a.has(o))throw Error(`LanguageStatusItem with id '${t}' ALREADY exists`);a.add(o);let s={selector:n,id:t,name:e.displayName??e.name,severity:bx.Information,command:void 0,text:``,detail:``,busy:!1},c,l=new v,u=()=>{if(c?.dispose(),!a.has(o)){console.warn(`LanguageStatusItem (${t}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`);return}c=So(()=>{l.clear(),this._proxy.$setLanguageStatus(r,{id:o,name:s.name??e.displayName??e.name,source:e.displayName??e.name,selector:CD.from(s.selector,this._uriTransformer),label:s.text,detail:s.detail??``,severity:s.severity===bx.Error?xc.Error:s.severity===bx.Warning?xc.Warning:xc.Info,command:s.command&&this._commands.toInternal(s.command,l),accessibilityInfo:s.accessibilityInformation,busy:s.busy})},0)},d={dispose(){l.dispose(),c?.dispose(),i.$removeLanguageStatus(r),a.delete(o)},get id(){return s.id},get name(){return s.name},set name(e){s.name=e,u()},get selector(){return s.selector},set selector(e){s.selector=e,u()},get text(){return s.text},set text(e){s.text=e,u()},set text2(t){U(e,`languageStatusText`),s.text=t,u()},get text2(){return U(e,`languageStatusText`),s.text},get detail(){return s.detail},set detail(e){s.detail=e,u()},get severity(){return s.severity},set severity(e){s.severity=e,u()},get accessibilityInformation(){return s.accessibilityInformation},set accessibilityInformation(e){s.accessibilityInformation=e,u()},get command(){return s.command},set command(e){s.command=e,u()},get busy(){return s.busy},set busy(e){s.busy=e,u()}};return u(),d}};function oH(e){return e&&e.title}let sH=class{constructor(e,t){this._logService=t,this._proxy=e.getProxy(E.MainThreadMessageService)}showMessage(e,t,n,r,i){let a={source:{identifier:e.identifier,label:e.displayName||e.name}},o;typeof r==`string`||oH(r)?o=[r,...i]:(a.modal=r?.modal,a.useCustom=r?.useCustom,a.detail=r?.detail,o=i),a.useCustom&&U(e,`resolvers`);let s=[],c=!1;for(let t=0;t<o.length;t++){let n=o[t];if(typeof n==`string`)s.push({title:n,handle:t,isCloseAffordance:!1});else if(typeof n==`object`){let{title:r,isCloseAffordance:i}=n;s.push({title:r,isCloseAffordance:!!i,handle:t}),i&&(c?this._logService.warn(`[${e.identifier}] Only one message item can have 'isCloseAffordance':`,n):c=!0)}else this._logService.warn(`[${e.identifier}] Invalid message item:`,n)}return this._proxy.$showMessage(t,n,a,s).then(e=>{if(typeof e==`number`)return o[e]})}};sH=A([j(1,xs)],sH);var cH=class{constructor(e,t,n,r){this.start=e,this.deletedCount=t,this.deletedItems=n,this.items=r}asApiEvent(){return{range:new FC(this.start,this.start+this.deletedCount),addedCells:this.items.map(e=>e.apiCell),removedCells:this.deletedItems}}},lH=class{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:!1,versionId:1,encoding:`utf8`}}constructor(e,t,n){this.notebook=e,this._extHostDocument=t,this._cellData=n,this.handle=n.handle,this.uri=w.revive(n.uri),this.cellKind=n.cellKind,this._outputs=n.outputs.map(MO.to),this._internalMetadata=n.internalMetadata??{},this._metadata=Object.freeze(n.metadata??{}),this._previousResult=Object.freeze(DO.to(n.internalMetadata??{}))}get internalMetadata(){return this._internalMetadata}get apiCell(){if(!this._apiCell){let e=this,t=this._extHostDocument.getDocument(this.uri);if(!t)throw Error(`MISSING extHostDocument for notebook cell: ${this.uri}`);let n={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:OO.to(this._cellData.cellKind),document:t.document,get mime(){return e._mime},set mime(t){e._mime=t},get outputs(){return e._outputs.slice(0)},get metadata(){return e._metadata},get executionSummary(){return e._previousResult}};this._apiCell=Object.freeze(n)}return this._apiCell}setOutputs(e){this._outputs=e.map(MO.to)}setOutputItems(e,t,n){let r=n.map(jO.to),i=this._outputs.find(t=>t.id===e);if(i&&(t||(i.items.length=0),i.items.push(...r),i.items.length>1&&i.items.every(e=>ty(e.mime)))){let e=new Map,t=[];i.items.forEach(n=>{let r;e.has(n.mime)?r=e.get(n.mime):(r=[],e.set(n.mime,r),t.push(n.mime)),r.push(n.data)}),i.items.length=0,t.forEach(t=>{let n=ry(e.get(t));i.items.push({mime:t,data:n.data.buffer})})}}setMetadata(e){this._metadata=Object.freeze(e)}setInternalMetadata(e){this._internalMetadata=e,this._previousResult=Object.freeze(DO.to(e))}setMime(e){}},uH=class e{static{this._handlePool=0}constructor(t,n,r,i,a){this._proxy=t,this._textDocumentsAndEditors=n,this._textDocuments=r,this.uri=i,this.handle=e._handlePool++,this._cells=[],this._versionId=0,this._isDirty=!1,this._disposed=!1,this._notebookType=a.viewType,this._metadata=Object.freeze(a.metadata??Object.create(null)),this._spliceNotebookCells([[0,0,a.cells]],!0,void 0),this._versionId=a.versionId}dispose(){this._disposed=!0}get versionId(){return this._versionId}get apiNotebook(){if(!this._notebook){let e=this,t={get uri(){return e.uri},get version(){return e._versionId},get notebookType(){return e._notebookType},get isDirty(){return e._isDirty},get isUntitled(){return e.uri.scheme===O.untitled},get isClosed(){return e._disposed},get metadata(){return e._metadata},get cellCount(){return e._cells.length},cellAt(t){return t=e._validateIndex(t),e._cells[t].apiCell},getCells(t){let n=t?e._getCells(t):e._cells;return n.map(e=>e.apiCell)},save(){return e._save()},[Symbol.for(`debug.description`)](){return`NotebookDocument(${this.uri.toString()})`}};this._notebook=Object.freeze(t)}return this._notebook}acceptDocumentPropertiesChanged(e){e.metadata&&(this._metadata=Object.freeze({...this._metadata,...e.metadata}))}acceptDirty(e){this._isDirty=e}acceptModelChanged(e,t,n){this._versionId=e.versionId,this._isDirty=t,this.acceptDocumentPropertiesChanged({metadata:n});let r={notebook:this.apiNotebook,metadata:n,cellChanges:[],contentChanges:[]},i=[];for(let t of e.rawEvents)t.kind===qv.ModelChange?this._spliceNotebookCells(t.changes,!1,r.contentChanges):t.kind===qv.Move?this._moveCells(t.index,t.length,t.newIdx,r.contentChanges):t.kind===qv.Output?(this._setCellOutputs(t.index,t.outputs),i.push({cell:this._cells[t.index].apiCell,outputs:this._cells[t.index].apiCell.outputs})):t.kind===qv.OutputItem?(this._setCellOutputItems(t.index,t.outputId,t.append,t.outputItems),i.push({cell:this._cells[t.index].apiCell,outputs:this._cells[t.index].apiCell.outputs})):t.kind===qv.ChangeCellLanguage?(this._changeCellLanguage(t.index,t.language),i.push({cell:this._cells[t.index].apiCell,document:this._cells[t.index].apiCell.document})):t.kind===qv.ChangeCellContent?i.push({cell:this._cells[t.index].apiCell,document:this._cells[t.index].apiCell.document}):t.kind===qv.ChangeCellMime?this._changeCellMime(t.index,t.mime):t.kind===qv.ChangeCellMetadata?(this._changeCellMetadata(t.index,t.metadata),i.push({cell:this._cells[t.index].apiCell,metadata:this._cells[t.index].apiCell.metadata})):t.kind===qv.ChangeCellInternalMetadata&&(this._changeCellInternalMetadata(t.index,t.internalMetadata),i.push({cell:this._cells[t.index].apiCell,executionSummary:this._cells[t.index].apiCell.executionSummary}));let a=new Map;for(let e=0;e<i.length;e++){let t=i[e],n=a.get(t.cell);if(n===void 0){let e=r.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...t});a.set(t.cell,e-1)}else r.cellChanges[n]={...r.cellChanges[n],...t}}return r}_validateIndex(e){return e|=0,e<0?0:e>=this._cells.length?this._cells.length-1:e}_validateRange(e){let t=e.start|0,n=e.end|0;return t<0&&(t=0),n>this._cells.length&&(n=this._cells.length),e.with({start:t,end:n})}_getCells(e){e=this._validateRange(e);let t=[];for(let n=e.start;n<e.end;n++)t.push(this._cells[n]);return t}async _save(){return this._disposed?Promise.reject(Error(`Notebook has been closed`)):this._proxy.$trySaveNotebook(this.uri)}_spliceNotebookCells(e,t,n){if(this._disposed)return;let r=[],i=[],a=[];if(e.reverse().forEach(e=>{let n=e[2],o=n.map(e=>{let n=new lH(this,this._textDocumentsAndEditors,e);return t||i.push(lH.asModelAddData(e)),n}),s=new cH(e[0],e[1],[],o),c=this._cells.splice(e[0],e[1],...o);for(let e of c)a.push(e.uri),s.deletedItems.push(e.apiCell);r.push(s)}),this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:i,removedDocuments:a}),n)for(let e of r)n.push(e.asApiEvent())}_moveCells(e,t,n,r){let i=this._cells.splice(e,t);this._cells.splice(n,0,...i);let a=[new cH(e,t,i.map(e=>e.apiCell),[]),new cH(n,0,[],i)];for(let e of a)r.push(e.asApiEvent())}_setCellOutputs(e,t){let n=this._cells[e];n.setOutputs(t)}_setCellOutputItems(e,t,n,r){let i=this._cells[e];i.setOutputItems(t,n,r)}_changeCellLanguage(e,t){let n=this._cells[e];n.apiCell.document.languageId!==t&&this._textDocuments.$acceptModelLanguageChanged(n.uri,t)}_changeCellMime(e,t){let n=this._cells[e];n.apiCell.mime=t}_changeCellMetadata(e,t){let n=this._cells[e];n.setMetadata(t)}_changeCellInternalMetadata(e,t){let n=this._cells[e];n.setInternalMetadata(t)}getCellFromApiCell(e){return this._cells.find(t=>t.apiCell===e)}getCellFromIndex(e){return this._cells[e]}getCell(e){return this._cells.find(t=>t.handle===e)}getCellIndex(e){return this._cells.indexOf(e)}},dH=class e{static{this.apiEditorsToExtHost=new WeakMap}constructor(e,t,n,r,i,a,o){this.id=e,this._proxy=t,this.notebookData=n,this._visibleRanges=r,this._selections=i,this._viewColumn=a,this.viewType=o,this._visible=!1}get apiEditor(){if(!this._editor){let t=this;this._editor={get notebook(){return t.notebookData.apiNotebook},get selection(){return t._selections[0]},set selection(e){this.selections=[e]},get selections(){return t._selections},set selections(e){if(!Array.isArray(e)||!e.every(FC.isNotebookRange))throw h(`selections`);t._selections=e.length===0?[new FC(0,0)]:e,t._trySetSelections(t._selections)},get visibleRanges(){return t._visibleRanges},revealRange(e,n){t._proxy.$tryRevealRange(t.id,EO.from(e),n??WC.Default)},get viewColumn(){return t._viewColumn},get replOptions(){if(t.viewType===`repl`)return{appendIndex:this.notebook.cellCount-1}},[Symbol.for(`debug.description`)](){return`NotebookEditor(${this.notebook.uri.toString()})`}},e.apiEditorsToExtHost.set(this._editor,this)}return this._editor}get visible(){return this._visible}_acceptVisibility(e){this._visible=e}_acceptVisibleRanges(e){this._visibleRanges=e}_acceptSelections(e){this._selections=e}_trySetSelections(e){this._proxy.$trySetSelections(this.id,e.map(EO.from))}_acceptViewColumn(e){this._viewColumn=e}},fH=class{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==$)return mH(this.right);let e=this;for(;e.parent!==$&&e.parent.left!==e;)e=e.parent;return e.parent===$?$:e.parent}prev(){if(this.left!==$)return hH(this.left);let e=this;for(;e.parent!==$&&e.parent.right!==e;)e=e.parent;return e.parent===$?$:e.parent}detach(){this.parent=null,this.left=null,this.right=null}},pH;(function(e){e[e.Black=0]=`Black`,e[e.Red=1]=`Red`})(pH||={});const $=new fH(null,pH.Black);$.parent=$,$.left=$,$.right=$,$.color=pH.Black;function mH(e){for(;e.left!==$;)e=e.left;return e}function hH(e){for(;e.right!==$;)e=e.right;return e}function gH(e){return e===$?0:e.size_left+e.piece.length+gH(e.right)}function _H(e){return e===$?0:e.lf_left+e.piece.lineFeedCnt+_H(e.right)}function vH(){$.parent=$}function yH(e,t){let n=t.right;n.size_left+=t.size_left+(t.piece?t.piece.length:0),n.lf_left+=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),t.right=n.left,n.left!==$&&(n.left.parent=t),n.parent=t.parent,t.parent===$?e.root=n:t.parent.left===t?t.parent.left=n:t.parent.right=n,n.left=t,t.parent=n}function bH(e,t){let n=t.left;t.left=n.right,n.right!==$&&(n.right.parent=t),n.parent=t.parent,t.size_left-=n.size_left+(n.piece?n.piece.length:0),t.lf_left-=n.lf_left+(n.piece?n.piece.lineFeedCnt:0),t.parent===$?e.root=n:t===t.parent.right?t.parent.right=n:t.parent.left=n,n.right=t,t.parent=n}function xH(e,t){let n,r;if(t.left===$?(r=t,n=r.right):t.right===$?(r=t,n=r.left):(r=mH(t.right),n=r.right),r===e.root){e.root=n,n.color=pH.Black,t.detach(),vH(),e.root.parent=$;return}let i=r.color===pH.Red;if(r===r.parent.left?r.parent.left=n:r.parent.right=n,r===t?(n.parent=r.parent,wH(e,n)):(r.parent===t?n.parent=r:n.parent=r.parent,wH(e,n),r.left=t.left,r.right=t.right,r.parent=t.parent,r.color=t.color,t===e.root?e.root=r:t===t.parent.left?t.parent.left=r:t.parent.right=r,r.left!==$&&(r.left.parent=r),r.right!==$&&(r.right.parent=r),r.size_left=t.size_left,r.lf_left=t.lf_left,wH(e,r)),t.detach(),n.parent.left===n){let t=gH(n),r=_H(n);if(t!==n.parent.size_left||r!==n.parent.lf_left){let i=t-n.parent.size_left,a=r-n.parent.lf_left;n.parent.size_left=t,n.parent.lf_left=r,CH(e,n.parent,i,a)}}if(wH(e,n.parent),i){vH();return}let a;for(;n!==e.root&&n.color===pH.Black;)n===n.parent.left?(a=n.parent.right,a.color===pH.Red&&(a.color=pH.Black,n.parent.color=pH.Red,yH(e,n.parent),a=n.parent.right),a.left.color===pH.Black&&a.right.color===pH.Black?(a.color=pH.Red,n=n.parent):(a.right.color===pH.Black&&(a.left.color=pH.Black,a.color=pH.Red,bH(e,a),a=n.parent.right),a.color=n.parent.color,n.parent.color=pH.Black,a.right.color=pH.Black,yH(e,n.parent),n=e.root)):(a=n.parent.left,a.color===pH.Red&&(a.color=pH.Black,n.parent.color=pH.Red,bH(e,n.parent),a=n.parent.left),a.left.color===pH.Black&&a.right.color===pH.Black?(a.color=pH.Red,n=n.parent):(a.left.color===pH.Black&&(a.right.color=pH.Black,a.color=pH.Red,yH(e,a),a=n.parent.left),a.color=n.parent.color,n.parent.color=pH.Black,a.left.color=pH.Black,bH(e,n.parent),n=e.root));n.color=pH.Black,vH()}function SH(e,t){for(wH(e,t);t!==e.root&&t.parent.color===pH.Red;)if(t.parent===t.parent.parent.left){let n=t.parent.parent.right;n.color===pH.Red?(t.parent.color=pH.Black,n.color=pH.Black,t.parent.parent.color=pH.Red,t=t.parent.parent):(t===t.parent.right&&(t=t.parent,yH(e,t)),t.parent.color=pH.Black,t.parent.parent.color=pH.Red,bH(e,t.parent.parent))}else{let n=t.parent.parent.left;n.color===pH.Red?(t.parent.color=pH.Black,n.color=pH.Black,t.parent.parent.color=pH.Red,t=t.parent.parent):(t===t.parent.left&&(t=t.parent,bH(e,t)),t.parent.color=pH.Black,t.parent.parent.color=pH.Red,yH(e,t.parent.parent))}e.root.color=pH.Black}function CH(e,t,n,r){for(;t!==e.root&&t!==$;)t.parent.left===t&&(t.parent.size_left+=n,t.parent.lf_left+=r),t=t.parent}function wH(e,t){let n=0,r=0;if(t!==e.root){for(;t!==e.root&&t===t.parent.right;)t=t.parent;if(t!==e.root)for(t=t.parent,n=gH(t.left)-t.size_left,r=_H(t.left)-t.lf_left,t.size_left+=n,t.lf_left+=r;t!==e.root&&(n!==0||r!==0);)t.parent.left===t&&(t.parent.size_left+=n,t.parent.lf_left+=r),t=t.parent}}const TH=65535;function EH(e){let t;return t=e[e.length-1]<65536?new Uint16Array(e.length):new Uint32Array(e.length),t.set(e,0),t}var DH=class{constructor(e,t,n,r,i){this.lineStarts=e,this.cr=t,this.lf=n,this.crlf=r,this.isBasicASCII=i}};function OH(e,t=!0){let n=[0],r=1;for(let t=0,i=e.length;t<i;t++){let a=e.charCodeAt(t);a===S.CarriageReturn?t+1<i&&e.charCodeAt(t+1)===S.LineFeed?(n[r++]=t+2,t++):n[r++]=t+1:a===S.LineFeed&&(n[r++]=t+1)}return t?EH(n):n}function kH(e,t){e.length=0,e[0]=0;let n=1,r=0,i=0,a=0,o=!0;for(let s=0,c=t.length;s<c;s++){let l=t.charCodeAt(s);l===S.CarriageReturn?s+1<c&&t.charCodeAt(s+1)===S.LineFeed?(a++,e[n++]=s+2,s++):(r++,e[n++]=s+1):l===S.LineFeed?(i++,e[n++]=s+1):o&&l!==S.Tab&&(l<32||l>126)&&(o=!1)}let s=new DH(EH(e),r,i,a,o);return e.length=0,s}var AH=class{constructor(e,t,n,r,i){this.bufferIndex=e,this.start=t,this.end=n,this.lineFeedCnt=r,this.length=i}},jH=class{constructor(e,t){this.buffer=e,this.lineStarts=t}},MH=class{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==$&&e.iterate(e.root,e=>(e!==$&&this._pieces.push(e.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}},NH=class{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e)return n}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e)return n}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1,n=this._cache;for(let r=0;r<n.length;r++){let i=n[r];if(i.node.parent===null||i.nodeStartOffset>=e){n[r]=null,t=!0;continue}}if(t){let e=[];for(let t of n)t!==null&&e.push(t);this._cache=e}}},PH=class{constructor(e,t,n){this.create(e,t,n)}create(e,t,n){this._buffers=[new jH(``,[0])],this._lastChangeBufferPos={line:0,column:0},this.root=$,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=n;let r=null;for(let t=0,n=e.length;t<n;t++)if(e[t].buffer.length>0){e[t].lineStarts||(e[t].lineStarts=OH(e[t].buffer));let n=new AH(t+1,{line:0,column:0},{line:e[t].lineStarts.length-1,column:e[t].buffer.length-e[t].lineStarts[e[t].lineStarts.length-1]},e[t].lineStarts.length-1,e[t].buffer.length);this._buffers.push(e[t]),r=this.rbInsertRight(r,n)}this._searchCache=new NH(1),this._lastVisitedLine={lineNumber:0,value:``},this.computeBufferMetadata()}normalizeEOL(e){let t=TH,n=t-Math.floor(t/3),r=n*2,i=``,a=0,o=[];if(this.iterate(this.root,t=>{let s=this.getNodeContent(t),c=s.length;if(a<=n||a+c<r)return i+=s,a+=c,!0;let l=i.replace(/\r\n|\r|\n/g,e);return o.push(new jH(l,OH(l))),i=s,a=c,!0}),a>0){let t=i.replace(/\r\n|\r|\n/g,e);o.push(new jH(t,OH(t)))}this.create(o,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new MH(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0,n=this.iterate(this.root,n=>{if(n===$)return!0;let r=this.getNodeContent(n),i=r.length,a=e.nodeAt(t),o=e.nodeAt(t+i),s=e.getValueInRange2(a,o);return t+=i,r===s});return n}getOffsetAt(e,t){let n=0,r=this.root;for(;r!==$;)if(r.left!==$&&r.lf_left+1>=e)r=r.left;else if(r.lf_left+r.piece.lineFeedCnt+1>=e){n+=r.size_left;let i=this.getAccumulatedValue(r,e-r.lf_left-2);return n+=i+t-1}else e-=r.lf_left+r.piece.lineFeedCnt,n+=r.size_left+r.piece.length,r=r.right;return n}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,n=0,r=e;for(;t!==$;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){let i=this.getIndexOf(t,e-t.size_left);if(n+=t.lf_left+i.index,i.index===0){let e=this.getOffsetAt(n+1,1),t=r-e;return new _p(n+1,t+1)}return new _p(n+1,i.remainder+1)}else if(e-=t.size_left+t.piece.length,n+=t.lf_left+t.piece.lineFeedCnt,t.right===$){let t=this.getOffsetAt(n+1,1),i=r-e-t;return new _p(n+1,i+1)}else t=t.right;return new _p(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return``;let n=this.nodeAt2(e.startLineNumber,e.startColumn),r=this.nodeAt2(e.endLineNumber,e.endColumn),i=this.getValueInRange2(n,r);return t?t!==this._EOL||!this._EOLNormalized?i.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?i:i.replace(/\r\n|\r|\n/g,t):i}getValueInRange2(e,t){if(e.node===t.node){let n=e.node,r=this._buffers[n.piece.bufferIndex].buffer,i=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return r.substring(i+e.remainder,i+t.remainder)}let n=e.node,r=this._buffers[n.piece.bufferIndex].buffer,i=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start),a=r.substring(i+e.remainder,i+n.piece.length);for(n=n.next();n!==$;){let e=this._buffers[n.piece.bufferIndex].buffer,r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===t.node){a+=e.substring(r,r+t.remainder);break}else a+=e.substr(r,n.piece.length);n=n.next()}return a}getLinesContent(){let e=[],t=0,n=``,r=!1;return this.iterate(this.root,i=>{if(i===$)return!0;let a=i.piece,o=a.length;if(o===0)return!0;let s=this._buffers[a.bufferIndex].buffer,c=this._buffers[a.bufferIndex].lineStarts,l=a.start.line,u=a.end.line,d=c[l]+a.start.column;if(r&&(s.charCodeAt(d)===S.LineFeed&&(d++,o--),e[t++]=n,n=``,r=!1,o===0))return!0;if(l===u)return!this._EOLNormalized&&s.charCodeAt(d+o-1)===S.CarriageReturn?(r=!0,n+=s.substr(d,o-1)):n+=s.substr(d,o),!0;n+=this._EOLNormalized?s.substring(d,Math.max(d,c[l+1]-this._EOLLength)):s.substring(d,c[l+1]).replace(/(\r\n|\r|\n)$/,``),e[t++]=n;for(let r=l+1;r<u;r++)n=this._EOLNormalized?s.substring(c[r],c[r+1]-this._EOLLength):s.substring(c[r],c[r+1]).replace(/(\r\n|\r|\n)$/,``),e[t++]=n;return!this._EOLNormalized&&s.charCodeAt(c[u]+a.end.column-1)===S.CarriageReturn?(r=!0,a.end.column===0?t--:n=s.substr(c[u],a.end.column-1)):n=s.substr(c[u],a.end.column),!0}),r&&(e[t++]=n,n=``),e[t++]=n,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,``),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){let t=e.node.next();if(!t)return 0;let n=this._buffers[t.piece.bufferIndex],r=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return n.buffer.charCodeAt(r)}else{let t=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start),r=n+e.remainder;return t.buffer.charCodeAt(r)}}getLineCharCode(e,t){let n=this.nodeAt2(e,t+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){let t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){let t=this.nodeAt(e);return this._getCharCode(t)}getNearestChunk(e){let t=this.nodeAt(e);if(t.remainder===t.node.piece.length){let e=t.node.next();if(!e||e===$)return``;let n=this._buffers[e.piece.bufferIndex],r=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);return n.buffer.substring(r,r+e.piece.length)}else{let e=this._buffers[t.node.piece.bufferIndex],n=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),r=n+t.remainder,i=n+t.node.piece.length;return e.buffer.substring(r,i)}}findMatchesInNode(e,t,n,r,i,a,o,s,c,l,u){let d=this._buffers[e.piece.bufferIndex],f=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),p=this.offsetInBuffer(e.piece.bufferIndex,i),ee=this.offsetInBuffer(e.piece.bufferIndex,a),m,te={line:0,column:0},ne,re;t._wordSeparators?(ne=d.buffer.substring(p,ee),re=e=>e+p,t.reset(0)):(ne=d.buffer,re=e=>e,t.reset(p));do if(m=t.next(ne),m){if(re(m.index)>=ee)return l;this.positionInBuffer(e,re(m.index)-f,te);let t=this.getLineFeedCnt(e.piece.bufferIndex,i,te),a=te.line===i.line?te.column-i.column+r:te.column+1,o=a+m[0].length;if(u[l++]=pP(new vp(n+t,a,n+t,o),m,s),re(m.index)+m[0].length>=ee||l>=c)return l}while(m);return l}findMatchesLineByLine(e,t,n,r){let i=[],a=0,o=new _P(t.wordSeparators,t.regex),s=this.nodeAt2(e.startLineNumber,e.startColumn);if(s===null)return[];let c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null)return[];let l=this.positionInBuffer(s.node,s.remainder),u=this.positionInBuffer(c.node,c.remainder);if(s.node===c.node)return this.findMatchesInNode(s.node,o,e.startLineNumber,e.startColumn,l,u,t,n,r,a,i),i;let d=e.startLineNumber,f=s.node;for(;f!==c.node;){let c=this.getLineFeedCnt(f.piece.bufferIndex,l,f.piece.end);if(c>=1){let s=this._buffers[f.piece.bufferIndex].lineStarts,u=this.offsetInBuffer(f.piece.bufferIndex,f.piece.start),p=s[l.line+c],ee=d===e.startLineNumber?e.startColumn:1;if(a=this.findMatchesInNode(f,o,d,ee,l,this.positionInBuffer(f,p-u),t,n,r,a,i),a>=r)return i;d+=c}let u=d===e.startLineNumber?e.startColumn-1:0;if(d===e.endLineNumber){let s=this.getLineContent(d).substring(u,e.endColumn-1);return a=this._findMatchesInLine(t,o,s,e.endLineNumber,u,a,i,n,r),i}if(a=this._findMatchesInLine(t,o,this.getLineContent(d).substr(u),d,u,a,i,n,r),a>=r)return i;d++,s=this.nodeAt2(d,1),f=s.node,l=this.positionInBuffer(s.node,s.remainder)}if(d===e.endLineNumber){let s=d===e.startLineNumber?e.startColumn-1:0,c=this.getLineContent(d).substring(s,e.endColumn-1);return a=this._findMatchesInLine(t,o,c,e.endLineNumber,s,a,i,n,r),i}let p=d===e.startLineNumber?e.startColumn:1;return a=this.findMatchesInNode(c.node,o,d,p,l,u,t,n,r,a,i),i}_findMatchesInLine(e,t,n,r,i,a,o,s,c){let l=e.wordSeparators;if(!s&&e.simpleSearch){let t=e.simpleSearch,s=t.length,u=n.length,d=-s;for(;(d=n.indexOf(t,d+s))!==-1;)if((!l||gP(l,n,u,d,s))&&(o[a++]=new cm(new vp(r,d+1+i,r,d+1+s+i),null),a>=c))return a;return a}let u;t.reset(0);do if(u=t.next(n),u&&(o[a++]=pP(new vp(r,u.index+1+i,r,u.index+1+u[0].length+i),u,s),a>=c))return a;while(u);return a}insert(e,t,n=!1){if(this._EOLNormalized=this._EOLNormalized&&n,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value=``,this.root!==$){let{node:n,remainder:r,nodeStartOffset:i}=this.nodeAt(e),a=n.piece,o=a.bufferIndex,s=this.positionInBuffer(n,r);if(n.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&i+a.length===e&&t.length<TH){this.appendToNode(n,t),this.computeBufferMetadata();return}if(i===e)this.insertContentToNodeLeft(t,n),this._searchCache.validate(e);else if(i+n.piece.length>e){let e=[],i=new AH(a.bufferIndex,s,a.end,this.getLineFeedCnt(a.bufferIndex,s,a.end),this.offsetInBuffer(o,a.end)-this.offsetInBuffer(o,s));if(this.shouldCheckCRLF()&&this.endWithCR(t)){let e=this.nodeCharCodeAt(n,r);if(e===10){let e={line:i.start.line+1,column:0};i=new AH(i.bufferIndex,e,i.end,this.getLineFeedCnt(i.bufferIndex,e,i.end),i.length-1),t+=`
`}}if(this.shouldCheckCRLF()&&this.startWithLF(t)){let i=this.nodeCharCodeAt(n,r-1);if(i===13){let i=this.positionInBuffer(n,r-1);this.deleteNodeTail(n,i),t=`\r`+t,n.piece.length===0&&e.push(n)}else this.deleteNodeTail(n,s)}else this.deleteNodeTail(n,s);let c=this.createNewPieces(t);i.length>0&&this.rbInsertRight(n,i);let l=n;for(let e=0;e<c.length;e++)l=this.rbInsertRight(l,c[e]);this.deleteNodes(e)}else this.insertContentToNodeRight(t,n)}else{let e=this.createNewPieces(t),n=this.rbInsertLeft(null,e[0]);for(let t=1;t<e.length;t++)n=this.rbInsertRight(n,e[t])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value=``,t<=0||this.root===$)return;let n=this.nodeAt(e),r=this.nodeAt(e+t),i=n.node,a=r.node;if(i===a){let a=this.positionInBuffer(i,n.remainder),o=this.positionInBuffer(i,r.remainder);if(n.nodeStartOffset===e){if(t===i.piece.length){let e=i.next();xH(this,i),this.validateCRLFWithPrevNode(e),this.computeBufferMetadata();return}this.deleteNodeHead(i,o),this._searchCache.validate(e),this.validateCRLFWithPrevNode(i),this.computeBufferMetadata();return}if(n.nodeStartOffset+i.piece.length===e+t){this.deleteNodeTail(i,a),this.validateCRLFWithNextNode(i),this.computeBufferMetadata();return}this.shrinkNode(i,a,o),this.computeBufferMetadata();return}let o=[],s=this.positionInBuffer(i,n.remainder);this.deleteNodeTail(i,s),this._searchCache.validate(e),i.piece.length===0&&o.push(i);let c=this.positionInBuffer(a,r.remainder);this.deleteNodeHead(a,c),a.piece.length===0&&o.push(a);let l=i.next();for(let e=l;e!==$&&e!==a;e=e.next())o.push(e);let u=i.piece.length===0?i.prev():i;this.deleteNodes(o),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){let n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){let r=t.piece,i={line:r.start.line+1,column:0},a=new AH(r.bufferIndex,i,r.end,this.getLineFeedCnt(r.bufferIndex,i,r.end),r.length-1);t.piece=a,e+=`
`,CH(this,t,-1,-1),t.piece.length===0&&n.push(t)}let r=this.createNewPieces(e),i=this.rbInsertLeft(t,r[r.length-1]);for(let e=r.length-2;e>=0;e--)i=this.rbInsertLeft(i,r[e]);this.validateCRLFWithPrevNode(i),this.deleteNodes(n)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);let n=this.createNewPieces(e),r=this.rbInsertRight(t,n[0]),i=r;for(let e=1;e<n.length;e++)i=this.rbInsertRight(i,n[e]);this.validateCRLFWithPrevNode(r)}positionInBuffer(e,t,n){let r=e.piece,i=e.piece.bufferIndex,a=this._buffers[i].lineStarts,o=a[r.start.line]+r.start.column,s=o+t,c=r.start.line,l=r.end.line,u=0,d=0,f=0;for(;c<=l&&(u=c+(l-c)/2|0,f=a[u],u!==l);)if(d=a[u+1],s<f)l=u-1;else if(s>=d)c=u+1;else break;return n?(n.line=u,n.column=s-f,null):{line:u,column:s-f}}getLineFeedCnt(e,t,n){if(n.column===0)return n.line-t.line;let r=this._buffers[e].lineStarts;if(n.line===r.length-1)return n.line-t.line;let i=r[n.line+1],a=r[n.line]+n.column;if(i>a+1)return n.line-t.line;let o=a-1,s=this._buffers[e].buffer;return s.charCodeAt(o)===13?n.line-t.line+1:n.line-t.line}offsetInBuffer(e,t){let n=this._buffers[e].lineStarts;return n[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)xH(this,e[t])}createNewPieces(e){if(e.length>TH){let t=[];for(;e.length>TH;){let n=e.charCodeAt(TH-1),r;n===S.CarriageReturn||n>=55296&&n<=56319?(r=e.substring(0,TH-1),e=e.substring(TH-1)):(r=e.substring(0,TH),e=e.substring(TH));let i=OH(r);t.push(new AH(this._buffers.length,{line:0,column:0},{line:i.length-1,column:r.length-i[i.length-1]},i.length-1,r.length)),this._buffers.push(new jH(r,i))}let n=OH(e);return t.push(new AH(this._buffers.length,{line:0,column:0},{line:n.length-1,column:e.length-n[n.length-1]},n.length-1,e.length)),this._buffers.push(new jH(e,n)),t}let t=this._buffers[0].buffer.length,n=OH(e,!1),r=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},r=this._lastChangeBufferPos;for(let e=0;e<n.length;e++)n[e]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+=`_`+e,t+=1}else{if(t!==0)for(let e=0;e<n.length;e++)n[e]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+=e}let i=this._buffers[0].buffer.length,a=this._buffers[0].lineStarts.length-1,o=i-this._buffers[0].lineStarts[a],s={line:a,column:o},c=new AH(0,r,s,this.getLineFeedCnt(0,r,s),i-t);return this._lastChangeBufferPos=s,[c]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let n=this.root,r=``,i=this._searchCache.get2(e);if(i){n=i.node;let a=this.getAccumulatedValue(n,e-i.nodeStartLineNumber-1),o=this._buffers[n.piece.bufferIndex].buffer,s=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(i.nodeStartLineNumber+n.piece.lineFeedCnt===e)r=o.substring(s+a,s+n.piece.length);else{let r=this.getAccumulatedValue(n,e-i.nodeStartLineNumber);return o.substring(s+a,s+r-t)}}else{let i=0,a=e;for(;n!==$;)if(n.left!==$&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let r=this.getAccumulatedValue(n,e-n.lf_left-2),o=this.getAccumulatedValue(n,e-n.lf_left-1),s=this._buffers[n.piece.bufferIndex].buffer,c=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i+=n.size_left,this._searchCache.set({node:n,nodeStartOffset:i,nodeStartLineNumber:a-(e-1-n.lf_left)}),s.substring(c+r,c+o-t)}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let t=this.getAccumulatedValue(n,e-n.lf_left-2),i=this._buffers[n.piece.bufferIndex].buffer,a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);r=i.substring(a+t,a+n.piece.length);break}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right}for(n=n.next();n!==$;){let e=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){let i=this.getAccumulatedValue(n,0),a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return r+=e.substring(a,a+i-t),r}else{let t=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);r+=e.substr(t,n.piece.length)}n=n.next()}return r}computeBufferMetadata(){let e=this.root,t=1,n=0;for(;e!==$;)t+=e.lf_left+e.piece.lineFeedCnt,n+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=n,this._searchCache.validate(this._length)}getIndexOf(e,t){let n=e.piece,r=this.positionInBuffer(e,t),i=r.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===t){let t=this.getLineFeedCnt(e.piece.bufferIndex,n.start,r);if(t!==i)return{index:t,remainder:0}}return{index:i,remainder:r.column}}getAccumulatedValue(e,t){if(t<0)return 0;let n=e.piece,r=this._buffers[n.bufferIndex].lineStarts,i=n.start.line+t+1;return i>n.end.line?r[n.end.line]+n.end.column-r[n.start.line]-n.start.column:r[i]-r[n.start.line]-n.start.column}deleteNodeTail(e,t){let n=e.piece,r=n.lineFeedCnt,i=this.offsetInBuffer(n.bufferIndex,n.end),a=t,o=this.offsetInBuffer(n.bufferIndex,a),s=this.getLineFeedCnt(n.bufferIndex,n.start,a),c=s-r,l=o-i,u=n.length+l;e.piece=new AH(n.bufferIndex,n.start,a,s,u),CH(this,e,l,c)}deleteNodeHead(e,t){let n=e.piece,r=n.lineFeedCnt,i=this.offsetInBuffer(n.bufferIndex,n.start),a=t,o=this.getLineFeedCnt(n.bufferIndex,a,n.end),s=this.offsetInBuffer(n.bufferIndex,a),c=o-r,l=i-s,u=n.length+l;e.piece=new AH(n.bufferIndex,a,n.end,o,u),CH(this,e,l,c)}shrinkNode(e,t,n){let r=e.piece,i=r.start,a=r.end,o=r.length,s=r.lineFeedCnt,c=t,l=this.getLineFeedCnt(r.bufferIndex,r.start,c),u=this.offsetInBuffer(r.bufferIndex,t)-this.offsetInBuffer(r.bufferIndex,i);e.piece=new AH(r.bufferIndex,r.start,c,l,u),CH(this,e,u-o,l-s);let d=new AH(r.bufferIndex,n,a,this.getLineFeedCnt(r.bufferIndex,n,a),this.offsetInBuffer(r.bufferIndex,a)-this.offsetInBuffer(r.bufferIndex,n)),f=this.rbInsertRight(e,d);this.validateCRLFWithPrevNode(f)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);let n=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),r=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;let i=OH(t,!1);for(let e=0;e<i.length;e++)i[e]+=r;if(n){let e=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:r-e}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1));let a=this._buffers[0].lineStarts.length-1,o=this._buffers[0].buffer.length-this._buffers[0].lineStarts[a],s={line:a,column:o},c=e.piece.length+t.length,l=e.piece.lineFeedCnt,u=this.getLineFeedCnt(0,e.piece.start,s),d=u-l;e.piece=new AH(e.piece.bufferIndex,e.piece.start,s,u,c),this._lastChangeBufferPos=s,CH(this,e,t.length,d)}nodeAt(e){let t=this.root,n=this._searchCache.get(e);if(n)return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset};let r=0;for(;t!==$;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){r+=t.size_left;let n={node:t,remainder:e-t.size_left,nodeStartOffset:r};return this._searchCache.set(n),n}else e-=t.size_left+t.piece.length,r+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let n=this.root,r=0;for(;n!==$;)if(n.left!==$&&n.lf_left>=e-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>e-1){let i=this.getAccumulatedValue(n,e-n.lf_left-2),a=this.getAccumulatedValue(n,e-n.lf_left-1);return r+=n.size_left,{node:n,remainder:Math.min(i+t-1,a),nodeStartOffset:r}}else if(n.lf_left+n.piece.lineFeedCnt===e-1){let i=this.getAccumulatedValue(n,e-n.lf_left-2);if(i+t-1<=n.piece.length)return{node:n,remainder:i+t-1,nodeStartOffset:r};t-=n.piece.length-i;break}else e-=n.lf_left+n.piece.lineFeedCnt,r+=n.size_left+n.piece.length,n=n.right;for(n=n.next();n!==$;){if(n.piece.lineFeedCnt>0){let e=this.getAccumulatedValue(n,0),r=this.offsetOfNode(n);return{node:n,remainder:Math.min(t-1,e),nodeStartOffset:r}}else if(n.piece.length>=t-1){let e=this.offsetOfNode(n);return{node:n,remainder:t-1,nodeStartOffset:e}}else t-=n.piece.length;n=n.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;let n=this._buffers[e.piece.bufferIndex],r=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return n.buffer.charCodeAt(r)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e==`string`)return e.charCodeAt(0)===10;if(e===$||e.piece.lineFeedCnt===0)return!1;let t=e.piece,n=this._buffers[t.bufferIndex].lineStarts,r=t.start.line,i=n[r]+t.start.column;if(r===n.length-1)return!1;let a=n[r+1];return a>i+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(i)===10}endWithCR(e){return typeof e==`string`?e.charCodeAt(e.length-1)===13:e===$||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){let t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){let n=[],r=this._buffers[e.piece.bufferIndex].lineStarts,i;i=e.piece.end.column===0?{line:e.piece.end.line-1,column:r[e.piece.end.line]-r[e.piece.end.line-1]-1}:{line:e.piece.end.line,column:e.piece.end.column-1};let a=e.piece.length-1,o=e.piece.lineFeedCnt-1;e.piece=new AH(e.piece.bufferIndex,e.piece.start,i,o,a),CH(this,e,-1,-1),e.piece.length===0&&n.push(e);let s={line:t.piece.start.line+1,column:0},c=t.piece.length-1,l=this.getLineFeedCnt(t.piece.bufferIndex,s,t.piece.end);t.piece=new AH(t.piece.bufferIndex,s,t.piece.end,l,c),CH(this,t,-1,-1),t.piece.length===0&&n.push(t);let u=this.createNewPieces(`\r
`);this.rbInsertRight(e,u[0]);for(let e=0;e<n.length;e++)xH(this,n[e])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let n=t.next();if(this.startWithLF(n)){if(e+=`
`,n.piece.length===1)xH(this,n);else{let e=n.piece,t={line:e.start.line+1,column:0},r=e.length-1,i=this.getLineFeedCnt(e.bufferIndex,t,e.end);n.piece=new AH(e.bufferIndex,t,e.end,i,r),CH(this,n,-1,-1)}return!0}}return!1}iterate(e,t){if(e===$)return t($);let n=this.iterate(e.left,t);return n&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===$)return``;let t=this._buffers[e.piece.bufferIndex],n=e.piece,r=this.offsetInBuffer(n.bufferIndex,n.start),i=this.offsetInBuffer(n.bufferIndex,n.end),a=t.buffer.substring(r,i);return a}getPieceContent(e){let t=this._buffers[e.bufferIndex],n=this.offsetInBuffer(e.bufferIndex,e.start),r=this.offsetInBuffer(e.bufferIndex,e.end),i=t.buffer.substring(n,r);return i}rbInsertRight(e,t){let n=new fH(t,pH.Red);n.left=$,n.right=$,n.parent=$,n.size_left=0,n.lf_left=0;let r=this.root;if(r===$)this.root=n,n.color=pH.Black;else if(e.right===$)e.right=n,n.parent=e;else{let t=mH(e.right);t.left=n,n.parent=t}return SH(this,n),n}rbInsertLeft(e,t){let n=new fH(t,pH.Red);if(n.left=$,n.right=$,n.parent=$,n.size_left=0,n.lf_left=0,this.root===$)this.root=n,n.color=pH.Black;else if(e.left===$)e.left=n,n.parent=e;else{let t=hH(e.left);t.right=n,n.parent=t}return SH(this,n),n}getContentOfSubTree(e){let t=``;return this.iterate(e,e=>(t+=this.getNodeContent(e),!0)),t}},FH;(function(e){e[e.Unknown=0]=`Unknown`,e[e.Invalid=3]=`Invalid`,e[e.LF=1]=`LF`,e[e.CRLF=2]=`CRLF`})(FH||={});function IH(e){let t=0,n=0,r=0,i=FH.Unknown;for(let a=0,o=e.length;a<o;a++){let s=e.charCodeAt(a);s===S.CarriageReturn?(t===0&&(n=a),t++,a+1<o&&e.charCodeAt(a+1)===S.LineFeed?(i|=FH.CRLF,a++):i|=FH.Invalid,r=a+1):s===S.LineFeed&&(i|=FH.LF,t===0&&(n=a),t++,r=a+1)}return t===0&&(n=e.length),[t,n,e.length-r,i]}let LH;function RH(){return LH||=new TextDecoder(`UTF-16LE`),LH}function zH(e,t,n){let r=new Uint16Array(e.buffer,t,n);return n>0&&(r[0]===65279||r[0]===65534)?BH(e,t,n):RH().decode(r)}function BH(e,t,n){let r=[],i=0;for(let a=0;a<n;a++){let n=Pt(e,t);t+=2,r[i++]=String.fromCharCode(n)}return r.join(``)}function VH(e){return e.replace(/\n/g,`\\n`).replace(/\r/g,`\\r`)}var HH=class e{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,n,r){this.oldPosition=e,this.oldText=t,this.newPosition=n,this.newText=r}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${VH(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${VH(this.oldText)}")`:`(replace@${this.oldPosition} "${VH(this.oldText)}" with "${VH(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,n){let r=t.length;Lt(e,r,n),n+=4;for(let i=0;i<r;i++)Ft(e,t.charCodeAt(i),n),n+=2;return n}static _readString(e,t){let n=It(e,t);return t+=4,zH(e,t,n)}writeSize(){return 8+e._writeStringSize(this.oldText)+e._writeStringSize(this.newText)}write(t,n){return Lt(t,this.oldPosition,n),n+=4,Lt(t,this.newPosition,n),n+=4,n=e._writeString(t,this.oldText,n),n=e._writeString(t,this.newText,n),n}static read(t,n,r){let i=It(t,n);n+=4;let a=It(t,n);n+=4;let o=e._readString(t,n);n+=e._writeStringSize(o);let s=e._readString(t,n);return n+=e._writeStringSize(s),r.push(new e(i,o,a,s)),n}},UH=class e extends y{constructor(e,t,n,r,i,a,o){super(),this._onDidChangeContent=this._register(new x),this.onDidChangeContent=this._onDidChangeContent.event,this._BOM=t,this._mightContainNonBasicASCII=!a,this._mightContainRTL=r,this._mightContainUnusualLineTerminators=i,this._pieceTree=new PH(e,n,o)}equals(t){return!(t instanceof e)||this._BOM!==t._BOM||this.getEOL()!==t.getEOL()?!1:this._pieceTree.equal(t._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:``)}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){let n=e+t,r=this.getPositionAt(e),i=this.getPositionAt(n);return new vp(r.lineNumber,r.column,i.lineNumber,i.column)}getValueInRange(e,t=am.TextDefined){if(e.isEmpty())return``;let n=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,t=am.TextDefined){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;let n=this.getOffsetAt(e.startLineNumber,e.startColumn),r=this.getOffsetAt(e.endLineNumber,e.endColumn),i=0,a=this._getEndOfLine(t),o=this.getEOL();if(a.length!==o.length){let t=a.length-o.length,n=e.endLineNumber-e.startLineNumber;i=t*n}return r-n+i}getCharacterCountInRange(e,t=am.TextDefined){if(this._mightContainNonBasicASCII){let n=0,r=e.startLineNumber,i=e.endLineNumber;for(let t=r;t<=i;t++){let a=this.getLineContent(t),o=t===r?e.startColumn-1:0,s=t===i?e.endColumn-1:a.length;for(let e=o;e<s;e++)na(a.charCodeAt(e))?(n+=1,e+=1):n+=1}return n+=this._getEndOfLine(t).length*(i-r),n}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){let t=Ki(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){let t=qi(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case am.LF:return`
`;case am.CRLF:return`\r
`;case am.TextDefined:return this.getEOL();default:throw Error(`Unknown EOL preference`)}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(t,n,r){let i=this._mightContainRTL,a=this._mightContainUnusualLineTerminators,o=this._mightContainNonBasicASCII,s=!0,c=[];for(let e=0;e<t.length;e++){let n=t[e];s&&n._isTracked&&(s=!1);let r=n.range;if(n.text){let e=!0;o||=(e=!ma(n.text),e),!i&&e&&(i=fa(n.text)),!a&&e&&(a=ga(n.text))}let l=``,u=0,d=0,f=0;if(n.text){let e;[u,d,f,e]=IH(n.text);let t=this.getEOL(),r=t===`\r
`?FH.CRLF:FH.LF;l=e===FH.Unknown||e===r?n.text:n.text.replace(/\r\n|\r|\n/g,t)}c[e]={sortIndex:e,identifier:n.identifier||null,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r),text:l,eolCount:u,firstLineLength:d,lastLineLength:f,forceMoveMarkers:!!n.forceMoveMarkers,isAutoWhitespaceEdit:n.isAutoWhitespaceEdit||!1}}c.sort(e._sortOpsAscending);let l=!1;for(let e=0,t=c.length-1;e<t;e++){let t=c[e].range.getEndPosition(),n=c[e+1].range.getStartPosition();if(n.isBeforeOrEqual(t)){if(n.isBefore(t))throw Error(`Overlapping ranges are not allowed!`);l=!0}}s&&(c=this._reduceOperations(c));let u=r||n?e._getInverseEditRanges(c):[],d=[];if(n)for(let e=0;e<c.length;e++){let t=c[e],n=u[e];if(t.isAutoWhitespaceEdit&&t.range.isEmpty())for(let e=n.startLineNumber;e<=n.endLineNumber;e++){let r=``;e===n.startLineNumber&&(r=this.getLineContent(t.range.startLineNumber),Ki(r)!==-1)||d.push({lineNumber:e,oldContent:r})}}let f=null;if(r){let e=0;f=[];for(let t=0;t<c.length;t++){let n=c[t],r=u[t],i=this.getValueInRange(n.range),a=n.rangeOffset+e;e+=n.text.length-i.length,f[t]={sortIndex:n.sortIndex,identifier:n.identifier,range:r,text:i,textChange:new HH(n.rangeOffset,i,a,n.text)}}l||f.sort((e,t)=>e.sortIndex-t.sortIndex)}this._mightContainRTL=i,this._mightContainUnusualLineTerminators=a,this._mightContainNonBasicASCII=o;let p=this._doApplyEdits(c),ee=null;if(n&&d.length>0){d.sort((e,t)=>t.lineNumber-e.lineNumber),ee=[];for(let e=0,t=d.length;e<t;e++){let t=d[e].lineNumber;if(e>0&&d[e-1].lineNumber===t)continue;let n=d[e].oldContent,r=this.getLineContent(t);r.length===0||r===n||Ki(r)!==-1||ee.push(t)}}return this._onDidChangeContent.fire(),new pm(f,p,ee)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1,n=e[0].range,r=e[e.length-1].range,i=new vp(n.startLineNumber,n.startColumn,r.endLineNumber,r.endColumn),a=n.startLineNumber,o=n.startColumn,s=[];for(let n=0,r=e.length;n<r;n++){let r=e[n],i=r.range;t||=r.forceMoveMarkers,s.push(this.getValueInRange(new vp(a,o,i.startLineNumber,i.startColumn))),r.text.length>0&&s.push(r.text),a=i.endLineNumber,o=i.endColumn}let c=s.join(``),[l,u,d]=IH(c);return{sortIndex:0,identifier:e[0].identifier,range:i,rangeOffset:this.getOffsetAt(i.startLineNumber,i.startColumn),rangeLength:this.getValueLengthInRange(i,am.TextDefined),text:c,eolCount:l,firstLineLength:u,lastLineLength:d,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(t){t.sort(e._sortOpsDescending);let n=[];for(let e=0;e<t.length;e++){let r=t[e],i=r.range.startLineNumber,a=r.range.startColumn,o=r.range.endLineNumber,s=r.range.endColumn;if(i===o&&a===s&&r.text.length===0)continue;r.text?(this._pieceTree.delete(r.rangeOffset,r.rangeLength),this._pieceTree.insert(r.rangeOffset,r.text,!0)):this._pieceTree.delete(r.rangeOffset,r.rangeLength);let c=new vp(i,a,o,s);n.push({range:c,rangeLength:r.rangeLength,text:r.text,rangeOffset:r.rangeOffset,forceMoveMarkers:r.forceMoveMarkers})}return n}findMatchesLineByLine(e,t,n,r){return this._pieceTree.findMatchesLineByLine(e,t,n,r)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){let n=e.startLineNumber,r=e.startColumn,[i,a,o]=IH(t),s;if(t.length>0){let e=i+1;s=e===1?new vp(n,r,n,r+a):new vp(n,r,n+e-1,o+1)}else s=new vp(n,r,n,r);return s}static _getInverseEditRanges(e){let t=[],n=0,r=0,i=null;for(let a=0,o=e.length;a<o;a++){let o=e[a],s,c;i?i.range.endLineNumber===o.range.startLineNumber?(s=n,c=r+(o.range.startColumn-i.range.endColumn)):(s=n+(o.range.startLineNumber-i.range.endLineNumber),c=o.range.startColumn):(s=o.range.startLineNumber,c=o.range.startColumn);let l;if(o.text.length>0){let e=o.eolCount+1;l=e===1?new vp(s,c,s,c+o.firstLineLength):new vp(s,c,s+e-1,o.lastLineLength+1)}else l=new vp(s,c,s,c);n=l.endLineNumber,r=l.endColumn,t.push(l),i=o}return t}static _sortOpsAscending(e,t){let n=vp.compareRangesUsingEnds(e.range,t.range);return n===0?e.sortIndex-t.sortIndex:n}static _sortOpsDescending(e,t){let n=vp.compareRangesUsingEnds(e.range,t.range);return n===0?t.sortIndex-e.sortIndex:-n}},WH=class{constructor(e,t,n,r,i,a,o,s,c){this._chunks=e,this._bom=t,this._cr=n,this._lf=r,this._crlf=i,this._containsRTL=a,this._containsUnusualLineTerminators=o,this._isBasicASCII=s,this._normalizeEOL=c}_getEOL(e){let t=this._cr+this._lf+this._crlf,n=this._cr+this._crlf;return t===0?e===om.LF?`
`:`\r
`:n>t/2?`\r
`:`
`}create(e){let t=this._getEOL(e),n=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let e=0,r=n.length;e<r;e++){let r=n[e].buffer.replace(/\r\n|\r|\n/g,t),i=OH(r);n[e]=new jH(r,i)}let r=new UH(n,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:r,disposable:r}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}},GH=class{constructor(){this.chunks=[],this.BOM=``,this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&xa(e)&&(this.BOM=ba,e=e.substr(1));let t=e.charCodeAt(e.length-1);t===S.CarriageReturn||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){let t=kH(this._tmpLineStarts,e);this.chunks.push(new jH(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||=fa(e),this.containsUnusualLineTerminators||=ga(e))}finish(e=!0){return this._finish(),new WH(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1(``,!0),this._hasPreviousChar){this._hasPreviousChar=!1;let e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);let t=OH(e.buffer);e.lineStarts=t,this._previousChar===S.CarriageReturn&&this.cr++}}},KH=class extends y{constructor(e,t,n){super(),this._source=e,this._inputTextBuffer=t,this._outputs=n,this._outputTextBuffers=void 0}_getFullModelRange(e){let t=e.getLineCount();return new vp(1,1,t,this._getLineMaxColumn(e,t))}_getLineMaxColumn(e,t){if(t<1||t>e.getLineCount())throw Error(`Illegal value for lineNumber`);return e.getLineLength(t)+1}get inputTextBuffer(){if(!this._inputTextBuffer){let e=new GH;e.acceptChunk(this._source);let t=e.finish(!0),{textBuffer:n,disposable:r}=t.create(om.LF);this._inputTextBuffer=n,this._register(r)}return this._inputTextBuffer}get outputTextBuffers(){return this._outputTextBuffers||=this._outputs.map(e=>{let t=new GH;t.acceptChunk(e);let n=t.finish(!0),{textBuffer:r,disposable:i}=n.create(om.LF);return this._register(i),r}),this._outputTextBuffers}findInInputs(e){let t=new dP(e,!1,!1,null),n=t.parseSearchRequest();if(!n)return[];let r=this._getFullModelRange(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(r,n,!0,5e3)}findInOutputs(e){let t=new dP(e,!1,!1,null),n=t.parseSearchRequest();return n?this.outputTextBuffers.map(e=>{let t=e.findMatchesLineByLine(this._getFullModelRange(e),n,!0,5e3);if(t.length!==0)return{textBuffer:e,matches:t}}).filter(e=>!!e):[]}};function qH(e,t){let n=-1,r=[],i=[];e.forEach(e=>{e.range.startLineNumber!==n&&i.length>0&&(r.push([...i]),i=[]),i.push(e),n=e.range.endLineNumber}),i.length>0&&r.push([...i]);let a=r.map(e=>{let n=[],r=e[0].range.startLineNumber,i=e[e.length-1].range.endLineNumber;for(let e=r;e<=i;e++)n.push(t.getLineContent(e));return new nA(n.join(`
`)+`
`,e.map(e=>new vp(e.range.startLineNumber-1,e.range.startColumn-1,e.range.endLineNumber-1,e.range.endColumn-1)))});return a}const JH=k(`remoteAgentService`),YH=k(`IUserDataProfilesService`),XH=Object.freeze({id:`workbench`,order:7,title:C(3857,`Workbench`),type:`object`}),ZH=Object.freeze({id:`security`,scope:Zh.APPLICATION,title:C(3858,`Security`),type:`object`,order:7});Object.freeze({id:`problems`,title:C(3859,`Problems`),type:`object`,order:101});const QH=Object.freeze({id:`window`,order:8,title:C(3860,`Window`),type:`object`}),$H={ConfigurationMigration:`base.contributions.configuration.migration`};var eU=class{constructor(){this.migrations=[],this._onDidRegisterConfigurationMigrations=new x,this.onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event}registerConfigurationMigrations(e){this.migrations.push(...e)}};const tU=new eU;Sm.add($H.ConfigurationMigration,tU);let nU=class extends y{static{this.ID=`workbench.contrib.configurationMigration`}constructor(e,t){super(),this.configurationService=e,this.workspaceService=t,this._register(this.workspaceService.onDidChangeWorkspaceFolders(async e=>{for(let t of e.added)await this.migrateConfigurationsForFolder(t,tU.migrations)})),this.migrateConfigurations(tU.migrations),this._register(tU.onDidRegisterConfigurationMigration(e=>this.migrateConfigurations(e)))}async migrateConfigurations(e){await this.migrateConfigurationsForFolder(void 0,e);for(let t of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(t,e)}async migrateConfigurationsForFolder(e,t){await Promise.all([t.map(t=>this.migrateConfigurationsForFolderAndOverride(t,e?.uri))])}async migrateConfigurationsForFolderAndOverride(e,t){let n=this.configurationService.inspect(e.key,{resource:t}),r=this.workspaceService.getWorkbenchState()===Dc.WORKSPACE?[[`user`,Fh.USER],[`userLocal`,Fh.USER_LOCAL],[`userRemote`,Fh.USER_REMOTE],[`workspace`,Fh.WORKSPACE],[`workspaceFolder`,Fh.WORKSPACE_FOLDER]]:[[`user`,Fh.USER],[`userLocal`,Fh.USER_LOCAL],[`userRemote`,Fh.USER_REMOTE],[`workspace`,Fh.WORKSPACE]];for(let[i,a]of r){let r=n[i];if(!r)continue;let o=[];if(r.value!==void 0){let n=await this.runMigration(e,i,r.value,t,void 0);for(let e of n??[])o.push([e,[]])}for(let{identifiers:n,value:a}of r.overrides??[])if(a!==void 0){let r=await this.runMigration(e,i,a,t,n);for(let e of r??[])o.push([e,n])}o.length&&await Promise.allSettled(o.map(async([[e,n],r])=>this.configurationService.updateValue(e,n.value,{resource:t,overrideIdentifiers:r},a)))}}async runMigration(e,t,n,r,i){let a=e=>{let n=this.configurationService.inspect(e,{resource:r}),a=n[t];if(a)return i?a.overrides?.find(({identifiers:e})=>tc(e,i))?.value:a.value},o=await e.migrateFn(n,a);return Array.isArray(o)?o:[[e.key,o]]}};nU=A([j(0,$j),j(1,vP)],nU);let rU=class extends y{static{this.ID=`workbench.contrib.dynamicWorkbenchSecurityConfiguration`}constructor(e){super(),this.remoteAgentService=e,this._ready=new No,this.ready=this._ready.p,this.create()}async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!Xn){let e=await this.remoteAgentService.getEnvironment();if(e?.os!==dr.Windows)return}let e=Sm.as(Xh.Configuration);e.registerConfiguration({...ZH,properties:{"security.allowedUNCHosts":{type:`array`,items:{type:`string`,pattern:`^[^\\\\]+$`,patternErrorMessage:C(3861,`UNC host names must not contain backslashes.`)},default:[],markdownDescription:C(3862,"A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:Zh.APPLICATION_MACHINE},"security.restrictUNCAccess":{type:`boolean`,default:!0,markdownDescription:C(3863,"If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:Zh.APPLICATION_MACHINE}}})}};rU=A([j(0,JH)],rU);const iU=`window.newWindowProfile`;let aU=class extends y{static{this.ID=`workbench.contrib.dynamicWindowConfiguration`}constructor(e,t){super(),this.userDataProfilesService=e,this.configurationService=t,this.registerNewWindowProfileConfiguration(),this._register(this.userDataProfilesService.onDidChangeProfiles(e=>this.registerNewWindowProfileConfiguration())),this.setNewWindowProfile(),this.checkAndResetNewWindowProfileConfig(),this._register(t.onDidChangeConfiguration(e=>{e.source!==Fh.DEFAULT&&e.affectsConfiguration(iU)&&this.setNewWindowProfile()})),this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}registerNewWindowProfileConfiguration(){let e=Sm.as(Xh.Configuration),t={...QH,properties:{[iU]:{type:[`string`,`null`],default:null,enum:[...this.userDataProfilesService.profiles.map(e=>e.name),null],enumItemLabels:[...this.userDataProfilesService.profiles.map(e=>``),C(3864,`Active Window`)],description:C(3865,`Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists.`),scope:Zh.APPLICATION}}};this.configurationNode?e.updateConfigurations({add:[t],remove:[this.configurationNode]}):e.registerConfiguration(t),this.configurationNode=t}setNewWindowProfile(){let e=this.configurationService.getValue(iU);this.newWindowProfile=e?this.userDataProfilesService.profiles.find(t=>t.name===e):void 0}checkAndResetNewWindowProfileConfig(){let e=this.configurationService.getValue(iU);if(!e)return;let t=this.newWindowProfile?this.userDataProfilesService.profiles.find(e=>e.id===this.newWindowProfile.id):void 0;e!==t?.name&&this.configurationService.updateValue(iU,t?.name)}};aU=A([j(0,YH),j(1,$j)],aU);const oU=Sm.as(Xh.Configuration),sU={...XH,properties:{"workbench.editorAssociations":{type:`object`,markdownDescription:C(13014,'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:`string`}}}};oU.registerConfiguration(sU);var cU;(function(e){e.builtin=`builtin`,e.option=`option`,e.exclusive=`exclusive`,e.default=`default`})(cU||={});var lU;(function(e){e[e.ABORT=1]=`ABORT`,e[e.NONE=2]=`NONE`})(lU||={});function uU(e,t){let n=new Set([O.extension,O.webviewPanel,O.vscodeWorkspaceTrust,O.vscodeSettings]);if(n.has(t.scheme))return!1;let r=typeof e==`string`&&e.indexOf(Lr.sep)>=0,i=r?`${t.scheme}:${t.path}`:Xa(t);return Ov(typeof e==`string`?e.toLowerCase():e,i.toLowerCase())}var dU=class e{static{this._notebookStatusBarItemProviderHandlePool=0}get activeNotebookEditor(){return this._activeNotebookEditor?.apiEditor}get visibleNotebookEditors(){return this._visibleNotebookEditors.map(e=>e.apiEditor)}constructor(t,n,r,i,a,o,s){this._textDocumentsAndEditors=r,this._textDocuments=i,this._extHostFileSystem=a,this._extHostSearch=o,this._logService=s,this._notebookStatusBarItemProviders=new Map,this._documents=new ze,this._editors=new Map,this._onDidChangeActiveNotebookEditor=new x,this.onDidChangeActiveNotebookEditor=this._onDidChangeActiveNotebookEditor.event,this._visibleNotebookEditors=[],this._onDidOpenNotebookDocument=new x,this.onDidOpenNotebookDocument=this._onDidOpenNotebookDocument.event,this._onDidCloseNotebookDocument=new x,this.onDidCloseNotebookDocument=this._onDidCloseNotebookDocument.event,this._onDidChangeVisibleNotebookEditors=new x,this.onDidChangeVisibleNotebookEditors=this._onDidChangeVisibleNotebookEditors.event,this._statusBarCache=new Iz(`NotebookCellStatusBarCache`),this._handlePool=0,this._notebookSerializer=new Map,this._notebookProxy=t.getProxy(E.MainThreadNotebook),this._notebookDocumentsProxy=t.getProxy(E.MainThreadNotebookDocuments),this._notebookEditorsProxy=t.getProxy(E.MainThreadNotebookEditors),this._commandsConverter=n.converter,n.registerArgumentProcessor({processArgument:e=>{if(e&&e.$mid===Dn.NotebookCellActionContext){let t=e.notebookEditor?.notebookUri,n=e.cell.handle,r=this._documents.get(t),i=r?.getCell(n);if(i)return i.apiCell}if(e&&e.$mid===Dn.NotebookActionContext){let t=e.uri,n=this._documents.get(t);if(n)return n.apiNotebook}return e}}),e._registerApiCommands(n)}getEditorById(e){let t=this._editors.get(e);if(!t)throw Error(`unknown text editor: ${e}. known editors: ${[...this._editors.keys()]} `);return t}getIdByEditor(e){for(let[t,n]of this._editors)if(n.apiEditor===e)return t}get notebookDocuments(){return[...this._documents.values()]}getNotebookDocument(e,t){let n=this._documents.get(e);if(!n&&!t)throw Error(`NO notebook document for '${e}'`);return n}static _convertNotebookRegistrationData(e,t){if(!t)return;let n=t.filenamePattern.map(e=>NO.from(e)).filter(e=>e!==void 0);if(t.filenamePattern&&!n){console.warn(`Notebook content provider view options file name pattern is invalid ${t.filenamePattern}`);return}return{extension:e.identifier,providerDisplayName:e.displayName||e.name,displayName:t.displayName,filenamePattern:n,priority:t.exclusive?cU.exclusive:void 0}}registerNotebookCellStatusBarItemProvider(t,n,r){let i=e._notebookStatusBarItemProviderHandlePool++,a=typeof r.onDidChangeCellStatusBarItems==`function`?e._notebookStatusBarItemProviderHandlePool++:void 0;this._notebookStatusBarItemProviders.set(i,r),this._notebookProxy.$registerNotebookCellStatusBarItemProvider(i,a,n);let o;return a!==void 0&&(o=r.onDidChangeCellStatusBarItems(e=>this._notebookProxy.$emitCellStatusBarEvent(a))),new Pb(()=>{this._notebookStatusBarItemProviders.delete(i),this._notebookProxy.$unregisterNotebookCellStatusBarItemProvider(i,a),o?.dispose()})}async createNotebookDocument(e){let t=await this._notebookDocumentsProxy.$tryCreateNotebook({viewType:e.viewType,content:e.content&&kO.from(e.content)});return w.revive(t)}async openNotebookDocument(e){let t=this._documents.get(e);if(t)return t.apiNotebook;let n=await this._notebookDocumentsProxy.$tryOpenNotebook(e),r=this._documents.get(w.revive(n));return st(r?.apiNotebook)}async showNotebookDocument(e,t){let n;n=typeof t==`object`?{position:OD.from(t.viewColumn),preserveFocus:t.preserveFocus,selections:t.selections&&t.selections.map(EO.from),pinned:typeof t.preview==`boolean`?!t.preview:void 0,label:typeof t.asRepl==`string`?t.asRepl:typeof t.asRepl==`object`?t.asRepl.label:void 0}:{preserveFocus:!1,pinned:!0};let r=t?.asRepl?`repl`:e.notebookType,i=await this._notebookEditorsProxy.$tryShowNotebookDocument(e.uri,r,n),a=i&&this._editors.get(i)?.apiEditor;if(a)return a;throw i?Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):Error(`Could NOT open editor for "${e.uri.toString()}".`)}async $provideNotebookCellStatusBarItems(e,t,n,r){let i=this._notebookStatusBarItemProviders.get(e),a=w.revive(t),o=this._documents.get(a);if(!o||!i)return;let s=o.getCellFromIndex(n);if(!s)return;let c=await i.provideCellStatusBarItems(s.apiCell,r);if(!c)return;let l=new v,u=this._statusBarCache.add([l]),d=Array.isArray(c)?c:[c],f=d.map(e=>PO.from(e,this._commandsConverter,l));return{cacheId:u,items:f}}$releaseNotebookCellStatusBarItems(e){this._statusBarCache.delete(e)}registerNotebookSerializer(t,n,r,i,a){if(Ii(n))throw Error(`viewType cannot be empty or just whitespace`);let o=this._handlePool++;return this._notebookSerializer.set(o,{viewType:n,serializer:r,options:i}),this._notebookProxy.$registerNotebookSerializer(o,{id:t.identifier,location:t.extensionLocation},n,IO.from(i),e._convertNotebookRegistrationData(t,a)),_(()=>{this._notebookProxy.$unregisterNotebookSerializer(o)})}async $dataToNotebook(e,t,n){let r=this._notebookSerializer.get(e);if(!r)throw Error(`NO serializer found`);let i=await r.serializer.deserializeNotebook(t.buffer,n);return new hi(kO.from(i))}async $notebookToData(e,t,n){let r=this._notebookSerializer.get(e);if(!r)throw Error(`NO serializer found`);let i=await r.serializer.serializeNotebook(kO.to(t.value),n);return b.wrap(i)}async $saveNotebook(e,t,n,r,i){let a=w.revive(t),o=this._notebookSerializer.get(e);if(this.trace(`enter saveNotebook(versionId: ${n}, ${a.toString()})`),!o)throw Error(`NO serializer found`);let s=this._documents.get(a);if(!s)throw Error(`Document NOT found`);if(s.versionId!==n)throw Error(`Document version mismatch, expected: `+n+`, actual: `+s.versionId);if(!this._extHostFileSystem.value.isWritableFileSystem(a.scheme))throw new gc(C(2631,`Unable to modify read-only file '{0}'`,this._resourceForError(a)),_c.FILE_PERMISSION_DENIED);let c={metadata:rc(s.apiNotebook.metadata,e=>!(o.options?.transientDocumentMetadata??{})[e]),cells:[]};for(let e of s.apiNotebook.getCells()){let t=new IC(e.kind,e.document.getText(),e.document.languageId,e.mime,o.options?.transientOutputs?[]:[...e.outputs],e.metadata,e.executionSummary);t.metadata=rc(e.metadata,e=>!(o.options?.transientCellMetadata??{})[e]),c.cells.push(t)}if(await this._validateWriteFile(a,r),i.isCancellationRequested)throw Error(`canceled`);let l=await o.serializer.serializeNotebook(c,i);if(i.isCancellationRequested)throw Error(`canceled`);this.trace(`serialized versionId: ${n} ${a.toString()}`),await this._extHostFileSystem.value.writeFile(a,l),this.trace(`Finished write versionId: ${n} ${a.toString()}`);let u=this._extHostFileSystem.getFileSystemProviderExtUri(a.scheme),d=await this._extHostFileSystem.value.stat(a),f={name:u.basename(a),isFile:(d.type&ac.File)!==0,isDirectory:(d.type&ac.Directory)!==0,isSymbolicLink:(d.type&ac.SymbolicLink)!==0,mtime:d.mtime,ctime:d.ctime,size:d.size,readonly:!!((d.permissions??0)&oc.Readonly)||!this._extHostFileSystem.value.isWritableFileSystem(a.scheme),locked:!!((d.permissions??0)&oc.Locked),etag:yc({mtime:d.mtime,size:d.size}),children:void 0};return this.trace(`exit saveNotebook(versionId: ${n}, ${a.toString()})`),f}async $searchInNotebooks(e,t,n,r,i){let a=this._notebookSerializer.get(e)?.serializer;if(!a)return{limitHit:!1,results:[]};let o=new Be,s=async(e,t,n)=>{await Promise.all(e.map(async e=>await Promise.all(e.filenamePatterns.map(i=>{let a={_reason:n._reason,folderQueries:n.folderQueries,includePattern:n.includePattern,excludePattern:n.excludePattern,maxResults:n.maxResults,type:$k.File,filePattern:i};return this._extHostSearch.doInternalFileSearchWithCustomCallback(a,t,t=>{t.forEach(t=>{if(o.has(t))return;let n=r.some(n=>e.isFromSettings&&!n.isFromSettings?!1:n.filenamePatterns.some(e=>uU(e,t)));n||o.add(t)})}).catch(e=>{if(e.code===`ENOENT`)return console.warn(`Could not find notebook search results, ignoring notebook results.`),{limitHit:!1,messages:[]};throw e})}))))};await s(n,i,t);let c=new ze,l=!1,u=Array.from(o).map(async e=>{let n=[];try{if(i.isCancellationRequested)return;if(t.maxResults&&[...c.values()].reduce((e,t)=>e+t.cellResults.length,0)>t.maxResults){l=!0;return}let r=[],o=this._documents.get(e);if(o){let e=o.apiNotebook.getCells();e.forEach(e=>r.push({input:e.document.getText(),outputs:e.outputs.flatMap(e=>e.items.map(e=>e.data.toString()))}))}else{let t=await this._extHostFileSystem.value.readFile(e),n=b.fromString(t.toString()),o=await a.deserializeNotebook(n.buffer,i);if(i.isCancellationRequested)return;let s=kO.from(o);s.cells.forEach(e=>r.push({input:e.source,outputs:e.outputs.flatMap(e=>e.items.map(e=>e.valueBytes.toString()))}))}if(i.isCancellationRequested)return;r.forEach((e,r)=>{let i=t.contentPattern.pattern,a=new KH(e.input,void 0,e.outputs),o=a.findInInputs(i),s=a.findInOutputs(i),c=s.flatMap(e=>qH(e.matches,e.textBuffer)).map((e,t)=>(e.webviewIndex=t,e));if(o.length>0||s.length>0){let e={index:r,contentResults:qH(o,a.inputTextBuffer),webviewResults:c};n.push(e)}});let s={resource:e,cellResults:n};c.set(e,s);return}catch{return}});return await Promise.all(u),{limitHit:l,results:[...c.values()]}}async _validateWriteFile(e,t){let n=await this._extHostFileSystem.value.stat(e);if(typeof t?.mtime==`number`&&typeof t.etag==`string`&&t.etag!==``&&typeof n.mtime==`number`&&typeof n.size==`number`&&t.mtime<n.mtime&&t.etag!==yc({mtime:t.mtime,size:n.size}))throw new gc(C(2632,`File Modified Since`),_c.FILE_MODIFIED_SINCE,t)}_resourceForError(e){return e.scheme===O.file?e.fsPath:e.toString()}_createExtHostEditor(e,t,n){if(this._editors.has(t))throw Error(`editor with id ALREADY EXSIST: ${t}`);let r=new dH(t,this._notebookEditorsProxy,e,n.visibleRanges.map(EO.to),n.selections.map(EO.to),typeof n.viewColumn==`number`?OD.to(n.viewColumn):void 0,n.viewType);this._editors.set(t,r)}$acceptDocumentAndEditorsDelta(e){if(e.value.removedDocuments)for(let t of e.value.removedDocuments){let e=w.revive(t),n=this._documents.get(e);n&&(n.dispose(),this._documents.delete(e),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({removedDocuments:n.apiNotebook.getCells().map(e=>e.document.uri)}),this._onDidCloseNotebookDocument.fire(n.apiNotebook));for(let t of this._editors.values())t.notebookData.uri.toString()===e.toString()&&this._editors.delete(t.id)}if(e.value.addedDocuments){let t=[];for(let n of e.value.addedDocuments){let e=w.revive(n.uri);if(this._documents.has(e))throw Error(`adding EXISTING notebook ${e} `);let r=new uH(this._notebookDocumentsProxy,this._textDocumentsAndEditors,this._textDocuments,e,n);t.push(...n.cells.map(e=>lH.asModelAddData(e))),this._documents.get(e)?.dispose(),this._documents.set(e,r),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({addedDocuments:t}),this._onDidOpenNotebookDocument.fire(r.apiNotebook)}}if(e.value.addedEditors)for(let t of e.value.addedEditors){if(this._editors.has(t.id))return;let e=w.revive(t.documentUri),n=this._documents.get(e);n&&this._createExtHostEditor(n,t.id,t)}if(e.value.removedEditors)for(let t of e.value.removedEditors){let e=this._editors.get(t);e&&(this._editors.delete(t),this._activeNotebookEditor?.id===e.id&&(this._activeNotebookEditor=void 0))}if(e.value.visibleEditors){this._visibleNotebookEditors=e.value.visibleEditors.map(e=>this._editors.get(e)).filter(e=>!!e);let t=new Set;this._visibleNotebookEditors.forEach(e=>t.add(e.id));for(let e of this._editors.values()){let n=t.has(e.id);e._acceptVisibility(n)}this._visibleNotebookEditors=[...this._editors.values()].map(e=>e).filter(e=>e.visible),this._onDidChangeVisibleNotebookEditors.fire(this.visibleNotebookEditors)}if(e.value.newActiveEditor===null)this._activeNotebookEditor=void 0;else if(e.value.newActiveEditor){let t=this._editors.get(e.value.newActiveEditor);t||console.error(`FAILED to find active notebook editor ${e.value.newActiveEditor}`),this._activeNotebookEditor=this._editors.get(e.value.newActiveEditor)}e.value.newActiveEditor!==void 0&&this._onDidChangeActiveNotebookEditor.fire(this._activeNotebookEditor?.apiEditor)}static _registerApiCommands(e){let t=Y.String.with(`notebookType`,`A notebook type`),n=new nN(`vscode.executeDataToNotebook`,`_executeDataToNotebook`,`Invoke notebook serializer`,[t,new Y(`data`,`Bytes to convert to data`,e=>e instanceof Uint8Array,e=>b.wrap(e))],new tN(`Notebook Data`,e=>kO.to(e.value))),r=new nN(`vscode.executeNotebookToData`,`_executeNotebookToData`,`Invoke notebook serializer`,[t,new Y(`NotebookData`,`Notebook data to convert to bytes`,e=>!0,e=>new hi(kO.from(e)))],new tN(`Bytes`,e=>e.buffer));e.registerApiCommand(n),e.registerApiCommand(r)}trace(e){this._logService.trace(`[Extension Host Notebook] ${e}`)}},fU=class{constructor(e,t,n,r={timeout:1500,errors:3}){this._logService=e,this._notebooksAndEditors=t,this._mainThreadBulkEdits=n,this._thresholds=r,this._onWillSaveNotebookDocumentEvent=new dn}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(t,n,r)=>{let i=function(e){t.call(n,e)};return i.extension=e,this._onWillSaveNotebookDocumentEvent.event(i,void 0,r)}}async $participateInSave(e,t,n){let r=w.revive(e),i=this._notebooksAndEditors.getNotebookDocument(r);if(!i)throw Error(`Unable to resolve notebook document`);let a=[];if(await this._onWillSaveNotebookDocumentEvent.fireAsync({notebook:i.apiNotebook,reason:_O.to(t)},n,async(e,t)=>{let r=Date.now(),i=await await Promise.resolve(e);Date.now()-r>this._thresholds.timeout&&this._logService.warn(`onWillSaveNotebookDocument-listener from extension`,t.extension.identifier),!n.isCancellationRequested&&i&&(i instanceof Xb?a.push(i):this._logService.warn(`onWillSaveNotebookDocument-listener from extension`,t.extension.identifier,`ignored due to invalid data`))}),n.isCancellationRequested)return!1;if(a.length===0)return!0;let o={edits:[]};for(let e of a){let{edits:t}=zD.from(e);o.edits=o.edits.concat(t)}return this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new hi(o))}},pU=class{constructor(e){this._notebooksAndEditors=e,this._onDidSaveNotebookDocument=new x,this.onDidSaveNotebookDocument=this._onDidSaveNotebookDocument.event,this._onDidChangeNotebookDocument=new x,this.onDidChangeNotebookDocument=this._onDidChangeNotebookDocument.event}$acceptModelChanged(e,t,n,r){let i=this._notebooksAndEditors.getNotebookDocument(w.revive(e)),a=i.acceptModelChanged(t.value,n,r);this._onDidChangeNotebookDocument.fire(a)}$acceptDirtyStateChanged(e,t){let n=this._notebooksAndEditors.getNotebookDocument(w.revive(e));n.acceptDirty(t)}$acceptModelSaved(e){let t=this._notebooksAndEditors.getNotebookDocument(w.revive(e));this._onDidSaveNotebookDocument.fire(t.apiNotebook)}};let mU=class{constructor(e,t){this._logService=e,this._notebooksAndEditors=t,this._onDidChangeNotebookEditorSelection=new x,this._onDidChangeNotebookEditorVisibleRanges=new x,this.onDidChangeNotebookEditorSelection=this._onDidChangeNotebookEditorSelection.event,this.onDidChangeNotebookEditorVisibleRanges=this._onDidChangeNotebookEditorVisibleRanges.event}$acceptEditorPropertiesChanged(e,t){this._logService.debug(`ExtHostNotebook#$acceptEditorPropertiesChanged`,e,t);let n=this._notebooksAndEditors.getEditorById(e);t.visibleRanges&&n._acceptVisibleRanges(t.visibleRanges.ranges.map(EO.to)),t.selections&&n._acceptSelections(t.selections.selections.map(EO.to)),t.visibleRanges&&this._onDidChangeNotebookEditorVisibleRanges.fire({notebookEditor:n.apiEditor,visibleRanges:n.apiEditor.visibleRanges}),t.selections&&this._onDidChangeNotebookEditorSelection.fire(Object.freeze({notebookEditor:n.apiEditor,selections:n.apiEditor.selections}))}$acceptEditorViewColumns(e){for(let t in e){let n=this._notebooksAndEditors.getEditorById(t);n._acceptViewColumn(OD.to(e[t]))}}};mU=A([j(0,xs)],mU);var hU;(function(e){e[e.Output=1]=`Output`,e[e.OutputItems=2]=`OutputItems`,e[e.ExecutionState=3]=`ExecutionState`})(hU||={});var gU;(function(e){e[e.Disconnected=1]=`Disconnected`,e[e.Connected=2]=`Connected`,e[e.Initializing=3]=`Initializing`})(gU||={});let _U=class{constructor(e,t,n,r,i){this._initData=t,this._extHostNotebook=n,this._commands=r,this._logService=i,this._activeExecutions=new ze,this._activeNotebookExecutions=new ze,this._kernelDetectionTask=new Map,this._kernelDetectionTaskHandlePool=0,this._kernelSourceActionProviders=new Map,this._kernelSourceActionProviderHandlePool=0,this._kernelData=new Map,this._handlePool=0,this.id=0,this.variableStore={},this._proxy=e.getProxy(E.MainThreadNotebookKernels);let a=new nN(`notebook.selectKernel`,`_notebook.selectKernel`,`Trigger kernel picker for specified notebook editor widget`,[new Y(`options`,`Select kernel options`,e=>!0,e=>{if(e&&`notebookEditor`in e&&`id`in e){let t=this._extHostNotebook.getIdByEditor(e.notebookEditor);return{id:e.id,extension:e.extension,notebookEditorId:t}}else if(e&&`notebookEditor`in e){let t=this._extHostNotebook.getIdByEditor(e.notebookEditor);if(t===void 0)throw Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${e.notebookEditor.notebook.uri.toString()}`);return`skipIfAlreadySelected`in e?{notebookEditorId:t,skipIfAlreadySelected:e.skipIfAlreadySelected}:{notebookEditorId:t}}return e})],tN.Void),o=new nN(`vscode.executeNotebookVariableProvider`,`_executeNotebookVariableProvider`,`Execute notebook variable provider`,[Y.Uri],new tN(`A promise that resolves to an array of variables`,(e,t)=>e.map(e=>({variable:{name:e.name,value:e.value,expression:e.expression,type:e.type,language:e.language},hasNamedChildren:e.hasNamedChildren,indexedChildrenCount:e.indexedChildrenCount}))));this._commands.registerApiCommand(a),this._commands.registerApiCommand(o)}createNotebookController(e,t,n,r,i,a){for(let n of this._kernelData.values())if(n.controller.id===t&&ms.equals(e.identifier,n.extensionId))throw Error(`notebook controller with id '${t}' ALREADY exist`);let o=this._handlePool++,s=this;this._logService.trace(`NotebookController[${o}], CREATED by ${e.identifier.value}, ${t}`);let c=()=>console.warn(`NO execute handler from notebook controller '${f.id}' of extension: '${e.identifier}'`),l=!1,u=new x,d=new x,f={id:wU(e.identifier,t),notebookType:n,extensionId:e.identifier,extensionLocation:e.extensionLocation,label:r||e.identifier.value,preloads:a?a.map(LO.from):[]},p=i??c,ee,m;this._proxy.$addKernel(o,f).catch(e=>{console.log(e),l=!0});let te=0,ne=()=>{if(l)return;let e=++te;Promise.resolve().then(()=>{e===te&&this._proxy.$updateKernel(o,f)})},re=new ze,ie={get id(){return t},get notebookType(){return f.notebookType},onDidChangeSelectedNotebooks:u.event,get label(){return f.label},set label(t){f.label=t??e.displayName??e.name,ne()},get detail(){return f.detail??``},set detail(e){f.detail=e,ne()},get description(){return f.description??``},set description(e){f.description=e,ne()},get supportedLanguages(){return f.supportedLanguages},set supportedLanguages(e){f.supportedLanguages=e,ne()},get supportsExecutionOrder(){return f.supportsExecutionOrder??!1},set supportsExecutionOrder(e){f.supportsExecutionOrder=e,ne()},get rendererScripts(){return f.preloads?f.preloads.map(LO.to):[]},get executeHandler(){return p},set executeHandler(e){p=e??c},get interruptHandler(){return ee},set interruptHandler(e){ee=e,f.supportsInterrupt=!!e,ne()},set variableProvider(t){U(e,`notebookVariableProvider`),m=t,f.hasVariableProvider=!!t,t?.onDidChangeVariables(e=>s._proxy.$variablesUpdated(e.uri)),ne()},get variableProvider(){return m},createNotebookCellExecution(t){if(l)throw Error(`notebook controller is DISPOSED`);if(!re.has(t.notebook.uri))throw s._logService.trace(`NotebookController[${o}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(re.keys()).map(e=>e.toString())),Error(`notebook controller is NOT associated to notebook: ${t.notebook.uri.toString()}`);return s._createNotebookCellExecution(t,wU(e.identifier,this.id))},createNotebookExecution(t){if(U(e,`notebookExecution`),l)throw Error(`notebook controller is DISPOSED`);if(!re.has(t.uri))throw s._logService.trace(`NotebookController[${o}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(re.keys()).map(e=>e.toString())),Error(`notebook controller is NOT associated to notebook: ${t.uri.toString()}`);return s._createNotebookExecution(t,wU(e.identifier,this.id))},dispose:()=>{l||(this._logService.trace(`NotebookController[${o}], DISPOSED`),l=!0,this._kernelData.delete(o),u.dispose(),d.dispose(),this._proxy.$removeKernel(o))},updateNotebookAffinity(t,n){n===qC.Hidden&&U(e,`notebookControllerAffinityHidden`),s._proxy.$updateNotebookPriority(o,t.uri,n)},onDidReceiveMessage:d.event,postMessage(t,n){return U(e,`notebookMessaging`),s._proxy.$postMessage(o,n&&s._extHostNotebook.getIdByEditor(n),t)},asWebviewUri(t){return U(e,`notebookMessaging`),dz(t,s._initData.remote)}};return this._kernelData.set(o,{extensionId:e.identifier,controller:ie,onDidReceiveMessage:d,onDidChangeSelection:u,associatedNotebooks:re}),ie}getIdByController(e){for(let[t,n]of this._kernelData)if(n.controller===e)return wU(n.extensionId,e.id);return null}createNotebookControllerDetectionTask(e,t){let n=this._kernelDetectionTaskHandlePool++,r=this;this._logService.trace(`NotebookControllerDetectionTask[${n}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelDetectionTask(n,t);let i={dispose:()=>{this._kernelDetectionTask.delete(n),r._proxy.$removeKernelDetectionTask(n)}};return this._kernelDetectionTask.set(n,i),i}registerKernelSourceActionProvider(e,t,n){let r=this._kernelSourceActionProviderHandlePool++,i=typeof n.onDidChangeNotebookKernelSourceActions==`function`?r:void 0,a=this;this._kernelSourceActionProviders.set(r,n),this._logService.trace(`NotebookKernelSourceActionProvider[${r}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelSourceActionProvider(r,r,t);let o;return i!==void 0&&(o=n.onDidChangeNotebookKernelSourceActions(e=>this._proxy.$emitNotebookKernelSourceActionsChangeEvent(i))),{dispose:()=>{this._kernelSourceActionProviders.delete(r),a._proxy.$removeKernelSourceActionProvider(r,r),o?.dispose()}}}async $provideKernelSourceActions(e,t){let n=this._kernelSourceActionProviders.get(e);if(n){let e=new v,r=await n.provideNotebookKernelSourceActions(t);return(r??[]).map(t=>FO.from(t,this._commands.converter,e))}return[]}$acceptNotebookAssociation(e,t,n){let r=this._kernelData.get(e);if(r){let i=this._extHostNotebook.getNotebookDocument(w.revive(t));n?r.associatedNotebooks.set(i.uri,!0):r.associatedNotebooks.delete(i.uri),this._logService.trace(`NotebookController[${e}] ASSOCIATE notebook`,i.uri.toString(),n),r.onDidChangeSelection.fire({selected:n,notebook:i.apiNotebook})}}async $executeCells(e,t,n){let r=this._kernelData.get(e);if(!r)return;let i=this._extHostNotebook.getNotebookDocument(w.revive(t)),a=[];for(let e of n){let t=i.getCell(e);t&&a.push(t.apiCell)}try{this._logService.trace(`NotebookController[${e}] EXECUTE cells`,i.uri.toString(),a.length),await r.controller.executeHandler.call(r.controller,a,i.apiNotebook,r.controller)}catch(t){this._logService.error(`NotebookController[${e}] execute cells FAILED`,t),console.error(t)}}async $cancelCells(e,t,n){let r=this._kernelData.get(e);if(!r)return;let i=this._extHostNotebook.getNotebookDocument(w.revive(t));if(r.controller.interruptHandler)await r.controller.interruptHandler.call(r.controller,i.apiNotebook);else for(let e of n){let t=i.getCell(e);t&&this._activeExecutions.get(t.uri)?.cancel()}if(r.controller.interruptHandler){let e=this._activeNotebookExecutions.get(i.uri);this._activeNotebookExecutions.delete(i.uri),n.length&&Array.isArray(e)&&e.length&&e.forEach(e=>e.dispose())}}async $provideVariables(e,t,n,r,i,a,o){let s=this._kernelData.get(e);if(!s)return;let c=this._extHostNotebook.getNotebookDocument(w.revive(n)),l=s.controller.variableProvider;if(!l)return;let u;if(r!==void 0){if(u=this.variableStore[r],!u)return}else this.variableStore={};let d=i===`named`?XC.Named:XC.Indexed,f=l.provideVariables(c.apiNotebook,u,d,a,o),p=0;for await(let e of f){if(o.isCancellationRequested)return;let n={id:this.id++,name:e.variable.name,value:e.variable.value,type:e.variable.type,interfaces:e.variable.interfaces,language:e.variable.language,expression:e.variable.expression,hasNamedChildren:e.hasNamedChildren,indexedChildrenCount:e.indexedChildrenCount,extensionId:s.extensionId.value};if(this.variableStore[n.id]=e.variable,this._proxy.$receiveVariable(t,n),p++>=100)return}}$acceptKernelMessageFromRenderer(e,t,n){let r=this._kernelData.get(e);if(!r)return;let i=this._extHostNotebook.getEditorById(t);r.onDidReceiveMessage.fire(Object.freeze({editor:i.apiEditor,message:n}))}_createNotebookCellExecution(e,t){if(e.index<0)throw Error(`CANNOT execute cell that has been REMOVED from notebook`);let n=this._extHostNotebook.getNotebookDocument(e.notebook.uri),r=n.getCellFromApiCell(e);if(!r)throw Error(`invalid cell`);if(this._activeExecutions.has(r.uri))throw Error(`duplicate execution for ${r.uri}`);let i=new yU(t,r,this._proxy);this._activeExecutions.set(r.uri,i);let a=i.onDidChangeState(()=>{i.state===vU.Resolved&&(i.dispose(),a.dispose(),this._activeExecutions.delete(r.uri))});return i.asApiObject()}_createNotebookExecution(e,t){let n=this._extHostNotebook.getNotebookDocument(e.uri),r=e.getCells().find(e=>{let t=n.getCellFromApiCell(e);return t&&this._activeExecutions.has(t.uri)});if(r)throw Error(`duplicate cell execution for ${r.document.uri}`);if(this._activeNotebookExecutions.has(n.uri))throw Error(`duplicate notebook execution for ${n.uri}`);let i=new SU(t,n,this._proxy),a=i.onDidChangeState(()=>{i.state===xU.Resolved&&(i.dispose(),a.dispose(),this._activeNotebookExecutions.delete(n.uri))});return this._activeNotebookExecutions.set(n.uri,[i,a]),i.asApiObject()}};_U=A([j(4,xs)],_U);var vU;(function(e){e[e.Init=0]=`Init`,e[e.Started=1]=`Started`,e[e.Resolved=2]=`Resolved`})(vU||={});var yU=class e extends y{static{this.HANDLE=0}get state(){return this._state}constructor(t,n,r){super(),this._cell=n,this._proxy=r,this._handle=e.HANDLE++,this._onDidChangeState=new x,this.onDidChangeState=this._onDidChangeState.event,this._state=vU.Init,this._tokenSource=this._register(new Ai),this._collector=new CU(10,e=>this.update(e)),this._executionOrder=n.internalMetadata.executionOrder,this._proxy.$createExecution(this._handle,t,this._cell.notebook.uri,this._cell.handle)}cancel(){this._tokenSource.cancel()}async updateSoon(e){await this._collector.addItem(e)}async update(e){let t=Array.isArray(e)?e:[e];return this._proxy.$updateExecution(this._handle,new hi(t))}verifyStateForOutput(){if(this._state===vU.Init)throw Error(`Must call start before modifying cell output`);if(this._state===vU.Resolved)throw Error(`Cannot modify cell output after calling resolve`)}cellIndexToHandle(e){let t=this._cell;if(e&&(t=this._cell.notebook.getCellFromApiCell(e)),!t)throw Error(`INVALID cell`);return t.handle}validateAndConvertOutputs(e){return e.map(e=>{let t=zC.ensureUniqueMimeTypes(e.items,!0);return t===e.items?MO.from(e):MO.from({items:t,id:e.id,metadata:e.metadata})})}async updateOutputs(e,t,n){let r=this.cellIndexToHandle(t),i=this.validateAndConvertOutputs(De(e));return this.updateSoon({editType:hU.Output,cellHandle:r,append:n,outputs:i})}async updateOutputItems(e,t,n){return e=zC.ensureUniqueMimeTypes(De(e),!0),this.updateSoon({editType:hU.OutputItems,items:e.map(jO.from),outputId:t.id,append:n})}asApiObject(){let e=this,t={get token(){return e._tokenSource.token},get cell(){return e._cell.apiCell},get executionOrder(){return e._executionOrder},set executionOrder(t){e._executionOrder=t,e.update([{editType:hU.ExecutionState,executionOrder:e._executionOrder}])},start(t){if(e._state===vU.Resolved||e._state===vU.Started)throw Error(`Cannot call start again`);e._state=vU.Started,e._onDidChangeState.fire(),e.update({editType:hU.ExecutionState,runStartTime:t})},end(t,n,r){if(e._state===vU.Resolved)throw Error(`Cannot call resolve twice`);e._state=vU.Resolved,e._onDidChangeState.fire(),e._collector.flush();let i=bU(r);e._proxy.$completeExecution(e._handle,new hi({runEndTime:n,lastRunSuccess:t,error:i}))},clearOutput(t){return e.verifyStateForOutput(),e.updateOutputs([],t,!1)},appendOutput(t,n){return e.verifyStateForOutput(),e.updateOutputs(t,n,!0)},replaceOutput(t,n){return e.verifyStateForOutput(),e.updateOutputs(t,n,!1)},appendOutputItems(t,n){return e.verifyStateForOutput(),e.updateOutputItems(t,n,!0)},replaceOutputItems(t,n){return e.verifyStateForOutput(),e.updateOutputItems(t,n,!1)}};return Object.freeze(t)}};function bU(e){let t=e=>e?{startLineNumber:e.start.line,startColumn:e.start.character,endLineNumber:e.end.line,endColumn:e.end.character}:void 0,n=e=>({uri:e.uri,position:e.position,label:e.label}),r=e?{name:e.name,message:e.message,stack:e.stack instanceof Array?e.stack.map(e=>n(e)):e.stack,location:t(e.location),uri:e.uri}:void 0;return r}var xU;(function(e){e[e.Init=0]=`Init`,e[e.Started=1]=`Started`,e[e.Resolved=2]=`Resolved`})(xU||={});var SU=class e extends y{static{this.HANDLE=0}get state(){return this._state}constructor(t,n,r){super(),this._notebook=n,this._proxy=r,this._handle=e.HANDLE++,this._onDidChangeState=new x,this.onDidChangeState=this._onDidChangeState.event,this._state=xU.Init,this._tokenSource=this._register(new Ai),this._proxy.$createNotebookExecution(this._handle,t,this._notebook.uri)}cancel(){this._tokenSource.cancel()}asApiObject(){let e={start:()=>{if(this._state===xU.Resolved||this._state===xU.Started)throw Error(`Cannot call start again`);this._state=xU.Started,this._onDidChangeState.fire(),this._proxy.$beginNotebookExecution(this._handle)},end:()=>{if(this._state===xU.Resolved)throw Error(`Cannot call resolve twice`);this._state=xU.Resolved,this._onDidChangeState.fire(),this._proxy.$completeNotebookExecution(this._handle)}};return Object.freeze(e)}},CU=class{constructor(e,t){this.delay=e,this.callback=t,this.batch=[],this.startedTimer=Date.now()}addItem(e){return this.batch.push(e),this.currentDeferred||(this.currentDeferred=new No,this.startedTimer=Date.now(),xo(this.delay).then(()=>this.flush())),Date.now()-this.startedTimer>this.delay?this.flush():this.currentDeferred.p}flush(){if(this.batch.length===0||!this.currentDeferred)return Promise.resolve();let e=this.currentDeferred;this.currentDeferred=void 0;let t=this.batch;return this.batch=[],this.callback(t).finally(()=>e.complete())}};function wU(e,t){return`${e.value}/${t}`}var TU=class{constructor(e,t){this._extHostNotebook=t,this._rendererMessageEmitters=new Map,this.proxy=e.getProxy(E.MainThreadNotebookRenderers)}$postRendererMessage(e,t,n){let r=this._extHostNotebook.getEditorById(e);this._rendererMessageEmitters.get(t)?.fire({editor:r.apiEditor,message:n})}createRendererMessaging(e,t){if(!e.contributes?.notebookRenderer?.some(e=>e.id===t))throw Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${t})`);let n={onDidReceiveMessage:(e,n,r)=>this.getOrCreateEmitterFor(t).event(e,n,r),postMessage:(e,n)=>{dH.apiEditorsToExtHost.has(e)&&([e,n]=[n,e]);let r=n&&dH.apiEditorsToExtHost.get(n);return this.proxy.$postMessage(r?.id,t,e)}};return n}getOrCreateEmitterFor(e){let t=this._rendererMessageEmitters.get(e);return t||(t=new x({onDidRemoveLastListener:()=>{t?.dispose(),this._rendererMessageEmitters.delete(e)}}),this._rendererMessageEmitters.set(e,t),t)}},EU=class{constructor(e){this.handlers=new Map,this.proxy=e.getProxy(E.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,t,n){if(U(e,`profileContentHandlers`),this.handlers.has(t))throw Error(`Handler with id '${t}' already registered`);return this.handlers.set(t,n),this.proxy.$registerProfileContentHandler(t,n.name,n.description,e.identifier.value),_(()=>{this.handlers.delete(t),this.proxy.$unregisterProfileContentHandler(t)})}async $saveProfile(e,t,n,r){let i=this.handlers.get(e);if(!i)throw Error(`Unknown handler with id: ${e}`);return i.saveProfile(t,n,r)}async $readProfile(e,t,n){let r=this.handlers.get(e);if(!r)throw Error(`Unknown handler with id: ${e}`);return r.readProfile(Ze(t)?t:w.revive(t),n)}},DU=class e{static{this.handlePool=0}constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(E.MainThreadQuickDiff)}$provideOriginalResource(e,t,n){let r=w.revive(t),i=this.providers.get(e);return i?uo(()=>i.provideOriginalResource(r,n)).then(e=>e||null):Promise.resolve(null)}registerQuickDiffProvider(t,n,r,i,a,o){let s=e.handlePool++;this.providers.set(s,r);let c=ms.toKey(t.identifier);return this.proxy.$registerQuickDiffProvider(s,CD.from(n,this.uriTransformer),`${c}.${i}`,a,o),{dispose:()=>{this.proxy.$unregisterQuickDiffProvider(s),this.providers.delete(s)}}}};function OU(e,t,n){let r=e.getProxy(E.MainThreadQuickOpen);class i{constructor(e,t){this._sessions=new Map,this._instances=0,this._workspace=e,this._commands=t}showQuickPick(e,t,n,i=Oi.None){this._onDidSelectItem=void 0;let a=Promise.resolve(t),o=++this._instances,s=r.$show(o,{title:n?.title,placeHolder:n?.placeHolder,matchOnDescription:n?.matchOnDescription,matchOnDetail:n?.matchOnDetail,ignoreFocusLost:n?.ignoreFocusOut,canPickMany:n?.canPickMany},i),c={},u=s.then(()=>c);return Promise.race([u,a]).then(t=>{if(t===c)return;let i=Hg(e,`quickPickItemTooltip`);return a.then(t=>{let a=[];for(let n=0;n<t.length;n++){let r=t[n];if(typeof r==`string`)a.push({label:r,handle:n});else if(r.kind===kC.Separator)a.push({type:`separator`,label:r.label});else{r.tooltip&&!i&&console.warn(`Extension '${e.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${e.identifier.value}`);let t=r.iconPath?l(r.iconPath):void 0;a.push({label:r.label,iconPath:t?.iconPath,iconClass:t?.iconClass,description:r.description,detail:r.detail,picked:r.picked,alwaysShow:r.alwaysShow,tooltip:i?jD.fromStrict(r.tooltip):void 0,handle:n})}}return n&&typeof n.onDidSelectItem==`function`&&(this._onDidSelectItem=e=>{n.onDidSelectItem(t[e])}),r.$setItems(o,a),s.then(e=>{if(typeof e==`number`)return t[e];if(Array.isArray(e))return e.map(e=>t[e])})})}).then(void 0,e=>{if(!ae(e))return r.$setError(o,e),Promise.reject(e)})}$onItemSelected(e){this._onDidSelectItem?.(e)}showInput(e,t=Oi.None){return this._validateInput=e?.validateInput,r.$input(e,typeof this._validateInput==`function`,t).then(void 0,e=>{if(!ae(e))return Promise.reject(e)})}async $validateInput(e){if(!this._validateInput)return;let t=await this._validateInput(e);if(!t||typeof t==`string`)return t;let n;switch(t.severity){case AC.Info:n=xc.Info;break;case AC.Warning:n=xc.Warning;break;case AC.Error:n=xc.Error;break;default:n=t.message?xc.Error:xc.Ignore;break}return{content:t.message,severity:n}}async showWorkspaceFolderPick(e,t=Oi.None){let n=await this._commands.executeCommand(`_workbench.pickWorkspaceFolder`,[e]);if(!n)return;let r=await this._workspace.getWorkspaceFolders2();if(r)return r.find(e=>e.uri.toString()===n.uri.toString())}createQuickPick(e){let t=new u(e,()=>this._sessions.delete(t._id));return this._sessions.set(t._id,t),t}createInputBox(e){let t=new d(e,()=>this._sessions.delete(t._id));return this._sessions.set(t._id,t),t}$onDidChangeValue(e,t){let n=this._sessions.get(e);n?._fireDidChangeValue(t)}$onDidAccept(e){let t=this._sessions.get(e);t?._fireDidAccept()}$onDidChangeActive(e,t){let n=this._sessions.get(e);n instanceof u&&n._fireDidChangeActive(t)}$onDidChangeSelection(e,t){let n=this._sessions.get(e);n instanceof u&&n._fireDidChangeSelection(t)}$onDidTriggerButton(e,t){let n=this._sessions.get(e);n?._fireDidTriggerButton(t)}$onDidTriggerItemButton(e,t,n){let r=this._sessions.get(e);r instanceof u&&r._fireDidTriggerItemButton(t,n)}$onDidHide(e){let t=this._sessions.get(e);t?._fireDidHide()}}class a{static{this._nextId=1}constructor(e,t){this._extension=e,this._onDidDispose=t,this._id=u._nextId++,this._visible=!1,this._expectingHide=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!0,this._value=``,this._valueSelection=void 0,this._buttons=[],this._handlesToButtons=new Map,this._onDidAcceptEmitter=new x,this._onDidChangeValueEmitter=new x,this._onDidTriggerButtonEmitter=new x,this._onDidHideEmitter=new x,this._pendingUpdate={id:this._id},this._disposed=!1,this._disposables=[this._onDidTriggerButtonEmitter,this._onDidHideEmitter,this._onDidAcceptEmitter,this._onDidChangeValueEmitter],this.onDidChangeValue=this._onDidChangeValueEmitter.event,this.onDidAccept=this._onDidAcceptEmitter.event,this.onDidTriggerButton=this._onDidTriggerButtonEmitter.event,this.onDidHide=this._onDidHideEmitter.event}get title(){return this._title}set title(e){this._title=e,this.update({title:e})}get step(){return this._steps}set step(e){this._steps=e,this.update({step:e})}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update({totalSteps:e})}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update({enabled:e})}get busy(){return this._busy}set busy(e){this._busy=e,this.update({busy:e})}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){this._ignoreFocusOut=e,this.update({ignoreFocusOut:e})}get value(){return this._value}set value(e){this._value=e,this.update({value:e})}get valueSelection(){return this._valueSelection}set valueSelection(e){this._valueSelection=e,this.update({valueSelection:e})}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update({placeholder:e})}get buttons(){return this._buttons}set buttons(e){let t=Hg(this._extension,`quickInputButtonLocation`);!t&&e.some(e=>e.location)&&console.warn(`Extension '${this._extension.identifier.value}' uses a button location which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this._extension.identifier.value}`),this._buttons=e.slice(),this._handlesToButtons.clear(),e.forEach((e,t)=>{let n=e===OC.Back?-1:t;this._handlesToButtons.set(n,e)}),this.update({buttons:e.map((e,n)=>({...l(e.iconPath),tooltip:e.tooltip,handle:e===OC.Back?-1:n,location:t?e.location:void 0}))})}show(){this._visible=!0,this._expectingHide=!0,this.update({visible:!0})}hide(){this._visible=!1,this.update({visible:!1})}_fireDidAccept(){this._onDidAcceptEmitter.fire()}_fireDidChangeValue(e){this._value=e,this._onDidChangeValueEmitter.fire(e)}_fireDidTriggerButton(e){let t=this._handlesToButtons.get(e);t&&this._onDidTriggerButtonEmitter.fire(t)}_fireDidHide(){this._expectingHide&&(this._expectingHide=this._visible,this._onDidHideEmitter.fire())}dispose(){this._disposed||(this._disposed=!0,this._fireDidHide(),this._disposables=yt(this._disposables),this._updateTimeout&&=(clearTimeout(this._updateTimeout),void 0),this._onDidDispose(),r.$dispose(this._id))}update(e){if(!this._disposed){for(let t of Object.keys(e)){let n=e[t];this._pendingUpdate[t]=n===void 0?null:n}`visible`in this._pendingUpdate?(this._updateTimeout&&=(clearTimeout(this._updateTimeout),void 0),this.dispatchUpdate()):this._visible&&!this._updateTimeout&&(this._updateTimeout=setTimeout(()=>{this._updateTimeout=void 0,this.dispatchUpdate()},0))}}dispatchUpdate(){r.$createOrUpdate(this._pendingUpdate),this._pendingUpdate={id:this._id}}}function o(e){if(e instanceof LS)return{id:e.id};let t=c(e),n=s(e);return{dark:typeof t==`string`?w.file(t):t,light:typeof n==`string`?w.file(n):n}}function s(e){return typeof e==`object`&&`light`in e?e.light:e}function c(e){return typeof e==`object`&&`dark`in e?e.dark:e}function l(e){let t=o(e),n,r;return`id`in t?r=fl.asClassName(t):n=t,{iconPath:n,iconClass:r}}class u extends a{constructor(e,t){super(e,t),this._items=[],this._handlesToItems=new Map,this._itemsToHandles=new Map,this._canSelectMany=!1,this._matchOnDescription=!0,this._matchOnDetail=!0,this._sortByLabel=!0,this._keepScrollPosition=!1,this._activeItems=[],this._onDidChangeActiveEmitter=new x,this._selectedItems=[],this._onDidChangeSelectionEmitter=new x,this._onDidTriggerItemButtonEmitter=new x,this.onDidChangeActive=this._onDidChangeActiveEmitter.event,this.onDidChangeSelection=this._onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this._onDidTriggerItemButtonEmitter.event,this._disposables.push(this._onDidChangeActiveEmitter,this._onDidChangeSelectionEmitter,this._onDidTriggerItemButtonEmitter),this.update({type:`quickPick`})}get items(){return this._items}set items(e){this._items=e.slice(),this._handlesToItems.clear(),this._itemsToHandles.clear(),e.forEach((e,t)=>{this._handlesToItems.set(t,e),this._itemsToHandles.set(e,t)});let t=Hg(this._extension,`quickPickItemTooltip`),n=[];for(let r=0;r<e.length;r++){let i=e[r];if(i.kind===kC.Separator)n.push({type:`separator`,label:i.label});else{i.tooltip&&!t&&console.warn(`Extension '${this._extension.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this._extension.identifier.value}`);let e=i.iconPath?l(i.iconPath):void 0;n.push({handle:r,label:i.label,iconPath:e?.iconPath,iconClass:e?.iconClass,description:i.description,detail:i.detail,picked:i.picked,alwaysShow:i.alwaysShow,tooltip:t?jD.fromStrict(i.tooltip):void 0,buttons:i.buttons?.map((e,t)=>({...l(e.iconPath),tooltip:e.tooltip,handle:t}))})}}this.update({items:n})}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update({canSelectMany:e})}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update({matchOnDescription:e})}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update({matchOnDetail:e})}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update({sortByLabel:e})}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e,this.update({keepScrollPosition:e})}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e.filter(e=>this._itemsToHandles.has(e)),this.update({activeItems:this._activeItems.map(e=>this._itemsToHandles.get(e))})}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e.filter(e=>this._itemsToHandles.has(e)),this.update({selectedItems:this._selectedItems.map(e=>this._itemsToHandles.get(e))})}_fireDidChangeActive(e){let t=be(e.map(e=>this._handlesToItems.get(e)));this._activeItems=t,this._onDidChangeActiveEmitter.fire(t)}_fireDidChangeSelection(e){let t=be(e.map(e=>this._handlesToItems.get(e)));this._selectedItems=t,this._onDidChangeSelectionEmitter.fire(t)}_fireDidTriggerItemButton(e,t){let n=this._handlesToItems.get(e);if(!n||!n.buttons||!n.buttons.length)return;let r=n.buttons[t];r&&this._onDidTriggerItemButtonEmitter.fire({button:r,item:n})}}class d extends a{constructor(e,t){super(e,t),this._password=!1,this.update({type:`inputBox`})}get password(){return this._password}set password(e){this._password=e,this.update({password:e})}get prompt(){return this._prompt}set prompt(e){this._prompt=e,this.update({prompt:e})}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,e?typeof e==`string`?this.update({validationMessage:e,severity:xc.Error}):this.update({validationMessage:e.message,severity:e.severity??xc.Error}):this.update({validationMessage:void 0,severity:xc.Ignore})}}return new i(t,n)}const kU=new u(()=>{let e=iP.Collator(void 0,{numeric:!0,sensitivity:`base`}).value;return{collator:e,collatorIsNumeric:e.resolvedOptions().numeric}});new u(()=>{let e=iP.Collator(void 0,{numeric:!0}).value;return{collator:e}}),new u(()=>{let e=iP.Collator(void 0,{numeric:!0,sensitivity:`accent`}).value;return{collator:e}});function AU(e,t,n=!1){let r=e||``,i=t||``,a=kU.value.collator.compare(r,i);return kU.value.collatorIsNumeric&&a===0&&r!==i?r<i?-1:1:a}function jU(e,t,n=!1){return n||(e&&=e.toLowerCase(),t&&=t.toLowerCase()),e===t?0:e<t?-1:1}function MU(e,t,n=!1){let r=e.split(Kr),i=t.split(Kr),a=r.length-1,o=i.length-1,s,c;for(let e=0;;e++){if(s=a===e,c=o===e,s&&c)return AU(r[e],i[e],n);if(s)return-1;if(c)return 1;let t=jU(r[e],i[e],n);if(t!==0)return t}}function NU(e){return e instanceof w}function PU(e,t){return e.scheme===O.file&&t.scheme===O.file&&Qn?e.toString()===t.toString():e.toString().toLowerCase()===t.toString().toLowerCase()}function FU(e){if(e)return typeof e.iconPath==`string`?w.file(e.iconPath):w.isUri(e.iconPath)||fl.isThemeIcon(e.iconPath)?e.iconPath:void 0}function IU(e){if(e){if(w.isUri(e)||fl.isThemeIcon(e))return e;{let t=e;return{light:t.light,dark:t.dark}}}else return}function LU(e){let t=IU(e.authorIcon),n=e.references?.map(e=>({...e,icon:IU(e.icon)}));return{...e,authorIcon:t,references:n}}function RU(e){return e?{...e,icon:IU(e.icon)}:void 0}function zU(e,t){if(!e.iconPath&&!t.iconPath)return 0;if(e.iconPath){if(!t.iconPath)return 1}else return-1;let n=typeof e.iconPath==`string`?e.iconPath:w.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id,r=typeof t.iconPath==`string`?t.iconPath:w.isUri(t.iconPath)?t.iconPath.fsPath:t.iconPath.id;return MU(n,r)}function BU(e,t){let n=0;if(e.strikeThrough!==t.strikeThrough)return e.strikeThrough?1:-1;if(e.faded!==t.faded)return e.faded?1:-1;if(e.tooltip!==t.tooltip)return(e.tooltip||``).localeCompare(t.tooltip||``);if(n=zU(e,t),n!==0)return n;if(e.light&&t.light)n=zU(e.light,t.light);else if(e.light)return 1;else if(t.light)return-1;if(n!==0)return n;if(e.dark&&t.dark)n=zU(e.dark,t.dark);else if(e.dark)return 1;else if(t.dark)return-1;return n}function VU(e,t){if(e.command!==t.command)return e.command<t.command?-1:1;if(e.title!==t.title)return e.title<t.title?-1:1;if(e.tooltip!==t.tooltip){if(e.tooltip!==void 0&&t.tooltip!==void 0)return e.tooltip<t.tooltip?-1:1;if(e.tooltip!==void 0)return 1;if(t.tooltip!==void 0)return-1}if(e.arguments===t.arguments)return 0;if(e.arguments)if(t.arguments){if(e.arguments.length!==t.arguments.length)return e.arguments.length-t.arguments.length}else return 1;else return-1;for(let n=0;n<e.arguments.length;n++){let r=e.arguments[n],i=t.arguments[n];if(r!==i&&!(NU(r)&&NU(i)&&PU(r,i)))return r<i?-1:1}return 0}function HU(e,t){let n=MU(e.resourceUri.fsPath,t.resourceUri.fsPath,!0);if(n!==0)return n;if(e.command&&t.command)n=VU(e.command,t.command);else if(e.command)return 1;else if(t.command)return-1;if(n!==0)return n;if(e.decorations&&t.decorations)n=BU(e.decorations,t.decorations);else if(e.decorations)return 1;else if(t.decorations)return-1;if(n!==0)return n;if(e.multiFileDiffEditorModifiedUri&&t.multiFileDiffEditorModifiedUri)n=MU(e.multiFileDiffEditorModifiedUri.fsPath,t.multiFileDiffEditorModifiedUri.fsPath,!0);else if(e.multiFileDiffEditorModifiedUri)return 1;else if(t.multiFileDiffEditorModifiedUri)return-1;if(n!==0)return n;if(e.multiDiffEditorOriginalUri&&t.multiDiffEditorOriginalUri)n=MU(e.multiDiffEditorOriginalUri.fsPath,t.multiDiffEditorOriginalUri.fsPath,!0);else if(e.multiDiffEditorOriginalUri)return 1;else if(t.multiDiffEditorOriginalUri)return-1;return n}function UU(e,t){for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function WU(e,t){return e.command===t.command&&e.title===t.title&&e.tooltip===t.tooltip&&(e.arguments&&t.arguments?UU(e.arguments,t.arguments):e.arguments===t.arguments)}function GU(e,t){return ge(e,t,WU)}var KU=class{#proxy;#extHostDocuments;get value(){return this._value}set value(e){e??=``,this.#proxy.$setInputBoxValue(this._sourceControlHandle,e),this.updateValue(e)}get onDidChange(){return this._onDidChange.event}get placeholder(){return this._placeholder}set placeholder(e){this.#proxy.$setInputBoxPlaceholder(this._sourceControlHandle,e),this._placeholder=e}get validateInput(){return U(this._extension,`scmValidation`),this._validateInput}set validateInput(e){if(U(this._extension,`scmValidation`),e&&typeof e!=`function`)throw Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`);this._validateInput=e,this.#proxy.$setValidationProviderIsEnabled(this._sourceControlHandle,!!e)}get enabled(){return this._enabled}set enabled(e){e=!!e,this._enabled!==e&&(this._enabled=e,this.#proxy.$setInputBoxEnablement(this._sourceControlHandle,e))}get visible(){return this._visible}set visible(e){e=!!e,this._visible!==e&&(this._visible=e,this.#proxy.$setInputBoxVisibility(this._sourceControlHandle,e))}get document(){return U(this._extension,`scmTextDocument`),this.#extHostDocuments.getDocument(this._documentUri)}constructor(e,t,n,r,i){this._extension=e,this._sourceControlHandle=r,this._documentUri=i,this._value=``,this._onDidChange=new x,this._placeholder=``,this._enabled=!0,this._visible=!0,this.#extHostDocuments=t,this.#proxy=n}showValidationMessage(e,t){U(this._extension,`scmValidation`),this.#proxy.$showValidationMessage(this._sourceControlHandle,e,t)}$onInputBoxValueChange(e){this.updateValue(e)}updateValue(e){this._value=e,this._onDidChange.fire(e)}},qU=class e{static{this._handlePool=0}get disposed(){return this._disposed}get id(){return this._id}get label(){return this._label}set label(e){this._label=e,this._proxy.$updateGroupLabel(this._sourceControlHandle,this.handle,e)}get contextValue(){return this._contextValue}set contextValue(e){this._contextValue=e,this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get hideWhenEmpty(){return this._hideWhenEmpty}set hideWhenEmpty(e){this._hideWhenEmpty=e,this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get features(){return{contextValue:this.contextValue,hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this._resourceStates]}set resourceStates(e){this._resourceStates=[...e],this._onDidUpdateResourceStates.fire()}constructor(t,n,r,i,a,o,s){this._proxy=t,this._commands=n,this._sourceControlHandle=r,this._id=i,this._label=a,this.multiDiffEditorEnableViewChanges=o,this._extension=s,this._resourceHandlePool=0,this._resourceStates=[],this._resourceStatesMap=new Map,this._resourceStatesCommandsMap=new Map,this._resourceStatesDisposablesMap=new Map,this._onDidUpdateResourceStates=new x,this.onDidUpdateResourceStates=this._onDidUpdateResourceStates.event,this._disposed=!1,this._onDidDispose=new x,this.onDidDispose=this._onDidDispose.event,this._handlesSnapshot=[],this._resourceSnapshot=[],this._contextValue=void 0,this._hideWhenEmpty=void 0,this.handle=e._handlePool++}getResourceState(e){return this._resourceStatesMap.get(e)}$executeResourceCommand(e,t){let n=this._resourceStatesCommandsMap.get(e);return n?uo(()=>this._commands.executeCommand(n.command,...n.arguments||[],t)):Promise.resolve(void 0)}_takeResourceStateSnapshot(){let e=[...this._resourceStates].sort(HU),t=ve(this._resourceSnapshot,e,HU),n=t.map(e=>{let t=e.toInsert.map(e=>{let t=this._resourceHandlePool++;this._resourceStatesMap.set(t,e);let n=e.resourceUri,r;if(e.command)if(e.command.command===`vscode.open`||e.command.command===`vscode.diff`||e.command.command===`vscode.changes`){let n=new v;r=this._commands.converter.toInternal(e.command,n),this._resourceStatesDisposablesMap.set(t,n)}else this._resourceStatesCommandsMap.set(t,e.command);let i=Hg(this._extension,`scmMultiDiffEditor`),a=i?e.multiDiffEditorOriginalUri:void 0,o=i?e.multiFileDiffEditorModifiedUri:void 0,s=FU(e.decorations),c=e.decorations&&FU(e.decorations.light)||s,l=e.decorations&&FU(e.decorations.dark)||s,u=[c,l],d=e.decorations&&e.decorations.tooltip||``,f=e.decorations&&!!e.decorations.strikeThrough,p=e.decorations&&!!e.decorations.faded,ee=e.contextValue||``,m=[t,n,u,d,f,p,ee,r,a,o];return{rawResource:m,handle:t}});return{start:e.start,deleteCount:e.deleteCount,toInsert:t}}),r=n.map(({start:e,deleteCount:t,toInsert:n})=>[e,t,n.map(e=>e.rawResource)]),i=n.reverse();for(let{start:e,deleteCount:t,toInsert:n}of i){let r=n.map(e=>e.handle),i=this._handlesSnapshot.splice(e,t,...r);for(let e of i)this._resourceStatesMap.delete(e),this._resourceStatesCommandsMap.delete(e),this._resourceStatesDisposablesMap.get(e)?.dispose(),this._resourceStatesDisposablesMap.delete(e)}return this._resourceSnapshot=e,r}dispose(){this._disposed=!0,this._onDidDispose.fire()}},JU=class e{static{this._handlePool=0}#proxy;get id(){return this._id}get label(){return this._label}get rootUri(){return this._rootUri}get contextValue(){return U(this._extension,`scmProviderOptions`),this._contextValue}set contextValue(e){U(this._extension,`scmProviderOptions`),this._contextValue!==e&&(this._contextValue=e,this.#proxy.$updateSourceControl(this.handle,{contextValue:e}))}get inputBox(){return this._inputBox}get count(){return this._count}set count(e){this._count!==e&&(this._count=e,this.#proxy.$updateSourceControl(this.handle,{count:e}))}get quickDiffProvider(){return this._quickDiffProvider}set quickDiffProvider(e){this._quickDiffProvider=e;let t;Hg(this._extension,`quickDiffProvider`)&&(t=e?.label),this.#proxy.$updateSourceControl(this.handle,{hasQuickDiffProvider:!!e,quickDiffLabel:t})}get secondaryQuickDiffProvider(){return U(this._extension,`quickDiffProvider`),this._secondaryQuickDiffProvider}set secondaryQuickDiffProvider(e){U(this._extension,`quickDiffProvider`),this._secondaryQuickDiffProvider=e;let t=e?.label;this.#proxy.$updateSourceControl(this.handle,{hasSecondaryQuickDiffProvider:!!e,secondaryQuickDiffLabel:t})}get historyProvider(){return U(this._extension,`scmHistoryProvider`),this._historyProvider}set historyProvider(e){U(this._extension,`scmHistoryProvider`),this._historyProvider=e,this._historyProviderDisposable.value=new v,this.#proxy.$updateSourceControl(this.handle,{hasHistoryProvider:!!e}),e&&(this._historyProviderDisposable.value.add(e.onDidChangeCurrentHistoryItemRefs(()=>{let t=RU(e?.currentHistoryItemRef),n=RU(e?.currentHistoryItemRemoteRef),r=RU(e?.currentHistoryItemBaseRef);this.#proxy.$onDidChangeHistoryProviderCurrentHistoryItemRefs(this.handle,t,n,r)})),this._historyProviderDisposable.value.add(e.onDidChangeHistoryItemRefs(e=>{if(e.added.length===0&&e.modified.length===0&&e.removed.length===0)return;let t=e.added.map(e=>({...e,icon:IU(e.icon)})),n=e.modified.map(e=>({...e,icon:IU(e.icon)})),r=e.removed.map(e=>({...e,icon:IU(e.icon)}));this.#proxy.$onDidChangeHistoryProviderHistoryItemRefs(this.handle,{added:t,modified:n,removed:r,silent:e.silent})})))}get commitTemplate(){return this._commitTemplate}set commitTemplate(e){e!==this._commitTemplate&&(this._commitTemplate=e,this.#proxy.$updateSourceControl(this.handle,{commitTemplate:e}))}get acceptInputCommand(){return this._acceptInputCommand}set acceptInputCommand(e){this._acceptInputDisposables.value=new v,this._acceptInputCommand=e;let t=this._commands.converter.toInternal(e,this._acceptInputDisposables.value);this.#proxy.$updateSourceControl(this.handle,{acceptInputCommand:t})}get actionButton(){return U(this._extension,`scmActionButton`),this._actionButton}set actionButton(e){if(U(this._extension,`scmActionButton`),QT(this._actionButton,e))return;this._actionButton=e,this._actionButtonDisposables.value=new v;let t=e===void 0?void 0:{command:{...this._commands.converter.toInternal(e.command,this._actionButtonDisposables.value),shortTitle:e.command.shortTitle},secondaryCommands:e.secondaryCommands?.map(e=>e.map(e=>this._commands.converter.toInternal(e,this._actionButtonDisposables.value))),enabled:e.enabled};this.#proxy.$updateSourceControl(this.handle,{actionButton:t??null})}get statusBarCommands(){return this._statusBarCommands}set statusBarCommands(e){if(this._statusBarCommands&&e&&GU(this._statusBarCommands,e))return;this._statusBarDisposables.value=new v,this._statusBarCommands=e;let t=(e||[]).map(e=>this._commands.converter.toInternal(e,this._statusBarDisposables.value));this.#proxy.$updateSourceControl(this.handle,{statusBarCommands:t})}get selected(){return this._selected}constructor(t,n,r,i,a,o,s,c,l){this._extension=t,this._commands=i,this._id=a,this._label=o,this._rootUri=s,this._onDidDispose=new x,this.onDidDispose=this._onDidDispose.event,this._groups=new Map,this._contextValue=void 0,this._count=void 0,this._quickDiffProvider=void 0,this._secondaryQuickDiffProvider=void 0,this._historyProviderDisposable=new xt,this._commitTemplate=void 0,this._acceptInputDisposables=new xt,this._acceptInputCommand=void 0,this._actionButtonDisposables=new xt,this._statusBarDisposables=new xt,this._statusBarCommands=void 0,this._selected=!1,this._onDidChangeSelection=new x,this.onDidChangeSelection=this._onDidChangeSelection.event,this.handle=e._handlePool++,this.createdResourceGroups=new Map,this.updatedResourceGroups=new Set,this.#proxy=r;let u=w.from({scheme:O.vscodeSourceControl,path:`${a}/scm${this.handle}/input`,query:s?`rootUri=${encodeURIComponent(s.toString())}`:void 0});this._inputBox=new KU(t,n,this.#proxy,this.handle,u),this.#proxy.$registerSourceControl(this.handle,l?.handle,a,o,s,IU(c),u),this.onDidDisposeParent=l?l.onDidDispose:en.None}createResourceGroup(e,t,n){let r=Hg(this._extension,`scmMultiDiffEditor`)&&n?.multiDiffEditorEnableViewChanges===!0,i=new qU(this.#proxy,this._commands,this.handle,e,t,r,this._extension),a=en.once(i.onDidDispose)(()=>this.createdResourceGroups.delete(i));return this.createdResourceGroups.set(i,a),this.eventuallyAddResourceGroups(),i}eventuallyAddResourceGroups(){let e=[],t=[];for(let[n,r]of this.createdResourceGroups){r.dispose();let i=n.onDidUpdateResourceStates(()=>{this.updatedResourceGroups.add(n),this.eventuallyUpdateResourceStates()});en.once(n.onDidDispose)(()=>{this.updatedResourceGroups.delete(n),i.dispose(),this._groups.delete(n.handle),this.#proxy.$unregisterGroup(this.handle,n.handle)}),e.push([n.handle,n.id,n.label,n.features,n.multiDiffEditorEnableViewChanges]);let a=n._takeResourceStateSnapshot();a.length>0&&t.push([n.handle,a]),this._groups.set(n.handle,n)}this.#proxy.$registerGroups(this.handle,e,t),this.createdResourceGroups.clear()}eventuallyUpdateResourceStates(){let e=[];this.updatedResourceGroups.forEach(t=>{let n=t._takeResourceStateSnapshot();n.length!==0&&e.push([t.handle,n])}),e.length>0&&this.#proxy.$spliceResourceStates(this.handle,e),this.updatedResourceGroups.clear()}getResourceGroup(e){return this._groups.get(e)}setSelectionState(e){this._selected=e,this._onDidChangeSelection.fire(e)}dispose(){this._acceptInputDisposables.dispose(),this._actionButtonDisposables.dispose(),this._statusBarDisposables.dispose(),this._groups.forEach(e=>e.dispose()),this.#proxy.$unregisterSourceControl(this.handle),this._onDidDispose.fire(),this._onDidDispose.dispose()}};JU.__decorator=A([zN(100)],JU.prototype,`eventuallyAddResourceGroups`,null),JU.__decorator=A([zN(100)],JU.prototype,`eventuallyUpdateResourceStates`,null);let YU=class{get onDidChangeActiveProvider(){return this._onDidChangeActiveProvider.event}constructor(e,t,n,r){this._commands=t,this._extHostDocuments=n,this.logService=r,this._sourceControls=new Map,this._sourceControlsByExtension=new gs,this._onDidChangeActiveProvider=new x,this._proxy=e.getProxy(E.MainThreadSCM),this._telemetry=e.getProxy(E.MainThreadTelemetry),t.registerArgumentProcessor({processArgument:e=>{if(e&&e.$mid===Dn.ScmResource){let t=this._sourceControls.get(e.sourceControlHandle);if(!t)return e;let n=t.getResourceGroup(e.groupHandle);return n?n.getResourceState(e.handle):e}else if(e&&e.$mid===Dn.ScmResourceGroup){let t=this._sourceControls.get(e.sourceControlHandle);return t?t.getResourceGroup(e.groupHandle):e}else if(e&&e.$mid===Dn.ScmProvider){let t=this._sourceControls.get(e.handle);return t||e}return e}})}createSourceControl(e,t,n,r,i,a){this.logService.trace(`ExtHostSCM#createSourceControl`,e.identifier.value,t,n,r),this._telemetry.$publicLog2(`api/scm/createSourceControl`,{extensionId:e.identifier.value});let o=a?pt.find(this._sourceControls.values(),e=>e===a):void 0,s=new JU(e,this._extHostDocuments,this._proxy,this._commands,t,n,r,i,o);this._sourceControls.set(s.handle,s);let c=this._sourceControlsByExtension.get(e.identifier)||[];return c.push(s),this._sourceControlsByExtension.set(e.identifier,c),s}getLastInputBox(e){this.logService.trace(`ExtHostSCM#getLastInputBox`,e.identifier.value);let t=this._sourceControlsByExtension.get(e.identifier),n=t&&t[t.length-1];return n&&n.inputBox}$provideOriginalResource(e,t,n){let r=w.revive(t);this.logService.trace(`ExtHostSCM#$provideOriginalResource`,e,r.toString());let i=this._sourceControls.get(e);return!i||!i.quickDiffProvider||!i.quickDiffProvider.provideOriginalResource?Promise.resolve(null):uo(()=>i.quickDiffProvider.provideOriginalResource(r,n)).then(e=>e||null)}$provideSecondaryOriginalResource(e,t,n){let r=w.revive(t);this.logService.trace(`ExtHostSCM#$provideSecondaryOriginalResource`,e,r.toString());let i=this._sourceControls.get(e);return!i||!i.secondaryQuickDiffProvider||!i.secondaryQuickDiffProvider.provideOriginalResource?Promise.resolve(null):uo(()=>i.secondaryQuickDiffProvider.provideOriginalResource(r,n)).then(e=>e||null)}$onInputBoxValueChange(e,t){this.logService.trace(`ExtHostSCM#$onInputBoxValueChange`,e);let n=this._sourceControls.get(e);return n&&n.inputBox.$onInputBoxValueChange(t),Promise.resolve(void 0)}$executeResourceCommand(e,t,n,r){this.logService.trace(`ExtHostSCM#$executeResourceCommand`,e,t,n);let i=this._sourceControls.get(e);if(!i)return Promise.resolve(void 0);let a=i.getResourceGroup(t);return a?a.$executeResourceCommand(n,r):Promise.resolve(void 0)}$validateInput(e,t,n){this.logService.trace(`ExtHostSCM#$validateInput`,e);let r=this._sourceControls.get(e);return!r||!r.inputBox.validateInput?Promise.resolve(void 0):uo(()=>r.inputBox.validateInput(t,n)).then(e=>{if(!e)return Promise.resolve(void 0);let t=jD.fromStrict(e.message);return t?Promise.resolve([t,e.type]):Promise.resolve(void 0)})}$setSelectedSourceControl(e){return this.logService.trace(`ExtHostSCM#$setSelectedSourceControl`,e),e!==void 0&&this._sourceControls.get(e)?.setSelectionState(!0),this._selectedSourceControlHandle!==void 0&&this._sourceControls.get(this._selectedSourceControlHandle)?.setSelectionState(!1),this._selectedSourceControlHandle=e,Promise.resolve(void 0)}async $resolveHistoryItemChatContext(e,t,n){try{let r=this._sourceControls.get(e)?.historyProvider,i=await r?.resolveHistoryItemChatContext(t,n);return i??void 0}catch(e){this.logService.error(`ExtHostSCM#$resolveHistoryItemChatContext`,e);return}}async $resolveHistoryItemRefsCommonAncestor(e,t,n){try{let r=this._sourceControls.get(e)?.historyProvider,i=await r?.resolveHistoryItemRefsCommonAncestor(t,n);return i??void 0}catch(e){this.logService.error(`ExtHostSCM#$resolveHistoryItemRefsCommonAncestor`,e);return}}async $provideHistoryItemRefs(e,t,n){try{let r=this._sourceControls.get(e)?.historyProvider,i=await r?.provideHistoryItemRefs(t,n);return i?.map(e=>({...e,icon:IU(e.icon)}))??void 0}catch(e){this.logService.error(`ExtHostSCM#$provideHistoryItemRefs`,e);return}}async $provideHistoryItems(e,t,n){try{let r=this._sourceControls.get(e)?.historyProvider,i=await r?.provideHistoryItems(t,n);return i?.map(e=>LU(e))??void 0}catch(e){this.logService.error(`ExtHostSCM#$provideHistoryItems`,e);return}}async $provideHistoryItemChanges(e,t,n,r){try{let i=this._sourceControls.get(e)?.historyProvider,a=await i?.provideHistoryItemChanges(t,n,r);return a??void 0}catch(e){this.logService.error(`ExtHostSCM#$provideHistoryItemChanges`,e);return}}};YU=A([j(3,xs)],YU);var XU=class e{static{this.handlePool=0}constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(E.MainThreadShare)}async $provideShare(e,t,n){let r=this.providers.get(e),i=await r?.provideShare({selection:K.to(t.selection),resourceUri:w.revive(t.resourceUri)},n);return i??void 0}registerShareProvider(t,n){let r=e.handlePool++;return this.providers.set(r,n),this.proxy.$registerShareProvider(r,CD.from(t,this.uriTransformer),n.id,n.label,n.priority),{dispose:()=>{this.proxy.$unregisterShareProvider(r),this.providers.delete(r)}}}},ZU=class e{static{this.ID_POOL=1}constructor(e){this.providers=new Map,this.sessions=new Map,this.synthesizers=new Map,this.proxy=e.getProxy(E.MainThreadSpeech)}async $createSpeechToTextSession(e,t,n){let r=this.providers.get(e);if(!r)return;let i=new v,a=new Ai;this.sessions.set(t,a);let o=await r.provideSpeechToTextSession(a.token,n?{language:n}:void 0);o&&(i.add(o.onDidChange(e=>{a.token.isCancellationRequested||this.proxy.$emitSpeechToTextEvent(t,e)})),i.add(a.token.onCancellationRequested(()=>i.dispose())))}async $cancelSpeechToTextSession(e){this.sessions.get(e)?.dispose(!0),this.sessions.delete(e)}async $createTextToSpeechSession(e,t,n){let r=this.providers.get(e);if(!r)return;let i=new v,a=new Ai;this.sessions.set(t,a);let o=await r.provideTextToSpeechSession(a.token,n?{language:n}:void 0);o&&(this.synthesizers.set(t,o),i.add(o.onDidChange(e=>{a.token.isCancellationRequested||this.proxy.$emitTextToSpeechEvent(t,e)})),i.add(a.token.onCancellationRequested(()=>i.dispose())))}async $synthesizeSpeech(e,t){this.synthesizers.get(e)?.synthesize(t)}async $cancelTextToSpeechSession(e){this.sessions.get(e)?.dispose(!0),this.sessions.delete(e),this.synthesizers.delete(e)}async $createKeywordRecognitionSession(e,t){let n=this.providers.get(e);if(!n)return;let r=new v,i=new Ai;this.sessions.set(t,i);let a=await n.provideKeywordRecognitionSession(i.token);a&&(r.add(a.onDidChange(e=>{i.token.isCancellationRequested||this.proxy.$emitKeywordRecognitionEvent(t,e)})),r.add(i.token.onCancellationRequested(()=>r.dispose())))}async $cancelKeywordRecognitionSession(e){this.sessions.get(e)?.dispose(!0),this.sessions.delete(e)}registerProvider(t,n,r){let i=e.ID_POOL++;return this.providers.set(i,r),this.proxy.$registerProvider(i,n,{extension:t,displayName:t.value}),_(()=>{this.proxy.$unregisterProvider(i),this.providers.delete(i)})}},QU=class e{static{this.ID_GEN=0}static{this.ALLOWED_BACKGROUND_COLORS=new Map([[`statusBarItem.errorBackground`,new RS(`statusBarItem.errorForeground`)],[`statusBarItem.warningBackground`,new RS(`statusBarItem.warningForeground`)]])}#proxy;#commands;constructor(t,n,r,i,a,o=zx.Left,s,c){if(this._onDispose=c,this._disposed=!1,this._text=``,this._staleCommandRegistrations=new v,this.#proxy=t,this.#commands=n,a&&i){this._entryId=Bx(i.identifier,a);let e=r.get(this._entryId);e&&(o=e.alignLeft?zx.Left:zx.Right,s=e.priority,this._visible=!0,this.name=e.name,this.text=e.text,this.tooltip=e.tooltip,this.command=e.command,this.accessibilityInformation=e.accessibilityInformation)}else this._entryId=String(e.ID_GEN++);this._extension=i,this._id=a,this._alignment=o,this._priority=this.validatePriority(s)}validatePriority(e){if(tt(e))return e===1/0?Number.MAX_VALUE:e===-1/0?-Number.MAX_VALUE:e}get id(){return this._id??this._extension.identifier.value}get entryId(){return this._entryId}get alignment(){return this._alignment}get priority(){return this._priority}get text(){return this._text}get name(){return this._name}get tooltip(){return this._tooltip}get tooltip2(){return this._extension&&U(this._extension,`statusBarItemTooltip`),this._tooltip2}get color(){return this._color}get backgroundColor(){return this._backgroundColor}get command(){return this._command?.fromApi}get accessibilityInformation(){return this._accessibilityInformation}set text(e){this._text=e,this.update()}set name(e){this._name=e,this.update()}set tooltip(e){this._tooltip=e,this.update()}set tooltip2(e){this._extension&&U(this._extension,`statusBarItemTooltip`),this._tooltip2=e,this.update()}set color(e){this._color=e,this.update()}set backgroundColor(t){t&&!e.ALLOWED_BACKGROUND_COLORS.has(t.id)&&(t=void 0),this._backgroundColor=t,this.update()}set command(e){this._command?.fromApi!==e&&(this._latestCommandRegistration&&this._staleCommandRegistrations.add(this._latestCommandRegistration),this._latestCommandRegistration=new v,typeof e==`string`?this._command={fromApi:e,internal:this.#commands.toInternal({title:``,command:e},this._latestCommandRegistration)}:e?this._command={fromApi:e,internal:this.#commands.toInternal(e,this._latestCommandRegistration)}:this._command=void 0,this.update())}set accessibilityInformation(e){this._accessibilityInformation=e,this.update()}show(){this._visible=!0,this.update()}hide(){clearTimeout(this._timeoutHandle),this._visible=!1,this.#proxy.$disposeEntry(this._entryId)}update(){this._disposed||!this._visible||(clearTimeout(this._timeoutHandle),this._timeoutHandle=setTimeout(()=>{this._timeoutHandle=void 0;let t;t=this._extension?this._id?`${this._extension.identifier.value}.${this._id}`:this._extension.identifier.value:this._id;let n;n=this._name?this._name:C(2633,`{0} (Extension)`,this._extension.displayName||this._extension.name);let r=this._color;this._backgroundColor&&(r=e.ALLOWED_BACKGROUND_COLORS.get(this._backgroundColor.id));let i,a;typeof this._tooltip2==`function`?(i=jD.fromStrict(this._tooltip),a=!0):(i=jD.fromStrict(this._tooltip2??this._tooltip),a=!1),this.#proxy.$setEntry(this._entryId,t,this._extension?.identifier.value,n,this._text,i,a,this._command?.internal,r,this._backgroundColor,this._alignment===zx.Left,this._priority,this._accessibilityInformation),this._staleCommandRegistrations.clear()},0))}dispose(){this.hide(),this._onDispose?.(),this._disposed=!0}},$U=class{constructor(e){this._messages=[],this._item=e.createStatusBarEntry(void 0,`status.extensionMessage`,zx.Left,Number.MIN_VALUE),this._item.name=C(2634,`Extension Status`)}dispose(){this._messages.length=0,this._item.dispose()}setMessage(e){let t={message:e};return this._messages.unshift(t),this._update(),new Pb(()=>{let e=this._messages.indexOf(t);e>=0&&(this._messages.splice(e,1),this._update())})}_update(){this._messages.length>0?(this._item.text=this._messages[0].message,this._item.show()):this._item.hide()}},eW=class{constructor(e,t){this._entries=new Map,this._existingItems=new Map,this._proxy=e.getProxy(E.MainThreadStatusBar),this._commands=t,this._statusMessage=new $U(this)}$acceptStaticEntries(e){for(let t of e)this._existingItems.set(t.entryId,t)}async $provideTooltip(e,t){let n=this._entries.get(e);if(!n)return;let r=typeof n.tooltip2==`function`?await n.tooltip2(t):n.tooltip2;return t.isCancellationRequested?void 0:jD.fromStrict(r)}createStatusBarEntry(e,t,n,r){let i=new QU(this._proxy,this._commands,this._existingItems,e,t,n,r,()=>this._entries.delete(i.entryId));return this._entries.set(i.entryId,i),i}setStatusBarMessage(e,t){let n=this._statusMessage.setMessage(e),r;return typeof t==`number`?r=setTimeout(()=>n.dispose(),t):t!==void 0&&t.then(()=>n.dispose(),()=>n.dispose()),new Pb(()=>{n.dispose(),clearTimeout(r)})}},tW=class extends y{constructor(e,t){super(),this._extHostDocumentsAndEditors=t,this._onDidChangeTextEditorSelection=new x,this._onDidChangeTextEditorOptions=new x,this._onDidChangeTextEditorVisibleRanges=new x,this._onDidChangeTextEditorViewColumn=new x,this._onDidChangeTextEditorDiffInformation=new x,this._onDidChangeActiveTextEditor=new x,this._onDidChangeVisibleTextEditors=new x,this.onDidChangeTextEditorSelection=this._onDidChangeTextEditorSelection.event,this.onDidChangeTextEditorOptions=this._onDidChangeTextEditorOptions.event,this.onDidChangeTextEditorVisibleRanges=this._onDidChangeTextEditorVisibleRanges.event,this.onDidChangeTextEditorViewColumn=this._onDidChangeTextEditorViewColumn.event,this.onDidChangeTextEditorDiffInformation=this._onDidChangeTextEditorDiffInformation.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this._proxy=e.getProxy(E.MainThreadTextEditors),this._register(this._extHostDocumentsAndEditors.onDidChangeVisibleTextEditors(e=>this._onDidChangeVisibleTextEditors.fire(e))),this._register(this._extHostDocumentsAndEditors.onDidChangeActiveTextEditor(e=>this._onDidChangeActiveTextEditor.fire(e)))}getActiveTextEditor(){return this._extHostDocumentsAndEditors.activeEditor()}getVisibleTextEditors(e){let t=this._extHostDocumentsAndEditors.allEditors();return e?t:t.map(e=>e.value)}async showTextDocument(e,t,n){let r;r=typeof t==`number`?{position:OD.from(t),preserveFocus:n}:typeof t==`object`?{position:OD.from(t.viewColumn),preserveFocus:t.preserveFocus,selection:typeof t.selection==`object`?K.from(t.selection):void 0,pinned:typeof t.preview==`boolean`?!t.preview:void 0}:{preserveFocus:!1};let i=await this._proxy.$tryShowTextDocument(e.uri,r),a=i&&this._extHostDocumentsAndEditors.getEditor(i);if(a)return a.value;throw i?Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):Error(`Could NOT open editor for "${e.uri.toString()}".`)}createTextEditorDecorationType(e,t){return new zF(this._proxy,e,t).value}$acceptEditorPropertiesChanged(e,t){let n=this._extHostDocumentsAndEditors.getEditor(e);if(!n)throw Error(`unknown text editor`);if(t.options&&n._acceptOptions(t.options),t.selections){let e=t.selections.selections.map(yD.to);n._acceptSelections(e)}if(t.visibleRanges){let e=be(t.visibleRanges.map(K.to));n._acceptVisibleRanges(e)}if(t.options&&this._onDidChangeTextEditorOptions.fire({textEditor:n.value,options:{...t.options,lineNumbers:vO.to(t.options.lineNumbers)}}),t.selections){let e=Wx.fromValue(t.selections.source),r=t.selections.selections.map(yD.to);this._onDidChangeTextEditorSelection.fire({textEditor:n.value,selections:r,kind:e})}if(t.visibleRanges){let e=be(t.visibleRanges.map(K.to));this._onDidChangeTextEditorVisibleRanges.fire({textEditor:n.value,visibleRanges:e})}}$acceptEditorPositionData(e){for(let t in e){let n=this._extHostDocumentsAndEditors.getEditor(t);if(!n)throw Error(`Unknown text editor`);let r=OD.to(e[t]);n.value.viewColumn!==r&&(n._acceptViewColumn(r),this._onDidChangeTextEditorViewColumn.fire({textEditor:n.value,viewColumn:r}))}}$acceptEditorDiffInformation(e,t){let n=this._extHostDocumentsAndEditors.getEditor(e);if(!n)throw Error(`unknown text editor`);if(!t){n._acceptDiffInformation(void 0),this._onDidChangeTextEditorDiffInformation.fire({textEditor:n.value,diffInformation:void 0});return}let r=this,i=t.map(e=>{let t=w.revive(e.original),n=w.revive(e.modified),i=e.changes.map(e=>{let[t,n,r,i]=e,a;return a=t===n?Gx.Addition:r===i?Gx.Deletion:Gx.Modification,{original:{startLineNumber:t,endLineNumberExclusive:n},modified:{startLineNumber:r,endLineNumberExclusive:i},kind:a}});return Object.freeze({documentVersion:e.documentVersion,original:t,modified:n,changes:i,get isStale(){let t=r._extHostDocumentsAndEditors.getDocument(n);return t?.version!==e.documentVersion}})});n._acceptDiffInformation(i),this._onDidChangeTextEditorDiffInformation.fire({textEditor:n.value,diffInformation:i})}getDiffInformation(e){return Promise.resolve(this._proxy.$getDiffInformation(e))}};let nW=class{constructor(e){this._actual=new NC(PC.Dark),this._onDidChangeActiveColorTheme=new x}get activeColorTheme(){return this._actual}$onColorThemeChange(e){let t;switch(e){case`light`:t=PC.Light;break;case`hcDark`:t=PC.HighContrast;break;case`hcLight`:t=PC.HighContrastLight;break;default:t=PC.Dark}this._actual=new NC(t),this._onDidChangeActiveColorTheme.fire(this._actual)}get onDidChangeActiveColorTheme(){return this._onDidChangeActiveColorTheme.event}};nW=A([j(0,Is)],nW);var rW=class{constructor(e,t){this._providers=new Map,this._itemsBySourceAndUriMap=new Map,this._proxy=e.getProxy(E.MainThreadTimeline),t.registerArgumentProcessor({processArgument:(e,t)=>{if(e&&e.$mid===Dn.TimelineActionContext)if(this._providers.get(e.source)&&t&&Hg(t,`timeline`)){let t=e.uri===void 0?void 0:w.revive(e.uri);return this._itemsBySourceAndUriMap.get(e.source)?.get(iW(t))?.get(e.handle)}else return;return e}})}async $getTimeline(e,t,n,r){let i=this._providers.get(e);return i?.provider.provideTimeline(w.revive(t),n,r)}registerTimelineProvider(e,t,n,r){let i=new v,a=this.convertTimelineItem(t.id,r,i).bind(this),o;t.onDidChange&&(o=t.onDidChange(e=>this._proxy.$emitTimelineChangeEvent({uri:void 0,reset:!0,...e,id:t.id}),this));let s=this._itemsBySourceAndUriMap;return this.registerTimelineProviderCore({...t,scheme:e,onDidChange:void 0,async provideTimeline(e,n,r){n?.resetCache&&(i.clear(),s.get(t.id)?.clear());let o=await t.provideTimeline(e,n,r);if(o==null)return;let c=a(e,n);return{...o,source:t.id,items:o.items.map(c)}},dispose(){for(let e of s.values())e.get(t.id)?.clear();o?.dispose(),i.dispose()}},n)}convertTimelineItem(e,t,n){return(r,i)=>{let a;if(i?.cacheResults){let t=this._itemsBySourceAndUriMap.get(e);t===void 0&&(t=new Map,this._itemsBySourceAndUriMap.set(e,t));let n=iW(r);a=t.get(n),a===void 0&&(a=new Map,t.set(n,a))}return r=>{let{iconPath:i,...o}=r,s=`${e}|${r.id??r.timestamp}`;a?.set(s,r);let c,l,u;r.iconPath&&(i instanceof LS?u={id:i.id,color:i.color}:w.isUri(i)?(c=i,l=i):{light:c,dark:l}=i);let d;return Sx.isMarkdownString(o.tooltip)?d=jD.from(o.tooltip):Ze(o.tooltip)?d=o.tooltip:Sx.isMarkdownString(o.detail)?(console.warn(`Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip`),d=jD.from(o.detail)):Ze(o.detail)&&(console.warn(`Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip`),d=o.detail),{...o,id:o.id??void 0,handle:s,source:e,command:r.command?t.toInternal(r.command,n):void 0,icon:c,iconDark:l,themeIcon:u,tooltip:d,accessibilityInformation:r.accessibilityInformation}}}}registerTimelineProviderCore(e,t){let n=this._providers.get(e.id);if(n)throw Error(`Timeline Provider ${e.id} already exists.`);return this._proxy.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme}),this._providers.set(e.id,{provider:e,extension:t}),_(()=>{for(let t of this._itemsBySourceAndUriMap.values())t.get(e.id)?.clear();this._providers.delete(e.id),this._proxy.$unregisterTimelineProvider(e.id),e.dispose()})}};function iW(e){return e?.toString()}C(4105,`Views`),iI(`default-view-icon`,P.window,C(4106,`Default view icon.`));var aW;(function(e){e.ViewContainersRegistry=`workbench.registry.view.containers`,e.ViewsRegistry=`workbench.registry.view`})(aW||={});var oW;(function(e){e[e.Sidebar=0]=`Sidebar`,e[e.Panel=1]=`Panel`,e[e.AuxiliaryBar=2]=`AuxiliaryBar`})(oW||={}),oW.Sidebar,oW.Panel,oW.AuxiliaryBar;var sW=class extends y{constructor(){super(...arguments),this._onDidRegister=this._register(new x),this.onDidRegister=this._onDidRegister.event,this._onDidDeregister=this._register(new x),this.onDidDeregister=this._onDidDeregister.event,this.viewContainers=new Map,this.defaultViewContainers=[]}get all(){return[...this.viewContainers.values()].flat()}registerViewContainer(e,t,n){let r=this.get(e.id);if(r)return r;let i=e;i.openCommandActionDescriptor=n?.doNotRegisterOpenCommand?void 0:i.openCommandActionDescriptor??{id:i.id};let a=g(this.viewContainers,t,[]);return a.push(i),n?.isDefault&&this.defaultViewContainers.push(i),this._onDidRegister.fire({viewContainer:i,viewContainerLocation:t}),i}deregisterViewContainer(e){for(let t of this.viewContainers.keys()){let n=this.viewContainers.get(t),r=n?.indexOf(e);if(r!==-1){n?.splice(r,1),n.length===0&&this.viewContainers.delete(t),this._onDidDeregister.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.viewContainers.get(e)||[]]}getViewContainerLocation(e){return[...this.viewContainers.keys()].filter(t=>this.getViewContainers(t).filter(t=>t?.id===e.id).length>0)[0]}getDefaultViewContainer(e){return this.defaultViewContainers.find(t=>this.getViewContainerLocation(t)===e)}};Sm.add(aW.ViewContainersRegistry,new sW);var cW;(function(e){e.Open=`2_open`,e.Debug=`4_debug`,e.SCM=`5_scm`,e.More=`9_more`})(cW||={});function lW(e,t){let n=e.group??cW.More,r=t.group??cW.More;return n===r?(e.order??5)-(t.order??5):n.localeCompare(r)}var uW=class extends y{constructor(){super(...arguments),this._onViewsRegistered=this._register(new x),this.onViewsRegistered=this._onViewsRegistered.event,this._onViewsDeregistered=this._register(new x),this.onViewsDeregistered=this._onViewsDeregistered.event,this._onDidChangeContainer=this._register(new x),this.onDidChangeContainer=this._onDidChangeContainer.event,this._onDidChangeViewWelcomeContent=this._register(new x),this.onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event,this._viewContainers=[],this._views=new Map,this._viewWelcomeContents=new Ge}registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:e,viewContainer:t})=>this.addViews(e,t)),this._onViewsRegistered.fire(e)}deregisterViews(e,t){let n=this.removeViews(e,t);n.length&&this._onViewsDeregistered.fire({views:n,viewContainer:t})}moveViews(e,t){for(let n of this._views.keys())if(n!==t){let r=this.removeViews(e,n);r.length&&(this.addViews(r,t),this._onDidChangeContainer.fire({views:r,from:n,to:t}))}}getViews(e){return this._views.get(e)||[]}getView(e){for(let t of this._viewContainers){let n=(this._views.get(t)||[]).filter(t=>t.id===e)[0];if(n)return n}return null}getViewContainer(e){for(let t of this._viewContainers){let n=(this._views.get(t)||[]).filter(t=>t.id===e)[0];if(n)return t}return null}registerViewWelcomeContent(e,t){return this._viewWelcomeContents.add(e,t),this._onDidChangeViewWelcomeContent.fire(e),_(()=>{this._viewWelcomeContents.delete(e,t),this._onDidChangeViewWelcomeContent.fire(e)})}registerViewWelcomeContent2(e,t){let n=new Map;for(let[r,i]of t)this._viewWelcomeContents.add(e,i),n.set(r,_(()=>{this._viewWelcomeContents.delete(e,i),this._onDidChangeViewWelcomeContent.fire(e)}));return this._onDidChangeViewWelcomeContent.fire(e),n}getViewWelcomeContent(e){let t=[];return this._viewWelcomeContents.forEach(e,e=>t.push(e)),t.sort(lW)}addViews(e,t){let n=this._views.get(t);n||(n=[],this._views.set(t,n),this._viewContainers.push(t));for(let t of e){if(this.getView(t.id)!==null)throw Error(C(4107,`A view with id '{0}' is already registered`,t.id));n.push(t)}}removeViews(e,t){let n=this._views.get(t);if(!n)return[];let r=[],i=[];for(let t of n)e.includes(t)?r.push(t):i.push(t);return r.length&&(i.length?this._views.set(t,i):(this._views.delete(t),this._viewContainers.splice(this._viewContainers.indexOf(t),1))),r}};Sm.add(aW.ViewsRegistry,new uW);var dW;(function(e){e[e.Default=0]=`Default`,e[e.Expand=1]=`Expand`})(dW||={});var fW;(function(e){e[e.None=0]=`None`,e[e.Collapsed=1]=`Collapsed`,e[e.Expanded=2]=`Expanded`})(fW||={});var pW=class extends Error{constructor(e){super(C(4108,`No tree view with id '{0}' registered.`,e)),this.name=`NoTreeViewError`}static is(e){return!!e&&e.name===`NoTreeViewError`}},mW=class{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){let t=this._dragOperations.get(e);return this._dragOperations.delete(e),t}}addDragOperationTransfer(e,t){this._dragOperations.set(e,t)}};function hW(e,t){if(Ze(e))return{label:e};if(e&&typeof e==`object`&&typeof e.label==`string`){let t;return Array.isArray(e.highlights)&&(t=e.highlights.filter((e=>e.length===2&&typeof e[0]==`number`&&typeof e[1]==`number`)),t=t.length?t:void 0),{label:e.label,highlights:t}}}var gW=class extends y{constructor(e,t,n){super(),this._proxy=e,this._commands=t,this._logService=n,this._treeViews=new Map,this._treeDragAndDropService=new mW;function r(e){return e&&e.$treeViewId&&(e.$treeItemHandle||e.$selectedTreeItems||e.$focusedTreeItem)}t.registerArgumentProcessor({processArgument:e=>r(e)?this._convertArgument(e):Array.isArray(e)&&e.length>0?e.map(e=>r(e)?this._convertArgument(e):e):e})}registerTreeDataProvider(e,t,n){let r=this.createTreeView(e,{treeDataProvider:t},n);return{dispose:()=>r.dispose()}}createTreeView(e,t,n){if(!t||!t.treeDataProvider)throw Error(`Options with treeDataProvider is mandatory`);let r=t.dragAndDropController?.dropMimeTypes??[],i=t.dragAndDropController?.dragMimeTypes??[],a=!!t.dragAndDropController?.handleDrag,o=!!t.dragAndDropController?.handleDrop,s=this._createExtHostTreeView(e,t,n),c={showCollapseAll:!!t.showCollapseAll,canSelectMany:!!t.canSelectMany,dropMimeTypes:r,dragMimeTypes:i,hasHandleDrag:a,hasHandleDrop:o,manuallyManageCheckboxes:!!t.manageCheckboxStateManually},l=this._proxy.$registerTreeViewDataProvider(e,c),u={get onDidCollapseElement(){return s.onDidCollapseElement},get onDidExpandElement(){return s.onDidExpandElement},get selection(){return s.selectedElements},get onDidChangeSelection(){return s.onDidChangeSelection},get activeItem(){return U(n,`treeViewActiveItem`),s.focusedElement},get onDidChangeActiveItem(){return U(n,`treeViewActiveItem`),s.onDidChangeActiveItem},get visible(){return s.visible},get onDidChangeVisibility(){return s.onDidChangeVisibility},get onDidChangeCheckboxState(){return s.onDidChangeCheckboxState},get message(){return s.message},set message(e){vl(e)&&U(n,`treeViewMarkdownMessage`),s.message=e},get title(){return s.title},set title(e){s.title=e},get description(){return s.description},set description(e){s.description=e},get badge(){return s.badge},set badge(e){e!==void 0&&wS.isViewBadge(e)?s.badge={value:Math.floor(Math.abs(e.value)),tooltip:e.tooltip}:e===void 0&&(s.badge=void 0)},reveal:(e,t)=>s.reveal(e,t),dispose:async()=>{await l,this._treeViews.delete(e),s.dispose()}};return this._register(u),u}async $getChildren(e,t){let n=this._treeViews.get(e);if(!n)return Promise.reject(new pW(e));if(!t){let e=await n.getChildren();return e?[[0,...e]]:void 0}let r=[];for(let e=0;e<t.length;e++){let i=t[e],a=await n.getChildren(i);a&&r.push([e,...a])}return r}async $handleDrop(e,t,n,r,i,a,o,s){let c=this._treeViews.get(e);if(!c)return Promise.reject(new pW(e));let l=YO.toDataTransfer(n,async n=>(await this._proxy.$resolveDropFileData(e,t,n)).buffer);return o===e&&s&&await this._addAdditionalTransferItems(l,c,s,i,a),c.onDrop(l,r,i)}async _addAdditionalTransferItems(e,t,n,r,i){let a=this._treeDragAndDropService.removeDragOperationTransfer(i);if(a)(await a)?.forEach((t,n)=>{t&&e.set(n,t)});else if(i&&t.handleDrag){let a=t.handleDrag(n,e,r);this._treeDragAndDropService.addDragOperationTransfer(i,a),await a}return e}async $handleDrag(e,t,n,r){let i=this._treeViews.get(e);if(!i)return Promise.reject(new pW(e));let a=await this._addAdditionalTransferItems(new MS,i,t,r,n);if(!(!a||r.isCancellationRequested))return YO.from(a)}async $hasResolve(e){let t=this._treeViews.get(e);if(!t)throw new pW(e);return t.hasResolve}$resolve(e,t,n){let r=this._treeViews.get(e);if(!r)throw new pW(e);return r.resolveTreeItem(t,n)}$setExpanded(e,t,n){let r=this._treeViews.get(e);if(!r)throw new pW(e);r.setExpanded(t,n)}$setSelectionAndFocus(e,t,n){let r=this._treeViews.get(e);if(!r)throw new pW(e);r.setSelectionAndFocus(t,n)}$setVisible(e,t){let n=this._treeViews.get(e);if(!n){if(!t)return;throw new pW(e)}n.setVisible(t)}$changeCheckboxState(e,t){let n=this._treeViews.get(e);if(!n)throw new pW(e);n.setCheckboxState(t)}_createExtHostTreeView(e,t,n){let r=this._register(new _W(e,t,this._proxy,this._commands.converter,this._logService,n));return this._treeViews.set(e,r),r}_convertArgument(e){let t=this._treeViews.get(e.$treeViewId),n=e;if(t&&n.$treeItemHandle)return t.getExtensionElement(n.$treeItemHandle);let r=e;return t&&r.$focusedTreeItem?t.focusedElement:null}},_W=class e extends y{static{this.LABEL_HANDLE_PREFIX=`0`}static{this.ID_HANDLE_PREFIX=`1`}get visible(){return this._visible}get selectedElements(){return this._selectedHandles.map(e=>this.getExtensionElement(e)).filter(e=>!at(e))}get focusedElement(){return this._focusedHandle?this.getExtensionElement(this._focusedHandle):void 0}constructor(e,t,n,r,i,a){if(super(),this._viewId=e,this._proxy=n,this._commands=r,this._logService=i,this._extension=a,this._roots=void 0,this._elements=new Map,this._nodes=new Map,this._visible=!1,this._selectedHandles=[],this._focusedHandle=void 0,this._onDidExpandElement=this._register(new x),this.onDidExpandElement=this._onDidExpandElement.event,this._onDidCollapseElement=this._register(new x),this.onDidCollapseElement=this._onDidCollapseElement.event,this._onDidChangeSelection=this._register(new x),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeActiveItem=this._register(new x),this.onDidChangeActiveItem=this._onDidChangeActiveItem.event,this._onDidChangeVisibility=this._register(new x),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDidChangeCheckboxState=this._register(new x),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidChangeData=this._register(new x),this._refreshPromise=Promise.resolve(),this._refreshQueue=Promise.resolve(),this._nodesToClear=new Set,this._message=``,this._title=``,this._refreshCancellationSource=new Ai,a.contributes&&a.contributes.views)for(let t in a.contributes.views)for(let n of a.contributes.views[t])n.id===e&&(this._title=n.name);this._dataProvider=t.treeDataProvider,this._dndController=t.dragAndDropController,this._dataProvider.onDidChangeTreeData&&this._register(this._dataProvider.onDidChangeTreeData(e=>{Array.isArray(e)&&e.length===0||this._onDidChangeData.fire({message:!1,element:e})}));let o,s,c=en.debounce(this._onDidChangeData.event,(e,t)=>(e||={message:!1,elements:[]},t.element!==!1&&(o||(o=new Promise(e=>s=e),this._refreshPromise=this._refreshPromise.then(()=>o)),Array.isArray(t.element)?e.elements.push(...t.element):e.elements.push(t.element)),t.message&&(e.message=!0),e),200,!0);this._register(c(({message:e,elements:t})=>{t.length&&(this._refreshQueue=this._refreshQueue.then(()=>{let e=s;o=null;let n=Array.from(this._nodesToClear);return this._refresh(t).then(()=>(this._clearNodes(n),e()))})),e&&this._proxy.$setMessage(this._viewId,jD.fromStrict(this._message)??``)}))}async getChildren(e){let t=e?this.getExtensionElement(e):void 0;if(e&&!t)return this._logService.error(`No tree item with id \'${e}\' found.`),Promise.resolve([]);let n=this._getChildrenNodes(e);return n||=await this._fetchChildrenNodes(t),n?n.map(e=>e.item):void 0}getExtensionElement(e){return this._elements.get(e)}reveal(e,t){t||={select:!0,focus:!1};let n=at(t.select)?!0:t.select,r=at(t.focus)?!1:t.focus,i=at(t.expand)?!1:t.expand;return typeof this._dataProvider.getParent==`function`?e?this._refreshPromise.then(()=>this._resolveUnknownParentChain(e)).then(t=>this._resolveTreeNode(e,t[t.length-1]).then(e=>this._proxy.$reveal(this._viewId,{item:e.item,parentChain:t.map(e=>e.item)},{select:n,focus:r,expand:i})),e=>this._logService.error(e)):this._proxy.$reveal(this._viewId,void 0,{select:n,focus:r,expand:i}):Promise.reject(Error(`Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method`))}get message(){return this._message}set message(e){this._message=e,this._onDidChangeData.fire({message:!0,element:!1})}get title(){return this._title}set title(e){this._title=e,this._proxy.$setTitle(this._viewId,e,this._description)}get description(){return this._description}set description(e){this._description=e,this._proxy.$setTitle(this._viewId,this._title,e)}get badge(){return this._badge}set badge(e){this._badge?.value===e?.value&&this._badge?.tooltip===e?.tooltip||(this._badge=qO.from(e),this._proxy.$setBadge(this._viewId,e))}setExpanded(e,t){let n=this.getExtensionElement(e);n&&(t?this._onDidExpandElement.fire(Object.freeze({element:n})):this._onDidCollapseElement.fire(Object.freeze({element:n})))}setSelectionAndFocus(e,t){let n=!ge(this._selectedHandles,e);this._selectedHandles=e;let r=this._focusedHandle!==t;this._focusedHandle=t,n&&this._onDidChangeSelection.fire(Object.freeze({selection:this.selectedElements})),r&&this._onDidChangeActiveItem.fire(Object.freeze({activeItem:this.focusedElement}))}setVisible(e){e!==this._visible&&(this._visible=e,this._onDidChangeVisibility.fire(Object.freeze({visible:this._visible})))}async setCheckboxState(e){let t=(await Promise.all(e.map(async e=>{let t=this.getExtensionElement(e.treeItemHandle);return t?{extensionItem:t,treeItem:await this._dataProvider.getTreeItem(t),newState:e.newState?DS.Checked:DS.Unchecked}:Promise.resolve(void 0)}))).filter(e=>e!==void 0);t.forEach(e=>{e.treeItem.checkboxState=e.newState?DS.Checked:DS.Unchecked}),this._onDidChangeCheckboxState.fire({items:t.map(e=>[e.extensionItem,e.newState])})}async handleDrag(e,t,n){let r=[];for(let t of e){let e=this.getExtensionElement(t);e&&r.push(e)}if(!(!this._dndController?.handleDrag||r.length===0))return await this._dndController.handleDrag(r,t,n),t}get hasHandleDrag(){return!!this._dndController?.handleDrag}async onDrop(e,t,n){let r=t?this.getExtensionElement(t):void 0;if(!(!r&&t||!this._dndController?.handleDrop))return uo(()=>this._dndController?.handleDrop?this._dndController.handleDrop(r,e,n):void 0)}get hasResolve(){return!!this._dataProvider.resolveTreeItem}async resolveTreeItem(e,t){if(!this._dataProvider.resolveTreeItem)return;let n=this._elements.get(e);if(n){let e=this._nodes.get(n);if(e){let r=await this._dataProvider.resolveTreeItem(e.extensionItem,n,t)??e.extensionItem;return this._validateTreeItem(r),e.item.tooltip=this._getTooltip(r.tooltip),e.item.command=this._getCommand(e.disposableStore,r.command),e.item}}}_resolveUnknownParentChain(e){return this._resolveParent(e).then(e=>e?this._resolveUnknownParentChain(e).then(t=>this._resolveTreeNode(e,t[t.length-1]).then(e=>(t.push(e),t))):Promise.resolve([]))}_resolveParent(e){let t=this._nodes.get(e);return t?Promise.resolve(t.parent?this._elements.get(t.parent.item.handle):void 0):uo(()=>this._dataProvider.getParent(e))}_resolveTreeNode(e,t){let n=this._nodes.get(e);return n?Promise.resolve(n):uo(()=>this._dataProvider.getTreeItem(e)).then(n=>this._createHandle(e,n,t,!0)).then(e=>this.getChildren(t?t.item.handle:void 0).then(()=>{let t=this.getExtensionElement(e);if(t){let e=this._nodes.get(t);if(e)return Promise.resolve(e)}throw Error(`Cannot resolve tree item for element ${e} from extension ${this._extension.identifier.value}`)}))}_getChildrenNodes(e){if(e){let t;if(typeof e==`string`){let n=this.getExtensionElement(e);t=n?this._nodes.get(n):void 0}else t=e;return t&&t.children||void 0}return this._roots}async _fetchChildrenNodes(e){this._addChildrenToClear(e);let t=new Ai(this._refreshCancellationSource.token);try{let n=e?this._nodes.get(e):void 0,r=await this._dataProvider.getChildren(e);if(t.token.isCancellationRequested)return;let i=be(r||[]),a=await Promise.all(be(i).map(e=>this._dataProvider.getTreeItem(e)));if(t.token.isCancellationRequested)return;let o=a.map((e,t)=>e?this._createAndRegisterTreeNode(i[t],e,n):null);return be(o)}finally{t.dispose()}}_refresh(e){let t=e.some(e=>!e);if(t)return this._refreshCancellationSource.dispose(!0),this._refreshCancellationSource=new Ai,this._addChildrenToClear(),this._proxy.$refresh(this._viewId);{let t=this._getHandlesToRefresh(e);if(t.length)return this._refreshHandles(t)}return Promise.resolve(void 0)}_getHandlesToRefresh(e){let t=new Set,n=e.map(e=>this._nodes.get(e));for(let e of n)if(e&&!t.has(e.item.handle)){let r=e;for(;r&&r.parent&&n.findIndex(e=>r&&r.parent&&e&&e.item.handle===r.parent.item.handle)===-1;){let e=this._elements.get(r.parent.item.handle);r=e?this._nodes.get(e):void 0}r&&!r.parent&&t.add(e.item.handle)}let r=[];return t.forEach(e=>{let n=this._elements.get(e);if(n){let i=this._nodes.get(n);i&&(!i.parent||!t.has(i.parent.item.handle))&&r.push(e)}}),r}_refreshHandles(e){let t={};return Promise.all(e.map(e=>this._refreshNode(e).then(n=>{n&&(t[e]=n.item)}))).then(()=>Object.keys(t).length?this._proxy.$refresh(this._viewId,t):void 0)}_refreshNode(e){let t=this.getExtensionElement(e);if(t){let e=this._nodes.get(t);if(e)return this._addChildrenToClear(t),uo(()=>this._dataProvider.getTreeItem(t)).then(n=>{if(n){let r=this._createTreeNode(t,n,e.parent);return this._updateNodeCache(t,r,e,e.parent),e.dispose(),r}return null})}return Promise.resolve(null)}_createAndRegisterTreeNode(e,t,n){let r=this._createTreeNode(e,t,n);if(t.id&&this._elements.has(r.item.handle))throw Error(C(2637,`Element with id {0} is already registered`,t.id));return this._addNodeToCache(e,r),this._addNodeToParentCache(r,n),r}_getTooltip(e){return Sx.isMarkdownString(e)?jD.from(e):e}_getCommand(e,t){return t?{...this._commands.toInternal(t,e),originalId:t.command}:void 0}_getCheckbox(e){if(e.checkboxState===void 0)return;let t,n,r;return typeof e.checkboxState==`number`?t=e.checkboxState:(t=e.checkboxState.state,n=e.checkboxState.tooltip,r=e.checkboxState.accessibilityInformation),{isChecked:t===DS.Checked,tooltip:n,accessibilityInformation:r}}_validateTreeItem(e){if(!TS.isTreeItem(e,this._extension))throw Error(`Extension ${this._extension.identifier.value} has provided an invalid tree item.`)}_createTreeNode(e,t,n){this._validateTreeItem(t);let r=this._register(new v),i=this._createHandle(e,t,n),a=this._getLightIconPath(t),o={handle:i,parentHandle:n?n.item.handle:void 0,label:hW(t.label),description:t.description,resourceUri:t.resourceUri,tooltip:this._getTooltip(t.tooltip),command:this._getCommand(r,t.command),contextValue:t.contextValue,icon:a,iconDark:this._getDarkIconPath(t)||a,themeIcon:this._getThemeIcon(t),collapsibleState:at(t.collapsibleState)?ES.None:t.collapsibleState,accessibilityInformation:t.accessibilityInformation,checkbox:this._getCheckbox(t)};return{item:o,extensionItem:t,parent:n,children:void 0,disposableStore:r,dispose(){r.dispose()}}}_getThemeIcon(e){return e.iconPath instanceof LS?e.iconPath:void 0}_createHandle(t,{id:n,label:r,resourceUri:i},a,o){if(n)return`${e.ID_HANDLE_PREFIX}/${n}`;let s=hW(r),c=a?a.item.handle:e.LABEL_HANDLE_PREFIX,l=s?s.label:i?Xa(i):``;l=l.indexOf(`/`)===-1?l:l.replace(`/`,`//`);let u=this._nodes.has(t)?this._nodes.get(t).item.handle:void 0,d=this._getChildrenNodes(a)||[],f,p=0;do{if(f=`${c}/${p}:${l}`,o||!this._elements.has(f)||u===f)break;p++}while(p<=d.length);return f}_getLightIconPath(e){if(e.iconPath&&!(e.iconPath instanceof LS))return typeof e.iconPath==`string`||w.isUri(e.iconPath)?this._getIconPath(e.iconPath):this._getIconPath(e.iconPath.light)}_getDarkIconPath(e){if(e.iconPath&&!(e.iconPath instanceof LS)&&e.iconPath.dark)return this._getIconPath(e.iconPath.dark)}_getIconPath(e){return w.isUri(e)?e:w.file(e)}_addNodeToCache(e,t){this._elements.set(t.item.handle,e),this._nodes.set(e,t)}_updateNodeCache(e,t,n,r){this._elements.delete(t.item.handle),this._nodes.delete(e),t.item.handle!==n.item.handle&&this._elements.delete(n.item.handle),this._addNodeToCache(e,t);let i=this._getChildrenNodes(r)||[],a=i.filter(e=>e.item.handle===n.item.handle)[0];a&&i.splice(i.indexOf(a),1,t)}_addNodeToParentCache(e,t){t?(t.children||=[],t.children.push(e)):(this._roots||=[],this._roots.push(e))}_addChildrenToClear(e){if(e){let t=this._nodes.get(e);if(t){if(t.children)for(let e of t.children){this._nodesToClear.add(e);let t=this._elements.get(e.item.handle);t&&(this._addChildrenToClear(t),this._nodes.delete(t),this._elements.delete(e.item.handle))}t.children=void 0}}else this._addAllToClear()}_addAllToClear(){this._roots=void 0,this._nodes.forEach(e=>{this._nodesToClear.add(e)}),this._nodes.clear(),this._elements.clear()}_clearNodes(e){yt(e)}_clearAll(){this._roots=void 0,this._elements.clear(),yt(this._nodes.values()),this._nodes.clear(),yt(this._nodesToClear),this._nodesToClear.clear()}dispose(){super.dispose(),this._refreshCancellationSource.dispose(),this._clearAll(),this._proxy.$disposeTree(this._viewId)}},vW=class e{static{this.supportedSchemes=new Set([O.http,O.https])}constructor(e){this._openers=new Map,this._proxy=e.getProxy(E.MainThreadUriOpeners)}registerExternalUriOpener(t,n,r,i){if(this._openers.has(n))throw Error(`Opener with id '${n}' already registered`);let a=i.schemes.find(t=>!e.supportedSchemes.has(t));if(a)throw Error(`Scheme '${a}' is not supported. Only http and https are currently supported.`);return this._openers.set(n,r),this._proxy.$registerUriOpener(n,i.schemes,t,i.label),_(()=>{this._openers.delete(n),this._proxy.$unregisterUriOpener(n)})}async $canOpenUri(e,t,n){let r=this._openers.get(e);if(!r)throw Error(`Unknown opener with id: ${e}`);let i=w.revive(t);return r.canOpenExternalUri(i,n)}async $openUri(e,t,n){let r=this._openers.get(e);if(!r)throw Error(`Unknown opener id: '${e}'`);return r.openExternalUri(w.revive(t.resolvedUri),{sourceUri:w.revive(t.sourceUri)},n)}},yW=class extends y{#handle;#proxy;#viewType;#webview;#options;#title;#iconPath;#viewColumn;#visible;#active;#isDisposed;#onDidDispose;#onDidChangeViewState;constructor(e,t,n,r){super(),this.#viewColumn=void 0,this.#visible=!0,this.#isDisposed=!1,this.#onDidDispose=this._register(new x),this.onDidDispose=this.#onDidDispose.event,this.#onDidChangeViewState=this._register(new x),this.onDidChangeViewState=this.#onDidChangeViewState.event,this.#handle=e,this.#proxy=t,this.#webview=n,this.#viewType=r.viewType,this.#options=r.panelOptions,this.#viewColumn=r.viewColumn,this.#title=r.title,this.#active=r.active}dispose(){this.#isDisposed||(this.#isDisposed=!0,this.#onDidDispose.fire(),this.#proxy.$disposeWebview(this.#handle),this.#webview.dispose(),super.dispose())}get webview(){return this.assertNotDisposed(),this.#webview}get viewType(){return this.assertNotDisposed(),this.#viewType}get title(){return this.assertNotDisposed(),this.#title}set title(e){this.assertNotDisposed(),this.#title!==e&&(this.#title=e,this.#proxy.$setTitle(this.#handle,e))}get iconPath(){return this.assertNotDisposed(),this.#iconPath}set iconPath(e){this.assertNotDisposed(),this.#iconPath!==e&&(this.#iconPath=e,this.#proxy.$setIconPath(this.#handle,w.isUri(e)?{light:e,dark:e}:e))}get options(){return this.#options}get viewColumn(){if(this.assertNotDisposed(),!(typeof this.#viewColumn==`number`&&this.#viewColumn<0))return this.#viewColumn}get active(){return this.assertNotDisposed(),this.#active}get visible(){return this.assertNotDisposed(),this.#visible}_updateViewState(e){this.#isDisposed||(this.active!==e.active||this.visible!==e.visible||this.viewColumn!==e.viewColumn)&&(this.#active=e.active,this.#visible=e.visible,this.#viewColumn=e.viewColumn,this.#onDidChangeViewState.fire({webviewPanel:this}))}reveal(e,t){this.assertNotDisposed(),this.#proxy.$reveal(this.#handle,{viewColumn:e===void 0?void 0:OD.from(e),preserveFocus:!!t})}assertNotDisposed(){if(this.#isDisposed)throw Error(`Webview is disposed`)}},bW=class e extends y{static newHandle(){return Nc()}constructor(e,t,n){super(),this.webviews=t,this.workspace=n,this._webviewPanels=new Map,this._serializers=new Map,this._proxy=e.getProxy(E.MainThreadWebviewPanels)}dispose(){super.dispose(),this._webviewPanels.forEach(e=>e.dispose()),this._webviewPanels.clear()}createWebviewPanel(t,n,r,i,a={}){let o=typeof i==`object`?i.viewColumn:i,s={viewColumn:OD.from(o),preserveFocus:typeof i==`object`&&!!i.preserveFocus},c=kz(t),l=e.newHandle();this._proxy.$createWebviewPanel(Mz(t),l,n,{title:r,panelOptions:xW(a),webviewOptions:Nz(t,this.workspace,a),serializeBuffersForPostMessage:c},s);let u=this.webviews.createNewWebview(l,a,t),d=this.createNewWebviewPanel(l,n,r,o,a,u,!0);return d}$onDidChangeWebviewPanelViewStates(e){let t=Object.keys(e);t.sort((t,n)=>{let r=e[t],i=e[n];return r.active?1:i.active?-1:r.visible-+i.visible});for(let n of t){let t=this.getWebviewPanel(n);if(!t)continue;let r=e[n];t._updateViewState({active:r.active,visible:r.visible,viewColumn:OD.to(r.position)})}}async $onDidDisposeWebviewPanel(e){let t=this.getWebviewPanel(e);t?.dispose(),this._webviewPanels.delete(e),this.webviews.deleteWebview(e)}registerWebviewPanelSerializer(e,t,n){if(this._serializers.has(t))throw Error(`Serializer for '${t}' already registered`);return this._serializers.set(t,{serializer:n,extension:e}),this._proxy.$registerSerializer(t,{serializeBuffersForPostMessage:kz(e)}),new Pb(()=>{this._serializers.delete(t),this._proxy.$unregisterSerializer(t)})}async $deserializeWebviewPanel(e,t,n,r){let i=this._serializers.get(t);if(!i)throw Error(`No serializer found for '${t}'`);let{serializer:a,extension:o}=i,s=this.webviews.createNewWebview(e,n.webviewOptions,o),c=this.createNewWebviewPanel(e,t,n.title,r,n.panelOptions,s,n.active);await a.deserializeWebviewPanel(c,n.state)}createNewWebviewPanel(e,t,n,r,i,a,o){let s=new yW(e,this._proxy,a,{viewType:t,title:n,viewColumn:r,panelOptions:i,active:o});return this._webviewPanels.set(e,s),s}getWebviewPanel(e){return this._webviewPanels.get(e)}};function xW(e){return{enableFindWidget:e.enableFindWidget,retainContextWhenHidden:e.retainContextWhenHidden}}var SW=class extends y{#handle;#proxy;#viewType;#webview;#isDisposed;#isVisible;#title;#description;#badge;constructor(e,t,n,r,i,a){super(),this.#isDisposed=!1,this.#onDidChangeVisibility=this._register(new x),this.onDidChangeVisibility=this.#onDidChangeVisibility.event,this.#onDidDispose=this._register(new x),this.onDidDispose=this.#onDidDispose.event,this.#viewType=n,this.#title=r,this.#handle=e,this.#proxy=t,this.#webview=i,this.#isVisible=a}dispose(){this.#isDisposed||(this.#isDisposed=!0,this.#onDidDispose.fire(),this.#webview.dispose(),super.dispose())}#onDidChangeVisibility;#onDidDispose;get title(){return this.assertNotDisposed(),this.#title}set title(e){this.assertNotDisposed(),this.#title!==e&&(this.#title=e,this.#proxy.$setWebviewViewTitle(this.#handle,e))}get description(){return this.assertNotDisposed(),this.#description}set description(e){this.assertNotDisposed(),this.#description!==e&&(this.#description=e,this.#proxy.$setWebviewViewDescription(this.#handle,e))}get visible(){return this.#isVisible}get webview(){return this.#webview}get viewType(){return this.#viewType}_setVisible(e){e===this.#isVisible||this.#isDisposed||(this.#isVisible=e,this.#onDidChangeVisibility.fire())}get badge(){return this.assertNotDisposed(),this.#badge}set badge(e){this.assertNotDisposed(),!(e?.value===this.#badge?.value&&e?.tooltip===this.#badge?.tooltip)&&(this.#badge=qO.from(e),this.#proxy.$setWebviewViewBadge(this.#handle,e))}show(e){this.assertNotDisposed(),this.#proxy.$show(this.#handle,!!e)}assertNotDisposed(){if(this.#isDisposed)throw Error(`Webview is disposed`)}},CW=class{constructor(e,t){this._extHostWebview=t,this._viewProviders=new Map,this._webviewViews=new Map,this._proxy=e.getProxy(E.MainThreadWebviewViews)}registerWebviewViewProvider(e,t,n,r){if(this._viewProviders.has(t))throw Error(`View provider for '${t}' already registered`);return this._viewProviders.set(t,{provider:n,extension:e}),this._proxy.$registerWebviewViewProvider(Mz(e),t,{retainContextWhenHidden:r?.retainContextWhenHidden,serializeBuffersForPostMessage:kz(e)}),new Pb(()=>{this._viewProviders.delete(t),this._proxy.$unregisterWebviewViewProvider(t)})}async $resolveWebviewView(e,t,n,r,i){let a=this._viewProviders.get(t);if(!a)throw Error(`No view provider found for '${t}'`);let{provider:o,extension:s}=a,c=this._extHostWebview.createNewWebview(e,{},s),l=new SW(e,this._proxy,t,n,c,!0);this._webviewViews.set(e,l),await o.resolveWebviewView(l,{state:r},i)}async $onDidChangeWebviewViewVisibility(e,t){let n=this.getWebviewView(e);n._setVisible(t)}async $disposeWebviewView(e){let t=this.getWebviewView(e);this._webviewViews.delete(e),t.dispose(),this._extHostWebview.deleteWebview(e)}getWebviewView(e){let t=this._webviewViews.get(e);if(!t)throw Error(`No webview found`);return t}},wW=class{constructor(e){this._settingsSearchProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(E.MainThreadAiSettingsSearch)}async $startSearch(e,t,n,r){if(this._settingsSearchProviders.size===0)throw Error(`No related information providers registered`);let i=this._settingsSearchProviders.get(e);if(!i)throw Error(`Settings search provider not found`);let a=new ym(t=>{this._proxy.$handleSearchResult(e,Wk.fromSettingsSearchResult(t))});return i.provideSettingsSearchResults(t,n,a,r)}registerSettingsSearchProvider(e,t){let n=this._nextHandle;return this._nextHandle++,this._settingsSearchProviders.set(n,t),this._proxy.$registerAiSettingsSearchProvider(n),new Pb(()=>{this._proxy.$unregisterAiSettingsSearchProvider(n),this._settingsSearchProviders.delete(n)})}},TW,EW=class{constructor(e,t,n,r,i,a){this.session=e,this.extension=t,this.proxy=r,this.commandsConverter=i,this.sessionDisposables=a,this._stream=new $R(t,n,r,i,a)}get activeResponseStream(){return this._stream}getActiveRequestStream(e){return new $R(this.extension,e,this.proxy,this.commandsConverter,this.sessionDisposables)}};let DW=class extends y{static{TW=this}static{this._sessionHandlePool=0}constructor(e,t,n,r){super(),this.commands=e,this._languageModels=t,this._extHostRpc=n,this._logService=r,this._chatSessionItemProviders=new Map,this._chatSessionContentProviders=new Map,this._nextChatSessionItemProviderHandle=0,this._nextChatSessionContentProviderHandle=0,this._sessionMap=new Map,this._extHostChatSessions=new Map,this._proxy=this._extHostRpc.getProxy(E.MainThreadChatSessions),e.registerArgumentProcessor({processArgument:e=>{if(e&&e.$mid===Dn.ChatSessionContext){let t=e.id,n=this._sessionMap.get(t);return n||(this._logService.warn(`No chat session found for ID: ${t}`),e)}return e}})}registerChatSessionItemProvider(e,t,n){let r=this._nextChatSessionItemProviderHandle++,i=new v;return this._chatSessionItemProviders.set(r,{provider:n,extension:e,disposable:i}),this._proxy.$registerChatSessionItemProvider(r,t),n.onDidChangeChatSessionItems&&i.add(n.onDidChangeChatSessionItems(()=>{this._proxy.$onDidChangeChatSessionItems(t)})),{dispose:()=>{this._chatSessionItemProviders.delete(r),i.dispose(),this._proxy.$unregisterChatSessionItemProvider(r)}}}registerChatSessionContentProvider(e,t,n){let r=this._nextChatSessionContentProviderHandle++,i=new v;return this._chatSessionContentProviders.set(r,{provider:n,extension:e,disposable:i}),this._proxy.$registerChatSessionContentProvider(r,t),new Pb(()=>{this._chatSessionContentProviders.delete(r),i.dispose(),this._proxy.$unregisterChatSessionContentProvider(r)})}async showChatSession(e,t,n,r){await this._proxy.$showChatSession(t,n,OD.from(r?.viewColumn))}async $provideChatSessionItems(e,t){let n=this._chatSessionItemProviders.get(e);if(!n)return this._logService.error(`No provider registered for handle ${e}`),[];let r=await n.provider.provideChatSessionItems(t);if(!r)return[];let i=[];for(let e of r)e.id&&(this._sessionMap.set(e.id,e),i.push({id:e.id,label:e.label,iconPath:e.iconPath}));return i}async $provideChatSessionContent(e,t,n){let r=this._chatSessionContentProviders.get(e);if(!r)throw Error(`No provider for handle ${e}`);let i=await r.provider.provideChatSessionContent(t,n),a=new v,o=TW._sessionHandlePool++,s=new EW(i,r.extension,{sessionId:`${t}.${o}`,requestId:`ongoing`,agentId:t,message:``,variables:{variables:[]},location:R_.Panel},{$handleProgressChunk:(n,r)=>this._proxy.$handleProgressChunk(e,t,n,r),$handleAnchorResolve:(n,r,i)=>{this._proxy.$handleAnchorResolve(e,t,n,r,i)}},this.commands.converter,a),c=a.add(new Ai);return this._extHostChatSessions.set(`${e}_${t}`,{sessionObj:s,disposeCts:c}),i.activeResponseCallback&&Promise.resolve(i.activeResponseCallback(s.activeResponseStream.apiObject,c.token)).finally(()=>{this._proxy.$handleProgressComplete(e,t,`ongoing`)}),{id:o+``,hasActiveResponseCallback:!!i.activeResponseCallback,hasRequestHandler:!!i.requestHandler,history:i.history.map(e=>{if(e instanceof aT)return{type:`request`,prompt:e.prompt};{let t=e,n=be(t.response.map(e=>Ck.from(e,this.commands.converter,a)));return{type:`response`,parts:n}}})}}async $interruptChatSessionActiveResponse(e,t,n){let r=`${e}_${t}`,i=this._extHostChatSessions.get(r);i?.disposeCts.cancel()}async $disposeChatSessionContent(e,t){let n=`${e}_${t}`,r=this._extHostChatSessions.get(n);if(!r){this._logService.warn(`No chat session found for ID: ${n}`);return}r.disposeCts.cancel(),r.sessionObj.sessionDisposables.dispose(),this._extHostChatSessions.delete(n)}async $invokeChatSessionRequestHandler(e,t,n,r,i){let a=this._extHostChatSessions.get(`${e}_${t}`);if(!a||!a.sessionObj.session.requestHandler)return{};let o=wk.to(n,void 0,await this.getModelForRequest(n,a.sessionObj.extension),[],new Map,a.sessionObj.extension,this._logService),s=a.sessionObj.getActiveRequestStream(n);return await a.sessionObj.session.requestHandler(o,{history:r},s.apiObject,i),{}}async getModelForRequest(e,t){let n;if(e.userSelectedModelId&&(n=await this._languageModels.getLanguageModelByIdentifier(t,e.userSelectedModelId)),!n&&(n=await this._languageModels.getDefaultLanguageModel(t),!n))throw Error(`Language model unavailable`);return n}};DW=TW=A([j(2,Is),j(3,xs)],DW);var OW=class{constructor(e,t){this.webviews=t,this._renderers=new Map,this._proxy=e.getProxy(E.MainThreadChatOutputRenderer)}registerChatOutputRenderer(e,t,n){if(this._renderers.has(t))throw Error(`Chat output renderer already registered for: ${t}`);return this._renderers.set(t,{extension:e,renderer:n}),this._proxy.$registerChatOutputRenderer(t,e.identifier,e.extensionLocation),new Pb(()=>{this._renderers.delete(t),this._proxy.$unregisterChatOutputRenderer(t)})}async $renderChatOutput(e,t,n,r,i){let a=this._renderers.get(e);if(!a)throw Error(`No chat output renderer registered for: ${e}`);let o=this.webviews.createNewWebview(r,{},a.extension);return a.renderer.renderChatOutput(Object.freeze({mime:t,value:n.buffer}),o,{},i)}};function kW(e){let t=e.get(ks),n=e.get(Mc),r=e.get(Xj),i=e.get(qP),a=e.get(nj),o=e.get(ZM),s=e.get(kj),c=e.get(Rs),l=e.get(Is),u=e.get(Gj),d=e.get(Zj),f=e.get(Ss),p=e.get(xs),ee=e.get(fM),m=e.get(QP),ne=e.get(PN),re=e.get(LN),ie=e.get(NP),ae=e.get(iL),se=e.get(LP),ce=e.get(VN),h=e.get(GN),le=e.get(QN),de=e.get(bR),fe=e.get(ER);l.set(D.ExtHostFileSystemInfo,n),l.set(D.ExtHostLogLevelServiceShape,f),l.set(D.ExtHostWorkspace,a),l.set(D.ExtHostConfiguration,s),l.set(D.ExtHostExtensionService,i),l.set(D.ExtHostStorage,u),l.set(D.ExtHostTunnelService,ee),l.set(D.ExtHostWindow,ne),l.set(D.ExtHostUrls,re),l.set(D.ExtHostSecretState,ie),l.set(D.ExtHostTelemetry,o),l.set(D.ExtHostEditorTabs,ae),l.set(D.ExtHostManagedSockets,se),l.set(D.ExtHostProgress,ce),l.set(D.ExtHostAuthentication,h),l.set(D.ExtHostChatProvider,le),l.set(D.ExtHostDataChannels,fe);let pe=l.set(D.ExtHostDecorations,e.get(kF)),me=l.set(D.ExtHostDocumentsAndEditors,e.get(GF)),he=l.set(D.ExtHostCommands,e.get($M)),ge=l.set(D.ExtHostTerminalService,e.get(rN)),_e=l.set(D.ExtHostTerminalShellIntegration,e.get(dR)),ve=l.set(D.ExtHostDebugService,e.get(IL)),ye=l.set(D.ExtHostSearch,e.get(sR)),be=l.set(D.ExtHostTask,e.get(JI)),xe=l.set(D.ExtHostOutputService,e.get(EF)),Se=l.set(D.ExtHostLocalization,e.get(IP)),Ce=l.set(D.ExtHostDocuments,new Qz(l,me)),we=l.set(D.ExtHostDocumentContentProviders,new Xz(l,me,p)),Te=l.set(D.ExtHostDocumentSaveParticipant,new Zz(p,Ce,l.getProxy(E.MainThreadBulkEdits))),Ee=l.set(D.ExtHostNotebook,new dU(l,he,me,Ce,r,ye,p)),De=l.set(D.ExtHostNotebookDocuments,new pU(Ee)),Oe=l.set(D.ExtHostNotebookEditors,new mU(p,Ee)),ke=l.set(D.ExtHostNotebookKernels,new _U(l,t,Ee,he,p)),Ae=l.set(D.ExtHostNotebookRenderers,new TU(l,Ee)),je=l.set(D.ExtHostNotebookDocumentSaveParticipant,new fU(p,Ee,l.getProxy(E.MainThreadBulkEdits))),Me=l.set(D.ExtHostEditors,new tW(l,me)),Ne=l.set(D.ExtHostTreeViews,new gW(l.getProxy(E.MainThreadTreeViews),he,p)),Pe=l.set(D.ExtHostEditorInsets,new pz(l.getProxy(E.MainThreadEditorInsets),Me,t.remote)),Fe=l.set(D.ExtHostDiagnostics,new Jz(l,p,n,me)),Ie=l.set(D.ExtHostLanguages,new aH(l,Ce,he.converter,c)),g=l.set(D.ExtHostLanguageFeatures,new rV(l,c,Ce,he,Fe,p,m,o)),Le=l.set(D.ExtHostCodeMapper,new mz(l)),Re=l.set(D.ExtHostFileSystem,new uB(l,g)),ze=l.set(D.ExtHostFileSystemEventService,new mB(l,p,me)),Be=l.set(D.ExtHostQuickOpen,OU(l,a,he)),Ve=l.set(D.ExtHostSCM,new YU(l,he,Ce,p)),He=l.set(D.ExtHostQuickDiff,new DU(l,c)),Ue=l.set(D.ExtHostShare,new XU(l,c)),We=l.set(D.ExtHostComments,hz(l,he,Ce)),Ge=l.set(D.ExtHostLabelService,new gB(l)),Ke=l.set(D.ExtHostTheming,new nW(l)),qe=l.set(D.ExtHostTimeline,new rW(l,he)),Je=l.set(D.ExtHostWebviews,new jz(l,t.remote,a,p,m)),Ye=l.set(D.ExtHostWebviewPanels,new bW(l,Je,a)),Xe=l.set(D.ExtHostCustomEditors,new Vz(l,Ce,d,Je,Ye)),Ze=l.set(D.ExtHostWebviewViews,new CW(l,Je)),Qe=l.set(D.ExtHostTesting,e.get(hL)),$e=l.set(D.ExtHostUriOpeners,new vW(l)),et=l.set(D.ExtHostProfileContentHandlers,new EU(l)),tt=l.set(D.ExtHostChatOutputRenderer,new OW(l,Je));l.set(D.ExtHostInteractive,new hB(l,Ee,me,he,p));let nt=l.set(D.ExtHostLanguageModelTools,new iH(l,le)),rt=l.set(D.ExtHostChatAgents2,new ez(l,p,he,Ce,le,Fe,nt)),it=l.set(D.ExtHostAiRelatedInformation,new NR(l)),at=l.set(D.ExtHostAiEmbeddingVector,new eB(l)),ot=l.set(D.ExtHostAiSettingsSearch,new wW(l)),st=l.set(D.ExtHostStatusBar,new eW(l,he.converter)),ct=l.set(D.ExtHostSpeech,new ZU(l)),lt=l.set(D.ExtHostEmbeddings,new $z(l)),ut=l.set(D.ExtHostChatSessions,new DW(he,le,l,p));l.set(D.ExtHostMcp,e.get(bR));let dt=Object.values(D);l.assertRegistered(dt);let ft=new GR(l,me),pt=new sz(l),mt=new sH(l,p),ht=new Yz(l),gt=new az(l);return HR.register(he),function(e,n,s){function c(t){return(n,r,i)=>{let a=t(t=>{try{n.call(r,t)}catch(t){te(new _s(e.identifier,t,`FAILED to handle event`))}});return i?.push(a),a}}let l=(function(){e.isUnderDevelopment;function t(){p.info(`Extension '${e.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`)}return function n(r){if(Array.isArray(r))r.forEach(n);else if(typeof r==`string`)t();else{let n=r;n.scheme===void 0&&t(),typeof n.exclusive==`boolean`&&U(e,`documentFiltersExclusive`)}return r}})(),u={getSession(t,n,r){return(typeof r?.forceNewSession==`object`&&r.forceNewSession.learnMore||typeof r?.createIfNone==`object`&&r.createIfNone.learnMore)&&U(e,`authLearnMore`),r?.authorizationServer&&U(e,`authIssuers`),h.getSession(e,t,n,r)},getAccounts(e){return h.getAccounts(e)},async hasSession(t,n){return U(e,`authSession`),!!await h.getSession(e,t,n,{silent:!0})},get onDidChangeSessions(){return c(h.getExtensionScopedSessionsEvent(e.identifier.value))},registerAuthenticationProvider(t,n,r,i){return i?.supportedAuthorizationServers&&U(e,`authIssuers`),h.registerAuthenticationProvider(t,n,r,i)}},d={registerCommand(t,n,r){return he.registerCommand(!0,t,n,r,void 0,e)},registerTextEditorCommand(t,n,r){return he.registerCommand(!0,t,(...e)=>{let i=Me.getActiveTextEditor();if(!i){p.warn(`Cannot execute `+t+` because there is no active text editor.`);return}return i.edit(t=>{n.apply(r,[i,t,...e])}).then(e=>{e||p.warn(`Edits from command `+t+` were not applied.`)},e=>{p.warn(`An error occurred while running command `+t,e)})},void 0,void 0,e)},registerDiffInformationCommand:(t,n,r)=>(U(e,`diffCommand`),he.registerCommand(!0,t,async(...e)=>{let i=me.activeEditor(!0);if(!i){p.warn(`Cannot execute `+t+` because there is no active text editor.`);return}let a=await Me.getDiffInformation(i.id);n.apply(r,[a,...e])},void 0,void 0,e)),executeCommand(e,...t){return he.executeCommand(e,...t)},getCommands(e=!1){return he.getCommands(e)}},f={get machineId(){return t.telemetryInfo.machineId},get sessionId(){return t.telemetryInfo.sessionId},get language(){return t.environment.appLanguage},get appName(){return t.environment.appName},get appRoot(){return t.environment.appRoot?.fsPath??``},get appHost(){return t.environment.appHost},get uriScheme(){return t.environment.appUriScheme},get clipboard(){return pt.value},get shell(){return ge.getDefaultShell(!1)},get onDidChangeShell(){return c(ge.onDidChangeShell)},get isTelemetryEnabled(){return o.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return c(o.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){return U(e,`telemetry`),o.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){return U(e,`telemetry`),c(o.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return XM(t.telemetryInfo.firstSessionDate)},createTelemetryLogger(t,n){return YM.validateSender(t),o.instantiateLogger(e,t,n)},openExternal(e,n){return ne.openUri(e,{allowTunneling:!!t.remote.authority,allowContributedOpeners:n?.allowContributedOpeners})},async asExternalUri(e){if(e.scheme===t.environment.appUriScheme)return re.createAppUri(e);try{return await ne.asExternalUri(e,{allowTunneling:!!t.remote.authority})}catch(t){if(Ia(e,O.http)||Ia(e,O.https))return e;throw t}},get remoteName(){return us(t.remote.authority)},get remoteAuthority(){return U(e,`resolvers`),t.remote.authority},get uiKind(){return t.uiKind},get logLevel(){return p.getLevel()},get onDidChangeLogLevel(){return c(p.onDidChangeLogLevel)},get appQuality(){return U(e,`resolvers`),t.quality},get appCommit(){return U(e,`resolvers`),t.commit},getDataChannel(t){return U(e,`dataChannels`),fe.createDataChannel(e,t)}},ie={createTestController(t,n,r){return Qe.createTestController(e,t,n,r)},createTestObserver(){return U(e,`testObserver`),Qe.createTestObserver()},runTests(t){return U(e,`testObserver`),Qe.runTests(t)},registerTestFollowupProvider(t){return U(e,`testObserver`),Qe.registerTestFollowupProvider(t)},get onDidChangeTestResults(){return U(e,`testObserver`),c(Qe.onResultsChanged)},get testResults(){return U(e,`testObserver`),Qe.results}},se=t.remote.isRemote?jC.Workspace:jC.UI,Je={getExtension(t,r){Hg(e,`extensionsAny`)||(r=!1);let a=n.mine.getExtensionDescription(t);if(a)return new JP(i,e.identifier,a,se,!1);if(r){let r=n.all.getExtensionDescription(t);if(r)return new JP(i,e.identifier,r,se,!0)}},get all(){let t=[];for(let r of n.mine.getAllExtensionDescriptions())t.push(new JP(i,e.identifier,r,se,!1));return t},get allAcrossExtensionHosts(){U(e,`extensionsAny`);let t=new hs(n.mine.getAllExtensionDescriptions().map(e=>e.identifier)),r=[];for(let a of n.all.getAllExtensionDescriptions()){let n=!t.has(a.identifier);r.push(new JP(i,e.identifier,a,se,n))}return r},get onDidChange(){return Hg(e,`extensionsAny`)?c(en.any(n.mine.onDidChange,n.all.onDidChange)):c(n.mine.onDidChange)}},dt={createDiagnosticCollection(t){return Fe.createDiagnosticCollection(e.identifier,t)},get onDidChangeDiagnostics(){return c(Fe.onDidChangeDiagnostics)},getDiagnostics:e=>Fe.getDiagnostics(e),getLanguages(){return Ie.getLanguages()},setTextDocumentLanguage(e,t){return Ie.changeLanguage(e.uri,t)},match(e,t){let n=TO.from(e),r;return AR(n)&&(r=Ee.notebookDocuments.find(e=>e.apiNotebook.getCells().find(e=>e.document===t))?.apiNotebook),kR(n,t.uri,t.languageId,!0,r?.uri,r?.notebookType)},registerCodeActionsProvider(t,n,r){return g.registerCodeActionProvider(e,l(t),n,r)},registerDocumentPasteEditProvider(t,n,r){return g.registerDocumentPasteEditProvider(e,l(t),n,r)},registerCodeLensProvider(t,n){return g.registerCodeLensProvider(e,l(t),n)},registerDefinitionProvider(t,n){return g.registerDefinitionProvider(e,l(t),n)},registerDeclarationProvider(t,n){return g.registerDeclarationProvider(e,l(t),n)},registerImplementationProvider(t,n){return g.registerImplementationProvider(e,l(t),n)},registerTypeDefinitionProvider(t,n){return g.registerTypeDefinitionProvider(e,l(t),n)},registerHoverProvider(t,n){return g.registerHoverProvider(e,l(t),n,e.identifier)},registerEvaluatableExpressionProvider(t,n){return g.registerEvaluatableExpressionProvider(e,l(t),n,e.identifier)},registerInlineValuesProvider(t,n){return g.registerInlineValuesProvider(e,l(t),n,e.identifier)},registerDocumentHighlightProvider(t,n){return g.registerDocumentHighlightProvider(e,l(t),n)},registerMultiDocumentHighlightProvider(t,n){return g.registerMultiDocumentHighlightProvider(e,l(t),n)},registerLinkedEditingRangeProvider(t,n){return g.registerLinkedEditingRangeProvider(e,l(t),n)},registerReferenceProvider(t,n){return g.registerReferenceProvider(e,l(t),n)},registerRenameProvider(t,n){return g.registerRenameProvider(e,l(t),n)},registerNewSymbolNamesProvider(t,n){return U(e,`newSymbolNamesProvider`),g.registerNewSymbolNamesProvider(e,l(t),n)},registerDocumentSymbolProvider(t,n,r){return g.registerDocumentSymbolProvider(e,l(t),n,r)},registerWorkspaceSymbolProvider(t){return g.registerWorkspaceSymbolProvider(e,t)},registerDocumentFormattingEditProvider(t,n){return g.registerDocumentFormattingEditProvider(e,l(t),n)},registerDocumentRangeFormattingEditProvider(t,n){return g.registerDocumentRangeFormattingEditProvider(e,l(t),n)},registerOnTypeFormattingEditProvider(t,n,r,...i){return g.registerOnTypeFormattingEditProvider(e,l(t),n,[r].concat(i))},registerDocumentSemanticTokensProvider(t,n,r){return g.registerDocumentSemanticTokensProvider(e,l(t),n,r)},registerDocumentRangeSemanticTokensProvider(t,n,r){return g.registerDocumentRangeSemanticTokensProvider(e,l(t),n,r)},registerSignatureHelpProvider(t,n,r,...i){return typeof r==`object`?g.registerSignatureHelpProvider(e,l(t),n,r):g.registerSignatureHelpProvider(e,l(t),n,r===void 0?[]:[r,...i])},registerCompletionItemProvider(t,n,...r){return g.registerCompletionItemProvider(e,l(t),n,r)},registerInlineCompletionItemProvider(t,n,r){return n.handleDidShowCompletionItem&&U(e,`inlineCompletionsAdditions`),n.handleDidPartiallyAcceptCompletionItem&&U(e,`inlineCompletionsAdditions`),r&&U(e,`inlineCompletionsAdditions`),g.registerInlineCompletionsProvider(e,l(t),n,r)},registerDocumentLinkProvider(t,n){return g.registerDocumentLinkProvider(e,l(t),n)},registerColorProvider(t,n){return g.registerColorProvider(e,l(t),n)},registerFoldingRangeProvider(t,n){return g.registerFoldingRangeProvider(e,l(t),n)},registerSelectionRangeProvider(t,n){return g.registerSelectionRangeProvider(e,t,n)},registerCallHierarchyProvider(t,n){return g.registerCallHierarchyProvider(e,t,n)},registerTypeHierarchyProvider(t,n){return g.registerTypeHierarchyProvider(e,t,n)},setLanguageConfiguration:(t,n)=>g.setLanguageConfiguration(e,t,n),getTokenInformationAtPosition(t,n){return U(e,`tokenInformation`),Ie.tokenAtPosition(t,n)},registerInlayHintsProvider(t,n){return g.registerInlayHintsProvider(e,t,n)},createLanguageStatusItem(t,n){return Ie.createLanguageStatusItem(e,t,n)},registerDocumentDropEditProvider(t,n,r){return g.registerDocumentOnDropEditProvider(e,t,n,r)}},_t={get activeTextEditor(){return Me.getActiveTextEditor()},get visibleTextEditors(){return Me.getVisibleTextEditors()},get activeTerminal(){return ge.activeTerminal},get terminals(){return ge.terminals},async showTextDocument(t,n,r){w.isUri(t)&&t.scheme===O.vscodeRemote&&!t.authority&&m.report(`workspace.showTextDocument`,e,`A URI of 'vscode-remote' scheme requires an authority.`);let i=await(w.isUri(t)?Promise.resolve(vt.openTextDocument(t)):Promise.resolve(t));return Me.showTextDocument(i,n,r)},createTextEditorDecorationType(t){return Me.createTextEditorDecorationType(e,t)},onDidChangeActiveTextEditor(e,t,n){return c(Me.onDidChangeActiveTextEditor)(e,t,n)},onDidChangeVisibleTextEditors(e,t,n){return c(Me.onDidChangeVisibleTextEditors)(e,t,n)},onDidChangeTextEditorSelection(e,t,n){return c(Me.onDidChangeTextEditorSelection)(e,t,n)},onDidChangeTextEditorOptions(e,t,n){return c(Me.onDidChangeTextEditorOptions)(e,t,n)},onDidChangeTextEditorVisibleRanges(e,t,n){return c(Me.onDidChangeTextEditorVisibleRanges)(e,t,n)},onDidChangeTextEditorViewColumn(e,t,n){return c(Me.onDidChangeTextEditorViewColumn)(e,t,n)},onDidChangeTextEditorDiffInformation(t,n,r){return U(e,`textEditorDiffInformation`),c(Me.onDidChangeTextEditorDiffInformation)(t,n,r)},onDidCloseTerminal(e,t,n){return c(ge.onDidCloseTerminal)(e,t,n)},onDidOpenTerminal(e,t,n){return c(ge.onDidOpenTerminal)(e,t,n)},onDidChangeActiveTerminal(e,t,n){return c(ge.onDidChangeActiveTerminal)(e,t,n)},onDidChangeTerminalDimensions(t,n,r){return U(e,`terminalDimensions`),c(ge.onDidChangeTerminalDimensions)(t,n,r)},onDidChangeTerminalState(e,t,n){return c(ge.onDidChangeTerminalState)(e,t,n)},onDidWriteTerminalData(t,n,r){return U(e,`terminalDataWriteEvent`),c(ge.onDidWriteTerminalData)(t,n,r)},onDidExecuteTerminalCommand(t,n,r){return U(e,`terminalExecuteCommandEvent`),c(ge.onDidExecuteTerminalCommand)(t,n,r)},onDidChangeTerminalShellIntegration(e,t,n){return c(_e.onDidChangeTerminalShellIntegration)(e,t,n)},onDidStartTerminalShellExecution(e,t,n){return c(_e.onDidStartTerminalShellExecution)(e,t,n)},onDidEndTerminalShellExecution(e,t,n){return c(_e.onDidEndTerminalShellExecution)(e,t,n)},get state(){return ne.getState()},onDidChangeWindowState(e,t,n){return c(ne.onDidChangeWindowState)(e,t,n)},showInformationMessage(t,...n){return mt.showMessage(e,xc.Info,t,n[0],n.slice(1))},showWarningMessage(t,...n){return mt.showMessage(e,xc.Warning,t,n[0],n.slice(1))},showErrorMessage(t,...n){return mt.showMessage(e,xc.Error,t,n[0],n.slice(1))},showQuickPick(t,n,r){return Be.showQuickPick(e,t,n,r)},showWorkspaceFolderPick(e){return Be.showWorkspaceFolderPick(e)},showInputBox(e,t){return Be.showInput(e,t)},showOpenDialog(e){return ht.showOpenDialog(e)},showSaveDialog(e){return ht.showSaveDialog(e)},createStatusBarItem(t,n,r){let i,a,o;return typeof t==`string`?(i=t,a=n,o=r):(a=t,o=n),st.createStatusBarEntry(e,i,a,o)},setStatusBarMessage(e,t){return st.setStatusBarMessage(e,t)},withScmProgress(t){return m.report(`window.withScmProgress`,e,`Use 'withProgress' instead.`),ce.withProgress(e,{location:CS.SourceControl},(e,n)=>t({report(e){}}))},withProgress(t,n){return ce.withProgress(e,t,n)},createOutputChannel(t,n){return xe.createOutputChannel(t,n,e)},createWebviewPanel(t,n,r,i){return Ye.createWebviewPanel(e,t,n,r,i)},createWebviewTextEditorInset(t,n,r,i){return U(e,`editorInsets`),Pe.createWebviewEditorInset(t,n,r,i,e)},createTerminal(e,t,n){return typeof e==`object`?`pty`in e?ge.createExtensionTerminal(e):ge.createTerminalFromOptions(e):ge.createTerminal(e,t,n)},registerTerminalLinkProvider(e){return ge.registerLinkProvider(e)},registerTerminalProfileProvider(t,n){return ge.registerProfileProvider(e,t,n)},registerTerminalCompletionProvider(t,...n){return U(e,`terminalCompletionProvider`),ge.registerTerminalCompletionProvider(e,t,...n)},registerTerminalQuickFixProvider(t,n){return U(e,`terminalQuickFixProvider`),ge.registerTerminalQuickFixProvider(t,e.identifier.value,n)},registerTreeDataProvider(t,n){return Ne.registerTreeDataProvider(t,n,e)},createTreeView(t,n){return Ne.createTreeView(t,n,e)},registerWebviewPanelSerializer:(t,n)=>Ye.registerWebviewPanelSerializer(e,t,n),registerCustomEditorProvider:(t,n,r={})=>Xe.registerCustomEditorProvider(e,t,n,r),registerFileDecorationProvider(t){return pe.registerFileDecorationProvider(t,e)},registerUriHandler(t){return re.registerUriHandler(e,t)},createQuickPick(){return Be.createQuickPick(e)},createInputBox(){return Be.createInputBox(e)},get activeColorTheme(){return Ke.activeColorTheme},onDidChangeActiveColorTheme(e,t,n){return c(Ke.onDidChangeActiveColorTheme)(e,t,n)},registerWebviewViewProvider(t,n,r){return Ze.registerWebviewViewProvider(e,t,n,r?.webviewOptions)},get activeNotebookEditor(){return Ee.activeNotebookEditor},onDidChangeActiveNotebookEditor(e,t,n){return c(Ee.onDidChangeActiveNotebookEditor)(e,t,n)},get visibleNotebookEditors(){return Ee.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return c(Ee.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(e,t,n){return c(Oe.onDidChangeNotebookEditorSelection)(e,t,n)},onDidChangeNotebookEditorVisibleRanges(e,t,n){return c(Oe.onDidChangeNotebookEditorVisibleRanges)(e,t,n)},showNotebookDocument(e,t){return Ee.showNotebookDocument(e,t)},registerExternalUriOpener(t,n,r){return U(e,`externalUriOpener`),$e.registerExternalUriOpener(e.identifier,t,n,r)},registerProfileContentHandler(t,n){return U(e,`profileContentHandlers`),et.registerProfileContentHandler(e,t,n)},registerQuickDiffProvider(t,n,r,i,a){return U(e,`quickDiffProvider`),He.registerQuickDiffProvider(e,l(t),n,r,i,a)},get tabGroups(){return ae.tabGroups},registerShareProvider(t,n){return U(e,`shareProvider`),Ue.registerShareProvider(l(t),n)},get nativeHandle(){return U(e,`nativeWindowHandle`),ne.nativeHandle},createChatStatusItem:t=>(U(e,`chatStatusItem`),gt.createChatStatusItem(e,t)),showChatSession:(t,n,r)=>(U(e,`chatSessionsProvider`),ut.showChatSession(e,t,n,r))},vt={get rootPath(){return m.report(`workspace.rootPath`,e,`Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath`),a.getPath()},set rootPath(e){throw new ue(`rootPath`)},getWorkspaceFolder(e){return a.getWorkspaceFolder(e)},get workspaceFolders(){return a.getWorkspaceFolders()},get name(){return a.name},set name(e){throw new ue(`name`)},get workspaceFile(){return a.workspaceFile},set workspaceFile(e){throw new ue(`workspaceFile`)},updateWorkspaceFolders:(t,n,...r)=>a.updateWorkspaceFolders(e,t,n||0,...r),onDidChangeWorkspaceFolders:function(e,t,n){return c(a.onDidChangeWorkspace)(e,t,n)},asRelativePath:(e,t)=>a.getRelativePath(e,t),findFiles:(t,n,r,i)=>a.findFiles(t,n,r,e.identifier,i),findFiles2:(t,n,r)=>(U(e,`findFiles2`),a.findFiles2(t,n,e.identifier,r)),findTextInFiles:(t,n,r,i)=>{U(e,`findTextInFiles`);let o,s;return typeof n==`object`?(o=n,s=r):(o={},s=n,i=r),a.findTextInFiles(t,o||{},s,e.identifier,i)},findTextInFiles2:(t,n,r)=>(U(e,`findTextInFiles2`),U(e,`textSearchProvider2`),a.findTextInFiles2(t,n,e.identifier,r)),save:e=>a.save(e),saveAs:e=>a.saveAs(e),saveAll:e=>a.saveAll(e),applyEdit(t,n){return ft.applyWorkspaceEdit(t,e,n)},createFileSystemWatcher:(t,n,r,i)=>{let o={ignoreCreateEvents:!!n,ignoreChangeEvents:!!r,ignoreDeleteEvents:!!i};return ze.createFileSystemWatcher(a,s,e,t,o)},get textDocuments(){return Ce.getAllDocumentData().map(e=>e.document)},set textDocuments(e){throw new ue(`textDocuments`)},openTextDocument(t,n){let r;if(n??=t,typeof t==`string`)r=Promise.resolve(w.file(t));else if(w.isUri(t))r=Promise.resolve(t);else if(!n||typeof n==`object`)r=Ce.createDocumentData(n);else throw Error(`illegal argument - uriOrFileNameOrOptions`);return r.then(t=>(p.trace(`openTextDocument from ${e.identifier}`),t.scheme===O.vscodeRemote&&!t.authority&&m.report(`workspace.openTextDocument`,e,`A URI of 'vscode-remote' scheme requires an authority.`),Ce.ensureDocumentData(t,n).then(e=>e.document)))},onDidOpenTextDocument:(e,t,n)=>c(Ce.onDidAddDocument)(e,t,n),onDidCloseTextDocument:(e,t,n)=>c(Ce.onDidRemoveDocument)(e,t,n),onDidChangeTextDocument:(t,n,r)=>Hg(e,`textDocumentChangeReason`)?c(Ce.onDidChangeDocumentWithReason)(t,n,r):c(Ce.onDidChangeDocument)(t,n,r),onDidSaveTextDocument:(e,t,n)=>c(Ce.onDidSaveDocument)(e,t,n),onWillSaveTextDocument:(t,n,r)=>c(Te.getOnWillSaveTextDocumentEvent(e))(t,n,r),get notebookDocuments(){return Ee.notebookDocuments.map(e=>e.apiNotebook)},async openNotebookDocument(e,t){let n;if(w.isUri(e))n=e,await Ee.openNotebookDocument(e);else if(typeof e==`string`)n=w.revive(await Ee.createNotebookDocument({viewType:e,content:t}));else throw Error(`Invalid arguments`);return Ee.getNotebookDocument(n).apiNotebook},onDidSaveNotebookDocument(e,t,n){return c(De.onDidSaveNotebookDocument)(e,t,n)},onDidChangeNotebookDocument(e,t,n){return c(De.onDidChangeNotebookDocument)(e,t,n)},onWillSaveNotebookDocument(t,n,r){return c(je.getOnWillSaveNotebookDocumentEvent(e))(t,n,r)},get onDidOpenNotebookDocument(){return c(Ee.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return c(Ee.onDidCloseNotebookDocument)},registerNotebookSerializer(t,n,r,i){return Ee.registerNotebookSerializer(e,t,n,r,Hg(e,`notebookLiveShare`)?i:void 0)},onDidChangeConfiguration:(e,t,n)=>c(s.onDidChangeConfiguration)(e,t,n),getConfiguration(t,n){return n=arguments.length===1?void 0:n,s.getConfiguration(t,n,e)},registerTextDocumentContentProvider(e,t){return we.registerTextDocumentContentProvider(e,t)},registerTaskProvider:(t,n)=>(m.report(`window.registerTaskProvider`,e,`Use the corresponding function on the 'tasks' namespace instead`),be.registerTaskProvider(e,t,n)),registerFileSystemProvider(t,n,i){return bt(Re.registerFileSystemProvider(e,t,n,i),r.addFileSystemProvider(t,n,i))},get fs(){return r.value},registerFileSearchProvider:(t,n)=>(U(e,`fileSearchProvider`),ye.registerFileSearchProviderOld(t,n)),registerTextSearchProvider:(t,n)=>(U(e,`textSearchProvider`),ye.registerTextSearchProviderOld(t,n)),registerAITextSearchProvider:(t,n)=>(U(e,`aiTextSearchProvider`),U(e,`textSearchProvider2`),ye.registerAITextSearchProvider(t,n)),registerFileSearchProvider2:(t,n)=>(U(e,`fileSearchProvider2`),ye.registerFileSearchProvider(t,n)),registerTextSearchProvider2:(t,n)=>(U(e,`textSearchProvider2`),ye.registerTextSearchProvider(t,n)),registerRemoteAuthorityResolver:(t,n)=>(U(e,`resolvers`),i.registerRemoteAuthorityResolver(t,n)),registerResourceLabelFormatter:t=>(U(e,`resolvers`),Ge.$registerResourceLabelFormatter(t)),getRemoteExecServer:t=>(U(e,`resolvers`),i.getRemoteExecServer(t)),onDidCreateFiles:(e,t,n)=>c(ze.onDidCreateFile)(e,t,n),onDidDeleteFiles:(e,t,n)=>c(ze.onDidDeleteFile)(e,t,n),onDidRenameFiles:(e,t,n)=>c(ze.onDidRenameFile)(e,t,n),onWillCreateFiles:(t,n,r)=>c(ze.getOnWillCreateFileEvent(e))(t,n,r),onWillDeleteFiles:(t,n,r)=>c(ze.getOnWillDeleteFileEvent(e))(t,n,r),onWillRenameFiles:(t,n,r)=>c(ze.getOnWillRenameFileEvent(e))(t,n,r),openTunnel:t=>(U(e,`tunnels`),ee.openTunnel(e,t).then(e=>{if(!e)throw Error(`cannot open tunnel`);return e})),get tunnels(){return U(e,`tunnels`),ee.getTunnels()},onDidChangeTunnels:(t,n,r)=>(U(e,`tunnels`),c(ee.onDidChangeTunnels)(t,n,r)),registerPortAttributesProvider:(t,n)=>(U(e,`portsAttributes`),ee.registerPortsAttributesProvider(t,n)),registerTunnelProvider:(t,n)=>(U(e,`tunnelFactory`),ee.registerTunnelProvider(t,n)),registerTimelineProvider:(t,n)=>(U(e,`timeline`),qe.registerTimelineProvider(t,n,e.identifier,he.converter)),get isTrusted(){return a.trusted},requestWorkspaceTrust:t=>(U(e,`workspaceTrust`),a.requestWorkspaceTrust(t)),onDidGrantWorkspaceTrust:(e,t,n)=>c(a.onDidGrantWorkspaceTrust)(e,t,n),registerEditSessionIdentityProvider:(t,n)=>(U(e,`editSessionIdentityProvider`),a.registerEditSessionIdentityProvider(t,n)),onWillCreateEditSessionIdentity:(t,n,r)=>(U(e,`editSessionIdentityProvider`),c(a.getOnWillCreateEditSessionIdentityEvent(e))(t,n,r)),registerCanonicalUriProvider:(t,n)=>(U(e,`canonicalUriProvider`),a.registerCanonicalUriProvider(t,n)),getCanonicalUri:(t,n,r)=>(U(e,`canonicalUriProvider`),a.provideCanonicalUri(t,n,r)),decode(e,t){return a.decode(e,t)},encode(e,t){return a.encode(e,t)}},yt={get inputBox(){return m.report(`scm.inputBox`,e,`Use 'SourceControl.inputBox' instead`),Ve.getLastInputBox(e)},createSourceControl(t,n,r,i,a){return(i||a)&&U(e,`scmProviderOptions`),Ve.createSourceControl(e,t,n,r,i,a)}},_={createCommentController(t,n){return We.createCommentController(e,t,n)}},v={get activeDebugSession(){return ve.activeDebugSession},get activeDebugConsole(){return ve.activeDebugConsole},get breakpoints(){return ve.breakpoints},get activeStackItem(){return ve.activeStackItem},registerDebugVisualizationProvider(t,n){return U(e,`debugVisualization`),ve.registerDebugVisualizationProvider(e,t,n)},registerDebugVisualizationTreeProvider(t,n){return U(e,`debugVisualization`),ve.registerDebugVisualizationTree(e,t,n)},onDidStartDebugSession(e,t,n){return c(ve.onDidStartDebugSession)(e,t,n)},onDidTerminateDebugSession(e,t,n){return c(ve.onDidTerminateDebugSession)(e,t,n)},onDidChangeActiveDebugSession(e,t,n){return c(ve.onDidChangeActiveDebugSession)(e,t,n)},onDidReceiveDebugSessionCustomEvent(e,t,n){return c(ve.onDidReceiveDebugSessionCustomEvent)(e,t,n)},onDidChangeBreakpoints(e,t,n){return c(ve.onDidChangeBreakpoints)(e,t,n)},onDidChangeActiveStackItem(e,t,n){return c(ve.onDidChangeActiveStackItem)(e,t,n)},registerDebugConfigurationProvider(e,t,n){return ve.registerDebugConfigurationProvider(e,t,n||Q_.Initial)},registerDebugAdapterDescriptorFactory(t,n){return ve.registerDebugAdapterDescriptorFactory(e,t,n)},registerDebugAdapterTrackerFactory(e,t){return ve.registerDebugAdapterTrackerFactory(e,t)},startDebugging(e,t,n){return!n||typeof n==`object`&&`configuration`in n?ve.startDebugging(e,t,{parentSession:n}):ve.startDebugging(e,t,n||{})},stopDebugging(e){return ve.stopDebugging(e)},addBreakpoints(e){return ve.addBreakpoints(e)},removeBreakpoints(e){return ve.removeBreakpoints(e)},asDebugSourceUri(e,t){return ve.asDebugSourceUri(e,t)}},y={registerTaskProvider:(t,n)=>be.registerTaskProvider(e,t,n),fetchTasks:e=>be.fetchTasks(e),executeTask:t=>be.executeTask(e,t),get taskExecutions(){return be.taskExecutions},onDidStartTask:(t,n,r)=>{let i=r=>{Hg(e,`taskExecutionTerminal`)||r?.execution?.terminal!==void 0&&(r.execution.terminal=void 0);let i={...r,execution:r.execution};return t.call(n,i)};return c(be.onDidStartTask)(i,n,r)},onDidEndTask:(e,t,n)=>c(be.onDidEndTask)(e,t,n),onDidStartTaskProcess:(e,t,n)=>c(be.onDidStartTaskProcess)(e,t,n),onDidEndTaskProcess:(e,t,n)=>c(be.onDidEndTaskProcess)(e,t,n),onDidStartTaskProblemMatchers:(t,n,r)=>(U(e,`taskProblemMatcherStatus`),c(be.onDidStartTaskProblemMatchers)(t,n,r)),onDidEndTaskProblemMatchers:(t,n,r)=>(U(e,`taskProblemMatcherStatus`),c(be.onDidEndTaskProblemMatchers)(t,n,r))},xt={createNotebookController(t,n,r,i,a){return ke.createNotebookController(e,t,n,r,i,Hg(e,`notebookMessaging`)?a:void 0)},registerNotebookCellStatusBarItemProvider:(t,n)=>Ee.registerNotebookCellStatusBarItemProvider(e,t,n),createRendererMessaging(t){return Ae.createRendererMessaging(e,t)},createNotebookControllerDetectionTask(t){return U(e,`notebookKernelSource`),ke.createNotebookControllerDetectionTask(e,t)},registerKernelSourceActionProvider(t,n){return U(e,`notebookKernelSource`),ke.registerKernelSourceActionProvider(e,t,n)}},St={t(...t){if(typeof t[0]==`string`){let n=t.shift(),r=!t||typeof t[0]!=`object`?t:t[0];return Se.getMessage(e.identifier.value,{message:n,args:r})}return Se.getMessage(e.identifier.value,t[0])},get bundle(){return Se.getBundle(e.identifier.value)},get uri(){return Se.getBundleUri(e.identifier.value)}},Ct={transferActiveChat(t){return U(e,`interactive`),rt.transferActiveChat(t)}},wt={getRelatedInformation(t,n){return U(e,`aiRelatedInformation`),it.getRelatedInformation(e,t,n)},registerRelatedInformationProvider(t,n){return U(e,`aiRelatedInformation`),it.registerRelatedInformationProvider(e,t,n)},registerEmbeddingVectorProvider(t,n){return U(e,`aiRelatedInformation`),at.registerEmbeddingVectorProvider(e,t,n)},registerSettingsSearchProvider(t){return U(e,`aiSettingsSearch`),ot.registerSettingsSearchProvider(e,t)}},Tt={registerMappedEditsProvider(t,n){return U(e,`mappedEditsProvider`),{dispose(){}}},registerMappedEditsProvider2(t){return U(e,`mappedEditsProvider`),Le.registerMappedEditsProvider(e,t)},createChatParticipant(t,n){return rt.createChatAgent(e,t,n)},createDynamicChatParticipant(t,n,r){return U(e,`chatParticipantPrivate`),rt.createDynamicChatAgent(e,t,n,r)},registerChatParticipantDetectionProvider(t){return U(e,`chatParticipantPrivate`),rt.registerChatParticipantDetectionProvider(e,t)},registerRelatedFilesProvider(t,n){return U(e,`chatEditing`),rt.registerRelatedFilesProvider(e,t,n)},onDidDisposeChatSession:(t,n,r)=>(U(e,`chatParticipantPrivate`),c(rt.onDidDisposeChatSession)(t,n,r)),registerChatSessionItemProvider:(t,n)=>(U(e,`chatSessionsProvider`),ut.registerChatSessionItemProvider(e,t,n)),registerChatSessionContentProvider(t,n){return U(e,`chatSessionsProvider`),ut.registerChatSessionContentProvider(e,t,n)},registerChatOutputRenderer:(t,n)=>(U(e,`chatOutputRenderer`),tt.registerChatOutputRenderer(e,t,n))},Et={selectChatModels:t=>le.selectLanguageModels(e,t??{}),onDidChangeChatModels:(e,t,n)=>le.onDidChangeProviders(e,t,n),registerChatModelProvider:(t,n)=>(U(e,`chatProvider`),le.registerLanguageModelProvider(e,t,n)),get embeddingModels(){return U(e,`embeddings`),lt.embeddingsModels},onDidChangeEmbeddingModels:(t,n,r)=>(U(e,`embeddings`),lt.onDidChange(t,n,r)),registerEmbeddingsProvider(t,n){return U(e,`embeddings`),lt.registerEmbeddingsProvider(e,t,n)},async computeEmbeddings(t,n,r){return U(e,`embeddings`),lt.computeEmbeddings(t,n,r)},registerTool(t,n){return nt.registerTool(e,t,n)},invokeTool(t,n,r){return nt.invokeTool(e,t,n,r)},get tools(){return nt.getTools(e)},fileIsIgnored(t,n){return le.fileIsIgnored(e,t,n)},registerIgnoredFileProvider(t){return le.registerIgnoredFileProvider(e,t)},registerMcpServerDefinitionProvider(t,n){return de.registerMcpConfigurationProvider(e,t,n)},onDidChangeChatRequestTools(...t){return U(e,`chatParticipantAdditions`),c(rt.onDidChangeChatRequestTools)(...t)}},Dt={registerSpeechProvider(t,n){return U(e,`speech`),ct.registerProvider(e.identifier,t,n)}};return{version:t.version,ai:wt,authentication:u,commands:d,comments:_,chat:Tt,debug:v,env:f,extensions:Je,interactive:Ct,l10n:St,languages:dt,lm:Et,notebooks:xt,scm:yt,speech:Dt,tasks:y,tests:ie,window:_t,workspace:vt,Breakpoint:US,TerminalOutputAnchor:Mb,ChatResultFeedbackKind:Rw,ChatVariableLevel:Nw,ChatCompletionItem:Pw,ChatReferenceDiagnostic:mT,CallHierarchyIncomingCall:vx,CallHierarchyItem:_x,CallHierarchyOutgoingCall:yx,CancellationError:oe,CancellationTokenSource:Ai,CandidatePortSource:Ci,CodeAction:mx,CodeActionKind:hx,CodeActionTriggerKind:px,CodeLens:xx,Color:Xx,ColorInformation:Zx,ColorPresentation:Qx,ColorThemeKind:PC,CommentMode:mC,CommentState:hC,CommentThreadCollapsibleState:pC,CommentThreadState:gC,CommentThreadApplicability:_C,CommentThreadFocus:vC,CompletionItem:Mx,CompletionItemKind:G,CompletionItemTag:jx,CompletionList:Nx,CompletionTriggerKind:Ax,ConfigurationTarget:zS,CustomExecution:xS,DebugAdapterExecutable:qS,DebugAdapterInlineImplementation:XS,DebugAdapterNamedPipeServer:YS,DebugAdapterServer:JS,DebugConfigurationProviderTriggerKind:Q_,DebugConsoleMode:TC,DebugVisualization:EC,DecorationRangeBehavior:qx,Diagnostic:nx,DiagnosticRelatedInformation:tx,DiagnosticSeverity:$b,DiagnosticTag:Qb,Disposable:Pb,DocumentHighlight:sx,DocumentHighlightKind:ox,MultiDocumentHighlight:cx,DocumentLink:Yx,DocumentSymbol:fx,EndOfLine:Wb,EnvironmentVariableMutatorType:Gb,EvaluatableExpression:$S,InlineValueText:nC,InlineValueVariableLookup:rC,InlineValueEvaluatableExpression:iC,InlineCompletionTriggerKind:eC,InlineCompletionsDisposeReasonKind:tC,EventEmitter:x,ExtensionKind:jC,ExtensionMode:QC,ExternalUriOpenerPriority:gw,FileChangeType:lC,FileDecoration:MC,FileDecoration2:MC,FileSystemError:uC,FileType:ac,FilePermission:oc,FoldingRange:dC,FoldingRangeKind:fC,FunctionBreakpoint:GS,InlineCompletionItem:Px,InlineCompletionList:Fx,Hover:rx,VerboseHover:ix,HoverVerbosityAction:ax,IndentAction:jR,Location:ex,MarkdownString:Sx,OverviewRulerLane:$p,ParameterInformation:Cx,PortAutoForwardAction:vw,Position:Fb,ProcessExecution:_S,ProgressLocation:CS,QuickInputButtonLocation:DC,QuickInputButtons:OC,Range:Ib,RelativePattern:BS,Selection:Lb,SelectionRange:gx,SemanticTokens:SC,SemanticTokensBuilder:xC,SemanticTokensEdit:CC,SemanticTokensEdits:wC,SemanticTokensLegend:yC,ShellExecution:vS,ShellQuoting:yS,SignatureHelp:Tx,SignatureHelpTriggerKind:Ex,SignatureInformation:wx,SnippetString:Zb,SourceBreakpoint:WS,StandardTokenType:ew,StatusBarAlignment:zx,SymbolInformation:dx,SymbolKind:lx,SymbolTag:ux,Task:SS,TaskEventKind:pS,TaskGroup:hS,TaskPanelKind:mS,TaskRevealKind:fS,TaskScope:bS,TerminalLink:iS,TerminalQuickFixTerminalCommand:oS,TerminalQuickFixOpener:aS,TerminalLocation:sS,TerminalProfile:cS,TerminalExitReason:tS,TerminalShellExecutionCommandLineConfidence:nS,TerminalCompletionItem:uS,TerminalCompletionItemKind:lS,TerminalCompletionList:dS,TerminalShellType:rS,TextDocumentSaveReason:Hx,TextEdit:Kb,SnippetTextEdit:Jb,TextEditorCursorStyle:_f,TextEditorChangeKind:Gx,TextEditorLineNumbersStyle:Vx,TextEditorRevealType:Ux,TextEditorSelectionChangeKind:Wx,SyntaxTokenType:Jx,TextDocumentChangeReason:Kx,ThemeColor:RS,ThemeIcon:LS,TreeItem:TS,TreeItemCheckboxState:DS,TreeItemCollapsibleState:ES,TypeHierarchyItem:yw,UIKind:hn,Uri:w,ViewColumn:Rx,WorkspaceEdit:Xb,DocumentPasteTriggerKind:PS,DocumentDropEdit:NS,DocumentDropOrPasteEditKind:FS,DocumentPasteEdit:IS,InlayHint:kx,InlayHintLabelPart:Ox,InlayHintKind:Dx,RemoteAuthorityResolverError:Ub,ResolvedAuthority:Vb,ManagedResolvedAuthority:Hb,SourceControlInputBoxValidationType:eS,ExtensionRuntime:$C,TimelineItem:ZC,NotebookRange:FC,NotebookCellKind:VC,NotebookCellExecutionState:HC,NotebookCellData:IC,NotebookData:LC,NotebookRendererScript:JC,NotebookCellStatusBarAlignment:UC,NotebookEditorRevealType:WC,NotebookCellOutput:zC,NotebookCellOutputItem:RC,CellErrorStackFrame:BC,NotebookCellStatusBarItem:GC,NotebookControllerAffinity:KC,NotebookControllerAffinity2:qC,NotebookEdit:qb,NotebookKernelSourceAction:YC,NotebookVariablesRequestKind:XC,PortAttributes:nw,LinkedEditingRanges:tw,TestResultState:rw,TestRunRequest:ow,TestMessage:sw,TestMessageStackFrame:lw,TestTag:cw,TestRunProfileKind:iw,TextSearchCompleteMessageType:Xk,DataTransfer:MS,DataTransferItem:OS,TestCoverageCount:uw,FileCoverage:fw,StatementCoverage:pw,BranchCoverage:mw,DeclarationCoverage:hw,WorkspaceTrustState:_w,LanguageStatusSeverity:bx,QuickPickItemKind:kC,InputBoxValidationSeverity:AC,TabInputText:bw,TabInputTextDiff:xw,TabInputTextMerge:Sw,TabInputCustom:Cw,TabInputNotebook:Tw,TabInputNotebookDiff:Ew,TabInputWebview:ww,TabInputTerminal:Dw,TabInputInteractiveWindow:Ow,TabInputChat:kw,TabInputTextMultiDiff:Aw,TelemetryTrustedValue:Og,LogLevel:eF,EditSessionIdentityMatch:MR,InteractiveSessionVoteDirection:jw,ChatCopyKind:Mw,ChatEditingSessionActionOutcome:Fw,InteractiveEditorResponseFeedbackKind:Lw,DebugStackFrame:ZS,DebugThread:QS,RelatedInformationType:PT,SpeechToTextStatus:IT,TextToSpeechStatus:LT,PartialAcceptTriggerKind:Ix,InlineCompletionEndOfLifeReasonKind:Lx,KeywordRecognitionStatus:RT,ChatImageMimeType:TT,ChatResponseMarkdownPart:zw,ChatResponseFileTreePart:Hw,ChatResponseAnchorPart:Ww,ChatResponseProgressPart:Gw,ChatResponseProgressPart2:Kw,ChatResponseReferencePart:Yw,ChatResponseReferencePart2:Yw,ChatResponseCodeCitationPart:Zw,ChatResponseCodeblockUriPart:Xw,ChatResponseWarningPart:qw,ChatResponseTextEditPart:tT,ChatResponseNotebookEditPart:nT,ChatResponseMarkdownWithVulnerabilitiesPart:Bw,ChatResponseCommandButtonPart:Jw,ChatResponseConfirmationPart:Vw,ChatResponseMovePart:Qw,ChatResponseExtensionsPart:$w,ChatResponsePullRequestPart:eT,ChatPrepareToolInvocationPart:rT,ChatResponseMultiDiffPart:Uw,ChatResponseReferencePartStatusKind:lT,ChatResponseClearToPreviousToolInvocationReason:uT,ChatRequestTurn:aT,ChatRequestTurn2:aT,ChatResponseTurn:oT,ChatResponseTurn2:sT,ChatToolInvocationPart:iT,ChatLocation:cT,ChatRequestEditorData:dT,ChatRequestNotebookData:fT,ChatReferenceBinaryData:pT,ChatRequestEditedFileEventKind:Iw,LanguageModelChatMessageRole:hT,LanguageModelChatMessage:yT,LanguageModelChatMessage2:bT,LanguageModelToolResultPart:gT,LanguageModelToolResultPart2:_T,LanguageModelTextPart:CT,LanguageModelTextPart2:CT,ToolResultAudience:ST,LanguageModelToolCallPart:xT,LanguageModelError:DT,LanguageModelToolResult:OT,LanguageModelToolResult2:kT,LanguageModelDataPart:wT,LanguageModelDataPart2:wT,LanguageModelToolExtensionSource:MT,LanguageModelToolMCPSource:NT,ExtendedLanguageModelToolResult:AT,LanguageModelChatToolMode:jT,LanguageModelPromptTsxPart:ET,NewSymbolName:cC,NewSymbolNameTag:oC,NewSymbolNameTriggerKind:sC,ExcludeSettingOptions:Yk,TextSearchContext2:qk,TextSearchMatch2:Kk,AISearchKeyword:Jk,TextSearchCompleteMessageTypeNew:Xk,ChatErrorLevel:vT,McpHttpServerDefinition:BT,McpStdioServerDefinition:zT,SettingsSearchResultKind:FT}}}var AW;let jW=class{constructor(e,t,n,r,i,a,o){this._apiFactory=e,this._extensionRegistry=t,this._instaService=n,this._extHostConfiguration=r,this._extHostExtensionService=i,this._initData=a,this._logService=o,this._factories=new Map,this._alternatives=[]}async install(){this._installInterceptor(),Tn(`code/extHost/willWaitForConfig`);let e=await this._extHostConfiguration.getConfigProvider();Tn(`code/extHost/didWaitForConfig`);let t=await this._extHostExtensionService.getExtensionPathIndex();this.register(new NW(this._apiFactory,t,this._extensionRegistry,e,this._logService)),this.register(this._instaService.createInstance(MW)),this._initData.remote.isRemote&&this.register(this._instaService.createInstance(PW,t,this._initData.environment.appUriScheme))}register(e){if(`nodeModuleName`in e)if(Array.isArray(e.nodeModuleName))for(let t of e.nodeModuleName)this._factories.set(t,e);else this._factories.set(e.nodeModuleName,e);typeof e.alternativeModuleName==`function`&&this._alternatives.push(t=>e.alternativeModuleName(t))}};jW=A([j(2,ys),j(3,kj),j(4,qP),j(5,ks),j(6,xs)],jW);let MW=class{static{AW=this}static{this.aliased=new Map([[`vscode-ripgrep`,`@vscode/ripgrep`],[`vscode-windows-registry`,`@vscode/windows-registry`]])}constructor(e){if(e.environment.appRoot&&AW.aliased.size){let t=zi(this.forceForwardSlashes(e.environment.appRoot.fsPath)),n=`[a-z0-9_.-]`,r=`@${n}+\\/${n}+|${n}+`;this.re=RegExp(`^(${t}/node_modules|node_modules\\.asar(?:\\.unpacked)?\\/)(${r})(.*)$`,`i`)}}alternativeModuleName(e){if(!this.re)return;let t=this.re.exec(this.forceForwardSlashes(e));if(!t)return;let[,n,r,i]=t,a=AW.aliased.get(r);if(a!==void 0)return console.warn(`${r} as been renamed to ${a}, please update your imports`),n+a+i}forceForwardSlashes(e){return e.replace(/\\/g,`/`)}};MW=AW=A([j(0,ks)],MW);var NW=class{constructor(e,t,n,r,i){this._apiFactory=e,this._extensionPaths=t,this._extensionRegistry=n,this._configProvider=r,this._logService=i,this.nodeModuleName=`vscode`,this._extApiImpl=new gs}load(e,t){let n=this._extensionPaths.findSubstr(t);if(n){let e=this._extApiImpl.get(n.identifier);return e||(e=this._apiFactory(n,this._extensionRegistry,this._configProvider),this._extApiImpl.set(n.identifier,e)),e}if(!this._defaultApiImpl){let e=``;this._extensionPaths.forEach((t,n)=>e+=`\t${n} -> ${t.identifier.value}\n`),this._logService.warn(`Could not identify extension for 'vscode' require call from ${t}. These are the extension path mappings: \n${e}`),this._defaultApiImpl=this._apiFactory(zg,this._extensionRegistry,this._configProvider)}return this._defaultApiImpl}};let PW=class{constructor(e,t,n){this._extensionPaths=e,this._appUriScheme=t,this.nodeModuleName=[`open`,`opn`],this._mainThreadTelemetry=n.getProxy(E.MainThreadTelemetry);let r=n.getProxy(E.MainThreadWindow);this._impl=(e,t)=>{let n=w.parse(e);return t?this.callOriginal(e,t):n.scheme===`http`||n.scheme===`https`?r.$openUri(n,e,{allowTunneling:!0}):n.scheme===`mailto`||n.scheme===this._appUriScheme?r.$openUri(n,e,{}):this.callOriginal(e,t)}}load(e,t,n){let r=this._extensionPaths.findSubstr(t);return r&&(this._extensionId=r.identifier.value,this.sendShimmingTelemetry()),this._original=n(e),this._impl}callOriginal(e,t){return this.sendNoForwardTelemetry(),this._original(e,t)}sendShimmingTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2(`shimming.open`,{extension:this._extensionId})}sendNoForwardTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2(`shimming.open.call.noForward`,{extension:this._extensionId})}};PW=A([j(2,Is)],PW);let FW=class{constructor(e,t){this._mainThreadConsole=e.getProxy(E.MainThreadConsole),this._includeStack=t.consoleForward.includeStack,this._logNative=t.consoleForward.logNative,this._wrapConsoleMethod(`info`,`log`),this._wrapConsoleMethod(`log`,`log`),this._wrapConsoleMethod(`warn`,`warn`),this._wrapConsoleMethod(`debug`,`debug`),this._wrapConsoleMethod(`error`,`error`)}_wrapConsoleMethod(e,t){let n=this,r=console[e];Object.defineProperty(console,e,{set:()=>{},get:()=>(function(){n._handleConsoleCall(e,t,r,arguments)})})}_handleConsoleCall(e,t,n,r){this._mainThreadConsole.$logExtensionHostMessage({type:`__$console`,severity:t,arguments:IW(r,this._includeStack)}),this._logNative&&this._nativeConsoleLogMessage(e,n,r)}};FW=A([j(0,Is),j(1,ks)],FW);function IW(e,t){let n=[];if(e.length)for(let t=0;t<e.length;t++){let r=e[t];if(r===void 0)r=`undefined`;else if(r instanceof Error){let e=r;r=e.stack?e.stack:e.toString()}n.push(r)}if(t){let e=Error().stack;e&&n.push({__$stack:e.split(`
`).slice(3).join(`
`)})}try{let e=nc(n);return e.length>1e5?`Output omitted for a large object that exceeds the limits`:e}catch(e){return`Output omitted for an object that cannot be inspected ('${e.toString()}')`}}let LW=class extends FW{constructor(e,t){super(e,t)}_nativeConsoleLogMessage(e,t,n){t.apply(console,n)}};LW=A([j(0,Is),j(1,ks)],LW);var RW=class extends jW{_installInterceptor(){}getModule(e,t){for(let t of this._alternatives){let n=t(e);if(n){e=n;break}}if(this._factories.has(e))return this._factories.get(e).load(e,t,()=>{throw Error(`CANNOT LOAD MODULE from here.`)})}},zW=class extends UP{constructor(){super(...arguments),this.extensionRuntime=$C.Webworker}async _beforeAlmostReadyToRunExtensions(){tr&&this._instaService.createInstance(LW),this._apiFactory=this._instaService.invokeFunction(kW),this._fakeModules=this._instaService.createInstance(RW,this._apiFactory,{mine:this._myRegistry,all:this._globalRegistry}),await this._fakeModules.install(),performance.mark(`code/extHost/didInitAPI`),await this._waitForDebuggerAttachment()}_getEntryPoint(e){return e.browser}async _loadCommonJSModule(e,t,n){t=t.with({path:BW(t.path,`.js`)});let r=e?.identifier.value;r&&performance.mark(`code/extHost/willFetchExtensionCode/${r}`);let i=w.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(t)),a=await fetch(i.toString(!0));if(r&&performance.mark(`code/extHost/didFetchExtensionCode/${r}`),a.status!==200)throw Error(a.statusText);let o=await a.text(),s=`${t.toString(!0)}#vscode-extension`,c=`${o}\n//# sourceURL=${s}`,l;try{l=Function(`module`,`exports`,`require`,c)}catch(e){throw r?console.error(`Loading code for extension ${r} failed: ${e.message}`):console.error(`Loading code failed: ${e.message}`),console.error(`${t.toString(!0)}${typeof e.line==`number`?` line ${e.line}`:``}${typeof e.column==`number`?` column ${e.column}`:``}`),console.error(e),e}e&&await this._extHostLocalizationService.initializeLocalizedMessages(e);let u={},d={exports:u},f=e=>{let n=this._fakeModules.getModule(e,t);if(n===void 0)throw Error(`Cannot load module '${e}'`);return n};try{return n.codeLoadingStart(),r&&performance.mark(`code/extHost/willLoadExtensionCode/${r}`),l(d,u,f),d.exports===u?u:d.exports}finally{r&&performance.mark(`code/extHost/didLoadExtensionCode/${r}`),n.codeLoadingStop()}}_loadESMModule(e,t,n){throw Error(`ESM modules are not supported in the web worker extension host`)}async $setRemoteEnvironment(e){}async _waitForDebuggerAttachment(e=5e3){if(!this._initData.environment.isExtensionDevelopmentDebug)return;let t=Date.now()+e;for(;Date.now()<t&&!(`__jsDebugIsReady`in globalThis);)await xo(10)}};function BW(e,t){let n=Gr(e);return n?e:e+t}Es(GN,KN,Ts.Eager),Es(qP,zW,Ts.Eager),Es(Zj,Qj,Ts.Eager),Es(ZM,new Cs(JM,[!0],!0));const VW=self.close.bind(self);self.close=()=>console.trace(`'close' has been blocked`);const HW=postMessage.bind(self);self.postMessage=()=>console.trace(`'postMessage' has been blocked`);function UW(e){return/^(file|extension-file|vscode-remote):/i.test(e)}const WW=fetch.bind(self);function GW(e){self.fetch=async function(t,n){return t instanceof Request||UW(String(t))&&(t=(await e(w.parse(String(t)))).toString(!0)),WW(t,n)},self.XMLHttpRequest=class extends XMLHttpRequest{open(t,n,r,i,a){(async()=>{UW(n.toString())&&(n=(await e(w.parse(n.toString()))).toString(!0)),super.open(t,n,r??!0,i,a)})()}}}self.importScripts=()=>{throw Error(`'importScripts' has been blocked`)},self.addEventListener=()=>console.trace(`'addEventListener' has been blocked`),self.AMDLoader=void 0,self.NLSLoaderPlugin=void 0,self.define=void 0,self.require=void 0,self.webkitRequestFileSystem=void 0,self.webkitRequestFileSystemSync=void 0,self.webkitResolveLocalFileSystemSyncURL=void 0,self.webkitResolveLocalFileSystemURL=void 0;function KW(e,t){if(self.Worker){let n=self.Worker;Worker=function(r,i){if(/^vscode-remote:/i.test(r.toString()))throw Error(`Creating workers from remote extensions is currently not supported.`);async function a(n){let[r,i]=await Promise.all([e(n).then(e=>e.toString(!0)),t().then(e=>Object.fromEntries(e.map(([e,t])=>[e.toString(!0),t.toString(!0)])))]),a=(function(e,t){function n(e){return typeof e==`string`||e instanceof URL?(e=String(e).replace(/^file:\/\//i,`vscode-file://vscode-app`),t[e]??e):e}let r=fetch.bind(self);self.fetch=function(e,t){return e instanceof Request?r(e,t):r(n(e),t)},self.XMLHttpRequest=class extends XMLHttpRequest{constructor(){super(...arguments),this.notFound=!1}open(e,t,r,i,a){let o=n(t);return this.notFound=o.startsWith(`extension-file:`),super.open(e,o,r??!0,i,a)}send(e){this.notFound||super.send(e)}get status(){return this.notFound?404:super.status}};let i=importScripts.bind(self);self.importScripts=(...e)=>{i(...e.map(n))},self.importExt=e=>Function(`url`,`return import(url)`)(n(e)),i(e)}).toString(),o=`(${a}('${r}', ${JSON.stringify(i)}))`,s=new Blob([o],{type:`application/javascript`});return URL.createObjectURL(s)}i||={},i.name=`${name} -> ${i.name||Wr(r.toString())}`;class o{constructor(e,t){this._onmessage=null,this._onmessageerror=null,this._onerror=null,this.workerPromise=a(w.parse(e instanceof URL?e.toString():e)).then(e=>new n(e,t))}set onmessage(e){this._onmessage=e,this.workerPromise.then(t=>{t.onmessage=e},console.error)}get onmessage(){return this._onmessage}set onmessageerror(e){this._onmessageerror=e,this.workerPromise.then(t=>{t.onmessageerror=e},console.error)}get onmessageerror(){return this._onmessageerror}set onerror(e){this._onerror=e,this.workerPromise.then(t=>{t.onerror=e},console.error)}get onerror(){return this._onerror}postMessage(e,t){this.workerPromise.then(n=>{n.postMessage(e,t)},console.error)}terminate(){this.workerPromise.then(e=>{e.terminate()},console.error)}addEventListener(e,t,n){this.workerPromise.then(r=>{r.addEventListener(e,t,n)},console.error)}removeEventListener(e,t,n){this.workerPromise.then(r=>{r.removeEventListener(e,t,n)},console.error)}dispatchEvent(e){return this.workerPromise.then(t=>{t.dispatchEvent(e)},console.error),!1}}return new o(r,i)}}else self.Worker=class extends vF{constructor(e,t){super(HW,e,{name:Wr(e.toString()),...t})}}}const qW=new class{constructor(){this.pid=void 0}exit(e){VW()}};var JW=class{constructor(){let e=new MessageChannel,t=new x,n=!1;HW(e.port2,[e.port2]),e.port1.onmessage=e=>{let{data:r}=e;if(!(r instanceof ArrayBuffer)){console.warn(`UNKNOWN data received`,r);return}let i=b.wrap(new Uint8Array(r,0,r.byteLength));if(yn(i,_n.Terminate)){n=!0,XW(`received terminate message from renderer`);return}t.fire(i)},this.protocol={onMessage:t.event,send:t=>{if(!n){let n=t.buffer.buffer.slice(t.buffer.byteOffset,t.buffer.byteOffset+t.buffer.byteLength);e.port1.postMessage(n,[n])}}}}};function YW(e){return new Promise(t=>{let n=e.onMessage(r=>{n.dispose();let i=JSON.parse(r.toString());e.send(vn(_n.Initialized)),t({protocol:e,initData:i})});e.send(vn(_n.Ready))})}let XW=e=>VW();function ZW(e){return!!e&&typeof e==`object`&&e.type===`vscode.init`&&e.data instanceof Map}function QW(){Tn(`code/extHost/willConnectToRenderer`);let e=new JW;return{onmessage(t){ZW(t)&&YW(e.protocol).then(e=>{Tn(`code/extHost/didWaitForInitData`);let n=new gF(e.protocol,e.initData,qW,null,t.data);GW(e=>n.asBrowserUri(e)),KW(e=>n.asBrowserUri(e),()=>n.getAllStaticBrowserUris()),XW=e=>n.terminate(e)})}}}const $W=QW();self.onmessage=e=>$W.onmessage(e.data);export{o as __commonJSMin};